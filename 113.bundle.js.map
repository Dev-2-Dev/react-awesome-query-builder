{"version":3,"file":"113.bundle.js","mappings":"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","sources":["webpack://react-awesome-query-builder-demo-local/../modules/components/operators/Proximity.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/WidgetFactory.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/Widget.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/utils.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/ValueField.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/FuncSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/FuncWidget.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaBoolean.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaText.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaTextArea.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaDate.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaTime.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaDateTime.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaMultiSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaNumber.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/value/VanillaSlider.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaFieldSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaConjs.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaButton.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaButtonGroup.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaValueSources.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/VanillaSwitch.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/core/vanillaConfirm.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/vanilla/index.js","webpack://react-awesome-query-builder-demo-local/../modules/config/basic.js","webpack://react-awesome-query-builder-demo-local/../modules/config/default.js","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialAutocomplete.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialFieldAutocomplete.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialValueSources.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/index.js","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialText.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialTextArea.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialDate.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialDateTime.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialTime.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialNumber.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialSlider.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialRange.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialBoolean.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/value/MaterialMultiSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialFieldSelect.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialButton.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialButtonGroup.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialConjs.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialSwitch.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/widgets/material/core/MaterialConfirm.jsx","webpack://react-awesome-query-builder-demo-local/../modules/config/material/index.js","webpack://react-awesome-query-builder-demo-local/../modules/hooks/useListValuesAutocomplete.jsx","webpack://react-awesome-query-builder-demo-local/../modules/constants.js","webpack://react-awesome-query-builder-demo-local/../modules/stores/tree.js","webpack://react-awesome-query-builder-demo-local/../modules/stores/context.js","webpack://react-awesome-query-builder-demo-local/../modules/actions/tree.js","webpack://react-awesome-query-builder-demo-local/../modules/actions/group.js","webpack://react-awesome-query-builder-demo-local/../modules/actions/rule.js","webpack://react-awesome-query-builder-demo-local/../modules/actions/drag.js","webpack://react-awesome-query-builder-demo-local/../modules/components/Query.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/QueryContainer.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/containers/RuleContainer.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/containers/SortableContainer.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/containers/Draggable.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/Operator.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/OperatorWrapper.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/Field.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/FieldWrapper.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/rule/OperatorOptions.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/Rule.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/containers/GroupContainer.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/GroupActions.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/Group.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/RuleGroupActions.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/RuleGroup.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/RuleGroupExtActions.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/RuleGroupExt.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/SwitchGroupActions.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/SwitchGroup.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/CaseGroup.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/item/Item.jsx","webpack://react-awesome-query-builder-demo-local/../modules/components/Builder.jsx","webpack://react-awesome-query-builder-demo-local/../modules/export/queryBuilder.js","webpack://react-awesome-query-builder-demo-local/../modules/export/jsonLogic.js","webpack://react-awesome-query-builder-demo-local/../modules/export/mongoDb.js","webpack://react-awesome-query-builder-demo-local/../modules/export/sql.js","webpack://react-awesome-query-builder-demo-local/../modules/export/spel.js","webpack://react-awesome-query-builder-demo-local/../modules/export/queryString.js","webpack://react-awesome-query-builder-demo-local/../modules/export/elasticSearch.js","webpack://react-awesome-query-builder-demo-local/../modules/import/tree.js","webpack://react-awesome-query-builder-demo-local/../modules/import/jsonLogic.js","webpack://react-awesome-query-builder-demo-local/../modules/import/spel.js","webpack://react-awesome-query-builder-demo-local/../modules/config/funcs.js","webpack://react-awesome-query-builder-demo-local/../modules/index.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/autocomplete.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/configUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/defaultUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/export.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/funcUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/reactUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/ruleUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/stuff.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/treeUtils.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/uuid.js","webpack://react-awesome-query-builder-demo-local/../modules/utils/validation.js","webpack://react-awesome-query-builder-demo-local/../node_modules/moment/locale/ sync [/\\\\](es-us(\\.js)"],"sourcesContent":["import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport range from \"lodash/range\";\n\nexport default class Proximity extends PureComponent {\n  static propTypes = {\n    config: PropTypes.object.isRequired,\n    setOption: PropTypes.func.isRequired,\n    options: PropTypes.any.isRequired, //instanceOf(Immutable.Map)\n    minProximity: PropTypes.number,\n    maxProximity: PropTypes.number,\n    optionPlaceholder: PropTypes.string,\n    optionTextBefore: PropTypes.string,\n    optionLabel: PropTypes.string,\n    customProps: PropTypes.object,\n    readonly: PropTypes.bool,\n    //children\n  };\n\n  static defaultProps = {\n    customProps: {},\n    minProximity: 2,\n    maxProximity: 10,\n    optionPlaceholder: \"Select words between\",\n    optionLabel: \"Words between\",\n    optionTextBefore: null,\n  };\n\n  handleChange = (value) => {\n    this.props.setOption(\"proximity\", parseInt(value));\n  };\n\n  render() {\n    const {\n      defaults, options, config, optionLabel, optionPlaceholder, customProps, \n      minProximity, maxProximity, optionTextBefore, readonly\n    } = this.props;\n    const {settings, widgets} = config;\n    const defaultProximity = defaults ? defaults.proximity : undefined;\n    const {showLabels} = settings;\n    const selectedProximity = options.get(\"proximity\", defaultProximity);\n    const proxValues = range(minProximity, maxProximity + 1).map((item) => ({title: item, value: item}));\n    const Select = widgets.select.factory;\n\n    return (\n      <div className=\"operator--PROXIMITY\">\n        <div className=\"operator--options\">\n          { showLabels\n            && <label className=\"rule--label\">{optionLabel}</label>\n          }\n          { !showLabels && optionTextBefore\n            && <div className=\"operator--options--sep\">\n              <span>{optionTextBefore}</span>\n            </div>\n          }\n          <Select\n            config={config}\n            value={selectedProximity}\n            listValues={proxValues}\n            setValue={this.handleChange}\n            readonly={readonly}\n            placeholder={optionPlaceholder}\n            {...customProps}\n          />\n        </div>\n        <div className=\"operator--widgets\">{this.props.children}</div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport {getTitleInListValues} from \"../../utils/stuff\";\n\nexport default ({\n  delta, isFuncArg, valueSrc,\n  value: immValue, valueError: immValueError, asyncListValues,\n  isSpecialRange, fieldDefinition,\n  widget, widgetDefinition, widgetValueLabel, valueLabels, textSeparators, setValueHandler,\n  config, field, operator, readonly, parentField, parentFuncs, id, groupId\n}) => {\n  const {factory: widgetFactory, ...fieldWidgetProps} = widgetDefinition;\n  const isConst = isFuncArg && fieldDefinition.valueSources && fieldDefinition.valueSources.length == 1 && fieldDefinition.valueSources[0] == \"const\";\n  const defaultValue = fieldDefinition.defaultValue;\n\n  if (!widgetFactory) {\n    return \"?\";\n  }\n    \n  let value = isSpecialRange \n    ? [immValue.get(0), immValue.get(1)] \n    : (immValue ? immValue.get(delta) : undefined);\n  const valueError = immValueError && (isSpecialRange \n    ? [immValueError.get(0), immValueError.get(1)]\n    : immValueError.get(delta)\n  ) || null;\n  if (isSpecialRange && value[0] === undefined && value[1] === undefined)\n    value = undefined;\n  const {fieldSettings} = fieldDefinition || {};\n  const widgetProps = Object.assign({}, fieldWidgetProps, fieldSettings, {\n    config: config,\n    field: field,\n    parentField: parentField,\n    parentFuncs: parentFuncs,\n    fieldDefinition: fieldDefinition,\n    operator: operator,\n    delta: delta,\n    isSpecialRange: isSpecialRange,\n    isFuncArg: isFuncArg,\n    value: value,\n    valueError: valueError,\n    label: widgetValueLabel.label,\n    placeholder: widgetValueLabel.placeholder,\n    placeholders: valueLabels ? valueLabels.placeholder : null,\n    textSeparators: textSeparators,\n    setValue: setValueHandler,\n    readonly: readonly,\n    asyncListValues: asyncListValues,\n    id, groupId\n  });\n    \n  if (widget == \"field\") {\n    //\n  }\n\n  if (isConst && defaultValue) {\n    if (typeof defaultValue == \"boolean\") {\n      return defaultValue ? (widgetProps.labelYes || \"YES\") : (widgetProps.labelNo || \"NO\");\n    } else if (fieldSettings.listValues) {\n      if (Array.isArray(defaultValue))\n        return defaultValue.map(v => getTitleInListValues(fieldSettings.listValues, v) || v).join(\", \");\n      else\n        return (getTitleInListValues(fieldSettings.listValues, defaultValue) || defaultValue);  \n    }\n    return \"\"+defaultValue;\n  }\n    \n  return widgetFactory(widgetProps);\n};\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport range from \"lodash/range\";\nimport {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig\n} from \"../../utils/configUtils\";\nimport {\n  getValueSourcesForFieldOp, getWidgetsForFieldOp, getWidgetForFieldOp, getValueLabel\n} from \"../../utils/ruleUtils\";\nimport {defaultValue} from \"../../utils/stuff\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport pick from \"lodash/pick\";\nimport Immutable from \"immutable\";\nimport WidgetFactory from \"./WidgetFactory\";\nimport {Col} from \"../utils\";\n\nconst funcArgDummyOpDef = {cardinality: 1};\n\nexport default class Widget extends PureComponent {\n  static propTypes = {\n    config: PropTypes.object.isRequired,\n    value: PropTypes.any, //instanceOf(Immutable.List)\n    valueSrc: PropTypes.any, //instanceOf(Immutable.List)\n    valueError: PropTypes.any,\n    field: PropTypes.string,\n    operator: PropTypes.string,\n    readonly: PropTypes.bool,\n    asyncListValues: PropTypes.array,\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    //actions\n    setValue: PropTypes.func,\n    setValueSrc: PropTypes.func,\n    // for isFuncArg\n    isFuncArg: PropTypes.bool,\n    fieldFunc: PropTypes.string,\n    fieldArg: PropTypes.string,\n    leftField: PropTypes.string,\n    // for RuleGroupExt\n    isForRuleGruop: PropTypes.bool,\n    parentField: PropTypes.string,\n    // for func in func\n    parentFuncs: PropTypes.array,\n    // for case_value\n    isCaseValue: PropTypes.bool,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForMeta = [\n      \"config\", \"field\", \"fieldFunc\", \"fieldArg\", \"leftField\", \"operator\", \"valueSrc\", \"isFuncArg\", \"asyncListValues\"\n    ];\n    const needUpdateMeta = !this.meta \n          || keysForMeta\n            .map(k => (\n              nextProps[k] !== prevProps[k] \n                  //tip: for isFuncArg we need to wrap value in Imm list\n                  || k == \"isFuncArg\" && nextProps[\"isFuncArg\"] && nextProps[\"value\"] !== prevProps[\"value\"])\n            )\n            .filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  _setValue = (isSpecialRange, delta, widgetType, value, asyncListValues, __isInternal) => {\n    if (isSpecialRange && Array.isArray(value)) {\n      const oldRange = [this.props.value.get(0), this.props.value.get(1)];\n      if (oldRange[0] != value[0])\n        this.props.setValue(0, value[0], widgetType, asyncListValues, __isInternal);\n      if (oldRange[1] != value[1])\n        this.props.setValue(1, value[1], widgetType, asyncListValues, __isInternal);\n    } else {\n      this.props.setValue(delta, value, widgetType, asyncListValues, __isInternal);\n    }\n  };\n\n  _onChangeValueSrc = (delta, srcKey) => {\n    this.props.setValueSrc(delta, srcKey);\n  };\n\n  getMeta({\n    config, field: simpleField, fieldFunc, fieldArg, operator, valueSrc: valueSrcs, value: values, \n    isForRuleGruop, isCaseValue, isFuncArg, leftField, asyncListValues\n  }) {\n    const field = isFuncArg ? {func: fieldFunc, arg: fieldArg} : simpleField;\n    let iValueSrcs = valueSrcs;\n    let iValues = values;\n    if (isFuncArg || isForRuleGruop || isCaseValue) {\n      iValueSrcs = Immutable.List([valueSrcs]);\n      iValues = Immutable.List([values]);\n    }\n\n    const fieldDefinition = getFieldConfig(config, field);\n    const defaultWidget = getWidgetForFieldOp(config, field, operator);\n    const _widgets = getWidgetsForFieldOp(config, field, operator);\n    const operatorDefinition = isFuncArg ? funcArgDummyOpDef : getOperatorConfig(config, operator, field);\n    if ((fieldDefinition == null || operatorDefinition == null) && !isCaseValue) {\n      return null;\n    }\n    const isSpecialRange = operatorDefinition?.isSpecialRange;\n    const isSpecialRangeForSrcField = isSpecialRange && (iValueSrcs.get(0) == \"field\" || iValueSrcs.get(1) == \"field\");\n    const isTrueSpecialRange = isSpecialRange && !isSpecialRangeForSrcField;\n    const cardinality = isTrueSpecialRange ? 1 : defaultValue(operatorDefinition?.cardinality, 1);\n    if (cardinality === 0) {\n      return null;\n    }\n\n    const valueSources = getValueSourcesForFieldOp(config, field, operator, fieldDefinition, isFuncArg ? leftField : null);\n\n    const widgets = range(0, cardinality).map(delta => {\n      const valueSrc = iValueSrcs.get(delta) || null;\n      let widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n      let widgetDefinition = getFieldWidgetConfig(config, field, operator, widget, valueSrc);\n      if (isSpecialRangeForSrcField) {\n        widget = widgetDefinition.singleWidget;\n        widgetDefinition = getFieldWidgetConfig(config, field, operator, widget, valueSrc);\n      }\n      const widgetType = widgetDefinition?.type;\n      const valueLabel = getValueLabel(config, field, operator, delta, valueSrc, isTrueSpecialRange);\n      const widgetValueLabel = getValueLabel(config, field, operator, delta, null, isTrueSpecialRange);\n      const sepText = operatorDefinition?.textSeparators ? operatorDefinition?.textSeparators[delta] : null;\n      const setValueSrcHandler = this._onChangeValueSrc.bind(this, delta);\n\n      let valueLabels = null;\n      let textSeparators = null;\n      if (isSpecialRange) {\n        valueLabels = [\n          getValueLabel(config, field, operator, 0),\n          getValueLabel(config, field, operator, 1)\n        ];\n        valueLabels = {\n          placeholder: [ valueLabels[0].placeholder, valueLabels[1].placeholder ],\n          label: [ valueLabels[0].label, valueLabels[1].label ],\n        };\n        textSeparators = operatorDefinition?.textSeparators;\n      }\n\n      const setValueHandler = this._setValue.bind(this, isSpecialRange, delta, widgetType);\n\n      return {\n        valueSrc,\n        valueLabel,\n        widget,\n        sepText,\n        setValueSrcHandler,\n        widgetDefinition,\n        widgetValueLabel,\n        valueLabels,\n        textSeparators,\n        setValueHandler\n      };\n    });\n      \n    return {\n      defaultWidget,\n      fieldDefinition,\n      operatorDefinition,\n      isSpecialRange: isTrueSpecialRange,\n      cardinality,\n      valueSources,\n      widgets,\n      iValues, //correct for isFuncArg\n      aField: field, //correct for isFuncArg\n      asyncListValues,\n    };\n  }\n\n  renderWidget = (delta, meta, props) => {\n    const {config, isFuncArg, leftField, operator, value: values, valueError, readonly, parentField, parentFuncs, id, groupId} = props;\n    const {settings} = config;\n    const { widgets, iValues, aField } = meta;\n    const value = isFuncArg ? iValues : values;\n    const field = isFuncArg ? leftField : aField;\n    const {valueSrc, valueLabel} = widgets[delta];\n \n    const widgetLabel = settings.showLabels\n      ? <label className=\"rule--label\">{valueLabel.label}</label>\n      : null;\n\n    return (\n      <div key={\"widget-\"+field+\"-\"+delta} className=\"widget--widget\">\n        {valueSrc == \"func\" ? null : widgetLabel}\n        <WidgetFactory\n          id={id}\n          groupId={groupId}\n          valueSrc={valueSrc}\n          delta={delta}\n          value={value}\n          valueError={valueError}\n          isFuncArg={isFuncArg}\n          {...pick(meta, [\"isSpecialRange\", \"fieldDefinition\", \"asyncListValues\"])}\n          {...pick(widgets[delta], [\"widget\", \"widgetDefinition\", \"widgetValueLabel\", \"valueLabels\", \"textSeparators\", \"setValueHandler\"])}\n          config={config}\n          field={field}\n          parentField={parentField}\n          parentFuncs={parentFuncs}\n          operator={operator}\n          readonly={readonly}\n        />\n      </div>\n    );\n  };\n\n  renderValueSources = (delta, meta, props) => {\n    const {config, isFuncArg, leftField, operator, readonly} = props;\n    const {settings} = config;\n    const { valueSources, widgets, aField } = meta;\n    const field = isFuncArg ? leftField : aField;\n    const {valueSrc, setValueSrcHandler} = widgets[delta];\n    const {valueSourcesInfo, renderValueSources: ValueSources} = settings;\n    const valueSourcesOptions = valueSources.map(srcKey => [srcKey, {\n      label: valueSourcesInfo[srcKey].label\n    }]);\n\n    const sourceLabel = settings.showLabels\n      ? <label className=\"rule--label\">&nbsp;</label>\n      : null;\n\n    return valueSources.length > 1 && !readonly\n      && <div key={\"valuesrc-\"+field+\"-\"+delta} className=\"widget--valuesrc\">\n        {sourceLabel}\n        <ValueSources\n          key={\"valuesrc-\"+delta}\n          delta={delta}\n          valueSources={valueSourcesOptions}\n          valueSrc={valueSrc}\n          config={config}\n          field={field}\n          operator={operator}\n          setValueSrc={setValueSrcHandler}\n          readonly={readonly}\n          title={settings.valueSourcesPopupTitle}\n        />\n      </div>;\n  };\n\n  renderSep = (delta, meta, props) => {\n    const {config} = props;\n    const {widgets} = meta;\n    const {settings} = config;\n    const {sepText} = widgets[delta];\n\n    const sepLabel = settings.showLabels\n      ? <label className=\"rule--label\">&nbsp;</label>\n      : null;\n\n    return sepText\n      && <div key={\"widget-separators-\"+delta} className=\"widget--sep\" >\n        {sepLabel}\n        <span>{sepText}</span>\n      </div>;\n  };\n\n  renderWidgetDelta = (delta) => {\n    const sep = this.renderSep(delta, this.meta, this.props);\n    const sources = this.renderValueSources(delta, this.meta, this.props);\n    const widgetCmp = this.renderWidget(delta, this.meta, this.props);\n\n    return [\n      sep,\n      sources,\n      widgetCmp,\n    ];\n  };\n\n  render() {\n    if (!this.meta) return null;\n    const { defaultWidget, cardinality } = this.meta;\n    if (!defaultWidget) return null;\n    const name = defaultWidget;\n\n    return (\n      <Col\n        className={`rule--widget rule--widget--${name.toUpperCase()}`}\n        key={\"widget-col-\"+name}\n      >\n        {range(0, cardinality).map(this.renderWidgetDelta)}\n      </Col>\n    );\n  }\n\n}\n","import React from \"react\";\n\nconst Col = ({children, ...props}) => (<div {...props}>{children}</div>);\n\nconst dummyFn = () => {};\n\nconst DragIcon = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"gray\" width=\"18px\" height=\"18px\">\n    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n    <path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/>\n  </svg>\n);\n\nconst ConfirmFn = (Cmp) => (\n  props => {\n    const {useConfirm} = props.config.settings;\n    const confirmFn = useConfirm ? useConfirm() : null;\n    return <Cmp {...props} confirmFn={confirmFn} />;\n  }\n);\n\nexport {\n  Col, dummyFn, DragIcon, ConfirmFn\n};\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {getFieldConfig} from \"../../utils/configUtils\";\nimport {getFieldPath, getFieldPathLabels, getWidgetForFieldOp} from \"../../utils/ruleUtils\";\nimport {truncateString} from \"../../utils/stuff\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport last from \"lodash/last\";\nimport keys from \"lodash/keys\";\nimport clone from \"clone\";\n\n//tip: this.props.value - right value, this.props.field - left value\n\nexport default class ValueField extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    setValue: PropTypes.func.isRequired,\n    config: PropTypes.object.isRequired,\n    field: PropTypes.string.isRequired,\n    value: PropTypes.string,\n    operator: PropTypes.string,\n    customProps: PropTypes.object,\n    readonly: PropTypes.bool,\n    parentField: PropTypes.string,\n    fieldDefinition: PropTypes.object,\n    isFuncArg: PropTypes.bool,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForItems = [\"config\", \"field\", \"operator\", \"isFuncArg\", \"parentField\"];\n    const keysForMeta = [\"config\", \"field\", \"operator\", \"value\", \"placeholder\", \"isFuncArg\", \"parentField\"];\n    const needUpdateItems = !this.items || keysForItems.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateItems) {\n      this.items = this.getItems(nextProps);\n    }\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  getItems({config, field, operator, parentField, isFuncArg, fieldDefinition}) {\n    const {canCompareFieldWithField} = config.settings;\n    const fieldSeparator = config.settings.fieldSeparator;\n    const parentFieldPath = typeof parentField == \"string\" ? parentField.split(fieldSeparator) : parentField;\n    const parentFieldConfig = parentField ? getFieldConfig(config, parentField) : null;\n    const sourceFields = parentField ? parentFieldConfig && parentFieldConfig.subfields : config.fields;\n\n    const filteredFields = this.filterFields(config, sourceFields, field, parentField, parentFieldPath, operator, canCompareFieldWithField, isFuncArg, fieldDefinition);\n    const items = this.buildOptions(parentFieldPath, config, filteredFields, parentFieldPath);\n    return items;\n  }\n\n  getMeta({config, field, operator, value, placeholder: customPlaceholder, isFuncArg, parentField}) {\n    const {fieldPlaceholder, fieldSeparatorDisplay} = config.settings;\n    const selectedKey = value;\n    const isFieldSelected = !!value;\n\n    const leftFieldConfig = getFieldConfig(config, field);\n    const leftFieldWidgetField = leftFieldConfig.widgets.field;\n    const leftFieldWidgetFieldProps = leftFieldWidgetField && leftFieldWidgetField.widgetProps || {};\n    const placeholder = isFieldSelected ? null \n      : (isFuncArg && customPlaceholder || leftFieldWidgetFieldProps.valuePlaceholder || fieldPlaceholder);\n    const currField = isFieldSelected ? getFieldConfig(config, selectedKey) : null;\n    const selectedOpts = currField || {};\n\n    const selectedKeys = getFieldPath(selectedKey, config);\n    const selectedPath = getFieldPath(selectedKey, config, true);\n    const selectedLabel = this.getFieldLabel(currField, selectedKey, config);\n    const partsLabels = getFieldPathLabels(selectedKey, config);\n    let selectedFullLabel = partsLabels ? partsLabels.join(fieldSeparatorDisplay) : null;\n    if (selectedFullLabel == selectedLabel || parentField)\n      selectedFullLabel = null;\n    const selectedAltLabel = selectedOpts.label2;\n\n    return {\n      placeholder,\n      selectedKey, selectedKeys, selectedPath, selectedLabel, selectedOpts, selectedAltLabel, selectedFullLabel,\n    };\n  }\n\n  filterFields(config, fields, leftFieldFullkey, parentField, parentFieldPath, operator, canCompareFieldWithField, isFuncArg, fieldDefinition) {\n    fields = clone(fields);\n    const fieldSeparator = config.settings.fieldSeparator;\n    const leftFieldConfig = getFieldConfig(config, leftFieldFullkey);\n    let expectedType;\n    const widget = getWidgetForFieldOp(config, leftFieldFullkey, operator, \"value\");\n    if (isFuncArg && fieldDefinition) {\n      expectedType = fieldDefinition.type;\n    } else if (widget) {\n      let widgetConfig = config.widgets[widget];\n      let widgetType = widgetConfig.type;\n      //expectedType = leftFieldConfig.type;\n      expectedType = widgetType;\n    } else {\n      expectedType = leftFieldConfig.type;\n    }\n    \n    function _filter(list, path) {\n      for (let rightFieldKey in list) {\n        let subfields = list[rightFieldKey].subfields;\n        let subpath = (path ? path : []).concat(rightFieldKey);\n        let rightFieldFullkey = subpath.join(fieldSeparator);\n        let rightFieldConfig = getFieldConfig(config, rightFieldFullkey);\n        if (!rightFieldConfig) {\n          delete list[rightFieldKey];\n        } else if (rightFieldConfig.type == \"!struct\" || rightFieldConfig.type == \"!group\") {\n          if(_filter(subfields, subpath) == 0)\n            delete list[rightFieldKey];\n        } else {\n          // tip: LHS field can be used as arg in RHS function\n          let canUse = rightFieldConfig.type == expectedType && (isFuncArg ? true : rightFieldFullkey != leftFieldFullkey);\n          let fn = canCompareFieldWithField || config.settings.canCompareFieldWithField;\n          if (fn)\n            canUse = canUse && fn(leftFieldFullkey, leftFieldConfig, rightFieldFullkey, rightFieldConfig, operator);\n          if (!canUse)\n            delete list[rightFieldKey];\n        }\n      }\n      return keys(list).length;\n    }\n\n    _filter(fields, parentFieldPath || []);\n\n    return fields;\n  }\n\n  buildOptions(parentFieldPath, config, fields, path = null, optGroupLabel = null) {\n    if (!fields)\n      return null;\n    const {fieldSeparator, fieldSeparatorDisplay} = config.settings;\n    const prefix = path ? path.join(fieldSeparator) + fieldSeparator : \"\";\n\n    return keys(fields).map(fieldKey => {\n      const field = fields[fieldKey];\n      const label = this.getFieldLabel(field, fieldKey, config);\n      const partsLabels = getFieldPathLabels(fieldKey, config);\n      let fullLabel = partsLabels.join(fieldSeparatorDisplay);\n      if (fullLabel == label || parentFieldPath)\n        fullLabel = null;\n      const altLabel = field.label2;\n      const tooltip = field.tooltip;\n      const subpath = (path ? path : []).concat(fieldKey);\n\n      if (field.hideForCompare)\n        return undefined;\n\n      if (field.type == \"!struct\" || field.type == \"!group\") {\n        return {\n          key: fieldKey,\n          path: prefix+fieldKey,\n          label,\n          fullLabel,\n          altLabel,\n          tooltip,\n          items: this.buildOptions(parentFieldPath, config, field.subfields, subpath, label)\n        };\n      } else {\n        return {\n          key: fieldKey,\n          path: prefix+fieldKey,\n          label,\n          fullLabel,\n          altLabel,\n          tooltip,\n          grouplabel: optGroupLabel\n        };\n      }\n    }).filter(o => !!o);\n  }\n\n  getFieldLabel(fieldOpts, fieldKey, config) {\n    if (!fieldKey) return null;\n    let fieldSeparator = config.settings.fieldSeparator;\n    let maxLabelsLength = config.settings.maxLabelsLength;\n    let fieldParts = Array.isArray(fieldKey) ? fieldKey : fieldKey.split(fieldSeparator);\n    let label = fieldOpts.label || last(fieldParts);\n    label = truncateString(label, maxLabelsLength);\n    return label;\n  }\n\n  render() {\n    const {config, customProps, setValue, readonly, id, groupId} = this.props;\n    const {renderField} = config.settings;\n    const renderProps = {\n      config,\n      customProps,\n      setField: setValue,\n      readonly,\n      items: this.items,\n      id,\n      groupId,\n      ...this.meta\n    };\n    return renderField(renderProps);\n  }\n\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {getFieldConfig, getFuncConfig} from \"../../utils/configUtils\";\nimport {\n  getFieldPath, getFuncPathLabels, getFieldPathLabels, getValueSourcesForFieldOp, getWidgetForFieldOp\n} from \"../../utils/ruleUtils\";\nimport {truncateString} from \"../../utils/stuff\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport last from \"lodash/last\";\nimport keys from \"lodash/keys\";\nimport clone from \"clone\";\n\n//tip: this.props.value - right value, this.props.field - left value\n\nexport default class FuncSelect extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    field: PropTypes.string.isRequired,\n    operator: PropTypes.string,\n    customProps: PropTypes.object,\n    value: PropTypes.string,\n    setValue: PropTypes.func.isRequired,\n    readonly: PropTypes.bool,\n    parentFuncs: PropTypes.array,\n    fieldDefinition: PropTypes.object,\n    isFuncArg: PropTypes.bool,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n      \n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForItems = [\"config\", \"field\", \"operator\", \"isFuncArg\"];\n    const keysForMeta = [\"config\", \"field\", \"value\"];\n    const needUpdateItems = !this.items || keysForItems.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n    if (needUpdateItems) {\n      this.items = this.getItems(nextProps);\n    }\n  }\n\n  getItems({config, field, operator, parentFuncs, fieldDefinition, isFuncArg}) {\n    const {canUseFuncForField} = config.settings;\n    const filteredFuncs = this.filterFuncs(config, config.funcs, field, operator, canUseFuncForField, parentFuncs, isFuncArg, fieldDefinition);\n    const items = this.buildOptions(config, filteredFuncs);\n    return items;\n  }\n\n  getMeta({config, field, value}) {\n    const {funcPlaceholder, fieldSeparatorDisplay} = config.settings;\n    const selectedFuncKey = value;\n    const isFuncSelected = !!value;\n\n    const leftFieldConfig = getFieldConfig(config, field);\n    const leftFieldWidgetField = leftFieldConfig.widgets.field;\n    const leftFieldWidgetFieldProps = leftFieldWidgetField && leftFieldWidgetField.widgetProps || {};\n    const placeholder = !isFuncSelected ? funcPlaceholder : null;\n\n    const currFunc = isFuncSelected ? getFuncConfig(config, selectedFuncKey) : null;\n    const selectedOpts = currFunc || {};\n\n    const selectedKeys = getFieldPath(selectedFuncKey, config);\n    const selectedPath = getFieldPath(selectedFuncKey, config, true);\n    const selectedLabel = this.getFuncLabel(currFunc, selectedFuncKey, config);\n    const partsLabels = getFuncPathLabels(selectedFuncKey, config);\n    let selectedFullLabel = partsLabels ? partsLabels.join(fieldSeparatorDisplay) : null;\n    if (selectedFullLabel == selectedLabel)\n      selectedFullLabel = null;\n    \n    return {\n      placeholder,\n      selectedKey: selectedFuncKey, selectedKeys, selectedPath, selectedLabel, selectedOpts, selectedFullLabel,\n    };\n  }\n\n  filterFuncs(config, funcs, leftFieldFullkey, operator, canUseFuncForField, parentFuncs, isFuncArg, fieldDefinition) {\n    funcs = clone(funcs);\n    const fieldSeparator = config.settings.fieldSeparator;\n    const leftFieldConfig = getFieldConfig(config, leftFieldFullkey);\n    let expectedType;\n    let targetDefinition = leftFieldConfig;\n    const widget = getWidgetForFieldOp(config, leftFieldFullkey, operator, \"value\");\n    if (isFuncArg && fieldDefinition) {\n      targetDefinition = fieldDefinition;\n      expectedType = fieldDefinition.type;\n    } else if (widget) {\n      let widgetConfig = config.widgets[widget];\n      let widgetType = widgetConfig.type;\n      //expectedType = leftFieldConfig.type;\n      expectedType = widgetType;\n    } else {\n      expectedType = leftFieldConfig.type;\n    }\n\n    function _filter(list, path) {\n      for (let funcKey in list) {\n        let subfields = list[funcKey].subfields;\n        let subpath = (path ? path : []).concat(funcKey);\n        let funcFullkey = subpath.join(fieldSeparator);\n        let funcConfig = getFuncConfig(config, funcFullkey);\n        if (funcConfig.type == \"!struct\") {\n          if(_filter(subfields, subpath) == 0)\n            delete list[funcKey];\n        } else {\n          let canUse = funcConfig.returnType == expectedType;\n          if (targetDefinition.funcs)\n            canUse = canUse && targetDefinition.funcs.includes(funcFullkey);\n          if (canUseFuncForField)\n            canUse = canUse && canUseFuncForField(leftFieldFullkey, leftFieldConfig, funcFullkey, funcConfig, operator);\n          // don't use func in func (can be configurable, but usually users don't need this)\n          if (!funcConfig.allowSelfNesting && parentFuncs && parentFuncs.map(([func, _arg]) => func).includes(funcFullkey))\n            canUse = false;\n          if (!canUse)\n            delete list[funcKey];\n        }\n      }\n      return keys(list).length;\n    }\n\n    _filter(funcs, []);\n\n    return funcs;\n  }\n\n  buildOptions(config, funcs, path = null, optGroupLabel = null) {\n    if (!funcs)\n      return null;\n    const {fieldSeparator, fieldSeparatorDisplay} = config.settings;\n    const prefix = path ? path.join(fieldSeparator) + fieldSeparator : \"\";\n\n    return keys(funcs).map(funcKey => {\n      const func = funcs[funcKey];\n      const label = this.getFuncLabel(func, funcKey, config);\n      const partsLabels = getFuncPathLabels(funcKey, config);\n      let fullLabel = partsLabels.join(fieldSeparatorDisplay);\n      if (fullLabel == label)\n        fullLabel = null;\n      const tooltip = func.tooltip;\n      const subpath = (path ? path : []).concat(funcKey);\n\n      if (func.type == \"!struct\") {\n        return {\n          key: funcKey,\n          path: prefix+funcKey,\n          label,\n          fullLabel,\n          tooltip,\n          items: this.buildOptions(config, func.subfields, subpath, label)\n        };\n      } else {\n        return {\n          key: funcKey,\n          path: prefix+funcKey,\n          label,\n          fullLabel,\n          tooltip,\n          grouplabel: optGroupLabel\n        };\n      }\n    });\n  }\n\n  getFuncLabel(funcOpts, funcKey, config) {\n    if (!funcKey) return null;\n    let fieldSeparator = config.settings.fieldSeparator;\n    let maxLabelsLength = config.settings.maxLabelsLength;\n    let funcParts = Array.isArray(funcKey) ? funcKey : funcKey.split(fieldSeparator);\n    let label = funcOpts.label || last(funcParts);\n    label = truncateString(label, maxLabelsLength);\n    return label;\n  }\n\n  render() {\n    const {config, customProps, setValue, readonly, id, groupId} = this.props;\n    const {renderFunc} = config.settings;\n    const renderProps = {\n      config,\n      customProps,\n      readonly,\n      setField: setValue,\n      items: this.items,\n      id,\n      groupId,\n      ...this.meta\n    };\n    return renderFunc(renderProps);\n  }\n\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport FuncSelect from \"./FuncSelect\";\nimport {\n  getFuncConfig\n} from \"../../utils/configUtils\";\nimport Widget from \"./Widget\";\nimport {Col} from \"../utils\";\nimport {setFunc, setArgValue, setArgValueSrc} from \"../../utils/funcUtils\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\n\n\nexport default class FuncWidget extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    field: PropTypes.string.isRequired,\n    operator: PropTypes.string,\n    customProps: PropTypes.object,\n    value: PropTypes.object, //instanceOf(Immutable.Map) //with keys 'func' and `args`\n    setValue: PropTypes.func.isRequired,\n    readonly: PropTypes.bool,\n    parentFuncs: PropTypes.array,\n    fieldDefinition: PropTypes.object,\n    isFuncArg: PropTypes.bool,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForMeta = [\"config\", \"field\", \"operator\", \"value\"];\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  getMeta({config, field, operator, value}) {\n    const funcKey = value ? value.get(\"func\") : null;\n    const funcDefinition = funcKey ? getFuncConfig(config, funcKey) : null;\n\n    return {\n      funcDefinition, funcKey\n    };\n  }\n\n  setFunc = (funcKey) => {\n    this.props.setValue( setFunc(this.props.value, funcKey, this.props.config) );\n  };\n\n  setArgValue = (argKey, argVal) => {\n    const {config} = this.props;\n    const {funcDefinition} = this.meta;\n    const {args} = funcDefinition;\n    const argDefinition = args[argKey];\n\n    this.props.setValue( setArgValue(this.props.value, argKey, argVal, argDefinition, config) );\n  };\n\n  setArgValueSrc = (argKey, argValSrc) => {\n    const {config} = this.props;\n    const {funcDefinition} = this.meta;\n    const {args} = funcDefinition;\n    const argDefinition = args[argKey];\n\n    this.props.setValue( setArgValueSrc(this.props.value, argKey, argValSrc, argDefinition, config) );\n  };\n\n  renderFuncSelect = () => {\n    const {config, field, operator, customProps, value, readonly, parentFuncs, id, groupId, isFuncArg, fieldDefinition} = this.props;\n    const funcKey = value ? value.get(\"func\") : null;\n    const selectProps = {\n      value: funcKey,\n      setValue: this.setFunc,\n      config, field, operator, customProps, readonly, parentFuncs, \n      isFuncArg, fieldDefinition,\n      id, groupId,\n    };\n    const {showLabels, funcLabel} = config.settings;\n    const widgetLabel = showLabels\n      ? <label className=\"rule--label\">{funcLabel}</label>\n      : null;\n\n    return (\n      <Col key=\"func\" className=\"rule--func\">\n        {widgetLabel}\n        <FuncSelect {...selectProps} />\n      </Col>\n    );\n  };\n\n  renderArgLabel = (argKey, argDefinition) => {\n    const {valueSources, type, showPrefix, label} = argDefinition;\n    const {config} = this.props;\n    const isConst = valueSources && valueSources.length == 1 && valueSources[0] == \"const\";\n    const forceShow = !config.settings.showLabels && (type == \"boolean\" || isConst) && showPrefix;\n    if (!forceShow) return null;\n    return (\n      <Col className=\"rule--func--arg-label\">\n        {label || argKey}\n      </Col>\n    );\n  };\n\n  renderArgLabelSep = (argKey, argDefinition) => {\n    const {valueSources, type, showPrefix} = argDefinition;\n    const {config} = this.props;\n    const isConst = valueSources && valueSources.length == 1 && valueSources[0] == \"const\";\n    const forceShow = !config.settings.showLabels && (type == \"boolean\" || isConst) && showPrefix;\n    if (!forceShow) return null;\n    return (\n      <Col className=\"rule--func--arg-label-sep\">\n        {\":\"}\n      </Col>\n    );\n  };\n\n  renderArgVal = (funcKey, argKey, argDefinition) => {\n    const {config, field, operator, value, readonly, parentFuncs, id, groupId} = this.props;\n    const arg = value ? value.getIn([\"args\", argKey]) : null;\n    const argVal = arg ? arg.get(\"value\") : undefined;\n    const defaultValueSource = argDefinition.valueSources.length == 1 ? argDefinition.valueSources[0] : undefined;\n    const argValSrc = arg ? (arg.get(\"valueSrc\") || defaultValueSource || \"value\") : defaultValueSource;\n\n    const widgetProps = {\n      config, \n      fieldFunc: funcKey,\n      fieldArg: argKey,\n      leftField: field,\n      operator: null,\n      value: argVal,\n      valueSrc: argValSrc,\n      setValue: this.setArgValue,\n      setValueSrc: this.setArgValueSrc,\n      funcKey,\n      argKey,\n      argDefinition,\n      readonly,\n      parentFuncs,\n      id,\n      groupId,\n    };\n    //tip: value & valueSrc will be converted to Immutable.List at <Widget>\n\n    return (\n      <Col className=\"rule--func--arg-value\">\n        <ArgWidget {...widgetProps} />\n      </Col>\n    );\n  };\n\n  renderArgSep = (argKey, argDefinition, argIndex, {renderSeps}) => {\n    if (!argIndex) return null;\n    return (\n      <Col className=\"rule--func--arg-sep\">\n        {renderSeps ? renderSeps[argIndex - 1] : \", \"}\n      </Col>\n    );\n  };\n\n  renderBracketBefore = ({renderBrackets}) => {\n    return (\n      <Col key=\"before_args\" className=\"rule--func--bracket-before\">\n        {renderBrackets ? renderBrackets[0] : \"(\"}\n      </Col>\n    );\n  };\n\n  renderBracketAfter = ({renderBrackets}) => {\n    return (\n      <Col key=\"after_args\" className=\"rule--func--bracket-after\">\n        {renderBrackets ? renderBrackets[1] : \")\"}\n      </Col>\n    );\n  };\n\n  renderFuncArgs = () => {\n    const {funcDefinition, funcKey} = this.meta;\n    if (!funcKey) return null;\n    const {args} = funcDefinition;\n    if (!args) return null;\n\n    return (\n      <>\n        {this.renderBracketBefore(funcDefinition)}\n        <Col key=\"args\" className=\"rule--func--args\">\n          {Object.keys(args).map((argKey, argIndex) => (\n            <Col key={`arg-${argKey}-${argIndex}`} className=\"rule--func--arg\">\n              {this.renderArgSep(argKey, args[argKey], argIndex, funcDefinition)}\n              {this.renderArgLabel(argKey, args[argKey])}\n              {this.renderArgLabelSep(argKey, args[argKey])}\n              {this.renderArgVal(funcKey, argKey, args[argKey])}\n            </Col>\n          ))}\n        </Col>\n        {this.renderBracketAfter(funcDefinition)}\n      </>\n    );\n  };\n\n  render() {\n    return (\n      <Col className=\"rule--func--wrapper\">\n        {this.renderFuncSelect()}\n        {this.renderFuncArgs()}\n      </Col>\n    );\n  }\n}\n\n\nclass ArgWidget extends PureComponent {\n  static propTypes = {\n    funcKey: PropTypes.string.isRequired,\n    argKey: PropTypes.string.isRequired,\n    setValue: PropTypes.func.isRequired,\n    setValueSrc: PropTypes.func.isRequired,\n    readonly: PropTypes.bool,\n    parentFuncs: PropTypes.array,\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n  };\n\n  setValue = (_delta, value, _widgetType) => {\n    const {setValue, argKey} = this.props;\n    setValue(argKey, value);\n  };\n\n  setValueSrc = (_delta, valueSrc, _widgetType) => {\n    const {setValueSrc, argKey} = this.props;\n    setValueSrc(argKey, valueSrc);\n  };\n\n  render() {\n    const {funcKey, argKey, parentFuncs} = this.props;\n    return (\n      <Widget\n        {...this.props} \n        setValue={this.setValue} \n        setValueSrc={this.setValueSrc} \n        isFuncArg={true}\n        parentFuncs={[...(parentFuncs || []), [funcKey, argKey]]}\n      />\n    );\n  }\n}\n","import React from \"react\";\nimport uuid from \"../../../../utils/uuid\";\n\nexport default (props) => {\n  const {value, setValue, config, labelYes, labelNo, readonly, customProps = {}} = props;\n  const customRadioYesProps = customProps.radioYes || {};\n  const customRadioNoProps = customProps.radioNo || {};\n\n  const onCheckboxChange = e => setValue(e.target.checked);\n  const onRadioChange = e => setValue(e.target.value == \"true\");\n  const id = uuid(), id2 = uuid();\n\n  // return <>\n  //     <input key={id}  type=\"checkbox\" id={id} checked={!!value} disabled={readonly} onChange={onCheckboxChange} />\n  //     <label style={{display: \"inline\"}} key={id+\"label\"}  htmlFor={id}>{value ? labelYes : labelNo}</label>\n  // </>;\n\n  return <>\n    <input key={id}  type=\"radio\" id={id} value={true} checked={!!value} disabled={readonly} onChange={onRadioChange} { ...customRadioYesProps }/>\n    <label style={{display: \"inline\"}} key={id+\"label\"}  htmlFor={id}>{labelYes}</label>\n    <input key={id2}  type=\"radio\" id={id2} value={false} checked={!value} disabled={readonly} onChange={onRadioChange} { ...customRadioNoProps } />\n    <label style={{display: \"inline\"}} key={id2+\"label\"}  htmlFor={id2}>{labelNo}</label>\n  </>;\n\n};\n","import React from \"react\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, placeholder, maxLength, customProps, } = props;\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\")\n      val = undefined; // don't allow empty value\n    setValue(val);\n  };\n  const textValue = value || \"\";\n  return (\n    <input\n      type=\"text\" \n      value={textValue} \n      placeholder={placeholder} \n      disabled={readonly} \n      onChange={onChange}\n      maxLength={maxLength}\n      {...customProps}\n    />\n  );\n};\n","import React from \"react\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, placeholder, maxLength, maxRows, fullWidth, customProps, } = props;\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\")\n      val = undefined; // don't allow empty value\n    setValue(val);\n  };\n  const textValue = value || \"\";\n  return (\n    <textarea\n      value={textValue} \n      placeholder={placeholder}\n      disabled={readonly}\n      onChange={onChange}\n      maxLength={maxLength}\n      style={{\n        width: fullWidth ? \"100%\" : undefined\n      }}\n      {...customProps}\n    />\n  );\n};\n","import React from \"react\";\nimport moment from \"moment\";\n\nexport default (props) => {\n  const {value, setValue, config, valueFormat, readonly, customProps, } = props;\n\n  const onChange = e => {\n    let value = e.target.value;\n    if (value == \"\")\n      value = undefined;\n    setValue(value);\n  };\n  \n  return (\n    <input type=\"date\"  value={value || \"\"}  disabled={readonly} onChange={onChange} {...customProps} />\n  );\n};\n","import React from \"react\";\n\nexport default (props) => {\n  const {value, setValue, config, valueFormat, use12Hours, readonly, customProps } = props;\n\n  const onChange = e => {\n    let value = e.target.value;\n    if (value == \"\")\n      value = undefined;\n    setValue(value);\n  };\n  \n  return (\n    <input type=\"time\"  value={value || \"\"}  disabled={readonly} onChange={onChange} {...customProps} />\n  );\n};\n","import React from \"react\";\nimport moment from \"moment\";\n\nexport default (props) => {\n  const {value, setValue, config, valueFormat, use12Hours, readonly, customProps, } = props;\n\n  const onChange = e => {\n    let value = e.target.value;\n    if (value == \"\")\n      value = undefined;\n    else\n      value = moment(new Date(value)).format(valueFormat);\n    setValue(value);\n  };\n\n  let dtValue = value;\n  if (!value)\n    dtValue = \"\";\n  else\n    dtValue = moment(value).format(\"YYYY-MM-DDTHH:mm\");\n  \n  return (\n    <input type=\"datetime-local\"  value={dtValue}  disabled={readonly} onChange={onChange} {...customProps} />\n  );\n};\n","import React from \"react\";\nimport {mapListValues} from \"../../../../utils/stuff\";\nimport omit from \"lodash/omit\";\n\nexport default ({listValues, value, setValue, allowCustomValues, readonly, customProps,}) => {\n  const renderOptions = () => \n    mapListValues(listValues, ({title, value}) => {\n      return <option key={value} value={value}>{title}</option>;\n    });\n\n  const getMultiSelectValues = (multiselect) => {\n    let values = [];\n    const options = multiselect.options;\n    for (let i = 0 ; i < options.length ; i++) {\n      const opt = options[i];\n      if (opt.selected) {\n        values.push(opt.value);\n      }\n    }\n    if (!values.length)\n      values = undefined; //not allow []\n    return values;\n  };\n\n  const onChange = e => setValue(getMultiSelectValues(e.target));\n  \n  return (\n    <select multiple\n      onChange={onChange}\n      value={value}\n      disabled={readonly}\n      {...omit(customProps, [\"showSearch\", \"input\", \"showCheckboxes\"])}\n    >\n      {renderOptions()}\n    </select>\n  );\n};\n","import React from \"react\";\nimport {mapListValues} from \"../../../../utils/stuff\";\nimport omit from \"lodash/omit\";\n\nexport default ({listValues, value, setValue, allowCustomValues, readonly, customProps,}) => {\n  const renderOptions = () => \n    mapListValues(listValues, ({title, value}) => {\n      return <option key={value} value={value}>{title}</option>;\n    });\n\n  const onChange = e => setValue(e.target.value);\n  \n  const hasValue = value != null;\n  return (\n    <select\n      onChange={onChange}\n      value={hasValue ? value : \"\"}\n      disabled={readonly}\n      {...omit(customProps, [\"showSearch\", \"input\"])}\n    >\n      {!hasValue && <option disabled value={\"\"}></option>}\n      {renderOptions()}\n    </select>\n  );\n};\n","import React from \"react\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, min, max, step, placeholder, customProps, } = props;\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\" || val === null)\n      val = undefined;\n    else\n      val = Number(val);\n    setValue(val);\n  };\n  const numberValue = value == undefined ? \"\" : value;\n  return (\n    <input type=\"number\"  value={numberValue} placeholder={placeholder} disabled={readonly} min={min} max={max} step={step} onChange={onChange} {...customProps} />\n  );\n};\n","import React from \"react\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, min, max, step, placeholder, customProps = {}, } = props;\n  const customInputProps = customProps.input || {};\n  const customSliderProps = customProps.slider || customProps;\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\" || val === null)\n      val = undefined;\n    else\n      val = Number(val);\n    setValue(val);\n  };\n  const numberValue = value == undefined ? \"\" : value;\n  return [\n    <input key={\"number\"} type=\"number\"  value={numberValue} placeholder={placeholder} disabled={readonly} min={min} max={max} step={step} onChange={onChange} {...customInputProps} />\n    ,\n    <input key={\"range\"} type=\"range\"  value={numberValue} disabled={readonly} min={min} max={max} step={step} onChange={onChange} {...customSliderProps} />\n  ];\n};\n","import React from \"react\";\n\nexport default ({items, setField, selectedKey, readonly}) => {\n  const renderOptions = (fields) => (\n    fields.map(field => {\n      const {items, path, label, disabled} = field;\n      if (items) {\n        return <optgroup disabled={disabled} key={path} label={label}>{renderOptions(items)}</optgroup>;\n      } else {\n        return <option disabled={disabled} key={path} value={path}>{label}</option>;\n      }\n    })\n  );\n\n  const onChange = e => setField(e.target.value);\n  \n  const hasValue = selectedKey != null;\n  return (\n    <select \n      onChange={onChange}\n      value={hasValue ? selectedKey : \"\"}\n      disabled={readonly}\n    >\n      {!hasValue && <option disabled value={\"\"}></option>}\n      {renderOptions(items)}\n    </select>\n  );\n};\n","import React from \"react\";\n\nexport default ({id, not, setNot, conjunctionOptions, setConjunction, disabled, readonly, config, showNot, notLabel}) => {\n  const conjsCount = Object.keys(conjunctionOptions).length;\n  const lessThenTwo = disabled;\n  const {forceShowConj} = config.settings;\n  const showConj = forceShowConj || conjsCount > 1 && !lessThenTwo;\n\n  const renderOptions = () => \n    Object.keys(conjunctionOptions).map(key => {\n      const {id, name, label, checked} = conjunctionOptions[key];\n      const postfix = setConjunction.isDummyFn ? \"__dummy\" : \"\";\n      if ((readonly || disabled) && !checked)\n        return null;\n      return [\n        <input key={id+postfix} type=\"radio\" id={id+postfix} name={name+postfix} checked={checked} disabled={readonly || disabled} value={key} onChange={onChange} />\n        ,\n        <label key={id+postfix+\"label\"} htmlFor={id+postfix}>{label}</label>\n      ];\n    });\n  \n  const renderNot = () => {\n    const postfix = \"not\";\n    return [\n      <input key={id+postfix}  type=\"checkbox\" id={id+postfix} checked={not} disabled={readonly} onChange={onNotChange} />\n      ,\n      <label key={id+postfix+\"label\"}  htmlFor={id+postfix}>{notLabel || \"NOT\"}</label>\n    ];\n  };\n\n  const onChange = e => setConjunction(e.target.value);\n\n  const onNotChange = e => setNot(e.target.checked);\n\n  return [\n    showNot && renderNot(),\n    showConj && renderOptions()\n  ];\n  \n};\n","import React from \"react\";\n\nexport default ({type, label, onClick, readonly, config}) => {\n  const typeToLabel = {\n    \"addRuleGroup\": \"+\",\n    \"addRuleGroupExt\": \"+\",\n    \"delGroup\": \"x\",\n    \"delRuleGroup\": \"x\",\n    \"delRule\": \"x\",\n  };\n  const btnLabel = label || typeToLabel[type];\n  return <button onClick={onClick} type=\"button\" disabled={readonly}>{btnLabel}</button>;\n};\n","import React from \"react\";\n\nexport default ({children, config}) => {\n  return <>{children}</>;\n};\n","import React from \"react\";\n\nexport default ({config, valueSources, valueSrc, title, setValueSrc, readonly}) => {\n  const renderOptions = (valueSources) => (\n    valueSources.map(([srcKey, info]) => (\n      <option key={srcKey} value={srcKey}>{info.label}</option>\n    ))\n  );\n\n  const onChange = e => setValueSrc(e.target.value);\n  \n  return (\n    <select \n      onChange={onChange}\n      value={valueSrc}\n      disabled={readonly}\n    >\n      {renderOptions(valueSources)}\n    </select>\n  );\n};\n","import React from \"react\";\n\nexport default ({value, setValue, label, id, config, type}) => {\n  const onChange = e => setValue(e.target.checked);\n  const postfix = type;\n  return [\n    <input key={id+postfix}  type=\"checkbox\" id={id+postfix} checked={!!value} onChange={onChange} />\n    ,\n    <label key={id+postfix+\"label\"}  htmlFor={id+postfix}>{label}</label>\n  ];\n};\n","export default ({onOk, okText, cancelText, title}) => {\n  if (confirm(title)) {\n    onOk();\n  }\n};\n","import React from \"react\";\n\n// value widgets\nexport {default as VanillaBooleanWidget} from \"./value/VanillaBoolean\";\nexport {default as VanillaTextWidget} from \"./value/VanillaText\";\nexport {default as VanillaTextAreaWidget} from \"./value/VanillaTextArea\";\nexport {default as VanillaDateWidget} from \"./value/VanillaDate\";\nexport {default as VanillaTimeWidget} from \"./value/VanillaTime\";\nexport {default as VanillaDateTimeWidget} from \"./value/VanillaDateTime\";\nexport {default as VanillaMultiSelectWidget} from \"./value/VanillaMultiSelect\";\nexport {default as VanillaSelectWidget} from \"./value/VanillaSelect\";\nexport {default as VanillaNumberWidget} from \"./value/VanillaNumber\";\nexport {default as VanillaSliderWidget} from \"./value/VanillaSlider\";\n\n// field select widget\nexport {default as VanillaFieldSelect} from \"./core/VanillaFieldSelect\";\n\n// core components\nexport {default as VanillaConjs} from \"./core/VanillaConjs\";\nexport {default as VanillaButton} from \"./core/VanillaButton\";\nexport {default as VanillaButtonGroup} from \"./core/VanillaButtonGroup\";\nexport {default as VanillaValueSources} from \"./core/VanillaValueSources\";\nexport {default as VanillaSwitch} from \"./core/VanillaSwitch\";\nexport {default as vanillaConfirm} from \"./core/vanillaConfirm\";\n\nexport const VanillaProvider = ({config, children}) => children;\n","import React from \"react\";\nimport * as Widgets from \"../components/widgets\";\nimport * as Operators from \"../components/operators\";\nimport {SqlString, sqlEmptyValue, mongoEmptyValue, spelEscape, spelFixList} from \"../utils/export\";\nimport {escapeRegExp, getTitleInListValues} from \"../utils/stuff\";\nimport moment from \"moment\";\nimport {settings as defaultSettings} from \"../config/default\";\n\nconst {\n  //vanilla\n  VanillaBooleanWidget,\n  VanillaTextWidget,\n  VanillaTextAreaWidget,\n  VanillaDateWidget,\n  VanillaTimeWidget,\n  VanillaDateTimeWidget,\n  VanillaMultiSelectWidget,\n  VanillaSelectWidget,\n  VanillaNumberWidget,\n  VanillaSliderWidget,\n\n  //common\n  ValueFieldWidget,\n  FuncWidget\n} = Widgets;\nconst { ProximityOperator } = Operators;\n\n\n//----------------------------  conjunctions\n\nconst conjunctions = {\n  AND: {\n    label: \"And\",\n    mongoConj: \"$and\",\n    jsonLogicConj: \"and\",\n    sqlConj: \"AND\",\n    spelConj: \"and\",\n    spelConjs: [\"and\", \"&&\"],\n    reversedConj: \"OR\",\n    formatConj: (children, conj, not, isForDisplay) => {\n      return children.size > 1\n        ? (not ? \"NOT \" : \"\") + \"(\" + children.join(\" \" + (isForDisplay ? \"AND\" : \"&&\") + \" \") + \")\"\n        : (not ? \"NOT (\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n    sqlFormatConj: (children, conj, not) => {\n      return children.size > 1\n        ? (not ? \"NOT \" : \"\") + \"(\" + children.join(\" \" + \"AND\" + \" \") + \")\"\n        : (not ? \"NOT (\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n    spelFormatConj: (children, conj, not, omitBrackets) => {\n      if (not) omitBrackets = false;\n      return children.size > 1\n        ? (not ? \"!\" : \"\") + (omitBrackets ? \"\" : \"(\") + children.join(\" \" + \"&&\" + \" \") + (omitBrackets ? \"\" : \")\")\n        : (not ? \"!(\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n  },\n  OR: {\n    label: \"Or\",\n    mongoConj: \"$or\",\n    jsonLogicConj: \"or\",\n    sqlConj: \"OR\",\n    spelConj: \"or\",\n    spelConjs: [\"or\", \"||\"],\n    reversedConj: \"AND\",\n    formatConj: (children, conj, not, isForDisplay) => {\n      return children.size > 1\n        ? (not ? \"NOT \" : \"\") + \"(\" + children.join(\" \" + (isForDisplay ? \"OR\" : \"||\") + \" \") + \")\"\n        : (not ? \"NOT (\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n    sqlFormatConj: (children, conj, not) => {\n      return children.size > 1\n        ? (not ? \"NOT \" : \"\") + \"(\" + children.join(\" \" + \"OR\" + \" \") + \")\"\n        : (not ? \"NOT (\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n    spelFormatConj: (children, conj, not, omitBrackets) => {\n      if (not) omitBrackets = false;\n      return children.size > 1\n        ? (not ? \"!\" : \"\") + (omitBrackets ? \"\" : \"(\") + children.join(\" \" + \"||\" + \" \") + (omitBrackets ? \"\" : \")\")\n        : (not ? \"!(\" : \"\") + children.first() + (not ? \")\" : \"\");\n    },\n  },\n};\n\n//----------------------------  operators\n\n// helpers for mongo format\nexport const mongoFormatOp1 = (mop, mc, not,  field, _op, value, useExpr, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n  const $field = typeof field == \"string\" && !field.startsWith(\"$\") ? \"$\"+field : field;\n  const mv = mc(value, fieldDef);\n  if (mv === undefined)\n    return undefined;\n  if (not) {\n    if (!useExpr && (!mop || mop == \"$eq\"))\n      return { [field]: { \"$ne\": mv } }; // short form\n    return !useExpr\n      ? { [field]: { \"$not\": { [mop]: mv } } } \n      : { \"$not\": { [mop]: [$field, mv] } };\n  } else {\n    if (!useExpr && (!mop || mop == \"$eq\"))\n      return { [field]: mv }; // short form\n    return !useExpr\n      ? { [field]: { [mop]: mv } } \n      : { [mop]: [$field, mv] };\n  }\n};\n\nexport const mongoFormatOp2 = (mops, not,  field, _op, values, useExpr, valueSrcs, valueTypes, opDef, operatorOptions, fieldDef) => {\n  const $field = typeof field == \"string\" && !field.startsWith(\"$\") ? \"$\"+field : field;\n  if (not) {\n    return !useExpr\n      ? { [field]: { \"$not\": { [mops[0]]: values[0], [mops[1]]: values[1] } } } \n      : {\"$not\":\n                {\"$and\": [\n                  { [mops[0]]: [ $field, values[0] ] },\n                  { [mops[1]]: [ $field, values[1] ] },\n                ]}\n      };\n  } else {\n    return !useExpr\n      ? { [field]: { [mops[0]]: values[0], [mops[1]]: values[1] } } \n      : {\"$and\": [\n        { [mops[0]]: [ $field, values[0] ] },\n        { [mops[1]]: [ $field, values[1] ] },\n      ]};\n  }\n};\n\n\nconst operators = {\n  equal: {\n    label: \"==\",\n    labelForFormat: \"==\",\n    sqlOp: \"=\",\n    spelOp: \"==\",\n    spelOps: [\"==\", \"eq\"],\n    reversedOp: \"not_equal\",\n    formatOp: (field, op, value, valueSrcs, valueTypes, opDef, operatorOptions, isForDisplay, fieldDef) => {\n      const opStr = isForDisplay ? \"=\" : opDef.label;\n      if (valueTypes == \"boolean\" && isForDisplay)\n        return value == \"No\" ? `NOT ${field}` : `${field}`;\n      else\n        return `${field} ${opStr} ${value}`;\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => v, false),\n    jsonLogic: \"==\",\n    elasticSearchQueryType: \"term\",\n  },\n  not_equal: {\n    isNotOp: true,\n    label: \"!=\",\n    labelForFormat: \"!=\",\n    sqlOp: \"<>\",\n    spelOp: \"!=\",\n    spelOps: [\"!=\", \"ne\"],\n    reversedOp: \"equal\",\n    formatOp: (field, op, value, valueSrcs, valueTypes, opDef, operatorOptions, isForDisplay, fieldDef) => {\n      if (valueTypes == \"boolean\" && isForDisplay)\n        return value == \"No\" ? `${field}` : `NOT ${field}`;\n      else\n        return `${field} ${opDef.label} ${value}`;\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$ne\", v => v, false),\n    jsonLogic: \"!=\",\n  },\n  less: {\n    label: \"<\",\n    labelForFormat: \"<\",\n    sqlOp: \"<\",\n    spelOp: \"<\",\n    spelOps: [\"<\", \"lt\"],\n    reversedOp: \"greater_or_equal\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$lt\", v => v, false),\n    jsonLogic: \"<\",\n    elasticSearchQueryType: \"range\",\n  },\n  less_or_equal: {\n    label: \"<=\",\n    labelForFormat: \"<=\",\n    sqlOp: \"<=\",\n    spelOp: \"<=\",\n    spelOps: [\"<=\", \"le\"],\n    reversedOp: \"greater\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$lte\", v => v, false),\n    jsonLogic: \"<=\",\n    elasticSearchQueryType: \"range\",\n  },\n  greater: {\n    label: \">\",\n    labelForFormat: \">\",\n    sqlOp: \">\",\n    spelOp: \">\",\n    spelOps: [\">\", \"gt\"],\n    reversedOp: \"less_or_equal\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$gt\", v => v, false),\n    jsonLogic: \">\",\n    elasticSearchQueryType: \"range\",\n  },\n  greater_or_equal: {\n    label: \">=\",\n    labelForFormat: \">=\",\n    sqlOp: \">=\",\n    spelOp: \">=\",\n    spelOps: [\">=\", \"ge\"],\n    reversedOp: \"less\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$gte\", v => v, false),\n    jsonLogic: \">=\",\n    elasticSearchQueryType: \"range\",\n  },\n  like: {\n    label: \"Contains\",\n    labelForFormat: \"Contains\",\n    reversedOp: \"not_like\",\n    sqlOp: \"LIKE\",\n    spelOp: \".contains\",\n    spelOps: [\"matches\", \".contains\"],\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$regex\", v => (typeof v == \"string\" ? escapeRegExp(v) : undefined), false),\n    //jsonLogic: (field, op, val) => ({ \"in\": [val, field] }),\n    jsonLogic: \"in\",\n    _jsonLogicIsRevArgs: true,\n    valueSources: [\"value\"],\n    elasticSearchQueryType: \"regexp\",\n  },\n  not_like: {\n    isNotOp: true,\n    label: \"Not contains\",\n    reversedOp: \"like\",\n    labelForFormat: \"Not Contains\",\n    sqlOp: \"NOT LIKE\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$regex\", v => (typeof v == \"string\" ? escapeRegExp(v) : undefined), true),\n    valueSources: [\"value\"],\n  },\n  starts_with: {\n    label: \"Starts with\",\n    labelForFormat: \"Starts with\",\n    sqlOp: \"LIKE\",\n    spelOp: \".startsWith\",\n    spelOps: [\"matches\", \".startsWith\"],\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$regex\", v => (typeof v == \"string\" ? \"^\" + escapeRegExp(v) : undefined), false),\n    jsonLogic: undefined, // not supported\n    valueSources: [\"value\"],\n  },\n  ends_with: {\n    label: \"Ends with\",\n    labelForFormat: \"Ends with\",\n    sqlOp: \"LIKE\",\n    spelOp: \".endsWith\",\n    spelOps: [\"matches\", \".endsWith\"],\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$regex\", v => (typeof v == \"string\" ? escapeRegExp(v) + \"$\" : undefined), false),\n    jsonLogic: undefined, // not supported\n    valueSources: [\"value\"],\n  },\n  between: {\n    label: \"Between\",\n    labelForFormat: \"BETWEEN\",\n    sqlOp: \"BETWEEN\",\n    cardinality: 2,\n    formatOp: (field, op, values, valueSrcs, valueTypes, opDef, operatorOptions, isForDisplay) => {\n      let valFrom = values.first();\n      let valTo = values.get(1);\n      if (isForDisplay)\n        return `${field} BETWEEN ${valFrom} AND ${valTo}`;\n      else\n        return `${field} >= ${valFrom} && ${field} <= ${valTo}`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      const valFrom = values[0];\n      const valTo = values[1];\n      return `${field} >= ${valFrom} && ${field} <= ${valTo}`;\n    },\n    mongoFormatOp: mongoFormatOp2.bind(null, [\"$gte\", \"$lte\"], false),\n    valueLabels: [\n      \"Value from\",\n      \"Value to\"\n    ],\n    textSeparators: [\n      null,\n      \"and\"\n    ],\n    reversedOp: \"not_between\",\n    jsonLogic: \"<=\",\n    validateValues: (values) => {\n      if (values[0] != undefined && values[1] != undefined) {\n        return values[0] <= values[1] ? null : \"Invalid range\";\n      }\n      return null;\n    },\n    elasticSearchQueryType: function elasticSearchQueryType(type) {\n      return type === \"time\" ? \"filter\" : \"range\";\n    },\n  },\n  not_between: {\n    isNotOp: true,\n    label: \"Not between\",\n    labelForFormat: \"NOT BETWEEN\",\n    sqlOp: \"NOT BETWEEN\",\n    cardinality: 2,\n    formatOp: (field, op, values, valueSrcs, valueTypes, opDef, operatorOptions, isForDisplay) => {\n      let valFrom = values.first();\n      let valTo = values.get(1);\n      if (isForDisplay)\n        return `${field} NOT BETWEEN ${valFrom} AND ${valTo}`;\n      else\n        return `(${field} < ${valFrom} || ${field} > ${valTo})`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      const valFrom = values[0];\n      const valTo = values[1];\n      return `(${field} < ${valFrom} || ${field} > ${valTo})`;\n    },\n    mongoFormatOp: mongoFormatOp2.bind(null, [\"$gte\", \"$lte\"], true),\n    valueLabels: [\n      \"Value from\",\n      \"Value to\"\n    ],\n    textSeparators: [\n      null,\n      \"and\"\n    ],\n    reversedOp: \"between\",\n    validateValues: (values) => {\n      if (values[0] != undefined && values[1] != undefined) {\n        return values[0] <= values[1] ? null : \"Invalid range\";\n      }\n      return null;\n    },\n  },\n  is_empty: {\n    label: \"Is empty\",\n    labelForFormat: \"IS EMPTY\",\n    cardinality: 0,\n    reversedOp: \"is_not_empty\",\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return isForDisplay ? `${field} IS EMPTY` : `!${field}`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      const empty = sqlEmptyValue(fieldDef);\n      return `COALESCE(${field}, ${empty}) = ${empty}`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      //tip: is empty or null\n      return `${field} <= ''`;\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$in\", (v, fieldDef) => [mongoEmptyValue(fieldDef), null], false),\n    jsonLogic: \"!\",\n  },\n  is_not_empty: {\n    isNotOp: true,\n    label: \"Is not empty\",\n    labelForFormat: \"IS NOT EMPTY\",\n    cardinality: 0,\n    reversedOp: \"is_empty\",\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return isForDisplay ? `${field} IS NOT EMPTY` : `!!${field}`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      const empty = sqlEmptyValue(fieldDef);\n      return `COALESCE(${field}, ${empty}) <> ${empty}`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      //tip: is not empty and not null\n      return `${field} > ''`;\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$nin\", (v, fieldDef) => [mongoEmptyValue(fieldDef), null], false),\n    jsonLogic: \"!!\",\n    elasticSearchQueryType: \"exists\",\n  },\n  is_null: {\n    label: \"Is null\",\n    labelForFormat: \"IS NULL\",\n    sqlOp: \"IS NULL\",\n    cardinality: 0,\n    reversedOp: \"is_not_null\",\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return isForDisplay ? `${field} IS NULL` : `!${field}`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      return `${field} == null`;\n    },\n    // check if value is null OR not exists\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => null, false),\n    jsonLogic: \"==\",\n  },\n  is_not_null: {\n    label: \"Is not null\",\n    labelForFormat: \"IS NOT NULL\",\n    sqlOp: \"IS NOT NULL\",\n    cardinality: 0,\n    reversedOp: \"is_null\",\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return isForDisplay ? `${field} IS NOT NULL` : `!!${field}`;\n    },\n    spelFormatOp: (field, op, values, valueSrc, valueTypes, opDef, operatorOptions, fieldDef) => {\n      return `${field} != null`;\n    },\n    // check if value exists and is not null\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$ne\", v => null, false),\n    jsonLogic: \"!=\",\n    elasticSearchQueryType: \"exists\",\n  },\n  select_equals: {\n    label: \"==\",\n    labelForFormat: \"==\",\n    sqlOp: \"=\", // enum/set\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      const opStr = isForDisplay ? \"=\" : \"==\";\n      return `${field} ${opStr} ${value}`;\n    },\n    spelOp: \"==\",\n    spelOps: [\"==\", \"eq\"],\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => v, false),\n    reversedOp: \"select_not_equals\",\n    jsonLogic: \"==\",\n    elasticSearchQueryType: \"term\",\n  },\n  select_not_equals: {\n    isNotOp: true,\n    label: \"!=\",\n    labelForFormat: \"!=\",\n    sqlOp: \"<>\", // enum/set\n    formatOp: (field, op, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return `${field} != ${value}`;\n    },\n    spelOp: \"!=\",\n    spelOps: [\"!=\", \"ne\"],\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$ne\", v => v, false),\n    reversedOp: \"select_equals\",\n    jsonLogic: \"!=\",\n  },\n  select_any_in: {\n    label: \"Any in\",\n    labelForFormat: \"IN\",\n    sqlOp: \"IN\",\n    formatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      if (valueSrc == \"value\")\n        return `${field} IN (${values.join(\", \")})`;\n      else\n        return `${field} IN (${values})`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (valueSrc == \"value\") {\n        return `${field} IN (${values.join(\", \")})`;\n      } else return undefined; // not supported\n    },\n    spelOp: \"$contains\", // tip: $ means first arg is object\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$in\", v => v, false),\n    reversedOp: \"select_not_any_in\",\n    jsonLogic: \"in\",\n    elasticSearchQueryType: \"term\",\n  },\n  select_not_any_in: {\n    isNotOp: true,\n    label: \"Not in\",\n    labelForFormat: \"NOT IN\",\n    sqlOp: \"NOT IN\",\n    formatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      if (valueSrc == \"value\")\n        return `${field} NOT IN (${values.join(\", \")})`;\n      else\n        return `${field} NOT IN (${values})`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (valueSrc == \"value\") {\n        return `${field} NOT IN (${values.join(\", \")})`;\n      } else return undefined; // not supported\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$nin\", v => v, false),\n    reversedOp: \"select_any_in\",\n  },\n  //todo: multiselect_contains - for SpEL it would be `.containsAll`\n  multiselect_equals: {\n    label: \"Equals\",\n    labelForFormat: \"==\",\n    sqlOp: \"=\",\n    formatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      const opStr = isForDisplay ? \"=\" : \"==\";\n      if (valueSrc == \"value\")\n        return `${field} ${opStr} [${values.join(\", \")}]`;\n      else\n        return `${field} ${opStr} ${values}`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (valueSrc == \"value\")\n      // set\n        return `${field} = '${values.map(v => SqlString.trim(v)).join(\",\")}'`;\n      else\n        return undefined; //not supported\n    },\n    spelOp: \".equals\",\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => v, false),\n    reversedOp: \"multiselect_not_equals\",\n    jsonLogic2: \"all-in\",\n    jsonLogic: (field, op, vals) => ({\n      // it's not \"equals\", but \"includes\" operator - just for example\n      \"all\": [ field, {\"in\": [{\"var\": \"\"}, vals]} ]\n    }),\n    elasticSearchQueryType: \"term\",\n  },\n  multiselect_not_equals: {\n    isNotOp: true,\n    label: \"Not equals\",\n    labelForFormat: \"!=\",\n    sqlOp: \"<>\",\n    formatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      if (valueSrc == \"value\")\n        return `${field} != [${values.join(\", \")}]`;\n      else\n        return `${field} != ${values}`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (valueSrc == \"value\")\n      // set\n        return `${field} != '${values.map(v => SqlString.trim(v)).join(\",\")}'`;\n      else\n        return undefined; //not supported\n    },\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$ne\", v => v, false),\n    reversedOp: \"multiselect_equals\",\n  },\n  proximity: {\n    label: \"Proximity search\",\n    cardinality: 2,\n    valueLabels: [\n      { label: \"Word 1\", placeholder: \"Enter first word\" },\n      { label: \"Word 2\", placeholder: \"Enter second word\" },\n    ],\n    textSeparators: [\n      //'Word 1',\n      //'Word 2'\n    ],\n    formatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      const val1 = values.first();\n      const val2 = values.get(1);\n      const prox = operatorOptions.get(\"proximity\");\n      return `${field} ${val1} NEAR/${prox} ${val2}`;\n    },\n    sqlFormatOp: (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      const val1 = values.first();\n      const val2 = values.get(1);\n      const aVal1 = SqlString.trim(val1);\n      const aVal2 = SqlString.trim(val2);\n      const prox = operatorOptions.get(\"proximity\");\n      return `CONTAINS(${field}, 'NEAR((${aVal1}, ${aVal2}), ${prox})')`;\n    },\n    mongoFormatOp: undefined, // not supported\n    jsonLogic: undefined, // not supported\n    options: {\n      optionLabel: \"Near\", // label on top of \"near\" selectbox (for config.settings.showLabels==true)\n      optionTextBefore: \"Near\", // label before \"near\" selectbox (for config.settings.showLabels==false)\n      optionPlaceholder: \"Select words between\", // placeholder for \"near\" selectbox\n      factory: (props) => <ProximityOperator {...props} />,\n      minProximity: 2,\n      maxProximity: 10,\n      defaults: {\n        proximity: 2\n      },\n    },\n  },\n  some: {\n    label: \"Some\",\n    labelForFormat: \"SOME\",\n    cardinality: 0,\n    jsonLogic: \"some\",\n    spelFormatOp: (filteredSize) => `${filteredSize} > 0`,\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$gt\", v => 0, false),\n  },\n  all: {\n    label: \"All\",\n    labelForFormat: \"ALL\",\n    cardinality: 0,\n    jsonLogic: \"all\",\n    spelFormatOp: (filteredSize, op, fullSize) => `${filteredSize} == ${fullSize}`,\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => v, false),\n  },\n  none: {\n    label: \"None\",\n    labelForFormat: \"NONE\",\n    cardinality: 0,\n    jsonLogic: \"none\",\n    spelFormatOp: (filteredSize) => `${filteredSize} == 0`,\n    mongoFormatOp: mongoFormatOp1.bind(null, \"$eq\", v => 0, false),\n  }\n};\n\n\n//----------------------------  widgets\n\nexport const stringifyForDisplay = (v) => (v == null ? \"NULL\" : v.toString());\n\nconst widgets = {\n  text: {\n    type: \"text\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    valueLabel: \"String\",\n    valuePlaceholder: \"Enter string\",\n    factory: (props) => <VanillaTextWidget {...props} />,\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? stringifyForDisplay(val) : JSON.stringify(val);\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      if (opDef.spelOp == \"matches\" && op != \"regex\") {\n        let regex;\n        if (op == \"starts_with\") {\n          regex = `(?s)^${escapeRegExp(val)}.*`;\n        } else if (op == \"ends_with\") {\n          regex = `(?s).*${escapeRegExp(val)}$`;\n        } else { // op == 'like'\n          regex = `(?s).*${escapeRegExp(val)}.*`; //tip: can use (?sui) for case-insensitive\n        }\n        return spelEscape(regex);\n      } else {\n        return spelEscape(val);\n      }\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      if (opDef.sqlOp == \"LIKE\" || opDef.sqlOp == \"NOT LIKE\") {\n        return SqlString.escapeLike(val, op != \"starts_with\", op != \"ends_with\");\n      } else {\n        return SqlString.escape(val);\n      }\n    },\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  textarea: {\n    type: \"text\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    valueLabel: \"Text\",\n    valuePlaceholder: \"Enter text\",\n    factory: (props) => <VanillaTextAreaWidget {...props} />,\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? stringifyForDisplay(val) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      if (opDef.sqlOp == \"LIKE\" || opDef.sqlOp == \"NOT LIKE\") {\n        return SqlString.escapeLike(val, op != \"starts_with\", op != \"ends_with\");\n      } else {\n        return SqlString.escape(val);\n      }\n    },\n    spelFormatValue: (val) => spelEscape(val),\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n    fullWidth: true,\n  },\n  number: {\n    type: \"number\",\n    jsType: \"number\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaNumberWidget {...props} />,\n    valueLabel: \"Number\",\n    valuePlaceholder: \"Enter number\",\n    valueLabels: [\n      { label: \"Number from\", placeholder: \"Enter number from\" },\n      { label: \"Number to\", placeholder: \"Enter number to\" },\n    ],\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? stringifyForDisplay(val) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return SqlString.escape(val);\n    },\n    spelFormatValue: (val, fieldDef, wgtDef) => {\n      const isFloat = wgtDef.step && !Number.isInteger(wgtDef.step);\n      return spelEscape(val, isFloat);\n    },\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  slider: {\n    type: \"number\",\n    jsType: \"number\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaSliderWidget {...props} />,\n    valueLabel: \"Number\",\n    valuePlaceholder: \"Enter number or move slider\",\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? stringifyForDisplay(val) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return SqlString.escape(val);\n    },\n    spelFormatValue: (val) => spelEscape(val),\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  select: {\n    type: \"select\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaSelectWidget {...props} />,\n    valueLabel: \"Value\",\n    valuePlaceholder: \"Select value\",\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      let valLabel = getTitleInListValues(fieldDef.fieldSettings.listValues || fieldDef.asyncListValues, val);\n      return isForDisplay ? stringifyForDisplay(valLabel) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return SqlString.escape(val);\n    },\n    spelFormatValue: (val) => spelEscape(val),\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  multiselect: {\n    type: \"multiselect\",\n    jsType: \"array\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaMultiSelectWidget {...props} />,\n    valueLabel: \"Values\",\n    valuePlaceholder: \"Select values\",\n    formatValue: (vals, fieldDef, wgtDef, isForDisplay) => {\n      let valsLabels = vals.map(v => getTitleInListValues(fieldDef.fieldSettings.listValues || fieldDef.asyncListValues, v));\n      return isForDisplay ? valsLabels.map(stringifyForDisplay) : vals.map(JSON.stringify);\n    },\n    sqlFormatValue: (vals, fieldDef, wgtDef, op, opDef) => {\n      return vals.map(v => SqlString.escape(v));\n    },\n    spelFormatValue: (vals, fieldDef, wgtDef, op, opDef) => {\n      const isCallable = opDef.spelOp && opDef.spelOp[0] == \"$\";\n      let res = spelEscape(vals); // inline list\n      if (isCallable) {\n        // `{1,2}.contains(1)` NOT works\n        // `{1,2}.?[true].contains(1)` works\n        res = spelFixList(res);\n      }\n      return res;\n    },\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  date: {\n    type: \"date\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaDateWidget {...props} />,\n    dateFormat: \"DD.MM.YYYY\",\n    valueFormat: \"YYYY-MM-DD\",\n    useKeyboard: true,\n    valueLabel: \"Date\",\n    valuePlaceholder: \"Enter date\",\n    valueLabels: [\n      { label: \"Date from\", placeholder: \"Enter date from\" },\n      { label: \"Date to\", placeholder: \"Enter date to\" },\n    ],\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return isForDisplay ? dateVal.format(wgtDef.dateFormat) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return SqlString.escape(dateVal.format(\"YYYY-MM-DD\"));\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return `new java.text.SimpleDateFormat('yyyy-MM-dd').parse('${dateVal.format(\"YYYY-MM-DD\")}')`;\n    },\n    jsonLogic: (val, fieldDef, wgtDef) => moment(val, wgtDef.valueFormat).toDate(),\n    toJS: (val, fieldSettings) => {\n      const dateVal = moment(val, fieldSettings.valueFormat);\n      return dateVal.isValid() ? dateVal.toDate() : undefined;\n    },\n    mongoFormatValue: (val, fieldDef, wgtDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return dateVal.isValid() ? dateVal.toDate() : undefined;\n    }\n  },\n  time: {\n    type: \"time\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaTimeWidget {...props} />,\n    timeFormat: \"HH:mm\",\n    valueFormat: \"HH:mm:ss\",\n    use12Hours: false,\n    useKeyboard: true,\n    valueLabel: \"Time\",\n    valuePlaceholder: \"Enter time\",\n    valueLabels: [\n      { label: \"Time from\", placeholder: \"Enter time from\" },\n      { label: \"Time to\", placeholder: \"Enter time to\" },\n    ],\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return isForDisplay ? dateVal.format(wgtDef.timeFormat) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return SqlString.escape(dateVal.format(\"HH:mm:ss\"));\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return `T(java.time.LocalTime).parse('${dateVal.format(\"HH:mm:ss\")}')`;\n      //return `new java.text.SimpleDateFormat('HH:mm:ss').parse('${dateVal.format(\"HH:mm:ss\")}')`;\n    },\n    jsonLogic: (val, fieldDef, wgtDef) => {\n      // return seconds of day\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return dateVal.get(\"hour\") * 60 * 60 + dateVal.get(\"minute\") * 60 + dateVal.get(\"second\");\n    },\n    toJS: (val, fieldSettings) => {\n      // return seconds of day\n      const dateVal = moment(val, fieldSettings.valueFormat);\n      return dateVal.isValid() ? dateVal.get(\"hour\") * 60 * 60 + dateVal.get(\"minute\") * 60 + dateVal.get(\"second\") : undefined;\n    },\n    mongoFormatValue: (val, fieldDef, wgtDef) => {\n      // return seconds of day\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return dateVal.get(\"hour\") * 60 * 60 + dateVal.get(\"minute\") * 60 + dateVal.get(\"second\");\n    },\n    elasticSearchFormatValue: function elasticSearchFormatValue(queryType, value, operator, fieldName) {\n      return {\n        script: {\n          script: {\n            source: \"doc[\".concat(fieldName, \"][0].getHour() >== params.min && doc[\").concat(fieldName, \"][0].getHour() <== params.max\"),\n            params: {\n              min: value[0],\n              max: value[1]\n            }\n          }\n        }\n      };\n    },\n  },\n  datetime: {\n    type: \"datetime\",\n    jsType: \"string\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaDateTimeWidget {...props} />,\n    timeFormat: \"HH:mm\",\n    dateFormat: \"DD.MM.YYYY\",\n    valueFormat: \"YYYY-MM-DD HH:mm:ss\",\n    use12Hours: false,\n    useKeyboard: true,\n    valueLabel: \"Datetime\",\n    valuePlaceholder: \"Enter datetime\",\n    valueLabels: [\n      { label: \"Datetime from\", placeholder: \"Enter datetime from\" },\n      { label: \"Datetime to\", placeholder: \"Enter datetime to\" },\n    ],\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return isForDisplay ? dateVal.format(wgtDef.dateFormat + \" \" + wgtDef.timeFormat) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return SqlString.escape(dateVal.toDate());\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return `new java.text.SimpleDateFormat('yyyy-MM-dd HH:mm:ss').parse('${dateVal.format(\"YYYY-MM-DD HH:mm:ss\")}')`;\n    },\n    jsonLogic: (val, fieldDef, wgtDef) => moment(val, wgtDef.valueFormat).toDate(),\n    toJS: (val, fieldSettings) => {\n      const dateVal = moment(val, fieldSettings.valueFormat);\n      return dateVal.isValid() ? dateVal.toDate() : undefined;\n    },\n    mongoFormatValue: (val, fieldDef, wgtDef) => {\n      const dateVal = moment(val, wgtDef.valueFormat);\n      return dateVal.isValid() ? dateVal.toDate() : undefined;\n    }\n  },\n  boolean: {\n    type: \"boolean\",\n    jsType: \"boolean\",\n    valueSrc: \"value\",\n    factory: (props) => <VanillaBooleanWidget {...props} />,\n    labelYes: \"Yes\",\n    labelNo: \"No\",\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? (val ? \"Yes\" : \"No\") : JSON.stringify(!!val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return SqlString.escape(val);\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return spelEscape(val);\n    },\n    defaultValue: false,\n    toJS: (val, fieldSettings) => (val),\n    mongoFormatValue: (val, fieldDef, wgtDef) => (val),\n  },\n  field: {\n    valueSrc: \"field\",\n    factory: (props) => <ValueFieldWidget {...props} />,\n    formatValue: (val, fieldDef, wgtDef, isForDisplay, op, opDef, rightFieldDef) => {\n      return isForDisplay ? (rightFieldDef.label || val) : val;\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef, rightFieldDef) => {\n      return val;\n    },\n    spelFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return val;\n    },\n    valueLabel: \"Field to compare\",\n    valuePlaceholder: \"Select field to compare\",\n    customProps: {\n      showSearch: true\n    }\n  },\n  func: {\n    valueSrc: \"func\",\n    factory: (props) => <FuncWidget {...props} />,\n    valueLabel: \"Function\",\n    valuePlaceholder: \"Select function\",\n    customProps: {\n      //showSearch: true\n    }\n  },\n  case_value: {\n    valueSrc: \"value\",\n    type: \"case_value\",\n    spelFormatValue: (val) => {\n      return spelEscape(val === \"\" ? null : val);\n    },\n    spelImportValue: (val) => {\n      return [val.value, []];\n    },\n    factory: ({value, setValue}) =>  \n      <input \n        type=\"text\" \n        value={value || \"\"} \n        onChange={e => setValue(e.target.value)} \n      />\n  }\n};\n\n//----------------------------  types\n\nconst types = {\n  text: {\n    defaultOperator: \"equal\",\n    mainWidget: \"text\",\n    widgets: {\n      text: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"like\",\n          \"not_like\",\n          \"starts_with\",\n          \"ends_with\",\n          \"proximity\",\n          \"is_empty\",\n          \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n        widgetProps: {},\n        opProps: {},\n      },\n      textarea: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"like\",\n          \"not_like\",\n          \"starts_with\",\n          \"ends_with\",\n          \"is_empty\",\n          \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n        widgetProps: {},\n        opProps: {},\n      },\n      field: {\n        operators: [\n          //unary ops (like `is_empty`) will be excluded anyway, see getWidgetsForFieldOp()\n          \"equal\",\n          \"not_equal\",\n          \"proximity\", //can exclude if you want\n        ],\n      }\n    },\n  },\n  number: {\n    defaultOperator: \"equal\",\n    mainWidget: \"number\",\n    widgets: {\n      number: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          \"between\",\n          \"not_between\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n      },\n      slider: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\"\n        ],\n      },\n    },\n  },\n  date: {\n    defaultOperator: \"equal\",\n    widgets: {\n      date: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          \"between\",\n          \"not_between\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\"\n        ]\n      }\n    },\n  },\n  time: {\n    defaultOperator: \"equal\",\n    widgets: {\n      time: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          \"between\",\n          \"not_between\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ]\n      }\n    },\n  },\n  datetime: {\n    defaultOperator: \"equal\",\n    widgets: {\n      datetime: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          \"between\",\n          \"not_between\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n      }\n    },\n  },\n  select: {\n    mainWidget: \"select\",\n    defaultOperator: \"select_equals\",\n    widgets: {\n      select: {\n        operators: [\n          \"select_equals\",\n          \"select_not_equals\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n        widgetProps: {\n          customProps: {\n            showSearch: true\n          }\n        },\n      },\n      multiselect: {\n        operators: [\n          \"select_any_in\",\n          \"select_not_any_in\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n      },\n    },\n  },\n  multiselect: {\n    defaultOperator: \"multiselect_equals\",\n    widgets: {\n      multiselect: {\n        operators: [\n          \"multiselect_equals\",\n          \"multiselect_not_equals\",\n          // \"is_empty\",\n          // \"is_not_empty\",\n          \"is_null\",\n          \"is_not_null\",\n        ]\n      }\n    },\n  },\n  boolean: {\n    defaultOperator: \"equal\",\n    widgets: {\n      boolean: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n        widgetProps: {\n          //you can enable this if you don't use fields as value sources\n          // hideOperator: true,\n          // operatorInlineLabel: \"is\",\n        }\n      },\n      field: {\n        operators: [\n          \"equal\",\n          \"not_equal\",\n        ],\n      }\n    },\n  },\n  \"!group\": {\n    defaultOperator: \"some\",\n    mainWidget: \"number\",\n    widgets: {\n      number: {\n        widgetProps: {\n          min: 0\n        },\n        operators: [\n          // w/o operand\n          \"some\",\n          \"all\",\n          \"none\",\n\n          // w/ operand - count\n          \"equal\",\n          \"not_equal\",\n          \"less\",\n          \"less_or_equal\",\n          \"greater\",\n          \"greater_or_equal\",\n          \"between\",\n          \"not_between\",\n        ],\n        opProps: {\n          equal: {\n            label: \"Count ==\"\n          },\n          not_equal: {\n            label: \"Count !=\"\n          },\n          less: {\n            label: \"Count <\"\n          },\n          less_or_equal: {\n            label: \"Count <=\"\n          },\n          greater: {\n            label: \"Count >\"\n          },\n          greater_or_equal: {\n            label: \"Count >=\"\n          },\n          between: {\n            label: \"Count between\"\n          },\n          not_between: {\n            label: \"Count not between\"\n          }\n        }\n      }\n    }\n  },\n  \"case_value\": {\n    mainWidget: \"case_value\",\n    widgets: {\n      case_value: {}\n    }\n  },\n};\n\n//----------------------------  settings\n\nconst settings = {\n  ...defaultSettings,\n\n  formatField: (field, parts, label2, fieldDefinition, config, isForDisplay) => {\n    if (isForDisplay)\n      return label2;\n    else\n      return field;\n  },\n  formatSpelField: (field, parentField, parts, partsExt, fieldDefinition, config) => {\n    let fieldName = partsExt.map(({key, parent}, ind) => {\n      if (ind == 0) {\n        if (parent == \"[map]\")\n          return `#this[${spelEscape(key)}]`;\n        else if (parent == \"[class]\")\n          return key;\n        else\n          return key;\n      } else {\n        if (parent == \"map\" || parent == \"[map]\")\n          return `[${spelEscape(key)}]`;\n        else if (parent == \"class\" || parent == \"[class]\")\n          return `.${key}`;\n        else\n          return `.${key}`;\n      }\n    }).join(\"\");\n    if (fieldDefinition.isSpelVariable) {\n      fieldName = \"#\" + fieldName;\n    }\n    return fieldName;\n  },\n  sqlFormatReverse: (q) => {\n    if (q == undefined) return undefined;\n    return \"NOT(\" + q + \")\";\n  },\n  spelFormatReverse: (q) => {\n    if (q == undefined) return undefined;\n    return \"!(\" + q + \")\";\n  },\n  formatReverse: (q, operator, reversedOp, operatorDefinition, revOperatorDefinition, isForDisplay) => {\n    if (q == undefined) return undefined;\n    if (isForDisplay)\n      return \"NOT (\" + q + \")\";\n    else\n      return \"!(\" + q + \")\";\n  },\n  formatAggr: (whereStr, aggrField, operator, value, valueSrc, valueType, opDef, operatorOptions, isForDisplay, aggrFieldDef) => {\n    const {labelForFormat, cardinality} = opDef;\n    if (cardinality == 0) {\n      const cond = whereStr ? ` HAVE ${whereStr}` : \"\";\n      return `${labelForFormat} OF ${aggrField}${cond}`;\n    } else if (cardinality == undefined || cardinality == 1) {\n      const cond = whereStr ? ` WHERE ${whereStr}` : \"\";\n      return `COUNT OF ${aggrField}${cond} ${labelForFormat} ${value}`;\n    } else if (cardinality == 2) {\n      const cond = whereStr ? ` WHERE ${whereStr}` : \"\";\n      let valFrom = value.first();\n      let valTo = value.get(1);\n      return `COUNT OF ${aggrField}${cond} ${labelForFormat} ${valFrom} AND ${valTo}`;\n    }\n  },\n  canCompareFieldWithField: (leftField, leftFieldConfig, rightField, rightFieldConfig) => {\n    //for type == 'select'/'multiselect' you can check listValues\n    return true;\n  },\n\n  // enable compare fields\n  valueSourcesInfo: {\n    value: {\n      label: \"Value\"\n    },\n    field: {\n      label: \"Field\",\n      widget: \"field\",\n    },\n    func: {\n      label: \"Function\",\n      widget: \"func\",\n    }\n  },\n  customFieldSelectProps: {\n    showSearch: true\n  },\n\n  defaultSliderWidth: \"200px\",\n  defaultSelectWidth: \"200px\",\n  defaultSearchWidth: \"100px\",\n  defaultMaxRows: 5,\n};\n\n//----------------------------\n\nexport default {\n  conjunctions,\n  operators,\n  widgets,\n  types,\n  settings,\n};\n","import * as Widgets from \"../components/widgets\";\nimport React from \"react\";\nconst {\n  VanillaFieldSelect,\n  VanillaConjs,\n  VanillaButton,\n  VanillaButtonGroup,\n  VanillaProvider,\n  VanillaValueSources,\n  vanillaConfirm,\n  VanillaSwitch,\n} = Widgets;\n\nexport const settings = {\n  formatField: (field, parts, label2, fieldDefinition, config, isForDisplay) => {\n    if (isForDisplay)\n      return label2;\n    else\n      return field;\n  },\n\n  renderField: (props) => <VanillaFieldSelect {...props} />,\n  renderOperator: (props) => <VanillaFieldSelect {...props} />,\n  renderFunc: (props) => <VanillaFieldSelect {...props} />,\n  renderConjs: (props) => <VanillaConjs {...props} />,\n  renderSwitch: (props) => <VanillaSwitch {...props} />,\n  renderButton: (props) => <VanillaButton {...props} />,\n  renderButtonGroup: (props) => <VanillaButtonGroup {...props} />,\n  renderProvider: (props) => <VanillaProvider {...props} />,\n  renderValueSources: (props) => <VanillaValueSources {...props} />,\n  renderConfirm: vanillaConfirm,\n  renderSwitchPrefix: () => <>{\"Conditions\"}</>,\n\n  valueSourcesInfo: {\n    value: {},\n  },\n  fieldSeparator: \".\",\n  fieldSeparatorDisplay: \".\",\n  renderSize: \"small\",\n  maxLabelsLength: 100,\n  canReorder: true,\n  canRegroup: true,\n  showLock: false,\n  canDeleteLocked: false,\n  showNot: true,\n  canLeaveEmptyGroup: true,\n  shouldCreateEmptyGroup: false,\n  forceShowConj: false,\n  canShortMongoQuery: true,\n  removeEmptyGroupsOnLoad: true,\n  removeIncompleteRulesOnLoad: true,\n  removeInvalidMultiSelectValuesOnLoad: true,\n  groupActionsPosition: \"topRight\", // oneOf [topLeft, topCenter, topRight, bottomLeft, bottomCenter, bottomRight]\n  setOpOnChangeField: [\"keep\", \"default\"], // 'default' (default if present), 'keep' (keep prev from last field), 'first', 'none'\n  groupOperators: [\"some\", \"all\", \"none\"],\n\n  convertableWidgets: {\n    \"number\": [\"slider\", \"rangeslider\"],\n    \"slider\": [\"number\", \"rangeslider\"],\n    \"rangeslider\": [\"number\", \"slider\"],\n    \"text\": [\"textarea\"],\n    \"textarea\": [\"text\"]\n  },\n\n  // localization\n  locale: {\n    moment: \"en\",\n  },\n  valueLabel: \"Value\",\n  valuePlaceholder: \"Value\",\n  fieldLabel: \"Field\",\n  operatorLabel: \"Operator\",\n  funcLabel: \"Function\",\n  fieldPlaceholder: \"Select field\",\n  funcPlaceholder: \"Select function\",\n  operatorPlaceholder: \"Select operator\",\n  lockLabel: \"Lock\",\n  lockedLabel: \"Locked\",\n  deleteLabel: null,\n  addGroupLabel: \"Add group\",\n  addCaseLabel: \"Add condition\",\n  addDefaultCaseLabel: \"Add default condition\",\n  defaultCaseLabel: \"Default:\",\n  addRuleLabel: \"Add rule\",\n  addSubRuleLabel: \"Add sub rule\",\n  delGroupLabel: \"\",\n  notLabel: \"Not\",\n  valueSourcesPopupTitle: \"Select value source\",\n  removeRuleConfirmOptions: null,\n  removeGroupConfirmOptions: null,\n\n  defaultGroupConjunction: \"AND\",\n  jsonLogic: {\n    groupVarKey: \"var\",\n    altVarKey: \"var\",\n    lockedOp: \"locked\"\n  }\n};\n","import React from \"react\";\nimport omit from \"lodash/omit\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Autocomplete, { createFilterOptions } from \"@material-ui/lab/Autocomplete\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport Chip from \"@material-ui/core/Chip\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\nimport CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n\nimport useListValuesAutocomplete from \"../../../../hooks/useListValuesAutocomplete\";\n\nconst nonCheckedIcon = <CheckBoxOutlineBlankIcon fontSize=\"small\" />;\nconst checkedIcon = <CheckBoxIcon fontSize=\"small\" />;\nconst defaultFilterOptions = createFilterOptions();\nconst emptyArray = [];\n\nexport default (props) => {\n  const {\n    allowCustomValues, multiple,\n    value: selectedValue, customProps, readonly, config, groupBy, filterOptionsConfig\n  } = props;\n  const filterOptionsFn = filterOptionsConfig ? createFilterOptions(filterOptionsConfig) : defaultFilterOptions;\n\n  // hook\n  const {\n    open,\n    onOpen,\n    onClose,\n    onChange,\n    onInputChange,\n    inputValue,\n    options,\n    isInitialLoading,\n    isLoading,\n    aPlaceholder,\n    extendOptions,\n    getOptionSelected,\n    getOptionDisabled,\n    getOptionLabel,\n  } = useListValuesAutocomplete(props, {\n    debounceTimeout: 100,\n    multiple\n  });\n\n  // setings\n  const {defaultSelectWidth, defaultSearchWidth} = config.settings;\n  const {width, showCheckboxes, ...rest} = customProps || {};\n  let customInputProps = rest.input || {};\n  const inputWidth = customInputProps.width || defaultSearchWidth;\n  customInputProps = omit(customInputProps, [\"width\"]);\n  const customAutocompleteProps = omit(rest, [\"showSearch\", \"showCheckboxes\"]);\n\n  const fullWidth = true;\n  const minWidth = width || defaultSelectWidth;\n  const style = {\n    width: (multiple ? undefined : minWidth),\n    minWidth: minWidth\n  };\n  const placeholder = !readonly ? aPlaceholder : \"\";\n  const hasValue = selectedValue != null;\n  // should be simple value to prevent re-render!s\n  const value = hasValue ? selectedValue : (multiple ? emptyArray : null);\n  \n  const filterOptions = (options, params) => {\n    const filtered = filterOptionsFn(options, params);\n    const extended = extendOptions(filtered);\n    return extended;\n  };\n\n  // styles\n  const useStyles = makeStyles((theme) => ({\n    // fix too small width\n    input: {\n      minWidth: inputWidth + \" !important\",\n    }\n  }));\n\n  const useStylesChip = makeStyles((theme) => ({\n    // fix height\n    root: {\n      height: \"auto\"\n    },\n    label: {\n      marginTop: \"3px\",\n      marginBottom: \"3px\",\n    }\n  }));\n\n  const classesChip = useStylesChip();\n  const classes = useStyles();\n\n  // render\n  const renderInput = (params) => {\n    return (\n      <TextField \n        {...params} \n        InputProps={{\n          ...params.InputProps,\n          readOnly: readonly,\n          endAdornment: (\n            <React.Fragment>\n              {isLoading ? <CircularProgress color=\"inherit\" size={20} /> : null}\n              {params.InputProps.endAdornment}\n            </React.Fragment>\n          ),\n        }}\n        disabled={readonly}\n        placeholder={placeholder}\n        //onChange={onInputChange}\n        {...customInputProps}\n      />\n    );\n  };\n\n  const renderTags = (value, getTagProps) => value.map((option, index) => {\n    return <Chip\n      key={index}\n      classes={classesChip}\n      label={getOptionLabel(option)}\n      {...getTagProps({ index })}\n    />;\n  });\n\n  const renderOption = (option, { selected }) => {\n    if (option.specialValue) {\n      return <React.Fragment>{option.renderTitle || option.title}</React.Fragment>;\n    } else if (multiple && showCheckboxes != false) {\n      return <React.Fragment>\n        <Checkbox\n          icon={nonCheckedIcon}\n          checkedIcon={checkedIcon}\n          style={{ marginRight: 8 }}\n          checked={selected}\n        />\n        {option.title}\n      </React.Fragment>;\n    } else {\n      return <React.Fragment>{option.renderTitle || option.title}</React.Fragment>;\n    }\n  };\n\n  return (\n    <FormControl fullWidth={fullWidth}>\n      <Autocomplete\n        disableCloseOnSelect={multiple}\n        fullWidth={fullWidth}\n        multiple={multiple}\n        style={style}\n        classes={classes}\n        freeSolo={allowCustomValues}\n        loading={isInitialLoading}\n        open={open}\n        onOpen={onOpen}\n        onClose={onClose}\n        inputValue={inputValue}\n        onInputChange={onInputChange}\n        label={placeholder}\n        onChange={onChange}\n        value={value}\n        getOptionSelected={getOptionSelected}\n        disabled={readonly}\n        readOnly={readonly}\n        options={options}\n        groupBy={groupBy}\n        getOptionLabel={getOptionLabel}\n        getOptionDisabled={getOptionDisabled}\n        renderInput={renderInput}\n        renderTags={renderTags}\n        renderOption={renderOption}\n        filterOptions={filterOptions}\n        {...customAutocompleteProps}\n      ></Autocomplete>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport MaterialAutocomplete from \"../value/MaterialAutocomplete\";\n\nconst itemsToListValues = (items, level = 0) => (\n  items.map(item => {\n    const {items, path, label, disabled, grouplabel} = item;\n    const prefix = \"\\u00A0\\u00A0\".repeat(level);\n    if (items) {\n      return itemsToListValues(items, level+1);\n    } else {\n      return {\n        title: label,\n        renderTitle: prefix+label,\n        value: path,\n        disabled,\n        groupTitle: level > 0 ? prefix+grouplabel : null,\n      };\n    }\n  }).flat(Infinity)\n);\n\nconst filterOptionsConfig = {\n  stringify: (option) => {\n    const keysForFilter = [\"title\", \"value\", \"grouplabel\", \"label\"];\n    const valueForFilter = keysForFilter\n      .map(k => (typeof option[k] == \"string\" ? option[k] : \"\"))\n      .join(\"\\0\");\n    return valueForFilter;\n  }\n};\n\nconst fieldAdapter = ({items, selectedKey, setField, ...rest}) => {\n  const listValues = itemsToListValues(items);\n  const groupBy = (option) => option.groupTitle;\n  const value = selectedKey;\n  const setValue = (value, _asyncValues) => {\n    if (!value) return undefined;\n    return setField(value);\n  };\n\n  return {\n    ...rest,\n    listValues,\n    setValue,\n    groupBy,\n    filterOptionsConfig,\n    allowCustomValues: false,\n    multiple: false,\n    value,\n  };\n};\n\nexport default (props) => {\n  return <MaterialAutocomplete  {...fieldAdapter(props)} />;\n};\n","import React from \"react\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport ExpandMoreSharpIcon from \"@material-ui/icons/ExpandMoreSharp\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Radio from \"@material-ui/core/Radio\";\nimport RadioGroup from \"@material-ui/core/RadioGroup\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport FormLabel from \"@material-ui/core/FormLabel\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    padding: theme.spacing(1),\n  },\n}));\n\nexport default ({ valueSources, valueSrc, title, setValueSrc, readonly}) => {\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const classes = useStyles();\n\n\n  const handleOpen = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const toggleOpenClose = (event) => {\n    anchorEl ? handleClose() : handleOpen(event);\n  };\n\n  const handleChange = e => {\n    if (e.target.value === undefined)\n      return;\n    setValueSrc(e.target.value);\n    handleClose();\n  };\n\n  const renderOptions = (valueSources) => (\n    valueSources.map(([srcKey, info]) => (\n      <FormControlLabel \n        key={srcKey} \n        value={srcKey} \n        checked={valueSrc == srcKey || !valueSrc && srcKey == \"value\"} \n        control={<Radio />} \n        label={info.label}\n      />\n    ))\n  );\n\n  const open = Boolean(anchorEl);\n\n  return (\n    <div>\n      <IconButton size=\"small\" onClick={toggleOpenClose}>\n        <ExpandMoreSharpIcon />\n      </IconButton>\n    \n      <Popover    \n        open={open}\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"left\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"left\",\n        }}\n        onClose={handleClose}\n        classes={{\n          paper: classes.paper,\n        }}\n        disablePortal\n      >\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\">{title}</FormLabel>\n          <RadioGroup value={valueSrc || \"value\"} onChange={handleChange}>\n            {renderOptions(valueSources)}\n          </RadioGroup>\n        </FormControl>\n      </Popover>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { ThemeProvider, createTheme } from \"@material-ui/core/styles\";\nimport { ConfirmProvider, useConfirm } from \"material-ui-confirm\";\nimport { MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport MomentUtils from \"@date-io/moment\";\n\n\n// value widgets\nimport MaterialTextWidget from \"./value/MaterialText\";\nimport MaterialTextAreaWidget from \"./value/MaterialTextArea\";\nimport MaterialDateWidget from \"./value/MaterialDate\";\nimport MaterialDateTimeWidget from \"./value/MaterialDateTime\";\nimport MaterialTimeWidget from \"./value/MaterialTime\";\nimport MaterialSelectWidget from \"./value/MaterialSelect\";\nimport MaterialNumberWidget from \"./value/MaterialNumber\";\nimport MaterialSliderWidget from \"./value/MaterialSlider\";\nimport MaterialRangeWidget from \"./value/MaterialRange\";\nimport MaterialBooleanWidget from \"./value/MaterialBoolean\";\nimport MaterialMultiSelectWidget from \"./value/MaterialMultiSelect\";\nimport MaterialAutocompleteWidget from \"./value/MaterialAutocomplete\";\n\n// field select widgets\nimport MaterialFieldSelect from \"./core/MaterialFieldSelect\";\nimport MaterialFieldAutocomplete from \"./core/MaterialFieldAutocomplete\";\n\n// core components\nimport MaterialButton from \"./core/MaterialButton\";\nimport MaterialButtonGroup from \"./core/MaterialButtonGroup\";\nimport MaterialConjs from \"./core/MaterialConjs\";\nimport MaterialSwitch from \"./core/MaterialSwitch\";\nimport MaterialValueSources from \"./core/MaterialValueSources\";\nimport MaterialConfirm from \"./core/MaterialConfirm\";\n\n// provider\nconst MaterialProvider = ({config, children}) => {\n  const settingsTheme = config.settings.theme || {};\n  const settingsLocale = config.settings.locale || {};\n  const themeConfig = settingsTheme.material;\n  const locale = settingsLocale.material;\n  const useTheme = themeConfig || locale;\n  const theme = useTheme ? createTheme(themeConfig, locale) : null;\n\n  const base = (<div className=\"mui\">{children}</div>);\n  const withProviders = (\n    <MuiPickersUtilsProvider utils={MomentUtils}>\n      <ConfirmProvider>\n        {base}\n      </ConfirmProvider>\n    </MuiPickersUtilsProvider>\n  );\n  const withTheme = theme ? (\n    <ThemeProvider theme={theme}>\n      {withProviders}\n    </ThemeProvider>\n  ) : withProviders;\n\n  return withTheme;\n};\n\n\nexport default {\n  MaterialTextWidget,\n  MaterialTextAreaWidget,\n  MaterialDateWidget,\n  MaterialDateTimeWidget,\n  MaterialTimeWidget,\n  MaterialSelectWidget,\n  MaterialNumberWidget,\n  MaterialSliderWidget,\n  MaterialRangeWidget,\n  MaterialBooleanWidget,\n  MaterialMultiSelectWidget,\n  MaterialAutocompleteWidget,\n\n  MaterialFieldSelect,\n  MaterialFieldAutocomplete,\n\n  MaterialButton,\n  MaterialButtonGroup,\n  MaterialConjs,\n  MaterialSwitch,\n  MaterialValueSources,\n  MaterialConfirm,\n  MaterialUseConfirm: useConfirm,\n\n  MaterialProvider,\n};\n","import React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, placeholder, customProps, maxLength} = props;\n\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\")\n      val = undefined; // don't allow empty value\n    setValue(val);\n  };\n\n  const textValue = value || \"\";\n\n  return (\n    <FormControl>\n      <TextField \n        value={textValue}\n        placeholder={!readonly ? placeholder : \"\"}\n        InputProps={{\n          readOnly: readonly,\n        }}\n        inputProps={{\n          maxLength: maxLength,\n        }}\n        disabled={readonly}\n        onChange={onChange}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, placeholder, customProps, maxLength, maxRows, fullWidth} = props;\n  const {defaultMaxRows} = config.settings;\n\n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\")\n      val = undefined; // don't allow empty value\n    setValue(val);\n  };\n  \n  const textValue = value || \"\";\n\n  return (\n    <FormControl fullWidth={fullWidth}>\n      <TextField \n        fullWidth={fullWidth}\n        maxRows={maxRows || defaultMaxRows}\n        multiline={true}\n        value={textValue}\n        placeholder={!readonly ? placeholder : \"\"}\n        InputProps={{\n          readOnly: readonly,\n        }}\n        inputProps={{\n          maxLength: maxLength,\n        }}\n        disabled={readonly}\n        onChange={onChange}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport { KeyboardDatePicker, DatePicker } from \"@material-ui/pickers\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, readonly, customProps, dateFormat, valueFormat, placeholder, useKeyboard} = props;\n\n  const formatSingleValue = (value) => {\n    return value && value.isValid() ? value.format(valueFormat) : undefined;\n  };\n\n  const handleChange = (value) => {\n    setValue(formatSingleValue(value));\n  };\n\n  const Picker = useKeyboard ? KeyboardDatePicker : DatePicker;\n\n  return (\n    <FormControl>\n      <Picker\n        readOnly={readonly}\n        disabled={readonly}\n        placeholder={!readonly ? placeholder : \"\"}\n        format={dateFormat}\n        value={value || null}\n        onChange={handleChange}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};","import React from \"react\";\nimport { DateTimePicker, KeyboardDateTimePicker } from \"@material-ui/pickers\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, use12Hours, readonly, placeholder, dateFormat, timeFormat, valueFormat, customProps, useKeyboard} = props;\n\n  const formatSingleValue = (value) => {\n    return value && value.isValid() ? value.format(valueFormat) : undefined;\n  };\n\n  const handleChange = (value) => {\n    setValue(formatSingleValue(value));\n  };\n\n  const Picker = useKeyboard ? KeyboardDateTimePicker : DateTimePicker;\n  const dateTimeFormat = dateFormat + \" \" + timeFormat;\n  \n  return (\n    <FormControl>\n      <Picker\n        readOnly={readonly}\n        disabled={readonly}\n        ampm={!!use12Hours}\n        placeholder={!readonly ? placeholder : \"\"}\n        format={dateTimeFormat}\n        value={value || null}\n        onChange={handleChange}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport { TimePicker, KeyboardTimePicker } from \"@material-ui/pickers\";\nimport moment from \"moment\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, use12Hours, readonly, placeholder, timeFormat, valueFormat, customProps, useKeyboard} = props;\n\n  const formatSingleValue = (value) => {\n    return value && value.isValid() ? value.format(valueFormat) : undefined;\n  };\n\n  const handleChange = (value) => {\n    setValue(formatSingleValue(value));\n  };\n\n  const Picker = useKeyboard ? KeyboardTimePicker : TimePicker;\n  const hasSeconds = timeFormat.indexOf(\":ss\") != -1;\n  const timeValue = value ? moment(value, timeFormat) : null;\n\n  return (\n    <FormControl>\n      <Picker\n        readOnly={readonly}\n        disabled={readonly}\n        ampm={!!use12Hours}\n        placeholder={!readonly ? placeholder : \"\"}\n        format={timeFormat}\n        value={timeValue || null}\n        onChange={handleChange}\n        views={hasSeconds ? [\"hours\", \"minutes\", \"seconds\"] : [\"hours\", \"minutes\"]}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport Select from \"@material-ui/core/Select\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport {mapListValues} from \"../../../../utils/stuff\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport omit from \"lodash/omit\";\n\nexport default ({listValues, value, setValue, allowCustomValues, readonly, placeholder, customProps}) => {\n  const renderOptions = () =>\n    mapListValues(listValues, ({title, value}) => {\n      return <MenuItem key={value} value={value}>{title}</MenuItem>;\n    });\n\n  const onChange = e => {\n    if (e.target.value === undefined)\n      return;\n    setValue(e.target.value);\n  };\n\n  const renderValue = (selectedValue) => {\n    if (!readonly && selectedValue == null)\n      return placeholder;\n    return getListValueTitle(selectedValue);\n  };\n\n  const getListValueTitle = (selectedValue) => \n    mapListValues(listValues, ({title, value}) => \n      (value === selectedValue ? title : null)\n    )\n      .filter(v => v !== null)\n      .shift();\n  \n  const hasValue = value != null;\n\n  return (\n    <FormControl>\n      <Select\n        autoWidth\n        displayEmpty\n        label={!readonly ? placeholder : \"\"}\n        onChange={onChange}\n        value={hasValue ? value : \"\"}\n        disabled={readonly}\n        readOnly={readonly}\n        renderValue={renderValue}\n        {...omit(customProps, [\"showSearch\", \"input\"])}\n      >\n        {renderOptions()}\n      </Select>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {value, setValue, config, readonly, min, max, step, placeholder, customProps} = props;\n  \n  const onChange = e => {\n    let val = e.target.value;\n    if (val === \"\" || val === null)\n      val = undefined;\n    else\n      val = Number(val);\n    setValue(val);\n  };\n\n  const numberValue = value == undefined ? \"\" : value;\n  \n  return (\n    <FormControl>\n      <TextField \n        type=\"number\"\n        value={numberValue}\n        placeholder={!readonly ? placeholder : \"\"}\n        InputProps={{\n          readOnly: readonly,\n        }}\n        inputProps={{\n          min: min,\n          max: max,\n          step: step,\n        }}\n        disabled={readonly}\n        onChange={onChange}\n        {...customProps}\n      />\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport Slider from \"@material-ui/core/Slider\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {config, placeholder, customProps, value, setValue, min, max, step, marks, readonly} = props;\n  const {defaultSliderWidth} = config.settings;\n\n  const handleSliderChange = (_e, newValue) => {\n    setValue(newValue);\n  };\n\n  const handleInputChange = (e) => {\n    let val = e.target.value;\n    if (val === \"\" || val === null)\n      val = undefined;\n    else\n      val = Number(val);\n    setValue(val);\n  };\n\n  const handleInputBlur = () => {\n    // TIP: Fix if typed value out of range in input\n    if (value < min) {\n      setValue(min);\n    } else if (value > max) {\n      setValue(max);\n    }\n  };\n\n\n  const {width, ...rest} =  customProps || {};\n  const customInputProps = rest.input || {};\n  const customSliderProps = rest.slider || rest;\n  \n  // TIP: Can't pass undefined to MUI, cause it means uncontrolled component use.\n  //      For empty value input needs \"\", slider needs null or 0\n  const inputValue = typeof value === \"number\" ? value : \"\";\n  const sliderValue = typeof value === \"number\" ? value : null;\n\n  // marks example: { 0: \"0%\", 100: React.createElement('strong', null, \"100%\") }\n  const muiMarks = marks ? Object.keys(marks).map(v => ({value: v, label: marks[v]})) : false;\n\n\n  const InputCmp = (\n    <TextField \n      type=\"number\"\n      value={inputValue}\n      placeholder={placeholder}\n      InputProps={{\n        readOnly: readonly,\n      }}\n      inputProps={{\n        min: min,\n        max: max,\n        step: step,\n      }}\n      disabled={readonly}\n      onChange={handleInputChange}\n      onBlur={handleInputBlur}\n      {...customInputProps}\n    />\n  );\n\n  const SliderCmp = (\n    <Slider \n      value={sliderValue}\n      onChange={handleSliderChange}\n      disabled={readonly}\n      min={min}\n      max={max}\n      step={step}\n      marks={muiMarks}\n      valueLabelDisplay=\"auto\"\n      {...customSliderProps}\n    />\n  );\n\n  const stylesWrapper = {\n    display: \"inline-flex\", \n    alignItems: \"center\"\n  };\n\n  const stylesInputWrapper = {\n    marginLeft: \"5px\",\n  };\n\n  const stylesSliderWrapper = {\n    marginLeft: \"5px\", \n    paddingLeft: \"12px\", \n    marginBottom: muiMarks && \"-16px\", \n    width: width || defaultSliderWidth,\n  };\n\n  return (\n    <FormControl>\n      <div style={stylesWrapper}>\n        <div style={stylesInputWrapper}>\n          {InputCmp}\n        </div>\n        <div style={stylesSliderWrapper}>\n          {SliderCmp}\n        </div>\n      </div>\n    </FormControl>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport Slider from \"@material-ui/core/Slider\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default (props) => {\n  const {config, placeholders, customProps, value, setValue, min, max, step, marks, readonly, textSeparators} = props;\n  const {defaultSliderWidth} = config.settings;\n\n  useEffect(() => {\n    const [valueFrom, valueTo] = props.value || [undefined, undefined];\n    if (props.value && (valueFrom == undefined || valueTo == undefined)) {\n      // happens if we changed op from '==' to 'between'\n      // (I know, timeout is dirty hack..)\n      setTimeout(() => {\n        const oneValue = valueFrom || valueTo;\n        const value = [oneValue, oneValue];\n        setValue(value);\n      }, 1);\n    }\n  }, []);\n\n  const handleSliderChange = (_e, newValues) => {\n    setValue(newValues);\n  };\n\n  const handleInputChangeFrom = (e) => {\n    // TIP: need to use props.value instead of value\n    let valueFrom = e.target.value;\n    if (valueFrom === \"\" || valueFrom == null)\n      valueFrom = undefined;\n    else\n      valueFrom = Number(valueFrom);\n    let value = props.value ? [...props.value] : [undefined, undefined];\n    value[0] = valueFrom;\n    setValue(value);\n  };\n\n  const handleInputChangeTo = (e) => {\n    let valueTo = e.target.value;\n    if (valueTo === \"\" || valueTo == null)\n      valueTo = undefined;\n    else\n      valueTo = Number(valueTo);\n    let value = props.value ? [...props.value] : [undefined, undefined];\n    value[1] = valueTo;\n    setValue(value);\n  };\n\n  const handleInputBlur = () => {\n    // TIP: Fix if typed value out of range in inputs\n    if (!value) return;\n    if (value[0] < min) {\n      setValue([min, value[1]]);\n    } else if (value[1] > max) {\n      setValue([value[0], max]);\n    }\n  };\n\n  const {width, ...rest} =  customProps || {};\n  const customInputProps = rest.input || {};\n  const customSliderProps = rest.slider || rest;\n\n  // marks example: { 0: \"0%\", 100: React.createElement('strong', null, \"100%\") }\n  const muiMarks = marks ? Object.keys(marks).map(v => ({value: v, label: marks[v]})) : false;\n\n  // TIP: Can't pass undefined to MUI, cause it means uncontrolled component use.\n  //      For empty value input needs \"\", slider needs null or 0, but null will cause problems with range mode\n  let sliderValue = value ? [...value] : [undefined, undefined];\n  let [valueFrom, valueTo] = sliderValue;\n  if (valueFrom == undefined) {\n    valueFrom = \"\";\n    sliderValue[0] = 0;\n  }\n  if (valueTo == undefined) {\n    valueTo = \"\";\n    sliderValue[1] = 0;\n  }\n  \n\n  const FromInputCmp = (\n    <TextField \n      type=\"number\"\n      value={valueFrom}\n      placeholder={placeholders[0]}\n      InputProps={{\n        readOnly: readonly,\n      }}\n      inputProps={{\n        min: min,\n        max: max,\n        step: step,\n      }}\n      disabled={readonly}\n      onChange={handleInputChangeFrom}\n      onBlur={handleInputBlur}\n      {...customInputProps}\n    />\n  );\n\n  const ToInputCmp = (\n    <TextField \n      type=\"number\"\n      value={valueTo}\n      placeholder={placeholders[1]}\n      InputProps={{\n        readOnly: readonly,\n      }}\n      inputProps={{\n        min: min,\n        max: max,\n        step: step,\n      }}\n      disabled={readonly}\n      onChange={handleInputChangeTo}\n      onBlur={handleInputBlur}\n      {...customInputProps}\n    />\n  );\n\n  const SliderCmp = (\n    <Slider \n      value={sliderValue}\n      onChange={handleSliderChange}\n      disabled={readonly}\n      min={min}\n      max={max}\n      step={step}\n      marks={muiMarks}\n      valueLabelDisplay=\"auto\"\n      {...customSliderProps}\n    />\n  );\n\n  const stylesWrapper = {\n    display: \"inline-flex\", \n  };\n\n  const stylesInputWrapper = {\n    marginLeft: \"5px\",\n  };\n\n  const stylesSliderWrapper = {\n    marginLeft: \"5px\", \n    paddingLeft: \"12px\", \n    marginBottom: muiMarks && \"-16px\", \n    width: width || defaultSliderWidth,\n  };\n\n  return (\n    <FormControl>\n      <div style={stylesWrapper}>\n        <div style={stylesInputWrapper}>\n          {FromInputCmp}\n        </div>\n        <div className={\"widget--sep\"}>\n          <span>{ textSeparators[1] }</span>\n        </div>\n        <div style={stylesInputWrapper}>\n          {ToInputCmp}\n        </div>\n        <div style={stylesSliderWrapper}>\n          {SliderCmp}\n        </div>\n      </div>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport Switch from \"@material-ui/core/Switch\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\n\nexport default (props) => {\n  const { customProps, value, setValue, labelYes, labelNo, readonly } = props;\n\n  const onChange = () => {\n    setValue(!value);\n  };\n  \n  return (\n    <FormControl>\n      <Typography component=\"div\">\n        <Grid component=\"label\" container alignItems=\"center\" spacing={0}>\n          <Grid item component=\"span\">{labelNo}</Grid>\n          <Grid item component=\"span\">\n            <Switch\n              checked={!!value}\n              onChange={onChange}\n              disabled={readonly}\n              {...customProps}\n            />\n          </Grid>\n          <Grid item component=\"span\">{labelYes}</Grid>\n        </Grid>\n      </Typography>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport {mapListValues} from \"../../../../utils/stuff\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport omit from \"lodash/omit\";\n\nexport default ({listValues, value, setValue, allowCustomValues, readonly, placeholder, customProps}) => {\n  const renderOptions = (selectedValues) => \n    mapListValues(listValues, ({title, value}) => {\n      return (\n        <MenuItem key={value} value={value}>\n          <Checkbox checked={selectedValues.indexOf(value) > -1} />\n          <ListItemText primary={title} />\n        </MenuItem>\n      );\n    });\n\n  const renderValue = (selectedValues) => {\n    if (!readonly && !selectedValues.length)\n      return placeholder;\n    const selectedTitles = mapListValues(listValues, ({title, value}) => (\n      selectedValues.indexOf(value) > -1 ? title : null\n    )).filter(v => v !== null);\n    return selectedTitles.join(\", \");\n  };\n\n  const hasValue = value != null && value.length > 0;\n\n  const onChange = e => {\n    if (e.target.value === undefined)\n      return;\n    setValue(e.target.value);\n  };\n\n  return (\n    <FormControl>\n      <Select multiple\n        autoWidth\n        displayEmpty\n        label={!readonly ? placeholder : \"\"}\n        onChange={onChange}\n        value={hasValue ? value : []}\n        disabled={readonly}\n        readOnly={readonly}\n        renderValue={renderValue}\n        {...omit(customProps, [\"showSearch\", \"input\", \"showCheckboxes\"])}\n      >\n        {renderOptions(hasValue ? value : [])}\n      </Select>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport Select from \"@material-ui/core/Select\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nexport default ({items, setField, selectedKey, readonly, placeholder}) => {\n  const renderOptions = (fields, level = 0) => (\n    fields.map(field => {\n      const {items, path, label, disabled} = field;\n      const prefix = \"\\u00A0\\u00A0\".repeat(level);\n      if (items) {\n        return [\n          <ListSubheader disabled={disabled} key={path} disableSticky={true}>\n            {prefix && <span>{prefix}</span>}\n            {label}\n          </ListSubheader>,\n          renderOptions(items, level+1),\n        ];\n      } else {\n        return <MenuItem disabled={disabled} key={path} value={path}>\n          {prefix && <span>{prefix}</span>}\n          {label}\n        </MenuItem>;\n      }\n    })\n  );\n\n  const onChange = e => {\n    if (e.target.value === undefined)\n      return;\n    setField(e.target.value);\n  };\n\n  const renderValue = (selectedValue) => {\n    if (!readonly && !selectedValue)\n      return placeholder;\n    const findLabel = (fields) => {\n      return fields.map(field => {\n        if(!field.items) return field.path === selectedValue ? field.label : null;\n        return findLabel(field.items);\n      });\n    };\n    return findLabel(items).filter((v) => {\n      if (Array.isArray(v)) {\n        return v.some((value) => value !== null);\n      } else {\n        return v !== null;\n      }\n    }).pop();\n  };\n  \n  const hasValue = selectedKey != null;\n  return (\n    <FormControl>\n      <Select\n        autoWidth\n        displayEmpty\n        label={placeholder}\n        onChange={onChange}\n        value={hasValue ? selectedKey : \"\"}\n        disabled={readonly}\n        renderValue={renderValue}\n      >\n        {renderOptions(items)}\n      </Select>\n    </FormControl>\n  );\n};\n","import React from \"react\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Button from \"@material-ui/core/Button\";\nimport IconButton from \"@material-ui/core/IconButton\";\n\nexport default ({type, label, onClick, readonly, config}) => {\n  const typeToOnlyIcon = {\n    \"delGroup\": <DeleteIcon />,\n    \"delRuleGroup\": <DeleteIcon />,\n    \"delRule\": <DeleteIcon />,\n    \"addRuleGroup\": <AddIcon />,\n  };\n  const typeToIcon = {\n    \"addRule\": <AddIcon />,\n    \"addGroup\": <AddIcon />,\n    \"addRuleGroupExt\": <AddIcon />,\n  };\n  const typeToColor = {\n    \"addRule\": \"default\",\n    \"addGroup\": \"primary\",\n    \"delGroup\": \"secondary\",\n    \"delRuleGroup\": \"secondary\",\n    \"delRule\": \"secondary\",\n  };\n  if (typeToOnlyIcon[type])\n    return <IconButton size=\"small\" disabled={readonly} onClick={onClick} color={typeToColor[type]}>{typeToOnlyIcon[type]}</IconButton>;\n  else\n    return <Button size=\"small\" disabled={readonly} onClick={onClick} color={typeToColor[type]} startIcon={typeToIcon[type]}>{label}</Button>;\n};\n","import React from \"react\";\n\nexport default ({children, config}) => {\n  return <>{children}</>;\n};\n","import React from \"react\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\nimport Button from \"@material-ui/core/Button\";\n\nexport default ({id, not, setNot, conjunctionOptions, setConjunction, disabled, readonly, config, showNot, notLabel}) => {\n  //TIP: disabled=true if only 1 rule; readonly=true if immutable mode\n  const conjsCount = Object.keys(conjunctionOptions).length;\n  const lessThenTwo = disabled;\n  const {forceShowConj} = config.settings;\n  const showConj = forceShowConj || conjsCount > 1 && !lessThenTwo;\n\n  const renderOptions = () => \n    Object.keys(conjunctionOptions).map(key => {\n      const {id, name, label, checked} = conjunctionOptions[key];\n      const postfix = setConjunction.isDummyFn ? \"__dummy\" : \"\";\n      if ((readonly || disabled) && !checked)\n        return null;\n      return (\n        <Button \n          key={id+postfix} \n          id={id+postfix} \n          color={checked ? \"primary\" : \"default\"} \n          value={key} \n          onClick={onClick.bind(null, key)} \n          disabled={readonly || disabled}\n        >\n          {label}\n        </Button>\n      );\n    });\n  \n  const renderNot = () => {\n    if (readonly && !not)\n      return null;\n    return (\n      <Button \n        key={id}\n        id={id + \"__not\"}\n        color={not ? \"secondary\" : \"default\"} \n        onClick={onNotClick.bind(null, !not)} \n        disabled={readonly}\n      >\n        {notLabel || \"NOT\"}\n      </Button>\n    );\n  };\n\n  const onClick = value => setConjunction(value);\n  const onNotClick = checked => setNot(checked);\n\n  return (\n    <FormControl>\n      <ButtonGroup \n        disableElevation \n        variant=\"contained\" \n        size=\"small\" \n        disabled={readonly}\n      >\n        {showNot && renderNot()}\n        {showConj && renderOptions()}\n      </ButtonGroup>\n    </FormControl>\n  );\n  \n};\n","import React from \"react\";\nimport Switch from \"@material-ui/core/Switch\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Button from \"@material-ui/core/Button\";\nimport LockOpenIcon from \"@material-ui/icons/LockOpen\";\nimport LockIcon from \"@material-ui/icons/Lock\";\n\nexport default ({value, setValue, label, checkedLabel, hideLabel, id, config, type}) => {\n  const {renderSize} = config.settings;\n  const onChange = e => setValue(e.target.checked);\n  const onClick = () => setValue(!value);\n  const postfix = type;\n  const showLabel = value ? (checkedLabel || label) : label;\n  const icon = value ? <LockIcon /> : <LockOpenIcon />;\n\n  if (type == \"lock\") {\n    if (hideLabel) {\n      return <IconButton\n        key={id+postfix}\n        onClick={onClick}\n        size={\"small\"}\n      >{icon}</IconButton>;\n    } else {\n      return <Button\n        key={id+postfix}\n        onClick={onClick}\n        size={\"small\"}\n        startIcon={icon}\n      >{showLabel}</Button>;\n    }\n  }\n\n  return <FormControlLabel \n    control={<Switch\n      checked={!!value}\n      size={\"small\"}\n      onChange={onChange}\n    />} \n    label={showLabel} \n  />;\n};\n","export default ({onOk, okText, cancelText, title, confirmFn}) => {\n  confirmFn({ \n    description: title || \"Are you sure?\",\n    title: null,\n    confirmationText: okText || \"Ok\",\n    cancellationText: cancelText || \"Cancel\",\n  })\n    .then(onOk)\n    .catch(() => {});\n};\n","import MaterialWidgets from \"../../components/widgets/material\";\nimport BasicConfig, {stringifyForDisplay} from \"../basic\";\nimport React from \"react\";\nimport {SqlString, spelEscape} from \"../../utils/export\";\n\n\nconst {\n  MaterialBooleanWidget,\n  MaterialTextWidget,\n  MaterialTextAreaWidget,\n  MaterialDateWidget,\n  MaterialTimeWidget,\n  MaterialDateTimeWidget,\n  MaterialMultiSelectWidget,\n  MaterialSelectWidget,\n  MaterialNumberWidget,\n  MaterialSliderWidget,\n  MaterialRangeWidget,\n  MaterialAutocompleteWidget,\n\n  MaterialFieldSelect,\n  MaterialFieldAutocomplete,\n  MaterialConjs,\n  MaterialSwitch,\n  MaterialButton,\n  MaterialButtonGroup,\n  MaterialValueSources,\n\n  MaterialProvider,\n  MaterialConfirm,\n  MaterialUseConfirm,\n} = MaterialWidgets;\n\n\nconst settings = {\n  ...BasicConfig.settings,\n\n  renderField: (props) => props?.customProps?.showSearch \n    ? <MaterialFieldAutocomplete {...props} /> \n    : <MaterialFieldSelect {...props} />,\n  renderOperator: (props) => <MaterialFieldSelect {...props} />,\n  renderFunc: (props) => <MaterialFieldSelect {...props} />,\n  renderConjs: (props) => <MaterialConjs {...props} />,\n  renderSwitch: (props) => <MaterialSwitch {...props} />,\n  renderButton: (props) => <MaterialButton {...props} />,\n  renderButtonGroup: (props) => <MaterialButtonGroup {...props} />,\n  renderValueSources: (props) => <MaterialValueSources {...props} />,\n  renderProvider: (props) => <MaterialProvider {...props} />,\n  renderConfirm: MaterialConfirm,\n  useConfirm: MaterialUseConfirm,\n};\n\n\nconst widgets = {\n  ...BasicConfig.widgets,\n  text: {\n    ...BasicConfig.widgets.text,\n    factory: (props) => <MaterialTextWidget {...props} />,\n  },\n  textarea: {\n    ...BasicConfig.widgets.textarea,\n    factory: (props) => <MaterialTextAreaWidget {...props} />,\n  },\n  number: {\n    ...BasicConfig.widgets.number,\n    factory: (props) => <MaterialNumberWidget {...props} />,\n  },\n  multiselect: {\n    ...BasicConfig.widgets.multiselect,\n    factory: (props) => {\n      return (props.asyncFetch || props.showSearch) \n        ? <MaterialAutocompleteWidget multiple {...props} /> \n        : <MaterialMultiSelectWidget {...props} />;\n    },\n  },\n  select: {\n    ...BasicConfig.widgets.select,\n    factory: (props) => {\n      return (props.asyncFetch || props.showSearch) \n        ? <MaterialAutocompleteWidget {...props} /> \n        : <MaterialSelectWidget {...props} />;\n    },\n  },\n  slider: {\n    ...BasicConfig.widgets.slider,\n    factory: (props) => <MaterialSliderWidget {...props} />,\n  },\n  boolean: {\n    ...BasicConfig.widgets.boolean,\n    factory: (props) => <MaterialBooleanWidget {...props} />,\n  },\n  date: {\n    ...BasicConfig.widgets.date,\n    factory: (props) => <MaterialDateWidget {...props} />,\n  },\n  time: {\n    ...BasicConfig.widgets.time,\n    factory: (props) => <MaterialTimeWidget {...props} />,\n  },\n  datetime: {\n    ...BasicConfig.widgets.datetime,\n    factory: (props) => <MaterialDateTimeWidget {...props} />,\n  },\n\n  rangeslider: {\n    type: \"number\",\n    jsType: \"number\",\n    valueSrc: \"value\",\n    factory: (props) => <MaterialRangeWidget {...props} />,\n    valueLabel: \"Range\",\n    valuePlaceholder: \"Select range\",\n    valueLabels: [\n      { label: \"Number from\", placeholder: \"Enter number from\" },\n      { label: \"Number to\", placeholder: \"Enter number to\" },\n    ],\n    formatValue: (val, fieldDef, wgtDef, isForDisplay) => {\n      return isForDisplay ? stringifyForDisplay(val) : JSON.stringify(val);\n    },\n    sqlFormatValue: (val, fieldDef, wgtDef, op, opDef) => {\n      return SqlString.escape(val);\n    },\n    spelFormatValue: (val) => spelEscape(val),\n    singleWidget: \"slider\",\n    toJS: (val, fieldSettings) => (val),\n  },\n};\n\n\nconst types = {\n  ...BasicConfig.types,\n  number: {\n    ...BasicConfig.types.number,\n    widgets: {\n      ...BasicConfig.types.number.widgets,\n      rangeslider: {\n        opProps: {\n          between: {\n            isSpecialRange: true,\n          },\n          not_between: {\n            isSpecialRange: true,\n          }\n        },\n        operators: [\n          \"between\",\n          \"not_between\",\n          \"is_null\",\n          \"is_not_null\",\n        ],\n      }\n    },\n  },\n};\n\nexport default {\n  ...BasicConfig,\n  types,\n  widgets,\n  settings,\n};","import React from \"react\";\nimport debounce from \"lodash/debounce\";\nimport { mapListValues, listValuesToArray } from \"../utils/stuff\";\nimport { mergeListValues, listValueToOption, getListValue } from \"../utils/autocomplete\";\n\n\nconst useListValuesAutocomplete = ({\n  asyncFetch, useLoadMore, useAsyncSearch, forceAsyncSearch,\n  asyncListValues: selectedAsyncListValues,\n  listValues: staticListValues, allowCustomValues,\n  value: selectedValue, setValue, placeholder\n}, {\n  debounceTimeout,\n  multiple\n}) => {\n  const knownSpecialValues = [\"LOAD_MORE\", \"LOADING_MORE\"];\n  const loadMoreTitle = \"Load more...\";\n  const loadingMoreTitle = \"Loading more...\";\n  const aPlaceholder = forceAsyncSearch ? \"Type to search\" : placeholder;\n\n  // state\n  const [open, setOpen] = React.useState(false);\n  const [asyncFetchMeta, setAsyncFetchMeta] = React.useState(undefined);\n  const [loadingCnt, setLoadingCnt] = React.useState(0);\n  const [isLoadingMore, setIsLoadingMore] = React.useState(false);\n  const [inputValue, setInputValue] = React.useState(\"\");\n  const [asyncListValues, setAsyncListValues] = React.useState(undefined);\n\n  // ref\n  const asyncFectchCnt = React.useRef(0);\n  const componentIsMounted = React.useRef(true);\n  const isSelectedLoadMore = React.useRef(false);\n\n  // compute\n  const nSelectedAsyncListValues = listValuesToArray(selectedAsyncListValues);\n  const listValues = asyncFetch\n    ? (!allowCustomValues ? mergeListValues(asyncListValues, nSelectedAsyncListValues, true) : asyncListValues)\n    : staticListValues;\n  //const isDirtyInitialListValues = asyncListValues == undefined && selectedAsyncListValues && selectedAsyncListValues.length && typeof selectedAsyncListValues[0] != \"object\";\n  const isLoading = loadingCnt > 0;\n  const canInitialLoad = open && asyncFetch\n    && asyncListValues === undefined\n    && (forceAsyncSearch ? inputValue : true);\n  const isInitialLoading = canInitialLoad && isLoading;\n  const canLoadMore = !isInitialLoading && listValues && listValues.length > 0\n    && asyncFetchMeta && asyncFetchMeta.hasMore && (asyncFetchMeta.filter || \"\") === inputValue;\n  const canShowLoadMore = !isLoading && canLoadMore;\n  const options = mapListValues(listValues, listValueToOption);\n  const hasValue = selectedValue != null;\n  // const selectedListValue = hasValue ? getListValue(selectedValue, listValues) : null;\n  // const selectedOption = listValueToOption(selectedListValue);\n\n  // fetch\n  const fetchListValues = async (filter = null, isLoadMore = false) => {\n    // clear obsolete meta\n    if (!isLoadMore && asyncFetchMeta) {\n      setAsyncFetchMeta(undefined);\n    }\n\n    const offset = isLoadMore && asyncListValues ? asyncListValues.length : 0;\n    const meta = isLoadMore && asyncFetchMeta || !useLoadMore && { pageSize: 0 };\n\n    const newAsyncFetchCnt = ++asyncFectchCnt.current;\n    const res = await asyncFetch(filter, offset, meta);\n    const isFetchCancelled = asyncFectchCnt.current != newAsyncFetchCnt;\n    if (isFetchCancelled || !componentIsMounted.current) {\n      return null;\n    }\n\n    const { values, hasMore, meta: newMeta } = res && res.values ? res : { values: res };\n    const nValues = listValuesToArray(values);\n    let assumeHasMore;\n    let newValues;\n    if (isLoadMore) {\n      newValues = mergeListValues(asyncListValues, nValues, false);\n      assumeHasMore = newValues.length > asyncListValues.length;\n    } else {\n      newValues = nValues;\n      if (useLoadMore) {\n        assumeHasMore = newValues.length > 0;\n      }\n    }\n\n    // save new meta\n    const realNewMeta = hasMore != null || newMeta != null || assumeHasMore != null ? {\n      ...(assumeHasMore != null ? { hasMore: assumeHasMore } : {}),\n      ...(hasMore != null ? { hasMore } : {}),\n      ...(newMeta != null ? newMeta : {}),\n      filter\n    } : undefined;\n    if (realNewMeta) {\n      setAsyncFetchMeta(realNewMeta);\n    }\n\n    return newValues;\n  };\n\n  const loadListValues = async (filter = null, isLoadMore = false) => {\n    setLoadingCnt(x => (x + 1));\n    setIsLoadingMore(isLoadMore);\n    const list = await fetchListValues(filter, isLoadMore);\n    if (!componentIsMounted.current) {\n      return;\n    }\n    if (list != null) {\n      // tip: null can be used for reject (eg, if user don't want to filter by input)\n      setAsyncListValues(list);\n    }\n    setLoadingCnt(x => (x - 1));\n    setIsLoadingMore(false);\n  };\n  const loadListValuesDebounced = React.useCallback(debounce(loadListValues, debounceTimeout), []);\n\n  // Unmount\n  React.useEffect(() => {\n    return () => {\n      componentIsMounted.current = false;\n    };\n  }, []);\n\n  // Initial loading\n  React.useEffect(() => {\n    if (canInitialLoad && loadingCnt == 0 && asyncFectchCnt.current == 0) {\n      (async () => {\n        await loadListValues();\n      })();\n    }\n  }, [canInitialLoad]);\n\n  // Event handlers\n  const onOpen = () => {\n    setOpen(true);\n  };\n\n  const onClose = (_e) => {\n    if (isSelectedLoadMore.current) {\n      isSelectedLoadMore.current = false;\n      if (multiple) {\n        setOpen(false);\n      }\n    } else {\n      setOpen(false);\n    }\n  };\n\n  const onDropdownVisibleChange = (open) => {\n    if (open) {\n      onOpen();\n    } else {\n      onClose();\n    }\n  };\n\n  const isSpecialValue = (option) => {\n    const specialValue = option?.specialValue || option?.value;\n    return knownSpecialValues.includes(specialValue);\n  };\n\n  const onChange = async (_e, option) => {\n    let specialValue = option?.specialValue || option?.value \n      || multiple && option.map(opt => opt?.specialValue || opt?.value).find(v => !!v);\n    if (specialValue == \"LOAD_MORE\") {\n      isSelectedLoadMore.current = true;\n      await loadListValues(inputValue, true);\n    } else if (specialValue == \"LOADING_MORE\") {\n      isSelectedLoadMore.current = true;\n    } else {\n      if (multiple) {\n        const options = option;\n        let newSelectedListValues = options.map((o, i) => {\n          const item = o.value != null ? o : getListValue(o, listValues);\n          // AntDesign puts array of labels in `_e` (`option` is array of objects, but custom option is always `{}`)\n          // MUI puts array of labels in `option`\n          const customItem = allowCustomValues && !item ? (Array.isArray(_e) ? _e[i] : o) : null;\n          return item || customItem;\n        });\n        let newSelectedValues = newSelectedListValues\n          .filter(o => o !== undefined)\n          .map(o => (o.value !== undefined ? o.value : o));\n        if (!newSelectedValues.length)\n          newSelectedValues = undefined; //not allow []\n        setValue(newSelectedValues, newSelectedListValues);\n      } else {\n        const v = option == null ? undefined : option.value;\n        setValue(v, [option]);\n      }\n    }\n  };\n\n  const onInputChange = async (_e, newInputValue) => {\n    const val = newInputValue;\n    //const isTypeToSearch = e.type == 'change';\n\n    if (val === loadMoreTitle || val === loadingMoreTitle) {\n      return;\n    }\n\n    setInputValue(val);\n\n    if (allowCustomValues) {\n      if (multiple) {\n        //todo\n      } else {\n        setValue(val, [val]);\n      }\n    }\n\n    const canSearchAsync = useAsyncSearch && (forceAsyncSearch ? !!val : true);\n    if (canSearchAsync) {\n      await loadListValuesDebounced(val);\n    } else if (useAsyncSearch && forceAsyncSearch) {\n      setAsyncListValues([]);\n    }\n  };\n\n  // to keep compatibility with antD\n  const onSearch = async (newInputValue) => {\n    if (newInputValue === \"\" && !open) {\n      return;\n    }\n\n    await onInputChange(null, newInputValue);\n  };\n\n  // Options\n  const extendOptions = (options) => {\n    const filtered = [...options];\n    if (useLoadMore) {\n      if (canShowLoadMore) {\n        filtered.push({\n          specialValue: \"LOAD_MORE\",\n          title: loadMoreTitle,\n        });\n      } else if (isLoadingMore) {\n        filtered.push({\n          specialValue: \"LOADING_MORE\",\n          title: loadingMoreTitle,\n          disabled: true\n        });\n      }\n    }\n    return filtered;\n  };\n\n  const getOptionSelected = (option, valueOrOption) => {\n    if (valueOrOption == null)\n      return null;\n    const selectedValue = valueOrOption.value != undefined ? valueOrOption.value : valueOrOption;\n    return option.value === selectedValue;\n  };\n\n  const getOptionDisabled = (valueOrOption) => {\n    return valueOrOption && valueOrOption.disabled;\n  };\n\n  const getOptionLabel = (valueOrOption) => {\n    if (valueOrOption == null)\n      return null;\n    const option = valueOrOption.value != undefined ? valueOrOption\n      : listValueToOption(getListValue(valueOrOption, listValues));\n    if (!option && valueOrOption.specialValue) {\n      // special last 'Load more...' item\n      return valueOrOption.title;\n    }\n    if (!option && allowCustomValues) {\n      // there is just string value, it's not item from list\n      return valueOrOption;\n    }\n    if (!option) {\n      // weird\n      return valueOrOption;\n    }\n    return option.title;\n  };\n\n  return {\n    options,\n    listValues,\n    hasValue,\n\n    open,\n    onOpen,\n    onClose,\n    onDropdownVisibleChange,\n    onChange,\n    \n    inputValue,\n    onInputChange,\n    onSearch,\n    canShowLoadMore,\n    isInitialLoading,\n    isLoading,\n    isLoadingMore,\n    isSpecialValue,\n\n    extendOptions,\n    getOptionSelected,\n    getOptionDisabled,\n    getOptionLabel,\n\n    // unused\n    //selectedListValue,\n    //selectedOption,\n    aPlaceholder,\n  };\n};\n\nexport default useListValuesAutocomplete;\n","export const ADD_GROUP = \"ADD_GROUP\";\nexport const ADD_CASE_GROUP = \"ADD_CASE_GROUP\";\nexport const REMOVE_GROUP = \"REMOVE_GROUP\";\nexport const SET_CONJUNCTION = \"SET_CONJUNCTION\";\nexport const SET_NOT = \"SET_NOT\";\nexport const ADD_RULE = \"ADD_RULE\";\nexport const REMOVE_RULE = \"REMOVE_RULE\";\nexport const SET_FIELD = \"SET_FIELD\";\nexport const SET_OPERATOR = \"SET_OPERATOR\";\nexport const SET_VALUE = \"SET_VALUE\";\nexport const SET_VALUE_SRC = \"SET_VALUE_SRC\";\nexport const SET_OPERATOR_OPTION = \"SET_OPERATOR_OPTION\";\nexport const SET_LOCK = \"SET_LOCK\";\n\nexport const SET_TREE = \"SET_TREE\";\n\nexport const MOVE_ITEM = \"MOVE_ITEM\";\n\nexport const PLACEMENT_AFTER = \"after\";\nexport const PLACEMENT_BEFORE = \"before\";\nexport const PLACEMENT_APPEND = \"append\";\nexport const PLACEMENT_PREPEND = \"prepend\";\n\nexport const SET_DRAG_PROGRESS = \"SET_DRAG_PROGRESS\";\nexport const SET_DRAG_START = \"SET_DRAG_START\";\nexport const SET_DRAG_END = \"SET_DRAG_END\";\n","\nimport Immutable from \"immutable\";\nimport {\n  expandTreePath, expandTreeSubpath, getItemByPath, fixPathsInTree, \n  getTotalRulesCountInTree, fixEmptyGroupsInTree, isEmptyTree, hasChildren, removeIsLockedInTree\n} from \"../utils/treeUtils\";\nimport {\n  defaultRuleProperties, defaultGroupProperties, defaultOperator, \n  defaultOperatorOptions, defaultRoot, defaultItemProperties\n} from \"../utils/defaultUtils\";\nimport * as constants from \"../constants\";\nimport uuid from \"../utils/uuid\";\nimport {\n  getFuncConfig, getFieldConfig, getFieldWidgetConfig, getOperatorConfig\n} from \"../utils/configUtils\";\nimport {\n  getOperatorsForField, getFirstOperator, getWidgetForFieldOp,\n  getNewValueForFieldOp\n} from \"../utils/ruleUtils\";\nimport {deepEqual, defaultValue, applyToJS} from \"../utils/stuff\";\nimport {validateValue} from \"../utils/validation\";\nimport omit from \"lodash/omit\";\nimport mapValues from \"lodash/mapValues\";\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nconst addNewGroup = (state, path, type, groupUuid, properties, config, children = null, meta = {}) => {\n  const {shouldCreateEmptyGroup} = config.settings;\n  const groupPath = path.push(groupUuid);\n  const canAddNewRule = !shouldCreateEmptyGroup;\n  const isDefaultCase = !!meta?.isDefaultCase;\n\n  const origState = state;\n  state = addItem(state, path, type, groupUuid, defaultGroupProperties(config).merge(properties || {}), config, children);\n  if (state !== origState) {\n    if (!children && !isDefaultCase) {\n      state = state.setIn(expandTreePath(groupPath, \"children1\"), new Immutable.OrderedMap());\n\n      // Add one empty rule into new group\n      if (canAddNewRule) {\n        state = addItem(state, groupPath, \"rule\", uuid(), defaultRuleProperties(config), config);\n      }\n    }\n\n    state = fixPathsInTree(state);\n  }\n  \n  return state;\n};\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nconst removeGroup = (state, path, config) => {\n  state = removeItem(state, path);\n\n  const {canLeaveEmptyGroup} = config.settings;\n  const parentPath = path.slice(0, -1);\n  const isEmptyParentGroup = !hasChildren(state, parentPath);\n  if (isEmptyParentGroup && !canLeaveEmptyGroup) {\n    // check ancestors for emptiness (and delete 'em if empty)\n    state = fixEmptyGroupsInTree(state);\n    \n    if (isEmptyTree(state) && !canLeaveEmptyGroup) {\n      // if whole query is empty, add one empty rule to root\n      state = addItem(state, new Immutable.List(), \"rule\", uuid(), defaultRuleProperties(config), config);\n    }\n  }\n  state = fixPathsInTree(state);\n  return state;\n};\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n */\nconst removeRule = (state, path, config) => {\n  state = removeItem(state, path);\n\n  const {canLeaveEmptyGroup} = config.settings;\n  const parentPath = path.pop();\n  const parent = state.getIn(expandTreePath(parentPath));\n\n  const parentField = parent.getIn([\"properties\", \"field\"]);\n  const parentOperator = parent.getIn([\"properties\", \"operator\"]);\n  const parentValue = parent.getIn([\"properties\", \"value\", 0]);\n  const parentFieldConfig = parentField ? getFieldConfig(config, parentField) : null;\n  const parentOperatorConfig = parentOperator ? getOperatorConfig(config, parentOperator, parentField) : null;\n  const hasGroupCountRule = parentField && parentOperator && parentOperatorConfig.cardinality != 0; // && parentValue != undefined;\n  \n  const isParentRuleGroup = parent.get(\"type\") == \"rule_group\";\n  const isEmptyParentGroup = !hasChildren(state, parentPath);\n  const canLeaveEmpty = isParentRuleGroup \n    ? hasGroupCountRule && parentFieldConfig.initialEmptyWhere\n    : canLeaveEmptyGroup;\n  \n  if (isEmptyParentGroup && !canLeaveEmpty) {\n    if (isParentRuleGroup) {\n      // deleted last rule from rule_group, so delete whole rule_group\n      state = state.deleteIn(expandTreePath(parentPath));\n    }\n\n    // check ancestors for emptiness (and delete 'em if empty)\n    state = fixEmptyGroupsInTree(state);\n\n    if (isEmptyTree(state) && !canLeaveEmptyGroup) {\n      // if whole query is empty, add one empty rule to root\n      state = addItem(state, new Immutable.List(), \"rule\", uuid(), defaultRuleProperties(config), config);\n    }\n  }\n  state = fixPathsInTree(state);\n  return state;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {bool} not\n */\nconst setNot = (state, path, not) =>\n  state.setIn(expandTreePath(path, \"properties\", \"not\"), not);\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {bool} lock\n */\nconst setLock = (state, path, lock) =>\n  removeIsLockedInTree(state.setIn(expandTreePath(path, \"properties\", \"isLocked\"), lock));\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {string} conjunction\n */\nconst setConjunction = (state, path, conjunction) =>\n  state.setIn(expandTreePath(path, \"properties\", \"conjunction\"), conjunction);\n\n// convert children deeply from JS to Immutable\nconst _addChildren1 = (config, item, children) => {\n  if (children && Array.isArray(children)) {\n    item.children1 = new Immutable.OrderedMap(\n      children.reduce((map, it) => {\n        const id1 = uuid();\n        const it1 = {\n          ...it,\n          properties: defaultItemProperties(config, it).merge(it.properties || {}),\n          id: id1\n        };\n        _addChildren1(config, it1, it1.children1);\n        //todo: guarantee order\n        return {\n          ...map,\n          [id1]: new Immutable.Map(it1)\n        };\n      }, {})\n    );\n  }\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {string} type\n * @param {string} id\n * @param {Immutable.OrderedMap} properties\n * @param {object} config\n */\nconst addItem = (state, path, type, id, properties, config, children = null) => {\n  if (type == \"switch_group\")\n    throw new Error(\"Can't add switch_group programmatically\");\n  const { maxNumberOfCases, maxNumberOfRules, maxNesting } = config.settings;\n  const rootType = state.get(\"type\");\n  const isTernary = rootType == \"switch_group\";\n  const targetItem = state.getIn(expandTreePath(path));\n  const caseGroup = isTernary ? state.getIn(expandTreePath(path.take(2))) : null;\n  const childrenPath = expandTreePath(path, \"children1\");\n  const targetChildren = state.getIn(childrenPath);\n  const hasChildren = !!targetChildren && targetChildren.size;\n  const targetChildrenSize = hasChildren ? targetChildren.size : null;\n  let currentNumber, maxNumber;\n  if (type == \"case_group\") {\n    currentNumber = targetChildrenSize;\n    maxNumber = maxNumberOfCases;\n  } else if (type == \"group\") {\n    currentNumber = path.size;\n    maxNumber = maxNesting;\n  } else if (targetItem?.get(\"type\") == \"rule_group\") {\n    // don't restrict\n  } else {\n    currentNumber = isTernary ? getTotalRulesCountInTree(caseGroup) : getTotalRulesCountInTree(state);\n    maxNumber = maxNumberOfRules;\n  }\n  const canAdd = maxNumber && currentNumber ? (currentNumber < maxNumber) : true;\n  \n  const item = {type, id, properties};\n  _addChildren1(config, item, children);\n\n  const isLastDefaultCase = type == \"case_group\" && hasChildren && targetChildren.last().get(\"children1\") == null;\n\n  if (canAdd) {\n    const newChildren = new Immutable.OrderedMap({\n      [id]: new Immutable.Map(item)\n    });\n    if (!hasChildren) {\n      state = state.setIn(childrenPath, newChildren);\n    } else if (isLastDefaultCase) {\n      const last = targetChildren.last();\n      const newChildrenWithLast = new Immutable.OrderedMap({\n        [id]: new Immutable.Map(item),\n        [last.get(\"id\")]: last\n      });\n      state = state.deleteIn(expandTreePath(childrenPath, \"children1\", last.get(\"id\")));\n      state = state.mergeIn(childrenPath, newChildrenWithLast);\n    } else {\n      state = state.mergeIn(childrenPath, newChildren);\n    }\n    state = fixPathsInTree(state);\n  }\n  return state;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n */\nconst removeItem = (state, path) => {\n  state = state.deleteIn(expandTreePath(path));\n  state = fixPathsInTree(state);\n  return state;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} fromPath\n * @param {Immutable.List} toPath\n * @param {string} placement, see constants PLACEMENT_*: PLACEMENT_AFTER, PLACEMENT_BEFORE, PLACEMENT_APPEND, PLACEMENT_PREPEND\n * @param {object} config\n */\nconst moveItem = (state, fromPath, toPath, placement, config) => {\n  const from = getItemByPath(state, fromPath);\n  const sourcePath = fromPath.pop();\n  const source = fromPath.size > 1 ? getItemByPath(state, sourcePath) : null;\n  const sourceChildren = source ? source.get(\"children1\") : null;\n\n  const to = getItemByPath(state, toPath);\n  const targetPath = (placement == constants.PLACEMENT_APPEND || placement == constants.PLACEMENT_PREPEND) ? toPath : toPath.pop();\n  const target = (placement == constants.PLACEMENT_APPEND || placement == constants.PLACEMENT_PREPEND) \n    ? to\n    : toPath.size > 1 ? getItemByPath(state, targetPath) : null;\n  const targetChildren = target ? target.get(\"children1\") : null;\n\n  if (!source || !target || !from)\n    return state;\n\n  const isSameParent = (source.get(\"id\") == target.get(\"id\"));\n  const isSourceInsideTarget = targetPath.size < sourcePath.size \n        && deepEqual(targetPath.toArray(), sourcePath.toArray().slice(0, targetPath.size));\n  const isTargetInsideSource = targetPath.size > sourcePath.size \n        && deepEqual(sourcePath.toArray(), targetPath.toArray().slice(0, sourcePath.size));\n  let sourceSubpathFromTarget = null;\n  let targetSubpathFromSource = null;\n  if (isSourceInsideTarget) {\n    sourceSubpathFromTarget = Immutable.List(sourcePath.toArray().slice(targetPath.size));\n  } else if (isTargetInsideSource) {\n    targetSubpathFromSource = Immutable.List(targetPath.toArray().slice(sourcePath.size));\n  }\n\n  let newTargetChildren = targetChildren, newSourceChildren = sourceChildren;\n  if (!isTargetInsideSource)\n    newSourceChildren = newSourceChildren.delete(from.get(\"id\"));\n  if (isSameParent) {\n    newTargetChildren = newSourceChildren;\n  } else if (isSourceInsideTarget) {\n    newTargetChildren = newTargetChildren.updateIn(expandTreeSubpath(sourceSubpathFromTarget, \"children1\"), (_oldChildren) => newSourceChildren);\n  }\n\n  if (placement == constants.PLACEMENT_BEFORE || placement == constants.PLACEMENT_AFTER) {\n    newTargetChildren = Immutable.OrderedMap().withMutations(r => {\n      for (let [itemId, item] of newTargetChildren.entries()) {\n        if (itemId == to.get(\"id\") && placement == constants.PLACEMENT_BEFORE) {\n          r.set(from.get(\"id\"), from);\n        }\n                \n        r.set(itemId, item);\n\n        if (itemId == to.get(\"id\") && placement == constants.PLACEMENT_AFTER) {\n          r.set(from.get(\"id\"), from);\n        }\n      }\n    });\n  } else if (placement == constants.PLACEMENT_APPEND) {\n    newTargetChildren = newTargetChildren.merge({[from.get(\"id\")]: from});\n  } else if (placement == constants.PLACEMENT_PREPEND) {\n    newTargetChildren = Immutable.OrderedMap({[from.get(\"id\")]: from}).merge(newTargetChildren);\n  }\n\n  if (isTargetInsideSource) {\n    newSourceChildren = newSourceChildren.updateIn(expandTreeSubpath(targetSubpathFromSource, \"children1\"), (_oldChildren) => newTargetChildren);\n    newSourceChildren = newSourceChildren.delete(from.get(\"id\"));\n  }\n\n  if (!isSameParent && !isSourceInsideTarget)\n    state = state.updateIn(expandTreePath(sourcePath, \"children1\"), (_oldChildren) => newSourceChildren);\n  if (!isTargetInsideSource)\n    state = state.updateIn(expandTreePath(targetPath, \"children1\"), (_oldChildren) => newTargetChildren);\n\n  state = fixPathsInTree(state);\n  return state;\n};\n\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {string} field\n */\nconst setField = (state, path, newField, config) => {\n  if (!newField)\n    return removeItem(state, path);\n\n  const {fieldSeparator, setOpOnChangeField, showErrorMessage} = config.settings;\n  if (Array.isArray(newField))\n    newField = newField.join(fieldSeparator);\n\n  const currentType = state.getIn(expandTreePath(path, \"type\"));\n  const currentProperties = state.getIn(expandTreePath(path, \"properties\"));\n  const wasRuleGroup = currentType == \"rule_group\";\n  const newFieldConfig = getFieldConfig(config, newField);\n  const isRuleGroup = newFieldConfig.type == \"!group\";\n  const isRuleGroupExt = isRuleGroup && newFieldConfig.mode == \"array\";\n  const isChangeToAnotherType = wasRuleGroup != isRuleGroup;\n  \n  const currentOperator = currentProperties.get(\"operator\");\n  const currentOperatorOptions = currentProperties.get(\"operatorOptions\");\n  const _currentField = currentProperties.get(\"field\");\n  const _currentValue = currentProperties.get(\"value\");\n  const _currentValueSrc = currentProperties.get(\"valueSrc\", new Immutable.List());\n  const _currentValueType = currentProperties.get(\"valueType\", new Immutable.List());\n\n  // If the newly selected field supports the same operator the rule currently\n  // uses, keep it selected.\n  const lastOp = newFieldConfig && newFieldConfig.operators.indexOf(currentOperator) !== -1 ? currentOperator : null;\n  let newOperator = null;\n  const availOps = getOperatorsForField(config, newField);\n  if (availOps && availOps.length == 1)\n    newOperator = availOps[0];\n  else if (availOps && availOps.length > 1) {\n    for (let strategy of setOpOnChangeField || []) {\n      if (strategy == \"keep\" && !isChangeToAnotherType)\n        newOperator = lastOp;\n      else if (strategy == \"default\")\n        newOperator = defaultOperator(config, newField, false);\n      else if (strategy == \"first\")\n        newOperator = getFirstOperator(config, newField);\n      if (newOperator) //found op for strategy\n        break;\n    }\n  }\n\n  if (!isRuleGroup && !newFieldConfig.operators) {\n    console.warn(`Type ${newFieldConfig.type} is not supported`);\n    return state;\n  }\n\n  if (wasRuleGroup && !isRuleGroup) {\n    state = state.setIn(expandTreePath(path, \"type\"), \"rule\");\n    state = state.deleteIn(expandTreePath(path, \"children1\"));\n    state = state.setIn(expandTreePath(path, \"properties\"), new Immutable.OrderedMap());\n  }\n\n  if (isRuleGroup) {\n    state = state.setIn(expandTreePath(path, \"type\"), \"rule_group\");\n    const {canReuseValue, newValue, newValueSrc, newValueType, operatorCardinality} = getNewValueForFieldOp(\n      config, config, currentProperties, newField, newOperator, \"field\", true\n    );\n    let groupProperties = defaultGroupProperties(config, newFieldConfig).merge({\n      field: newField,\n      mode: newFieldConfig.mode,\n    });\n    if (isRuleGroupExt) {\n      groupProperties = groupProperties.merge({\n        operator: newOperator,\n        value: newValue,\n        valueSrc: newValueSrc,\n        valueType: newValueType,\n      });\n    }\n    state = state.setIn(expandTreePath(path, \"children1\"), new Immutable.OrderedMap());\n    state = state.setIn(expandTreePath(path, \"properties\"), groupProperties);\n    if (newFieldConfig.initialEmptyWhere && operatorCardinality == 1) { // just `COUNT(grp) > 1` without `HAVING ..`\n      // no childeren\n    } else {\n      state = addItem(state, path, \"rule\", uuid(), defaultRuleProperties(config, newField), config);\n    }\n    state = fixPathsInTree(state);\n\n    return state;\n  }\n\n  return state.updateIn(expandTreePath(path, \"properties\"), (map) => map.withMutations((current) => {\n    const {canReuseValue, newValue, newValueSrc, newValueType, newValueError} = getNewValueForFieldOp(\n      config, config, current, newField, newOperator, \"field\", true\n    );\n    if (showErrorMessage) {\n      current = current\n        .set(\"valueError\", newValueError);\n    }\n    const newOperatorOptions = canReuseValue ? currentOperatorOptions : defaultOperatorOptions(config, newOperator, newField);\n\n    return current\n      .set(\"field\", newField)\n      .set(\"operator\", newOperator)\n      .set(\"operatorOptions\", newOperatorOptions)\n      .set(\"value\", newValue)\n      .set(\"valueSrc\", newValueSrc)\n      .set(\"valueType\", newValueType)\n      .delete(\"asyncListValues\");\n  }));\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {string} operator\n */\nconst setOperator = (state, path, newOperator, config) => {\n  const {showErrorMessage} = config.settings;\n\n  const properties = state.getIn(expandTreePath(path, \"properties\"));\n  const children = state.getIn(expandTreePath(path, \"children1\"));\n  const currentField = properties.get(\"field\");\n  const fieldConfig = getFieldConfig(config, currentField);\n  const isRuleGroup = fieldConfig.type == \"!group\";\n  const operatorConfig = getOperatorConfig(config, newOperator, currentField);\n  const operatorCardinality = operatorConfig ? defaultValue(operatorConfig.cardinality, 1) : null;\n\n  state = state.updateIn(expandTreePath(path, \"properties\"), (map) => map.withMutations((current) => {\n    const currentField = current.get(\"field\");\n    const currentOperatorOptions = current.get(\"operatorOptions\");\n    const _currentValue = current.get(\"value\", new Immutable.List());\n    const _currentValueSrc = current.get(\"valueSrc\", new Immutable.List());\n    const _currentOperator = current.get(\"operator\");\n\n    const {canReuseValue, newValue, newValueSrc, newValueType, newValueError} = getNewValueForFieldOp(\n      config, config, current, currentField, newOperator, \"operator\", true\n    );\n    if (showErrorMessage) {\n      current = current\n        .set(\"valueError\", newValueError);\n    }\n    const newOperatorOptions = canReuseValue ? currentOperatorOptions : defaultOperatorOptions(config, newOperator, currentField);\n\n    if (!canReuseValue) {\n      current = current\n        .delete(\"asyncListValues\");\n    }\n\n    return current\n      .set(\"operator\", newOperator)\n      .set(\"operatorOptions\", newOperatorOptions)\n      .set(\"value\", newValue)\n      .set(\"valueSrc\", newValueSrc)\n      .set(\"valueType\", newValueType);\n  }));\n\n  if (isRuleGroup) {\n    if (operatorCardinality == 0 && children.size == 0) {\n      state = addItem(state, path, \"rule\", uuid(), defaultRuleProperties(config, currentField), config);\n    }\n  }\n\n  return state;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {integer} delta\n * @param {*} value\n * @param {string} valueType\n * @param {*} asyncListValues\n * @param {boolean} __isInternal\n */\nconst setValue = (state, path, delta, value, valueType, config, asyncListValues, __isInternal) => {\n  const {fieldSeparator, showErrorMessage} = config.settings;\n  let isInternalValueChange;\n  const valueSrc = state.getIn(expandTreePath(path, \"properties\", \"valueSrc\", delta + \"\")) || null;\n  if (valueSrc === \"field\" && Array.isArray(value))\n    value = value.join(fieldSeparator);\n\n  const field = state.getIn(expandTreePath(path, \"properties\", \"field\")) || null;\n  const operator = state.getIn(expandTreePath(path, \"properties\", \"operator\")) || null;\n  const operatorConfig = getOperatorConfig(config, operator, field);\n  const operatorCardinality = operator ? defaultValue(operatorConfig.cardinality, 1) : null;\n\n  const isEndValue = false;\n  const calculatedValueType = valueType || calculateValueType(value, valueSrc, config);\n  const canFix = false;\n  const [validateError, fixedValue] = validateValue(\n    config, field, field, operator, value, calculatedValueType, valueSrc, asyncListValues, canFix, isEndValue\n  );\n  const isValid = !validateError;\n  if (fixedValue !== value) {\n    // eg, get exact value from listValues (not string)\n    value = fixedValue;\n  }\n\n  // Additional validation for range values\n  if (showErrorMessage) {\n    const w = getWidgetForFieldOp(config, field, operator, valueSrc);\n    const fieldWidgetDefinition = getFieldWidgetConfig(config, field, operator, w, valueSrc);\n    const valueSrcs = Array.from({length: operatorCardinality}, (_, i) => (state.getIn(expandTreePath(path, \"properties\", \"valueSrc\", i + \"\")) || null));\n        \n    if (operatorConfig && operatorConfig.validateValues && valueSrcs.filter(vs => vs == \"value\" || vs == null).length == operatorCardinality) {\n      const values = Array.from({length: operatorCardinality}, (_, i) => (i == delta ? value : state.getIn(expandTreePath(path, \"properties\", \"value\", i + \"\")) || null));\n      const jsValues = fieldWidgetDefinition && fieldWidgetDefinition.toJS ? values.map(v => fieldWidgetDefinition.toJS(v, fieldWidgetDefinition)) : values;\n      const rangeValidateError = operatorConfig.validateValues(jsValues);\n\n      state = state.setIn(expandTreePath(path, \"properties\", \"valueError\", operatorCardinality), rangeValidateError);\n    }\n  }\n  \n  const lastValueArr = state.getIn(expandTreePath(path, \"properties\", \"value\"));\n  if (!lastValueArr) {\n    state = state\n      .setIn(expandTreePath(path, \"properties\", \"value\"), new Immutable.List(new Array(operatorCardinality)))\n      .setIn(expandTreePath(path, \"properties\", \"valueType\"), new Immutable.List(new Array(operatorCardinality)))\n      .setIn(expandTreePath(path, \"properties\", \"valueError\"), new Immutable.List(new Array(operatorCardinality)));\n  }\n\n  const lastValue = state.getIn(expandTreePath(path, \"properties\", \"value\", delta + \"\"));\n  const lastError = state.getIn(expandTreePath(path, \"properties\", \"valueError\", delta));\n  const isLastEmpty = lastValue == undefined;\n  const isLastError = !!lastError;\n  if (isValid || showErrorMessage) {\n    state = state.deleteIn(expandTreePath(path, \"properties\", \"asyncListValues\"));\n    // set only good value\n    if (typeof value === \"undefined\") {\n      state = state.setIn(expandTreePath(path, \"properties\", \"value\", delta + \"\"), undefined);\n      state = state.setIn(expandTreePath(path, \"properties\", \"valueType\", delta + \"\"), null);\n    } else {\n      if (asyncListValues) {\n        state = state.setIn(expandTreePath(path, \"properties\", \"asyncListValues\"), asyncListValues);\n      }\n      state = state.setIn(expandTreePath(path, \"properties\", \"value\", delta + \"\"), value);\n      state = state.setIn(expandTreePath(path, \"properties\", \"valueType\", delta + \"\"), calculatedValueType);\n      isInternalValueChange = __isInternal && !isLastEmpty && !isLastError;\n    }\n  }\n  if (showErrorMessage) {\n    state = state.setIn(expandTreePath(path, \"properties\", \"valueError\", delta), validateError);\n  }\n  if (__isInternal && (isValid && isLastError || !isValid && !isLastError)) {\n    state = state.setIn(expandTreePath(path, \"properties\", \"valueError\", delta), validateError);\n    isInternalValueChange = false;\n  }\n  \n  return {tree: state, isInternalValueChange};\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {integer} delta\n * @param {*} srcKey\n */\nconst setValueSrc = (state, path, delta, srcKey, config) => {\n  const {showErrorMessage} = config.settings;\n\n  const field = state.getIn(expandTreePath(path, \"properties\", \"field\")) || null;\n  const operator = state.getIn(expandTreePath(path, \"properties\", \"operator\")) || null;\n\n  state = state.setIn(expandTreePath(path, \"properties\", \"value\", delta + \"\"), undefined);\n  state = state.setIn(expandTreePath(path, \"properties\", \"valueType\", delta + \"\"), null);\n  state = state.deleteIn(expandTreePath(path, \"properties\", \"asyncListValues\"));\n\n  if (showErrorMessage) {\n    // clear value error\n    state = state.setIn(expandTreePath(path, \"properties\", \"valueError\", delta), null);\n\n    // if current operator is range, clear possible range error\n    const operatorConfig = getOperatorConfig(config, operator, field);\n    const operatorCardinality = operator ? defaultValue(operatorConfig.cardinality, 1) : null;\n    if (operatorConfig.validateValues) {\n      state = state.setIn(expandTreePath(path, \"properties\", \"valueError\", operatorCardinality), null);\n    }\n  }\n  \n  // set valueSrc\n  if (typeof srcKey === \"undefined\") {\n    state = state.setIn(expandTreePath(path, \"properties\", \"valueSrc\", delta + \"\"), null);\n  } else {\n    state = state.setIn(expandTreePath(path, \"properties\", \"valueSrc\", delta + \"\"), srcKey);\n  }\n\n  // maybe set default value\n  if (srcKey) {\n    const properties = state.getIn(expandTreePath(path, \"properties\"));\n    // this call should return canReuseValue = false and provide default value\n    const {canReuseValue, newValue, newValueSrc, newValueType, newValueError} = getNewValueForFieldOp(\n      config, config, properties, field, operator, \"valueSrc\", true\n    );\n    if (!canReuseValue && newValueSrc.get(delta) == srcKey) {\n      state = state.setIn(expandTreePath(path, \"properties\", \"value\", delta + \"\"), newValue.get(delta));\n      state = state.setIn(expandTreePath(path, \"properties\", \"valueType\", delta + \"\"), newValueType.get(delta));\n    }\n  }\n\n  return state;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {Immutable.List} path\n * @param {string} name\n * @param {*} value\n */\nconst setOperatorOption = (state, path, name, value) => {\n  return state.setIn(expandTreePath(path, \"properties\", \"operatorOptions\", name), value);\n};\n\n/**\n * @param {Immutable.Map} state\n */\nconst checkEmptyGroups = (state, config) => {\n  const {canLeaveEmptyGroup} = config.settings;\n  if (!canLeaveEmptyGroup) {\n    state = fixEmptyGroupsInTree(state);\n  }\n  return state;\n};\n\n\n/**\n * \n */\nconst calculateValueType = (value, valueSrc, config) => {\n  let calculatedValueType = null;\n  if (value) {\n    if (valueSrc === \"field\") {\n      const fieldConfig = getFieldConfig(config, value);\n      if (fieldConfig) {\n        calculatedValueType = fieldConfig.type;\n      }\n    } else if (valueSrc === \"func\") {\n      const funcKey = value.get(\"func\");\n      if (funcKey) {\n        const funcConfig = getFuncConfig(config, funcKey);\n        if (funcConfig) {\n          calculatedValueType = funcConfig.returnType;\n        }\n      }\n    }\n  }\n  return calculatedValueType;\n};\n\nconst getField = (state, path) => {\n  const field = state.getIn(expandTreePath(path, \"properties\", \"field\")) || null;\n  return field;\n};\n\nconst emptyDrag = {\n  dragging: {\n    id: null,\n    x: null,\n    y: null,\n    w: null,\n    h: null\n  },\n  mousePos: {},\n  dragStart: {\n    id: null,\n  },\n};\n\nconst getActionMeta = (action, state) => {\n  const actionKeysToOmit = [\n    \"config\", \"asyncListValues\", \"__isInternal\"\n  ];\n  const actionTypesToIgnore = [\n    constants.SET_TREE,\n    constants.SET_DRAG_START,\n    constants.SET_DRAG_PROGRESS,\n    constants.SET_DRAG_END,\n  ];\n  let meta = mapValues(omit(action, actionKeysToOmit), applyToJS);\n  let affectedField = action.path && getField(state.tree, action.path) || action.field;\n  if (affectedField)\n    meta.affectedField = affectedField;\n  if (actionTypesToIgnore.includes(action.type) || action.type.indexOf(\"@@redux\") == 0)\n    meta = null;\n  return meta;\n};\n\n/**\n * @param {Immutable.Map} state\n * @param {object} action\n */\nexport default (config, tree, getMemoizedTree) => {\n  const emptyTree = defaultRoot(config);\n  const initTree = tree || emptyTree;\n  const emptyState = {\n    tree: initTree, \n    ...emptyDrag\n  };\n    \n  return (state = emptyState, action) => {\n    const unset = {__isInternalValueChange: undefined, __lastAction: undefined};\n    let set = {};\n    let actionMeta = getActionMeta(action, state);\n\n    switch (action.type) {\n    case constants.SET_TREE: {\n      const validatedTree = getMemoizedTree(action.config, action.tree);\n      set.tree = validatedTree;\n      break;\n    }\n\n    case constants.ADD_CASE_GROUP: {\n      set.tree = addNewGroup(state.tree, action.path, \"case_group\", action.id, action.properties, action.config,  action.children, action.meta);\n      break;\n    }\n\n    case constants.ADD_GROUP: {\n      set.tree = addNewGroup(state.tree, action.path, \"group\", action.id, action.properties, action.config,  action.children, action.meta);\n      break;\n    }\n\n    case constants.REMOVE_GROUP: {\n      set.tree = removeGroup(state.tree, action.path, action.config);\n      break;\n    }\n\n    case constants.ADD_RULE: {\n      set.tree = addItem(state.tree, action.path, action.ruleType, action.id, action.properties, action.config, action.children);\n      break;\n    }\n\n    case constants.REMOVE_RULE: {\n      set.tree = removeRule(state.tree, action.path, action.config);\n      break;\n    }\n\n    case constants.SET_CONJUNCTION: {\n      set.tree = setConjunction(state.tree, action.path, action.conjunction);\n      break;\n    }\n\n    case constants.SET_NOT: {\n      set.tree = setNot(state.tree, action.path, action.not);\n      break;\n    }\n\n    case constants.SET_FIELD: {\n      set.tree = setField(state.tree, action.path, action.field, action.config);\n      break;\n    }\n\n    case constants.SET_LOCK: {\n      set.tree = setLock(state.tree, action.path, action.lock);\n      break;\n    }\n\n    case constants.SET_OPERATOR: {\n      set.tree = setOperator(state.tree, action.path, action.operator, action.config);\n      break;\n    }\n\n    case constants.SET_VALUE: {\n      const {tree, isInternalValueChange} = setValue(\n        state.tree, action.path, action.delta, action.value, action.valueType, action.config, action.asyncListValues, action.__isInternal\n      );\n      set.__isInternalValueChange = isInternalValueChange;\n      set.tree = tree;\n      break;\n    }\n\n    case constants.SET_VALUE_SRC: {\n      set.tree = setValueSrc(state.tree, action.path, action.delta, action.srcKey, action.config);\n      break;\n    }\n\n    case constants.SET_OPERATOR_OPTION: {\n      set.tree = setOperatorOption(state.tree, action.path, action.name, action.value);\n      break;\n    }\n\n    case constants.MOVE_ITEM: {\n      set.tree = moveItem(state.tree, action.fromPath, action.toPath, action.placement, action.config);\n      break;\n    }\n\n    case constants.SET_DRAG_START: {\n      set.dragStart = action.dragStart;\n      set.dragging = action.dragging;\n      set.mousePos = action.mousePos;\n      break;\n    }\n\n    case constants.SET_DRAG_PROGRESS: {\n      set.mousePos = action.mousePos;\n      set.dragging = action.dragging;\n      break;\n    }\n\n    case constants.SET_DRAG_END: {\n      set.tree = checkEmptyGroups(state.tree, config);\n      set = { ...set, ...emptyDrag };\n      break;\n    }\n\n    default: {\n      break;\n    }\n    }\n\n    if (actionMeta) {\n      set.__lastAction = actionMeta;\n    }\n    \n    return {...state, ...unset, ...set};\n  };\n\n};\n","import React from \"react\";\n\nexport default React.createContext(); ","import uuid from \"../utils/uuid\";\nimport {toImmutableList} from \"../utils/stuff\";\nimport {defaultRuleProperties, defaultGroupProperties} from \"../utils/defaultUtils\";\nimport * as constants from \"../constants\";\nimport Immutable from \"immutable\";\n\n\n\n/**\n * @param {object} config\n * @param {Immutable.Map} tree\n */\nexport const setTree = (config, tree) => ({\n  type: constants.SET_TREE,\n  tree: tree,\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nexport const addRule = (config, path, properties, ruleType = \"rule\", children = null) => ({\n  type: constants.ADD_RULE,\n  ruleType: ruleType,\n  children: children,\n  path: toImmutableList(path),\n  id: uuid(),\n  properties: defaultRuleProperties(config).merge(properties || {}),\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n */\nexport const removeRule = (config, path) => ({\n  type: constants.REMOVE_RULE,\n  path: toImmutableList(path),\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nexport const addDefaultCaseGroup = (config, path, properties, children = null) => ({\n  type: constants.ADD_CASE_GROUP,\n  path: toImmutableList(path),\n  children: children,\n  id: uuid(),\n  properties: defaultGroupProperties(config).merge(properties || {}),\n  config: config,\n  meta: {\n    isDefaultCase: true\n  }\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nexport const addCaseGroup = (config, path, properties, children = null) => ({\n  type: constants.ADD_CASE_GROUP,\n  path: toImmutableList(path),\n  children: children,\n  id: uuid(),\n  properties: defaultGroupProperties(config).merge(properties || {}),\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {Immutable.Map} properties\n */\nexport const addGroup = (config, path, properties, children = null) => ({\n  type: constants.ADD_GROUP,\n  path: toImmutableList(path),\n  children: children,\n  id: uuid(),\n  properties: defaultGroupProperties(config).merge(properties || {}),\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n */\nexport const removeGroup = (config, path) => ({\n  type: constants.REMOVE_GROUP,\n  path: toImmutableList(path),\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Array} fromPath\n * @param {Array} toPath\n * @param {String} placement, see constants PLACEMENT_*\n */\nexport const moveItem = (config, fromPath, toPath, placement) => ({\n  type: constants.MOVE_ITEM,\n  fromPath: toImmutableList(fromPath),\n  toPath: toImmutableList(toPath),\n  placement: placement,\n  config: config,\n});\n","import * as constants from \"../constants\";\nimport {toImmutableList} from \"../utils/stuff\";\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {string} conjunction\n */\nexport const setConjunction = (config, path, conjunction) => ({\n  type: constants.SET_CONJUNCTION,\n  path: toImmutableList(path),\n  conjunction: conjunction\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {bool} not\n */\nexport const setNot = (config, path, not) => ({\n  type: constants.SET_NOT,\n  path: toImmutableList(path),\n  not: not\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {bool} lock\n */\nexport const setLock = (config, path, lock) => ({\n  type: constants.SET_LOCK,\n  path: toImmutableList(path),\n  lock: lock\n});","import * as constants from \"../constants\";\nimport {toImmutableList} from \"../utils/stuff\";\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {string} field\n */\nexport const setField = (config, path, field) => ({\n  type: constants.SET_FIELD,\n  path: toImmutableList(path),\n  field: field,\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {string} operator\n */\nexport const setOperator = (config, path, operator) => ({\n  type: constants.SET_OPERATOR,\n  path: toImmutableList(path),\n  operator: operator,\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {integer} delta\n * @param {*} value\n * @param {string} valueType\n * @param {*} asyncListValues\n * @param {boolean} __isInternal\n */\nexport const setValue = (config, path, delta, value, valueType, asyncListValues, __isInternal) => ({\n  type: constants.SET_VALUE,\n  path: toImmutableList(path),\n  delta: delta,\n  value: value,\n  valueType: valueType,\n  asyncListValues: asyncListValues,\n  config: config,\n  __isInternal: __isInternal\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {integer} delta\n * @param {*} srcKey\n */\nexport const setValueSrc = (config, path, delta, srcKey) => ({\n  type: constants.SET_VALUE_SRC,\n  path: toImmutableList(path),\n  delta: delta,\n  srcKey: srcKey,\n  config: config\n});\n\n/**\n * @param {object} config\n * @param {Immutable.List} path\n * @param {string} name\n * @param {*} value\n */\nexport const setOperatorOption = (config, path, name, value) => ({\n  type: constants.SET_OPERATOR_OPTION,\n  path: toImmutableList(path),\n  name: name,\n  value: value,\n  config: config\n});\n","import * as constants from \"../constants\";\n\n\n/**\n * @param {Object} mousePos\n * @param {Object} dragging\n */\nexport const setDragProgress = (mousePos, dragging) => ({\n  type: constants.SET_DRAG_PROGRESS,\n  mousePos: mousePos,\n  dragging: dragging,\n});\n\n/**\n * @param {Object} dragStart\n * @param {Object} dragging\n * @param {Object} mousePos\n */\nexport const setDragStart = (dragStart, dragging, mousePos) => ({\n  type: constants.SET_DRAG_START,\n  dragStart: dragStart,\n  dragging: dragging,\n  mousePos: mousePos,\n});\n\n/**\n *\n */\nexport const setDragEnd = () => ({\n  type: constants.SET_DRAG_END,\n});\n","import React, { Component } from \"react\";\nimport {connect} from \"react-redux\";\nimport context from \"../stores/context\";\nimport PropTypes from \"prop-types\";\nimport * as actions from \"../actions\";\nimport {immutableEqual} from \"../utils/stuff\";\nimport {useOnPropsChanged, liteShouldComponentUpdate, bindActionCreators} from \"../utils/reactUtils\";\n\n\nclass Query extends Component {\n  static propTypes = {\n    config: PropTypes.object.isRequired,\n    onChange: PropTypes.func,\n    renderBuilder: PropTypes.func,\n    tree: PropTypes.any, //instanceOf(Immutable.Map)\n    //dispatch: PropTypes.func.isRequired,\n    //__isInternalValueChange\n    //__lastAction\n    //getMemoizedTree: PropTypes.func.isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this._updateActions(props);\n\n    // For preventive validation (tree and config consistency)\n    // When config has chnaged from QueryContainer, \n    //  but new dispatched validated tree value is not in redux store yet (tree prop is old)\n    this.validatedTree = props.getMemoizedTree(props.config, props.tree);\n    this.oldValidatedTree = this.validatedTree;\n\n    //props.onChange && props.onChange(this.validatedTree, props.config);\n  }\n\n  _updateActions (props) {\n    const {config, dispatch} = props;\n    this.actions = bindActionCreators({...actions.tree, ...actions.group, ...actions.rule}, config, dispatch);\n  }\n\n  shouldComponentUpdate = liteShouldComponentUpdate(this, {\n    tree: (nextValue) => {\n      if (nextValue === this.oldValidatedTree && this.oldValidatedTree === this.validatedTree) {\n        // Got value dispatched from QueryContainer\n        // Ignore, because we've just rendered it\n        return false;\n      }\n      return true;\n    }\n  });\n\n  onPropsChanged(nextProps) {\n    const {onChange} = nextProps;\n    const oldConfig = this.props.config;\n    const newTree = nextProps.tree;\n    const oldTree = this.props.tree;\n    const newConfig = nextProps.config;\n\n    this.oldValidatedTree = this.validatedTree;\n    this.validatedTree = newTree;\n    if (oldConfig !== newConfig) {\n      this._updateActions(nextProps);\n      this.validatedTree = nextProps.getMemoizedTree(newConfig, newTree, oldConfig);\n    }\n\n    const validatedTreeChanged = !immutableEqual(this.validatedTree, this.oldValidatedTree);\n    if (validatedTreeChanged) {\n      onChange && onChange(this.validatedTree, newConfig, nextProps.__lastAction);\n    }\n  }\n\n  render() {\n    const {config, renderBuilder, dispatch, __isInternalValueChange} = this.props;\n    const builderProps = {\n      tree: this.validatedTree,\n      actions: this.actions,\n      config: config,\n      dispatch: dispatch,\n      __isInternalValueChange\n    };\n\n    return renderBuilder(builderProps);\n  }\n}\n\n\nconst ConnectedQuery = connect(\n  (state) => {\n    return {\n      tree: state.tree,\n      __isInternalValueChange: state.__isInternalValueChange,\n      __lastAction: state.__lastAction,\n    };\n  },\n  null,\n  null,\n  {\n    context\n  }\n)(Query);\nConnectedQuery.displayName = \"ConnectedQuery\";\n\n\nexport default ConnectedQuery;\n","import React, { Component, PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport treeStoreReducer from \"../stores/tree\";\nimport context from \"../stores/context\";\nimport {createStore} from \"redux\";\nimport {Provider} from \"react-redux\";\nimport * as actions from \"../actions\";\nimport {createConfigMemo} from \"../utils/configUtils\";\nimport {immutableEqual} from \"../utils/stuff\";\nimport {defaultRoot} from \"../utils/defaultUtils\";\nimport {createValidationMemo} from \"../utils/validation\";\nimport {liteShouldComponentUpdate, useOnPropsChanged} from \"../utils/reactUtils\";\nimport ConnectedQuery from \"./Query\";\n\n\nexport default class QueryContainer extends Component {\n  static propTypes = {\n    //config\n    conjunctions: PropTypes.object.isRequired,\n    fields: PropTypes.object.isRequired,\n    types: PropTypes.object.isRequired,\n    operators: PropTypes.object.isRequired,\n    widgets: PropTypes.object.isRequired,\n    settings: PropTypes.object.isRequired,\n\n    onChange: PropTypes.func,\n    renderBuilder: PropTypes.func,\n    value: PropTypes.any, //instanceOf(Immutable.Map)\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    useOnPropsChanged(this);\n\n    this.getMemoizedConfig = createConfigMemo();\n    this.getMemoizedTree = createValidationMemo();\n    \n    const config = this.getMemoizedConfig(props);\n    const tree = props.value;\n    const validatedTree = this.getMemoizedTree(config, tree);\n\n    const reducer = treeStoreReducer(config, validatedTree, this.getMemoizedTree);\n    const store = createStore(reducer);\n\n    this.state = {\n      store,\n      config\n    };\n  }\n\n  shouldComponentUpdate = liteShouldComponentUpdate(this, {\n    value: (nextValue, prevValue, state) => { return false; }\n  });\n\n  onPropsChanged(nextProps) {\n    // compare configs\n    const oldConfig = this.state.config;\n    const nextConfig = this.getMemoizedConfig(nextProps);\n    const isConfigChanged = oldConfig !== nextConfig;\n\n    // compare trees\n    const storeValue = this.state.store.getState().tree;\n    const isTreeChanged = !immutableEqual(nextProps.value, this.props.value) && !immutableEqual(nextProps.value, storeValue);\n    const currentTree = isTreeChanged ? nextProps.value || defaultRoot(nextProps) : storeValue;\n\n    if (isConfigChanged) {\n      this.setState({config: nextConfig});\n    }\n    \n    if (isTreeChanged || isConfigChanged) {\n      const validatedTree = this.getMemoizedTree(nextConfig, currentTree, oldConfig);\n      return Promise.resolve().then(() => {\n        this.state.store.dispatch(\n          actions.tree.setTree(nextConfig, validatedTree)\n        );\n      });\n    }\n  }\n\n  render() {\n    // `get_children` is deprecated!\n    const {renderBuilder, get_children, onChange, settings} = this.props;\n    const {config, store} = this.state;\n    const {renderProvider: QueryWrapper} = settings;\n\n    return (\n      <QueryWrapper config={config}>\n        <Provider store={store} context={context}>\n          <ConnectedQuery\n            config={config}\n            getMemoizedTree={this.getMemoizedTree}\n            onChange={onChange}\n            renderBuilder={renderBuilder || get_children}\n          />\n        </Provider>\n      </QueryWrapper>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport context from \"../../stores/context\";\nimport {getFieldConfig} from \"../../utils/configUtils\";\nimport {pureShouldComponentUpdate} from \"../../utils/reactUtils\";\nimport {connect} from \"react-redux\";\nconst classNames = require(\"classnames\");\n\n\nconst createRuleContainer = (Rule) => \n  class RuleContainer extends Component {\n    static propTypes = {\n      id: PropTypes.string.isRequired,\n      groupId: PropTypes.string,\n      config: PropTypes.object.isRequired,\n      path: PropTypes.any.isRequired, //instanceOf(Immutable.List)\n      operator: PropTypes.string,\n      field: PropTypes.string,\n      actions: PropTypes.object.isRequired, //{removeRule: Funciton, setField, setOperator, setOperatorOption, setValue, setValueSrc, ...}\n      onDragStart: PropTypes.func,\n      value: PropTypes.any, //depends on widget\n      valueSrc: PropTypes.any,\n      asyncListValues: PropTypes.array,\n      valueError: PropTypes.any,\n      operatorOptions: PropTypes.object,\n      reordableNodesCnt: PropTypes.number,\n      parentField: PropTypes.string, //from RuleGroup\n      isLocked: PropTypes.bool,\n      isTrueLocked: PropTypes.bool,\n      //connected:\n      dragging: PropTypes.object, //{id, x, y, w, h}\n      isDraggingTempo: PropTypes.bool,\n    };\n\n    constructor(props) {\n      super(props);\n      \n      this.dummyFn.isDummyFn = true;\n    }\n\n    dummyFn = () => {};\n\n    removeSelf = () => {\n      this.props.actions.removeRule(this.props.path);\n    };\n\n    setLock = (lock = null) => {\n      this.props.actions.setLock(this.props.path, lock);\n    };\n\n    setField = (field) => {\n      this.props.actions.setField(this.props.path, field);\n    };\n\n    setOperator = (operator) => {\n      this.props.actions.setOperator(this.props.path, operator);\n    };\n\n    setOperatorOption = (name, value) => {\n      this.props.actions.setOperatorOption(this.props.path, name, value);\n    };\n\n    setValue = (delta, value, type, asyncListValues, __isInternal) => {\n      this.props.actions.setValue(this.props.path, delta, value, type, asyncListValues, __isInternal);\n    };\n\n    setValueSrc = (delta, srcKey) => {\n      this.props.actions.setValueSrc(this.props.path, delta, srcKey);\n    };\n\n    shouldComponentUpdate(nextProps, nextState) {\n      let prevProps = this.props;\n      let prevState = this.state;\n\n      let should = pureShouldComponentUpdate(this)(nextProps, nextState);\n      if (should) {\n        if (prevState == nextState && prevProps != nextProps) {\n          const draggingId = (nextProps.dragging.id || prevProps.dragging.id);\n          const isDraggingMe = draggingId == nextProps.id;\n          let chs = [];\n          for (let k in nextProps) {\n            let changed = (nextProps[k] != prevProps[k]);\n            if (k == \"dragging\" && !isDraggingMe) {\n              changed = false; //dragging another item -> ignore\n            }\n            if (changed) {\n              chs.push(k);\n            }\n          }\n          if (!chs.length)\n            should = false;\n        }\n      }\n      return should;\n    }\n\n    render() {\n      const isDraggingMe = this.props.dragging.id == this.props.id;\n      const fieldConfig = getFieldConfig(this.props.config, this.props.field);\n      const {showErrorMessage} = this.props.config.settings;\n      const _isGroup = fieldConfig && fieldConfig.type == \"!struct\";\n      const isInDraggingTempo = !isDraggingMe && this.props.isDraggingTempo;\n\n      const valueError = this.props.valueError;\n      const oneValueError = valueError && valueError.toArray().filter(e => !!e).shift() || null;\n      const hasError = oneValueError != null && showErrorMessage;\n\n      return (\n        <div\n          className={classNames(\"group-or-rule-container\", \"rule-container\", hasError ? \"rule-with-error\" : null)}\n          data-id={this.props.id}\n        >\n          {[\n            isDraggingMe ? <Rule\n              key={\"dragging\"}\n              id={this.props.id}\n              groupId={this.props.groupId}\n              isDraggingMe={true}\n              isDraggingTempo={true}\n              dragging={this.props.dragging}\n              setField={this.dummyFn}\n              setOperator={this.dummyFn}\n              setOperatorOption={this.dummyFn}\n              setLock={this.dummyFn}\n              removeSelf={this.dummyFn}\n              setValue={this.dummyFn}\n              setValueSrc={this.dummyFn}\n              selectedField={this.props.field || null}\n              parentField={this.props.parentField || null}\n              selectedOperator={this.props.operator || null}\n              value={this.props.value || null}\n              valueSrc={this.props.valueSrc || null}\n              valueError={this.props.valueError || null}\n              operatorOptions={this.props.operatorOptions}\n              config={this.props.config}\n              reordableNodesCnt={this.props.reordableNodesCnt}\n              totalRulesCnt={this.props.totalRulesCnt}\n              asyncListValues={this.props.asyncListValues}\n              isLocked={this.props.isLocked}\n              isTrueLocked={this.props.isTrueLocked}\n              parentReordableNodesCnt={this.props.parentReordableNodesCnt}\n            /> : null\n            ,\n            <Rule\n              key={this.props.id}\n              id={this.props.id}\n              groupId={this.props.groupId}\n              isDraggingMe={isDraggingMe}\n              isDraggingTempo={isInDraggingTempo}\n              onDragStart={this.props.onDragStart}\n              setLock={isInDraggingTempo ? this.dummyFn : this.setLock}\n              removeSelf={isInDraggingTempo ? this.dummyFn : this.removeSelf}\n              setField={isInDraggingTempo ? this.dummyFn : this.setField}\n              setOperator={isInDraggingTempo ? this.dummyFn : this.setOperator}\n              setOperatorOption={isInDraggingTempo ? this.dummyFn : this.setOperatorOption}\n              setValue={isInDraggingTempo ? this.dummyFn : this.setValue}\n              setValueSrc={isInDraggingTempo ? this.dummyFn : this.setValueSrc}\n              selectedField={this.props.field || null}\n              parentField={this.props.parentField || null}\n              selectedOperator={this.props.operator || null}\n              value={this.props.value || null}\n              valueSrc={this.props.valueSrc || null}\n              valueError={this.props.valueError || null}\n              operatorOptions={this.props.operatorOptions}\n              config={this.props.config}\n              reordableNodesCnt={this.props.reordableNodesCnt}\n              totalRulesCnt={this.props.totalRulesCnt}\n              asyncListValues={this.props.asyncListValues}\n              isLocked={this.props.isLocked}\n              isTrueLocked={this.props.isTrueLocked}\n              parentReordableNodesCnt={this.props.parentReordableNodesCnt}\n            />\n          ]}\n        </div>\n      );\n    }\n\n  };\n\n\nexport default (Rule) => {\n  const ConnectedRuleContainer = connect(\n    (state) => {\n      return {\n        dragging: state.dragging,\n      };\n    },\n    null,\n    null,\n    {\n      context\n    }\n  )(createRuleContainer(Rule));\n  ConnectedRuleContainer.displayName = \"ConnectedRuleContainer\";\n\n  return ConnectedRuleContainer;\n};\n","import React, { Component } from \"react\";\nimport {connect} from \"react-redux\";\nimport {getFlatTree} from \"../../utils/treeUtils\";\nimport {logger} from \"../../utils/stuff\";\nimport context from \"../../stores/context\";\nimport * as constants from \"../../constants\";\nimport clone from \"clone\";\nimport PropTypes from \"prop-types\";\nimport * as actions from \"../../actions\";\nimport {pureShouldComponentUpdate, useOnPropsChanged, isUsingLegacyReactDomRender} from \"../../utils/reactUtils\";\n\nlet _isReorderingTree = false;\n\nconst createSortableContainer = (Builder, CanMoveFn = null) => \n  class SortableContainer extends Component {\n    static propTypes = {\n      tree: PropTypes.any.isRequired, //instanceOf(Immutable.Map)\n      actions: PropTypes.object.isRequired, // {moveItem: Function, ..}\n      //... see Builder\n    };\n\n    constructor(props) {\n      super(props);\n      useOnPropsChanged(this);\n\n      this.onPropsChanged(props);\n    }\n\n    onPropsChanged(nextProps) {\n      this.tree = getFlatTree(nextProps.tree);\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n      let prevProps = this.props;\n      let prevState = this.state;\n\n      let should = pureShouldComponentUpdate(this)(nextProps, nextState);\n      if (should) {\n        if (prevState == nextState && prevProps != nextProps) {\n          let chs = [];\n          for (let k in nextProps) {\n            let changed = (nextProps[k] != prevProps[k]);\n            if (changed) {\n              //don't render <Builder> on dragging - appropriate redux-connected components will do it\n              if(k != \"dragging\" && k != \"mousePos\")\n                chs.push(k);\n            }\n          }\n          if (!chs.length)\n            should = false;\n        }\n      }\n      return should;\n    }\n\n    componentDidUpdate(_prevProps, _prevState) {\n      let dragging = this.props.dragging;\n      let startDragging = this.props.dragStart;\n      _isReorderingTree = false;\n      if (startDragging && startDragging.id) {\n        dragging.itemInfo = this.tree.items[dragging.id];\n        if (dragging.itemInfo) {\n          if (dragging.itemInfo.index != startDragging.itemInfo.index || dragging.itemInfo.parent != startDragging.itemInfo.parent) {\n            const treeEl = startDragging.treeEl;\n            const treeElContainer = startDragging.treeElContainer;\n            const plhEl = this._getPlaceholderNodeEl(treeEl, true);\n            if (plhEl) {\n              const plX = plhEl.getBoundingClientRect().left + window.scrollX;\n              const plY = plhEl.getBoundingClientRect().top + window.scrollY;\n              const oldPlX = startDragging.plX;\n              const oldPlY = startDragging.plY;\n              const scrollTop = treeElContainer.scrollTop;\n              startDragging.plX = plX;\n              startDragging.plY = plY;\n              startDragging.itemInfo = clone(dragging.itemInfo);\n              startDragging.y = plhEl.offsetTop;\n              startDragging.x = plhEl.offsetLeft;\n              startDragging.clientY += (plY - oldPlY);\n              startDragging.clientX += (plX - oldPlX);\n              if (treeElContainer != document.body)\n                startDragging.scrollTop = scrollTop;\n\n              this.onDrag(this.props.mousePos, false);\n            }\n          }\n        }\n      }\n    }\n\n    _getNodeElById (treeEl, indexId, ignoreCache = false) {\n      if (indexId == null)\n        return null;\n      if (!this._cacheEls)\n        this._cacheEls = {};\n      let el = this._cacheEls[indexId];\n      if (el && document.contains(el) && !ignoreCache)\n        return el;\n      el = treeEl.querySelector('.group-or-rule-container[data-id=\"'+indexId+'\"]');\n      this._cacheEls[indexId] = el;\n      return el;\n    }\n\n    _getDraggableNodeEl (treeEl, ignoreCache = false) {\n      if (!this._cacheEls)\n        this._cacheEls = {};\n      let el = this._cacheEls[\"draggable\"];\n      if (el && document.contains(el) && !ignoreCache)\n        return el;\n      const els = treeEl.getElementsByClassName(\"qb-draggable\");\n      el = els.length ? els[0] : null;\n      this._cacheEls[\"draggable\"] = el;\n      return el;\n    }\n\n    _getPlaceholderNodeEl (treeEl, ignoreCache = false) {\n      if (!this._cacheEls)\n        this._cacheEls = {};\n      let el = this._cacheEls[\"placeholder\"];\n      if (el && document.contains(el) && !ignoreCache)\n        return el;\n      const els = treeEl.getElementsByClassName(\"qb-placeholder\");\n      el = els.length ? els[0] : null;\n      this._cacheEls[\"placeholder\"] = el;\n      return el;\n    }\n\n    _isScrollable(node) {\n      const overflowY = window.getComputedStyle(node)[\"overflow-y\"];\n      return (overflowY === \"scroll\" || overflowY === \"auto\") && (node.scrollHeight > node.offsetHeight);\n    }\n\n    _getScrollParent(node) {\n      if (node == null)\n        return null;\n    \n      if (node === document.body || this._isScrollable(node)) {\n        return node;\n      } else {\n        return this._getScrollParent(node.parentNode);\n      }\n    }\n\n    _getEventTarget = (e, dragStart) => {\n      return e && e.__mocked_window || document.body || window;\n    };\n\n    onDragStart = (id, dom, e) => {\n      let treeEl = dom.closest(\".query-builder\");\n      if (this._isUsingLegacyReactDomRender === undefined) {\n        this._isUsingLegacyReactDomRender = isUsingLegacyReactDomRender(treeEl);\n      }\n      document.body.classList.add(\"qb-dragging\");\n      treeEl.classList.add(\"qb-dragging\");\n      let treeElContainer = treeEl.closest(\".query-builder-container\") || treeEl;\n      treeElContainer = this._getScrollParent(treeElContainer) || document.body;\n      const scrollTop = treeElContainer.scrollTop;\n      \n      const _dragEl = this._getDraggableNodeEl(treeEl);\n      const _plhEl = this._getPlaceholderNodeEl(treeEl);\n\n      const tmpAllGroups = treeEl.querySelectorAll(\".group--children\");\n      const anyGroup = tmpAllGroups.length ? tmpAllGroups[0] : null;\n      let groupPadding;\n      if (anyGroup) {\n        groupPadding = window.getComputedStyle(anyGroup, null).getPropertyValue(\"padding-left\");\n        groupPadding = parseInt(groupPadding);\n      }\n\n      const dragging = {\n        id: id,\n        x: dom.offsetLeft,\n        y: dom.offsetTop,\n        w: dom.offsetWidth,\n        h: dom.offsetHeight,\n        itemInfo: this.tree.items[id],\n        paddingLeft: groupPadding,\n      };\n      const dragStart = {\n        id: id,\n        x: dom.offsetLeft,\n        y: dom.offsetTop,\n        scrollTop: scrollTop,\n        clientX: e.clientX,\n        clientY: e.clientY,\n        itemInfo: clone(this.tree.items[id]),\n        treeEl: treeEl,\n        treeElContainer: treeElContainer,\n      };\n      const mousePos = {\n        clientX: e.clientX,\n        clientY: e.clientY,\n      };\n\n      const target = this._getEventTarget(e, dragStart);\n      this.eventTarget = target;\n      target.addEventListener(\"mousemove\", this.onDrag);\n      target.addEventListener(\"mouseup\", this.onDragEnd);\n\n      this.props.setDragStart(dragStart, dragging, mousePos);\n    };\n\n\n    onDrag = (e, doHandleDrag = true) => {\n      let dragging = Object.assign({}, this.props.dragging);\n      let startDragging = this.props.dragStart;\n      const paddingLeft = dragging.paddingLeft; //this.props.paddingLeft;\n      const treeElContainer = startDragging.treeElContainer;\n      const scrollTop = treeElContainer.scrollTop;\n      dragging.itemInfo = this.tree.items[dragging.id];\n      if (!dragging.itemInfo) {\n        return;\n      }\n\n      let mousePos = {\n        clientX: e.clientX,\n        clientY: e.clientY,\n      };\n      const startMousePos = {\n        clientX: startDragging.clientX,\n        clientY: startDragging.clientY,\n      };\n\n      if (e.__mock_dom) {\n        const treeEl = startDragging.treeEl;\n        const dragEl = this._getDraggableNodeEl(treeEl);\n        const plhEl = this._getPlaceholderNodeEl(treeEl);\n        e.__mock_dom({treeEl, dragEl, plhEl});\n      }\n\n      //first init plX/plY\n      if (!startDragging.plX) {\n        const treeEl = startDragging.treeEl;\n        const plhEl = this._getPlaceholderNodeEl(treeEl);\n        if (plhEl) {\n          startDragging.plX = plhEl.getBoundingClientRect().left + window.scrollX;\n          startDragging.plY = plhEl.getBoundingClientRect().top + window.scrollY;\n        }\n      }\n\n      const startX = startDragging.x;\n      const startY = startDragging.y;\n      const startClientX = startDragging.clientX;\n      const startClientY = startDragging.clientY;\n      const startScrollTop = startDragging.scrollTop;\n      const pos = {\n        x: startX + (e.clientX - startClientX),\n        y: startY + (e.clientY - startClientY) + (scrollTop - startScrollTop)\n      };\n      dragging.x = pos.x;\n      dragging.y = pos.y;\n      dragging.paddingLeft = paddingLeft;\n      dragging.mousePos = mousePos;\n      dragging.startMousePos = startMousePos;\n\n\n      this.props.setDragProgress(mousePos, dragging);\n\n      const moved = doHandleDrag ? this.handleDrag(dragging, e, CanMoveFn) : false;\n\n      if (!moved) {\n        if (e.preventDefault)\n          e.preventDefault();\n      }\n    };\n\n    onDragEnd = () => {\n      let treeEl = this.props.dragStart.treeEl;\n\n      this.props.setDragEnd();\n\n      treeEl.classList.remove(\"qb-dragging\");\n      document.body.classList.remove(\"qb-dragging\");\n      this._cacheEls = {};\n\n      const target = this.eventTarget || this._getEventTarget();\n      target.removeEventListener(\"mousemove\", this.onDrag);\n      target.removeEventListener(\"mouseup\", this.onDragEnd);\n    };\n    \n\n    handleDrag (dragInfo, e, canMoveFn) {\n      const canMoveBeforeAfterGroup = true;\n      const itemInfo = dragInfo.itemInfo;\n      const paddingLeft = dragInfo.paddingLeft;\n\n      let moveInfo = null;\n      const treeEl = this.props.dragStart.treeEl;\n      const dragId = dragInfo.id;\n      const dragEl = this._getDraggableNodeEl(treeEl);\n      const plhEl = this._getPlaceholderNodeEl(treeEl);\n      let dragRect, plhRect, hovRect, treeRect;\n      if (dragEl && plhEl) {\n        dragRect = dragEl.getBoundingClientRect();\n        plhRect = plhEl.getBoundingClientRect();\n        if (!plhRect.width) {\n          return;\n        }\n        let dragDirs = {hrz: 0, vrt: 0};\n        if (dragRect.top < plhRect.top)\n          dragDirs.vrt = -1; //up\n        else if (dragRect.bottom > plhRect.bottom)\n          dragDirs.vrt = +1; //down\n        if (dragRect.left > plhRect.left)\n          dragDirs.hrz = +1; //right\n        else if (dragRect.left < plhRect.left)\n          dragDirs.hrz = -1; //left\n\n        treeRect = treeEl.getBoundingClientRect();\n        const trgCoord = {\n          x: treeRect.left + (treeRect.right - treeRect.left) / 2,\n          y: dragDirs.vrt >= 0 ? dragRect.bottom : dragRect.top,\n        };\n        let hovCNodeEl;\n        if (e.__mocked_hov_container) {\n          hovCNodeEl = e.__mocked_hov_container;\n        } else {\n          const hovNodeEl = document.elementFromPoint(trgCoord.x, trgCoord.y-1);\n          hovCNodeEl = hovNodeEl ? hovNodeEl.closest(\".group-or-rule-container\") : null;\n          if (!hovCNodeEl && hovNodeEl && hovNodeEl.classList.contains(\"query-builder-container\")) {\n            // fix 2022-01-24 - get root .group-or-rule-container\n            const rootGroupContainer = hovNodeEl?.firstChild?.firstChild;\n            if (rootGroupContainer && rootGroupContainer.classList.contains(\"group-or-rule-container\")) {\n              hovCNodeEl = rootGroupContainer;\n            }\n          }\n        }\n        if (!hovCNodeEl) {\n          logger.log(\"out of tree bounds!\");\n        } else {\n          const isGroup = hovCNodeEl.classList.contains(\"group-container\");\n          const hovNodeId = hovCNodeEl.getAttribute(\"data-id\");\n          const hovEl = hovCNodeEl;\n          let doAppend = false;\n          let doPrepend = false;\n          if (hovEl) {\n            hovRect = hovEl.getBoundingClientRect();\n            const hovHeight = hovRect.bottom - hovRect.top;\n            const hovII = this.tree.items[hovNodeId];\n            let trgRect = null,\n              trgEl = null,\n              trgII = null,\n              altII = null; //for canMoveBeforeAfterGroup\n\n            if (dragDirs.vrt == 0) {\n              trgII = itemInfo;\n              trgEl = plhEl;\n              if (trgEl)\n                trgRect = trgEl.getBoundingClientRect();\n            } else {\n              if (isGroup) {\n                if (dragDirs.vrt > 0) { //down\n                  //take group header (for prepend only)\n                  const hovInnerEl = hovCNodeEl.getElementsByClassName(\"group--header\");\n                  const hovEl2 = hovInnerEl.length ? hovInnerEl[0] : null;\n                  if (hovEl2) {\n                    const hovRect2 = hovEl2.getBoundingClientRect();\n                    const hovHeight2 = hovRect2.bottom - hovRect2.top;\n                    const isOverHover = ((dragRect.bottom - hovRect2.top) > hovHeight2*3/4);\n                    if (isOverHover && hovII.top > dragInfo.itemInfo.top) {\n                      trgII = hovII;\n                      trgRect = hovRect2;\n                      trgEl = hovEl2;\n                      doPrepend = true;\n                    }\n                  }\n                } else if (dragDirs.vrt < 0) { //up\n                  if (hovII.lev >= itemInfo.lev) {\n                    //take whole group\n                    const isClimbToHover = ((hovRect.bottom - dragRect.top) >= 2);\n                    if (isClimbToHover && hovII.top < dragInfo.itemInfo.top) {\n                      trgII = hovII;\n                      trgRect = hovRect;\n                      trgEl = hovEl;\n                      doAppend = true;\n                    }\n                  }\n                }\n                if (!doPrepend && !doAppend || canMoveBeforeAfterGroup) {\n                  //take whole group and check if we can move before/after group\n                  const isOverHover = (dragDirs.vrt < 0 //up\n                    ? ((hovRect.bottom - dragRect.top) > (hovHeight-5))\n                    : ((dragRect.bottom - hovRect.top) > (hovHeight-5)));\n                  if (isOverHover) {\n                    if (!doPrepend && !doAppend) {\n                      trgII = hovII;\n                      trgRect = hovRect;\n                      trgEl = hovEl;\n                    }\n                    if (canMoveBeforeAfterGroup) {\n                      altII = hovII;\n                    }\n                  }\n                }\n              } else {\n                //check if we can move before/after group\n                const isOverHover = (dragDirs.vrt < 0 //up\n                  ? ((hovRect.bottom - dragRect.top) > hovHeight/2)\n                  : ((dragRect.bottom - hovRect.top) > hovHeight/2));\n                if (isOverHover) {\n                  trgII = hovII;\n                  trgRect = hovRect;\n                  trgEl = hovEl;\n                }\n              }\n            }\n\n            const isSamePos = (trgII && trgII.id == dragId);\n            if (trgRect) {\n              const dragLeftOffset = dragRect.left - treeRect.left;\n              const trgLeftOffset = trgRect.left - treeRect.left;\n              const _trgLev = trgLeftOffset / paddingLeft;\n              const dragLev = Math.max(0, Math.round(dragLeftOffset / paddingLeft));\n\n              //find all possible moves\n              let availMoves = [];\n              let altMoves = []; //alternatively can move after/before group, if can't move into it\n              if (isSamePos) {\n                //do nothing\n              } else {\n                if (isGroup) {\n                  if (doAppend) {\n                    availMoves.push([constants.PLACEMENT_APPEND, trgII, trgII.lev+1]);\n                  } else if (doPrepend) {\n                    availMoves.push([constants.PLACEMENT_PREPEND, trgII, trgII.lev+1]);\n                  }\n                  //alt\n                  if (canMoveBeforeAfterGroup && altII) {\n                    // fix 2022-01-24: do prepend/append instead of before/after for root\n                    const isToRoot = altII.lev == 0;\n                    // fix 2022-01-25: fix prepend/append instead of before/after for case_group\n                    const isToCase = altII.type == \"case_group\" && itemInfo.type != \"case_group\";\n                    let prevCaseId = altII.prev && this.tree.items[altII.prev].caseId;\n                    let nextCaseId = altII.next && this.tree.items[altII.next].caseId;\n                    if (itemInfo.caseId == prevCaseId)\n                      prevCaseId = null;\n                    if (itemInfo.caseId == nextCaseId)\n                      nextCaseId = null;\n                    const prevCase = prevCaseId && this.tree.items[prevCaseId];\n                    const nextCase = nextCaseId && this.tree.items[nextCaseId];\n\n                    if (dragDirs.vrt > 0) { //down\n                      if (isToRoot) {\n                        altMoves.push([constants.PLACEMENT_APPEND, altII, altII.lev+1]);\n                      } else if (isToCase && nextCase) {\n                        altMoves.push([constants.PLACEMENT_PREPEND, nextCase, nextCase.lev+1]);\n                      } else {\n                        altMoves.push([constants.PLACEMENT_AFTER, altII, altII.lev]);\n                      }\n                    } else if (dragDirs.vrt < 0) { //up\n                      if (isToRoot) {\n                        altMoves.push([constants.PLACEMENT_PREPEND, altII, altII.lev+1]);\n                      } else if (isToCase && prevCase) {\n                        altMoves.push([constants.PLACEMENT_APPEND, prevCase, prevCase.lev+1]);\n                      } else {\n                        altMoves.push([constants.PLACEMENT_BEFORE, altII, altII.lev]);\n                      }\n                    }\n                  }\n                }\n                if (!doAppend && !doPrepend) {\n                  if (dragDirs.vrt < 0) { //up\n                    availMoves.push([constants.PLACEMENT_BEFORE, trgII, trgII.lev]);\n                  } else if (dragDirs.vrt > 0) { //down\n                    availMoves.push([constants.PLACEMENT_AFTER, trgII, trgII.lev]);\n                  }\n                }\n              }\n              \n              //add case\n              const addCaseII = am => {\n                const toII = am[1];\n                const fromCaseII = itemInfo.caseId ? this.tree.items[itemInfo.caseId] : null;\n                const toCaseII = toII.caseId ? this.tree.items[toII.caseId] : null;\n                return [...am, fromCaseII, toCaseII];\n              };\n              availMoves = availMoves.map(addCaseII);\n              altMoves = altMoves.map(addCaseII);\n\n              //sanitize\n              availMoves = availMoves.filter(am => {\n                const placement = am[0];\n                const trg = am[1];\n                if ((placement == constants.PLACEMENT_BEFORE || placement == constants.PLACEMENT_AFTER) && trg.parent == null)\n                  return false;\n                if (trg.collapsed && (placement == constants.PLACEMENT_APPEND || placement == constants.PLACEMENT_PREPEND))\n                  return false;\n\n                let isInside = (trg.id == itemInfo.id);\n                if (!isInside) {\n                  let tmp = trg;\n                  while (tmp.parent) {\n                    tmp = this.tree.items[tmp.parent];\n                    if (tmp.id == itemInfo.id) {\n                      isInside = true;\n                      break;\n                    }\n                  }\n                }\n                return !isInside;\n              }).map(am => {\n                const placement = am[0],\n                  toII = am[1],\n                  _lev = am[2],\n                  _fromCaseII = am[3],\n                  _toCaseII = am[4];\n                let toParentII = null;\n                if (placement == constants.PLACEMENT_APPEND || placement == constants.PLACEMENT_PREPEND)\n                  toParentII = toII;\n                else\n                  toParentII = this.tree.items[toII.parent];\n                if (toParentII && toParentII.parent == null)\n                  toParentII = null;\n                am[5] = toParentII;\n                return am;\n              });\n\n              let bestMode = null;\n              let filteredMoves = availMoves.filter(am => this.canMove(itemInfo, am[1], am[0], am[3], am[4], am[5], canMoveFn));\n              if (canMoveBeforeAfterGroup && filteredMoves.length == 0 && altMoves.length > 0) {\n                filteredMoves = altMoves.filter(am => this.canMove(itemInfo, am[1], am[0], am[3], am[4], am[5], canMoveFn));\n              }\n              const levs = filteredMoves.map(am => am[2]);\n              const curLev = itemInfo.lev;\n              const allLevs = levs.concat(curLev);\n              let closestDragLev = null;\n              if (allLevs.indexOf(dragLev) != -1)\n                closestDragLev = dragLev;\n              else if (dragLev > Math.max(...allLevs))\n                closestDragLev = Math.max(...allLevs);\n              else if (dragLev < Math.min(...allLevs))\n                closestDragLev = Math.min(...allLevs);\n              bestMode = filteredMoves.find(am => am[2] == closestDragLev);\n              if (!isSamePos && !bestMode && filteredMoves.length)\n                bestMode = filteredMoves[0];\n              moveInfo = bestMode;\n            }\n          }\n        }\n      }\n\n      if (moveInfo) {\n        this.move(itemInfo, moveInfo[1], moveInfo[0], moveInfo[3]);\n\n        // logger.log(\"DRAG-N-DROP\", JSON.stringify({\n        //   dragRect,\n        //   plhRect,\n        //   treeRect,\n        //   hovRect,\n        //   startMousePos: dragInfo.startMousePos,\n        //   mousePos: dragInfo.mousePos,\n        // }));\n        return true;\n      }\n\n      return false;\n    }\n\n    canMove (fromII, toII, placement, fromCaseII, toCaseII, toParentII, canMoveFn) {\n      if (!fromII || !toII)\n        return false;\n      if (fromII.id === toII.id)\n        return false;\n\n      const { canRegroup, canRegroupCases, maxNesting, maxNumberOfRules, canLeaveEmptyCase } = this.props.config.settings;\n      const newLev = toParentII ? toParentII.lev + 1 : toII.lev;\n      const isBeforeAfter = placement == constants.PLACEMENT_BEFORE || placement == constants.PLACEMENT_AFTER;\n      const isPend = placement == constants.PLACEMENT_PREPEND || placement == constants.PLACEMENT_APPEND;\n      const isLev1 = isBeforeAfter && toII.lev == 1 || isPend && toII.lev == 0;\n      const isParentChange = fromII.parent != toII.parent;\n      const isStructChange = isPend || isParentChange;\n      // can't move `case_group` anywhere but before/after anoter `case_group`\n      const isForbiddenStructChange = fromII.type == \"case_group\" && !isLev1\n        // can't restruct `rule_group`\n        || fromII.parentType == \"rule_group\" || toII.type == \"rule_group\" || toII.parentType == \"rule_group\" \n        // only `case_group` can be placed under `switch_group`\n        || fromII.type != \"case_group\" && toII.type == \"case_group\" && isBeforeAfter\n        || fromII.type != \"case_group\" && toII.type == \"switch_group\"\n        // can't move rule/group to another case\n        || !canRegroupCases && fromII.caseId != toII.caseId;\n      const isLockedChange = toII.isLocked || fromII.isLocked || toParentII && toParentII.isLocked;\n\n      if (maxNesting && newLev > maxNesting)\n        return false;\n      \n      if (isStructChange && (!canRegroup || isForbiddenStructChange || isLockedChange))\n        return false;\n      \n      if (fromII.type != \"case_group\" && fromII.caseId != toII.caseId) {\n        const isLastFromCase = fromCaseII ? fromCaseII._height == 2 : false;\n        const newRulesInTargetCase = toCaseII ? toCaseII.leafsCount + 1 : 0;\n        if (maxNumberOfRules && newRulesInTargetCase > maxNumberOfRules)\n          return false;\n        if (isLastFromCase && !canLeaveEmptyCase)\n          return false;\n      }\n\n      if (fromII.type == \"case_group\" && (\n        fromII.isDefaultCase || toII.isDefaultCase\n        || toII.type == \"switch_group\" && placement == constants.PLACEMENT_APPEND\n      )) {\n        // leave default case alone\n        return false;\n      }\n\n      let res = true;\n      if (canMoveFn) {\n        res = canMoveFn(fromII.node.toJS(), toII.node.toJS(), placement, toParentII ? toParentII.node.toJS() : null);\n      }\n      return res;\n    }\n\n    move (fromII, toII, placement, toParentII) {\n      if (!this._isUsingLegacyReactDomRender) {\n        _isReorderingTree = true;\n      }\n      //logger.log(\"move\", fromII, toII, placement, toParentII);\n      this.props.actions.moveItem(fromII.path, toII.path, placement);\n    }\n\n    render() {\n      return <Builder\n        {...this.props}\n        onDragStart={this.onDragStart}\n      />;\n    }\n  };\n\n\nexport default (Builder, CanMoveFn = null) => {\n  const ConnectedSortableContainer = connect(\n    (state) => {\n      return {\n        dragging: state.dragging,\n        dragStart: state.dragStart,\n        mousePos: state.mousePos,\n      };\n    }, {\n      setDragStart: actions.drag.setDragStart,\n      setDragProgress: actions.drag.setDragProgress,\n      setDragEnd: actions.drag.setDragEnd,\n    },\n    null,\n    {\n      context\n    }\n  )(createSortableContainer(Builder, CanMoveFn));\n  ConnectedSortableContainer.displayName = \"ConnectedSortableContainer\";\n\n  return ConnectedSortableContainer;\n};\n\nexport { _isReorderingTree };\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { _isReorderingTree } from \"./SortableContainer\";\nconst classNames = require(\"classnames\");\n\n\nexport default (className) => (GroupOrRule) =>\n  class Draggable extends PureComponent {\n    static propTypes = {\n      isDraggingTempo: PropTypes.bool,\n      isDraggingMe: PropTypes.bool,\n      onDragStart: PropTypes.func,\n      dragging: PropTypes.object, //{id, x, y, w, h}\n      isLocked: PropTypes.bool,\n      isTrueLocked: PropTypes.bool,\n    };\n\n    constructor(props) {\n      super(props);\n      this.wrapper = React.createRef();\n    }\n\n    handleDraggerMouseDown = (e) => {\n      var nodeId = this.props.id;\n      var dom = this.wrapper.current;\n        \n      if (this.props.onDragStart) {\n        this.props.onDragStart(nodeId, dom, e);\n      }\n    };\n\n    render () {\n      const {\n        isDraggingTempo,\n        isDraggingMe,\n        dragging,\n        ...otherProps\n      } = this.props;\n      const {\n        isTrueLocked,\n      } = otherProps;\n\n      let styles = {};\n      if (isDraggingMe && isDraggingTempo) {\n        if (_isReorderingTree) {\n          // don't apply old styles for dragging tempo during reorder\n        } else {\n          styles = {\n            top: dragging.y,\n            left: dragging.x,\n            width: dragging.w\n          };\n        }\n      }\n\n      const cn = classNames(className, \"group-or-rule\",\n        isDraggingMe && isDraggingTempo ? \"qb-draggable\" : null,\n        isDraggingMe && !isDraggingTempo ? \"qb-placeholder\" : null,\n        isTrueLocked ? \"locked\" : null\n      );\n\n      return (\n        <div\n          className={cn}\n          style={styles}\n          ref={this.wrapper}\n          data-id={this.props.id}\n        >\n          <GroupOrRule\n            handleDraggerMouseDown={this.handleDraggerMouseDown}\n            isDraggingMe={isDraggingMe}\n            isDraggingTempo={isDraggingTempo}\n            {...otherProps}\n          />\n        </div>\n      );\n    }\n\n  };\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {getFieldConfig, getOperatorConfig} from \"../../utils/configUtils\";\nimport keys from \"lodash/keys\";\nimport pickBy from \"lodash/pickBy\";\nimport mapValues from \"lodash/mapValues\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\n\n\nexport default class Operator extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    selectedField: PropTypes.string,\n    selectedOperator: PropTypes.string,\n    readonly: PropTypes.bool,\n    //actions\n    setOperator: PropTypes.func.isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForMeta = [\"config\", \"selectedField\", \"selectedOperator\"];\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  getMeta({config, selectedField, selectedOperator}) {\n    const fieldConfig = getFieldConfig(config, selectedField);\n    const operators = fieldConfig?.operators;\n    const operatorOptions \n      = mapValues(\n        pickBy(\n          config.operators, \n          (item, key) => operators?.indexOf(key) !== -1\n        ), \n        (_opts, op) => getOperatorConfig(config, op, selectedField)\n      );\n      \n    const items = this.buildOptions(config, operatorOptions, operators);\n\n    const isOpSelected = !!selectedOperator;\n    const currOp = isOpSelected ? operatorOptions[selectedOperator] : null;\n    const selectedOpts = currOp || {};\n    const placeholder = this.props.config.settings.operatorPlaceholder;\n    const selectedKey = selectedOperator;\n    const selectedKeys = isOpSelected ? [selectedKey] : null;\n    const selectedPath = selectedKeys;\n    const selectedLabel = selectedOpts.label;\n    \n    return {\n      placeholder, items,\n      selectedKey, selectedKeys, selectedPath, selectedLabel, selectedOpts, fieldConfig\n    };\n  }\n\n  buildOptions(config, fields, ops) {\n    if (!fields || !ops)\n      return null;\n\n    return keys(fields).sort((a, b) => (ops.indexOf(a) - ops.indexOf(b))).map(fieldKey => {\n      const field = fields[fieldKey];\n      const label = field.label;\n      return {\n        key: fieldKey,\n        path: fieldKey,\n        label,\n      };\n    });\n  }\n\n  render() {\n    const {config, customProps, setOperator, readonly, id, groupId} = this.props;\n    const {renderOperator} = config.settings;\n    const renderProps = {\n      id,\n      groupId,\n      config, \n      customProps, \n      readonly,\n      setField: setOperator,\n      ...this.meta\n    };\n    if (!renderProps.items)\n      return null;\n    return renderOperator(renderProps);\n  }\n\n\n}\n","import React, { PureComponent } from \"react\";\nimport Operator from \"./Operator\";\nimport {Col} from \"../utils\";\n\n\nexport default class OperatorWrapper extends PureComponent {\n  render() {\n    const {\n      config, selectedField, selectedOperator, setOperator, \n      selectedFieldPartsLabels, showOperator, showOperatorLabel, selectedFieldWidgetConfig, readonly, id, groupId\n    } = this.props;\n    const operator = showOperator\n            && <Col key={\"operators-for-\"+(selectedFieldPartsLabels || []).join(\"_\")} className=\"rule--operator\">\n              { config.settings.showLabels\n                    && <label className=\"rule--label\">{config.settings.operatorLabel}</label>\n              }\n              <Operator\n                key=\"operator\"\n                config={config}\n                selectedField={selectedField}\n                selectedOperator={selectedOperator}\n                setOperator={setOperator}\n                readonly={readonly}\n                id={id}\n                groupId={groupId}\n              />\n            </Col>;\n    const hiddenOperator = showOperatorLabel\n            && <Col key={\"operators-for-\"+(selectedFieldPartsLabels || []).join(\"_\")} className=\"rule--operator\">\n              <div className=\"rule--operator\">\n                {config.settings.showLabels\n                  ? <label className=\"rule--label\">&nbsp;</label>\n                  : null}\n                <span>{selectedFieldWidgetConfig.operatorInlineLabel}</span>\n              </div>\n            </Col>;\n    return [\n      operator,\n      hiddenOperator\n    ];\n  }\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {getFieldConfig} from \"../../utils/configUtils\";\nimport {getFieldPath, getFieldPathLabels} from \"../../utils/ruleUtils\";\nimport {truncateString} from \"../../utils/stuff\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport last from \"lodash/last\";\nimport keys from \"lodash/keys\";\n\n\nexport default class Field extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    selectedField: PropTypes.string,\n    parentField: PropTypes.string,\n    customProps: PropTypes.object,\n    readonly: PropTypes.bool,\n    //actions\n    setField: PropTypes.func.isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForMeta = [\"selectedField\", \"config\", \"parentField\"];\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  getMeta({selectedField, config, parentField}) {\n    const selectedKey = selectedField;\n    const {maxLabelsLength, fieldSeparatorDisplay, fieldPlaceholder, fieldSeparator} = config.settings;\n    const isFieldSelected = !!selectedField;\n    const placeholder = !isFieldSelected ? truncateString(fieldPlaceholder, maxLabelsLength) : null;\n    const currField = isFieldSelected ? getFieldConfig(config, selectedKey) : null;\n    const selectedOpts = currField || {};\n\n    const selectedKeys = getFieldPath(selectedKey, config);\n    const selectedPath = getFieldPath(selectedKey, config, true);\n    const selectedLabel = this.getFieldLabel(currField, selectedKey, config);\n    const partsLabels = getFieldPathLabels(selectedKey, config);\n    let selectedFullLabel = partsLabels ? partsLabels.join(fieldSeparatorDisplay) : null;\n    if (selectedFullLabel == selectedLabel || parentField)\n      selectedFullLabel = null;\n    const selectedAltLabel = selectedOpts.label2;\n\n    const parentFieldPath = typeof parentField == \"string\" ? parentField.split(fieldSeparator) : parentField;\n    const parentFieldConfig = parentField ? getFieldConfig(config, parentField) : null;\n    const sourceFields = parentField ? parentFieldConfig && parentFieldConfig.subfields : config.fields;\n    const items = this.buildOptions(parentFieldPath, config, sourceFields, parentFieldPath);\n\n    return {\n      placeholder, items, parentField,\n      selectedKey, selectedKeys, selectedPath, selectedLabel, selectedOpts, selectedAltLabel, selectedFullLabel,\n    };\n  }\n\n  getFieldLabel(fieldOpts, fieldKey, config) {\n    if (!fieldKey) return null;\n    let fieldSeparator = config.settings.fieldSeparator;\n    let maxLabelsLength = config.settings.maxLabelsLength;\n    let fieldParts = Array.isArray(fieldKey) ? fieldKey : fieldKey.split(fieldSeparator);\n    let label = fieldOpts && fieldOpts.label || last(fieldParts);\n    label = truncateString(label, maxLabelsLength);\n    return label;\n  }\n\n  buildOptions(parentFieldPath, config, fields, path = null, optGroupLabel = null) {\n    if (!fields)\n      return null;\n    const {fieldSeparator, fieldSeparatorDisplay} = config.settings;\n    const prefix = path ? path.join(fieldSeparator) + fieldSeparator : \"\";\n\n    return keys(fields).map(fieldKey => {\n      const field = fields[fieldKey];\n      const label = this.getFieldLabel(field, fieldKey, config);\n      const partsLabels = getFieldPathLabels(prefix+fieldKey, config);\n      let fullLabel = partsLabels.join(fieldSeparatorDisplay);\n      if (fullLabel == label || parentFieldPath)\n        fullLabel = null;\n      const altLabel = field.label2;\n      const tooltip = field.tooltip;\n      const subpath = (path ? path : []).concat(fieldKey);\n      const disabled = field.disabled;\n            \n      if (field.hideForSelect)\n        return undefined;\n\n      if (field.type == \"!struct\") {\n        return {\n          disabled,\n          key: fieldKey,\n          path: prefix+fieldKey,\n          label,\n          fullLabel,\n          altLabel,\n          tooltip,\n          items: this.buildOptions(parentFieldPath, config, field.subfields, subpath, label)\n        };\n      } else {\n        return {\n          disabled,\n          key: fieldKey,\n          path: prefix+fieldKey,\n          label,\n          fullLabel,\n          altLabel,\n          tooltip,\n          grouplabel: optGroupLabel\n        };\n      }\n    }).filter(o => !!o);\n  }\n\n  render() {\n    const {config, customProps, setField, readonly, id, groupId} = this.props;\n    const {renderField} = config.settings;\n    const renderProps = {\n      id,\n      groupId,\n      config, \n      customProps, \n      readonly,\n      setField,\n      ...this.meta\n    };\n    return renderField(renderProps);\n  }\n\n}\n","import React, { PureComponent } from \"react\";\nimport Field from \"./Field\";\nimport {Col} from \"../utils\";\n\n\nexport default class FieldWrapper extends PureComponent {\n  render() {\n    const {config, selectedField, setField, parentField, classname, readonly, id, groupId} = this.props;\n    return (\n      <Col className={classname}>\n        { config.settings.showLabels\n                    && <label className=\"rule--label\">{config.settings.fieldLabel}</label>\n        }\n        <Field\n          config={config}\n          selectedField={selectedField}\n          parentField={parentField}\n          setField={setField}\n          customProps={config.settings.customFieldSelectProps}\n          readonly={readonly}\n          id={id}\n          groupId={groupId}\n        />\n      </Col>\n    );\n  }\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {getOperatorConfig} from \"../../utils/configUtils\";\n\nexport default class OperatorOptions extends PureComponent {\n  static propTypes = {\n    config: PropTypes.object.isRequired,\n    operatorOptions: PropTypes.any.isRequired, //instanceOf(Immutable.Map)\n    selectedField: PropTypes.string.isRequired,\n    selectedOperator: PropTypes.string.isRequired,\n    readonly: PropTypes.bool,\n    //actions\n    setOperatorOption: PropTypes.func.isRequired,\n  };\n\n  render() {\n    if (!this.props.selectedOperator)\n      return null;\n    const operatorDefinitions = getOperatorConfig(this.props.config, this.props.selectedOperator, this.props.selectedField);\n    if (typeof operatorDefinitions.options === \"undefined\") {\n      return null;\n    }\n\n    const { factory: optionsFactory, ...basicOptionsProps } = operatorDefinitions.options;\n    const optionsProps = Object.assign({}, basicOptionsProps, {\n      config: this.props.config,\n      field: this.props.selectedField,\n      operator: this.props.selectedOperator,\n      options: this.props.operatorOptions,\n      setOption: this.props.setOperatorOption,\n      readonly: this.props.readonly,\n    });\n    const optionsCmp = optionsFactory(optionsProps);\n    const name = this.props.selectedOperator;\n\n    return (\n      <div className={`rule--operator rule--operator--${name.toUpperCase()}`}>\n        {optionsCmp}\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport RuleContainer from \"../containers/RuleContainer\";\nimport Draggable from \"../containers/Draggable\";\nimport OperatorWrapper from \"../rule/OperatorWrapper\";\nimport FieldWrapper from \"../rule/FieldWrapper\";\nimport Widget from \"../rule/Widget\";\nimport OperatorOptions from \"../rule/OperatorOptions\";\nimport {getFieldConfig, getOperatorConfig, getFieldWidgetConfig} from \"../../utils/configUtils\";\nimport {getFieldPathLabels, getValueSourcesForFieldOp} from \"../../utils/ruleUtils\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {Col, DragIcon, dummyFn, ConfirmFn} from \"../utils\";\nconst classNames = require(\"classnames\");\n\n\n@RuleContainer\n@Draggable(\"rule\")\n@ConfirmFn\nclass Rule extends PureComponent {\n  static propTypes = {\n    id: PropTypes.string.isRequired,\n    groupId: PropTypes.string,\n    selectedField: PropTypes.string,\n    selectedOperator: PropTypes.string,\n    operatorOptions: PropTypes.object,\n    config: PropTypes.object.isRequired,\n    value: PropTypes.any, //depends on widget\n    valueSrc: PropTypes.any,\n    asyncListValues: PropTypes.array,\n    isDraggingMe: PropTypes.bool,\n    isDraggingTempo: PropTypes.bool,\n    parentField: PropTypes.string, //from RuleGroup\n    valueError: PropTypes.any,\n    isLocked: PropTypes.bool,\n    isTrueLocked: PropTypes.bool,\n    //path: PropTypes.instanceOf(Immutable.List),\n    //actions\n    handleDraggerMouseDown: PropTypes.func,\n    setField: PropTypes.func,\n    setOperator: PropTypes.func,\n    setOperatorOption: PropTypes.func,\n    setLock: PropTypes.func,\n    removeSelf: PropTypes.func,\n    setValue: PropTypes.func,\n    setValueSrc: PropTypes.func,\n    reordableNodesCnt: PropTypes.number,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n    this.removeSelf = this.removeSelf.bind(this);\n    this.setLock = this.setLock.bind(this);\n\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n    const prevProps = this.props;\n    const keysForMeta = [\"selectedField\", \"selectedOperator\", \"config\", \"reordableNodesCnt\", \"isLocked\"];\n    const needUpdateMeta = !this.meta || keysForMeta.map(k => (nextProps[k] !== prevProps[k])).filter(ch => ch).length > 0;\n\n    if (needUpdateMeta) {\n      this.meta = this.getMeta(nextProps);\n    }\n  }\n\n  getMeta({selectedField, selectedOperator, config, reordableNodesCnt, isLocked}) {\n    const selectedFieldPartsLabels = getFieldPathLabels(selectedField, config);\n    const selectedFieldConfig = getFieldConfig(config, selectedField);\n    const isSelectedGroup = selectedFieldConfig && selectedFieldConfig.type == \"!struct\";\n    const isFieldAndOpSelected = selectedField && selectedOperator && !isSelectedGroup;\n    const selectedOperatorConfig = getOperatorConfig(config, selectedOperator, selectedField);\n    const selectedOperatorHasOptions = selectedOperatorConfig && selectedOperatorConfig.options != null;\n    const selectedFieldWidgetConfig = getFieldWidgetConfig(config, selectedField, selectedOperator) || {};\n    const hideOperator = selectedFieldWidgetConfig.hideOperator;\n\n    const showDragIcon = config.settings.canReorder && reordableNodesCnt > 1 && !isLocked;\n    const showOperator = selectedField && !hideOperator;\n    const showOperatorLabel = selectedField && hideOperator && selectedFieldWidgetConfig.operatorInlineLabel;\n    const showWidget = isFieldAndOpSelected;\n    const showOperatorOptions = isFieldAndOpSelected && selectedOperatorHasOptions;\n\n    return {\n      selectedFieldPartsLabels, selectedFieldWidgetConfig,\n      showDragIcon, showOperator, showOperatorLabel, showWidget, showOperatorOptions\n    };\n  }\n\n  setLock(lock) {\n    this.props.setLock(lock);\n  }\n\n  removeSelf() {\n    const {confirmFn} = this.props;\n    const {renderConfirm, removeRuleConfirmOptions: confirmOptions} = this.props.config.settings;\n    const doRemove = () => {\n      this.props.removeSelf();\n    };\n    if (confirmOptions && !this.isEmptyCurrentRule()) {\n      renderConfirm({...confirmOptions,\n        onOk: doRemove,\n        onCancel: null,\n        confirmFn: confirmFn\n      });\n    } else {\n      doRemove();\n    }\n  }\n\n  isEmptyCurrentRule() {\n    return !(\n      this.props.selectedField !== null\n            && this.props.selectedOperator !== null\n            && this.props.value.filter((val) => val !== undefined).size > 0\n    );\n  }\n\n  renderField() {\n    const {config, isLocked} = this.props;\n    const { immutableFieldsMode } = config.settings;\n\n    return <FieldWrapper\n      key=\"field\"\n      classname={\"rule--field\"}\n      config={config}\n      selectedField={this.props.selectedField}\n      setField={!immutableFieldsMode ? this.props.setField : dummyFn}\n      parentField={this.props.parentField}\n      readonly={immutableFieldsMode || isLocked}\n      id={this.props.id}\n      groupId={this.props.groupId}\n    />;\n  }\n\n  renderOperator () {\n    const {config, isLocked} = this.props;\n    const {\n      selectedFieldPartsLabels, selectedFieldWidgetConfig, showOperator, showOperatorLabel\n    } = this.meta;\n    const { immutableOpsMode } = config.settings;\n\n    return <OperatorWrapper\n      key=\"operator\"\n      config={config}\n      selectedField={this.props.selectedField}\n      selectedOperator={this.props.selectedOperator}\n      setOperator={!immutableOpsMode ? this.props.setOperator : dummyFn}\n      selectedFieldPartsLabels={selectedFieldPartsLabels}\n      showOperator={showOperator}\n      showOperatorLabel={showOperatorLabel}\n      selectedFieldWidgetConfig={selectedFieldWidgetConfig}\n      readonly={immutableOpsMode || isLocked}\n      id={this.props.id}\n      groupId={this.props.groupId}\n    />;\n  }\n\n  renderWidget() {\n    const {config, valueError, isLocked} = this.props;\n    const { showWidget } = this.meta;\n    const { immutableValuesMode } = config.settings;\n    if (!showWidget) return null;\n\n    const widget = <Widget\n      key=\"values\"\n      field={this.props.selectedField}\n      parentField={this.props.parentField}\n      operator={this.props.selectedOperator}\n      value={this.props.value}\n      valueSrc={this.props.valueSrc}\n      asyncListValues={this.props.asyncListValues}\n      valueError={valueError}\n      config={config}\n      setValue={!immutableValuesMode ? this.props.setValue : dummyFn}\n      setValueSrc={!immutableValuesMode ? this.props.setValueSrc : dummyFn}\n      readonly={immutableValuesMode || isLocked}\n      id={this.props.id}\n      groupId={this.props.groupId}\n    />;\n\n    return (\n      <Col key={\"widget-for-\"+this.props.selectedOperator} className=\"rule--value\">\n        {widget}\n      </Col>\n    );\n  }\n\n  renderOperatorOptions() {\n    const {config} = this.props;\n    const { showOperatorOptions } = this.meta;\n    const { immutableOpsMode, immutableValuesMode } = config.settings;\n    if (!showOperatorOptions) return null;\n\n    const opOpts = <OperatorOptions\n      key=\"operatorOptions\"\n      selectedField={this.props.selectedField}\n      selectedOperator={this.props.selectedOperator}\n      operatorOptions={this.props.operatorOptions}\n      setOperatorOption={!immutableOpsMode ? this.props.setOperatorOption : dummyFn}\n      config={config}\n      readonly={immutableValuesMode}\n    />;\n\n    return (\n      <Col key={\"op-options-for-\"+this.props.selectedOperator} className=\"rule--operator-options\">\n        {opOpts}\n      </Col>\n    );\n  }\n\n  renderBeforeWidget() {\n    const {config} = this.props;\n    const { renderBeforeWidget } = config.settings;\n    return renderBeforeWidget \n        && <Col key={\"before-widget-for-\" +this.props.selectedOperator} className=\"rule--before-widget\">\n          {typeof renderBeforeWidget === \"function\" ? renderBeforeWidget(this.props) : renderBeforeWidget}\n        </Col>;\n  }\n\n  renderAfterWidget() {\n    const {config} = this.props;\n    const { renderAfterWidget } = config.settings;\n    return renderAfterWidget \n        && <Col key={\"after-widget-for-\" +this.props.selectedOperator} className=\"rule--after-widget\">\n          {typeof renderAfterWidget === \"function\" ? renderAfterWidget(this.props) : renderAfterWidget}\n        </Col>;\n  }\n\n  renderError() {\n    const {config, valueError} = this.props;\n    const { renderRuleError, showErrorMessage } = config.settings;\n    const oneValueError = valueError && valueError.toArray().filter(e => !!e).shift() || null;\n    return showErrorMessage && oneValueError \n        && <div className=\"rule--error\">\n          {renderRuleError ? renderRuleError({error: oneValueError}) : oneValueError}\n        </div>;\n  }\n\n  renderDrag() {\n    const { showDragIcon } = this.meta;\n\n    return showDragIcon\n        && <span\n          key=\"rule-drag-icon\"\n          className={\"qb-drag-handler rule--drag-handler\"}\n          onMouseDown={this.props.handleDraggerMouseDown}\n        ><DragIcon /> </span>;\n  }\n\n  renderDel() {\n    const {config, isLocked} = this.props;\n    const {\n      deleteLabel, \n      immutableGroupsMode, \n      renderButton: Btn,\n      canDeleteLocked\n    } = config.settings;\n\n    return !immutableGroupsMode && (!isLocked || isLocked && canDeleteLocked) && (\n      <Btn \n        type=\"delRule\" onClick={this.removeSelf} label={deleteLabel} config={config}\n      />\n    );\n  }\n\n  renderLock() {\n    const {config, isLocked, isTrueLocked, id} = this.props;\n    const {\n      lockLabel, lockedLabel, showLock,\n      renderSwitch: Switch\n    } = config.settings;\n      \n    return showLock && !(isLocked && !isTrueLocked) && (\n      <Switch \n        type=\"lock\" id={id} value={isLocked} setValue={this.setLock} label={lockLabel} checkedLabel={lockedLabel} hideLabel={true} config={config}\n      />\n    );\n  }\n\n  render () {\n    const { showOperatorOptions, selectedFieldWidgetConfig } = this.meta;\n    const { valueSrc, value, config } = this.props;\n    const canShrinkValue = valueSrc.first() == \"value\" && !showOperatorOptions && value.size == 1 && selectedFieldWidgetConfig.fullWidth;\n    const { renderButtonGroup: BtnGrp } = config.settings;\n\n    const parts = [\n      this.renderField(),\n      this.renderOperator(),\n      this.renderBeforeWidget(),\n      this.renderWidget(),\n      this.renderAfterWidget(),\n      this.renderOperatorOptions(),\n    ];\n    const body = <div key=\"rule-body\" className={classNames(\"rule--body\", canShrinkValue && \"can--shrink--value\")}>{parts}</div>;\n\n    const error = this.renderError();\n    const drag = this.renderDrag();\n    const lock = this.renderLock();\n    const del = this.renderDel();\n      \n    return (\n      <>\n        {drag}\n        <div className=\"rule--body--wrapper\">\n          {body}{error}\n        </div>\n        <div className=\"rule--header\">\n          <BtnGrp config={config}>\n            {lock}\n            {del}\n          </BtnGrp>\n        </div>\n      </>\n    );\n  }\n\n}\n\n\nexport default Rule;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport mapValues from \"lodash/mapValues\";\nimport context from \"../../stores/context\";\nimport {pureShouldComponentUpdate, useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {connect} from \"react-redux\";\nimport {defaultGroupConjunction} from \"../../utils/defaultUtils\";\n\n\nconst createGroupContainer = (Group) => \n  class GroupContainer extends Component {\n    static propTypes = {\n      //tree: PropTypes.instanceOf(Immutable.Map).isRequired,\n      config: PropTypes.object.isRequired,\n      actions: PropTypes.object.isRequired, //{setConjunction: Funciton, removeGroup, addGroup, addRule, ...}\n      path: PropTypes.any.isRequired, //instanceOf(Immutable.List)\n      id: PropTypes.string.isRequired,\n      groupId: PropTypes.string,\n      not: PropTypes.bool,\n      conjunction: PropTypes.string,\n      children1: PropTypes.any, //instanceOf(Immutable.OrderedMap)\n      onDragStart: PropTypes.func,\n      reordableNodesCnt: PropTypes.number,\n      field: PropTypes.string, // for RuleGroup\n      parentField: PropTypes.string, //from RuleGroup\n      isLocked: PropTypes.bool,\n      isTrueLocked: PropTypes.bool,\n      //connected:\n      dragging: PropTypes.object, //{id, x, y, w, h}\n      isDraggingTempo: PropTypes.bool,\n    };\n\n    constructor(props) {\n      super(props);\n      useOnPropsChanged(this);\n\n      this.selectedConjunction = this._selectedConjunction(props);\n      this.conjunctionOptions = this._getConjunctionOptions(props);\n      this.dummyFn.isDummyFn = true;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n      let prevProps = this.props;\n      let prevState = this.state;\n\n      let should = pureShouldComponentUpdate(this)(nextProps, nextState);\n      if (should) {\n        if (prevState == nextState && prevProps != nextProps) {\n          const draggingId = (nextProps.dragging.id || prevProps.dragging.id);\n          const isDraggingMe = draggingId == nextProps.id;\n          let chs = [];\n          for (let k in nextProps) {\n            let changed = (nextProps[k] != prevProps[k]);\n            if (k == \"dragging\" && !isDraggingMe) {\n              changed = false; //dragging another item -> ignore\n            }\n            if (changed) {\n              chs.push(k);\n            }\n          }\n          if (!chs.length)\n            should = false;\n        }\n      }\n      return should;\n    }\n\n    onPropsChanged(nextProps) {\n      const {config, id, conjunction} = nextProps;\n      const oldConfig = this.props.config;\n      const oldConjunction = this.props.conjunction;\n      if (oldConfig != config || oldConjunction != conjunction) {\n        this.selectedConjunction = this._selectedConjunction(nextProps);\n        this.conjunctionOptions = this._getConjunctionOptions(nextProps);\n      }\n    }\n\n    _getConjunctionOptions (props) {\n      return mapValues(props.config.conjunctions, (item, index) => ({\n        id: `conjunction-${props.id}-${index}`,\n        name: `conjunction[${props.id}]`,\n        key: index,\n        label: item.label,\n        checked: index === this._selectedConjunction(props),\n      }));\n    }\n\n    _selectedConjunction = (props) => {\n      props = props || this.props;\n      return props.conjunction || defaultGroupConjunction(props.config, props.field);\n    };\n\n    setConjunction = (conj = null) => {\n      this.props.actions.setConjunction(this.props.path, conj);\n    };\n\n    setNot = (not = null) => {\n      this.props.actions.setNot(this.props.path, not);\n    };\n\n    setLock = (lock = null) => {\n      this.props.actions.setLock(this.props.path, lock);\n    };\n\n    dummyFn = () => {};\n\n    removeSelf = () => {\n      this.props.actions.removeGroup(this.props.path);\n    };\n\n    addGroup = () => {\n      this.props.actions.addGroup(this.props.path);\n    };\n\n    addCaseGroup = () => {\n      this.props.actions.addCaseGroup(this.props.path);\n    };\n\n    addDefaultCaseGroup = () => {\n      this.props.actions.addDefaultCaseGroup(this.props.path);\n    };\n\n    addRule = () => {\n      this.props.actions.addRule(this.props.path);\n    };\n\n    // for RuleGroup\n    setField = (field) => {\n      this.props.actions.setField(this.props.path, field);\n    };\n\n    // for RuleGroupExt\n    setOperator = (operator) => {\n      this.props.actions.setOperator(this.props.path, operator);\n    };\n\n    setValue = (delta, value, type) => {\n      this.props.actions.setValue(this.props.path, delta, value, type);\n    };\n\n    render() {\n      const isDraggingMe = this.props.dragging.id == this.props.id;\n      const currentNesting = this.props.path.size;\n      const maxNesting = this.props.config.settings.maxNesting;\n      const isInDraggingTempo = !isDraggingMe && this.props.isDraggingTempo;\n\n      // Don't allow nesting further than the maximum configured depth and don't\n      // allow removal of the root group.\n      const allowFurtherNesting = typeof maxNesting === \"undefined\" || currentNesting < maxNesting;\n      const isRoot = currentNesting == 1;\n      return (\n        <div\n          className={\"group-or-rule-container group-container\"}\n          data-id={this.props.id}\n        >\n          {[\n            isDraggingMe ? <Group\n              key={\"dragging\"}\n              id={this.props.id}\n              groupId={this.props.groupId}\n              isDraggingMe={true}\n              isDraggingTempo={true}\n              dragging={this.props.dragging}\n              isRoot={isRoot}\n              allowFurtherNesting={allowFurtherNesting}\n              conjunctionOptions={this.conjunctionOptions}\n              not={this.props.not}\n              selectedConjunction={this.selectedConjunction}\n              setConjunction={this.dummyFn}\n              setNot={this.dummyFn}\n              setLock={this.dummyFn}\n              removeSelf={this.dummyFn}\n              addGroup={this.dummyFn}\n              addCaseGroup={this.dummyFn}\n              addDefaultCaseGroup={this.dummyFn}\n              addRule={this.dummyFn}\n              setField={this.dummyFn}\n              setOperator={this.dummyFn}\n              setValue={this.dummyFn}\n              value={this.props.value || null}\n              config={this.props.config}\n              children1={this.props.children1}\n              actions={this.props.actions}\n              //tree={this.props.tree}\n              reordableNodesCnt={this.props.reordableNodesCnt}\n              totalRulesCnt={this.props.totalRulesCnt}\n              selectedField={this.props.field || null}\n              parentField={this.props.parentField || null}\n              selectedOperator={this.props.operator || null}\n              isLocked={this.props.isLocked}\n              isTrueLocked={this.props.isTrueLocked}\n              parentReordableNodesCnt={this.props.parentReordableNodesCnt}\n            /> : null\n            ,\n            <Group\n              key={this.props.id}\n              id={this.props.id}\n              groupId={this.props.groupId}\n              isDraggingMe={isDraggingMe}\n              isDraggingTempo={isInDraggingTempo}\n              onDragStart={this.props.onDragStart}\n              isRoot={isRoot}\n              allowFurtherNesting={allowFurtherNesting}\n              conjunctionOptions={this.conjunctionOptions}\n              not={this.props.not}\n              selectedConjunction={this.selectedConjunction}\n              setConjunction={isInDraggingTempo ? this.dummyFn : this.setConjunction}\n              setNot={isInDraggingTempo ? this.dummyFn : this.setNot}\n              setLock={isInDraggingTempo ? this.dummyFn : this.setLock}\n              removeSelf={isInDraggingTempo ? this.dummyFn : this.removeSelf}\n              addGroup={isInDraggingTempo ? this.dummyFn : this.addGroup}\n              addCaseGroup={isInDraggingTempo ? this.dummyFn : this.addCaseGroup}\n              addDefaultCaseGroup={isInDraggingTempo ? this.dummyFn : this.addDefaultCaseGroup}\n              addRule={isInDraggingTempo ? this.dummyFn : this.addRule}\n              setField={isInDraggingTempo ? this.dummyFn : this.setField}\n              setOperator={isInDraggingTempo ? this.dummyFn : this.setOperator}\n              setValue={isInDraggingTempo ? this.dummyFn : this.setValue}\n              value={this.props.value || null}\n              config={this.props.config}\n              children1={this.props.children1}\n              actions={this.props.actions}\n              //tree={this.props.tree}\n              reordableNodesCnt={this.props.reordableNodesCnt}\n              totalRulesCnt={this.props.totalRulesCnt}\n              selectedField={this.props.field || null}\n              parentField={this.props.parentField || null}\n              selectedOperator={this.props.operator || null}\n              isLocked={this.props.isLocked}\n              isTrueLocked={this.props.isTrueLocked}\n              parentReordableNodesCnt={this.props.parentReordableNodesCnt}\n            />\n          ]}\n        </div>\n      );\n    }\n\n  };\n\n\nexport default (Group) => {\n  const ConnectedGroupContainer = connect(\n    (state) => {\n      return {\n        dragging: state.dragging,\n      };\n    },\n    null,\n    null,\n    {\n      context\n    }\n  )(createGroupContainer(Group));\n  ConnectedGroupContainer.displayName = \"ConnectedGroupContainer\";\n\n  return ConnectedGroupContainer;\n};\n","import React, { PureComponent } from \"react\";\n\nconst groupActionsPositionList = {\n  topLeft: \"group--actions--tl\",\n  topCenter: \"group--actions--tc\",\n  topRight: \"group--actions--tr\",\n  bottomLeft: \"group--actions--bl\",\n  bottomCenter: \"group--actions--bc\",\n  bottomRight: \"group--actions--br\"\n};\nconst defaultPosition = \"topRight\";\n\n\nexport class GroupActions extends PureComponent {\n  render() {\n    const {\n      config, \n      addRule, addGroup, removeSelf, setLock, isLocked, isTrueLocked, id,\n      canAddGroup, canAddRule, canDeleteGroup\n    } = this.props;\n    const {\n      immutableGroupsMode, addRuleLabel, addGroupLabel, delGroupLabel, groupActionsPosition, \n      renderButton: Btn, renderSwitch: Switch, renderButtonGroup: BtnGrp,\n      lockLabel, lockedLabel, showLock, canDeleteLocked,\n    } = config.settings;\n    const position = groupActionsPositionList[groupActionsPosition || defaultPosition];\n\n    const setLockSwitch = showLock && !(isLocked && !isTrueLocked) && <Switch \n      type=\"lock\" id={id} value={isLocked} setValue={setLock} label={lockLabel} checkedLabel={lockedLabel} config={config}\n    />;\n\n    const addRuleBtn = !immutableGroupsMode && canAddRule && !isLocked && <Btn\n      type=\"addRule\" onClick={addRule} label={addRuleLabel} readonly={isLocked} config={config}\n    />;\n    const addGroupBtn = !immutableGroupsMode && canAddGroup && !isLocked && <Btn\n      type=\"addGroup\" onClick={addGroup} label={addGroupLabel} readonly={isLocked} config={config}\n    />;\n    const delGroupBtn = !immutableGroupsMode && canDeleteGroup && (!isLocked || isLocked && canDeleteLocked) && <Btn\n      type=\"delGroup\" onClick={removeSelf} label={delGroupLabel} config={config}\n    />;\n\n    return (\n      <div className={`group--actions ${position}`}>\n        <BtnGrp config={config}>\n          {setLockSwitch}\n          {addRuleBtn}\n          {addGroupBtn}\n          {delGroupBtn}\n        </BtnGrp>\n      </div>\n    );\n  }\n}\n","import React, { Component, PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport startsWith from \"lodash/startsWith\";\nimport GroupContainer from \"../containers/GroupContainer\";\nimport Draggable from \"../containers/Draggable\";\nconst classNames = require(\"classnames\");\nimport { Item } from \"./Item\";\nimport {GroupActions} from \"./GroupActions\";\nimport {ConfirmFn, DragIcon, dummyFn} from \"../utils\";\n\nconst defaultPosition = \"topRight\";\n\n\nexport class BasicGroup extends PureComponent {\n  static propTypes = {\n    //tree: PropTypes.instanceOf(Immutable.Map).isRequired,\n    reordableNodesCnt: PropTypes.number,\n    conjunctionOptions: PropTypes.object.isRequired,\n    allowFurtherNesting: PropTypes.bool.isRequired,\n    isRoot: PropTypes.bool.isRequired,\n    not: PropTypes.bool,\n    selectedConjunction: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    id: PropTypes.string.isRequired,\n    groupId: PropTypes.string,\n    path: PropTypes.any, //instanceOf(Immutable.List)\n    children1: PropTypes.any, //instanceOf(Immutable.OrderedMap)\n    isDraggingMe: PropTypes.bool,\n    isDraggingTempo: PropTypes.bool,\n    isLocked: PropTypes.bool,\n    isTrueLocked: PropTypes.bool,\n    //actions\n    handleDraggerMouseDown: PropTypes.func,\n    onDragStart: PropTypes.func,\n    addRule: PropTypes.func.isRequired,\n    addGroup: PropTypes.func.isRequired,\n    removeSelf: PropTypes.func.isRequired,\n    setConjunction: PropTypes.func.isRequired,\n    setNot: PropTypes.func.isRequired,\n    setLock: PropTypes.func.isRequired,\n    actions: PropTypes.object.isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.removeSelf = this.removeSelf.bind(this);\n    this.setLock = this.setLock.bind(this);\n    this.renderItem = this.renderItem.bind(this);\n  }\n\n  isGroupTopPosition() {\n    return startsWith(this.props.config.settings.groupActionsPosition || defaultPosition, \"top\");\n  }\n\n  setLock(lock) {\n    this.props.setLock(lock);\n  }\n\n  removeSelf() {\n    const {confirmFn} = this.props;\n    const {renderConfirm, removeGroupConfirmOptions: confirmOptions} = this.props.config.settings;\n    const doRemove = () => {\n      this.props.removeSelf();\n    };\n    if (confirmOptions && !this.isEmptyCurrentGroup()) {\n      renderConfirm({...confirmOptions,\n        onOk: doRemove,\n        onCancel: null,\n        confirmFn: confirmFn\n      });\n    } else {\n      doRemove();\n    }\n  }\n\n  isEmptyCurrentGroup() {\n    const children = this.props.children1;\n    return !children || children.size == 0\n      || children.size == 1 && this.isEmpty(children.first());\n  }\n\n  isEmpty(item) {\n    const isGroup = (item.get(\"type\") == \"group\" || item.get(\"type\") == \"rule_group\");\n    return isGroup ? this.isEmptyGroup(item) : this.isEmptyRule(item);\n  }\n\n  isEmptyGroup(group) {\n    const children = group.get(\"children1\");\n    return !children || children.size == 0\n      || children.size == 1 && this.isEmpty(children.first());\n  }\n\n  isEmptyRule(rule) {\n    const properties = rule.get(\"properties\");\n    return !(\n      properties.get(\"field\") !== null\n          && properties.get(\"operator\") !== null\n          && properties.get(\"value\").filter((val) => val !== undefined).size > 0\n    );\n  }\n\n  render() {\n    return <>\n      {this.renderHeaderWrapper()}\n      {this.renderChildrenWrapper()}\n      {this.renderFooterWrapper()}\n    </>;\n  }\n\n  showNot() {\n    const {config} = this.props;\n    return config.settings.showNot;\n  }\n\n  // show conjs for 2+ children?\n  showConjs() {\n    const {conjunctionOptions, children1, config} = this.props;\n    const conjunctionCount = Object.keys(conjunctionOptions).length;\n    return conjunctionCount > 1 || this.showNot();\n  }\n\n  isOneChild() {\n    const {children1} = this.props;\n    return children1 ? children1.size < 2 : true;\n  }\n\n  renderChildrenWrapper() {\n    const {children1} = this.props;\n\n    return children1 && (\n      <div key=\"group-children\" className={classNames(\n        \"group--children\",\n        !this.showConjs() ? \"hide--conjs\" : \"\",\n        this.isOneChild() ? \"hide--line\" : \"\",\n        this.isOneChild() ? \"one--child\" : \"\",\n        this.childrenClassName()\n      )}>{this.renderChildren()}</div>\n    );\n  }\n\n  childrenClassName = () => \"\";\n\n  renderHeaderWrapper() {\n    const isGroupTopPosition = this.isGroupTopPosition();\n    return (\n      <div key=\"group-header\" className={classNames(\n        \"group--header\",\n        this.isOneChild() ? \"one--child\" : \"\",\n      )}>\n        {this.renderHeader()}\n        {isGroupTopPosition && this.renderBeforeActions()}\n        {isGroupTopPosition && this.renderActions()}\n        {isGroupTopPosition && this.renderAfterActions()}\n      </div>\n    );\n  }\n\n  renderFooterWrapper() {\n    const isGroupTopPosition = this.isGroupTopPosition();\n    return !isGroupTopPosition && (\n      <div key=\"group-footer\" className='group--footer'>\n        {this.renderBeforeActions()}\n        {this.renderActions()}\n        {this.renderAfterActions()}\n      </div>\n    );\n  }\n\n  renderBeforeActions = () => {\n    const BeforeActions = this.props.config.settings.renderBeforeActions;\n    if (BeforeActions == undefined)\n      return null;\n\n    return typeof BeforeActions === \"function\" ? <BeforeActions {...this.props}/> : BeforeActions;\n  };\n\n  renderAfterActions = () => {\n    const AfterActions = this.props.config.settings.renderAfterActions;\n    if (AfterActions == undefined)\n      return null;\n\n    return typeof AfterActions === \"function\" ? <AfterActions {...this.props}/> : AfterActions;\n  };\n\n  renderActions() {\n    const {config, addRule, addGroup, isLocked, isTrueLocked, id} = this.props;\n\n    return <GroupActions\n      config={config}\n      addRule={addRule}\n      addGroup={addGroup}\n      canAddGroup={this.canAddGroup()}\n      canAddRule={this.canAddRule()}\n      canDeleteGroup={this.canDeleteGroup()}\n      removeSelf={this.removeSelf}\n      setLock={this.setLock}\n      isLocked={isLocked}\n      isTrueLocked={isTrueLocked}\n      id={id}\n    />;\n  }\n\n  canAddGroup() {\n    return this.props.allowFurtherNesting;\n  }\n  canAddRule() {\n    const maxNumberOfRules = this.props.config.settings.maxNumberOfRules;\n    const totalRulesCnt = this.props.totalRulesCnt;\n    if (maxNumberOfRules) {\n      return totalRulesCnt < maxNumberOfRules;\n    }\n    return true;\n  }\n  canDeleteGroup() {\n    return !this.props.isRoot;\n  }\n\n  renderChildren() {\n    const {children1} = this.props;\n    return children1 ? children1.map(this.renderItem).toList() : null;\n  }\n\n  renderItem(item) {\n    const props = this.props;\n    const {config, actions, onDragStart, isLocked} = props;\n    const isRuleGroup = item.get(\"type\") == \"group\" && item.getIn([\"properties\", \"field\"]) != null;\n    const type = isRuleGroup ? \"rule_group\" : item.get(\"type\");\n    \n    return (\n      <Item\n        {...this.extraPropsForItem(item)}\n        key={item.get(\"id\")}\n        id={item.get(\"id\")}\n        groupId={props.id}\n        //path={props.path.push(item.get('id'))}\n        path={item.get(\"path\")}\n        type={type}\n        properties={item.get(\"properties\")}\n        config={config}\n        actions={actions}\n        children1={item.get(\"children1\")}\n        //tree={props.tree}\n        reordableNodesCnt={this.reordableNodesCntForItem(item)}\n        totalRulesCnt={this.totalRulesCntForItem(item)}\n        parentReordableNodesCnt={this.reordableNodesCnt()}\n        onDragStart={onDragStart}\n        isDraggingTempo={this.props.isDraggingTempo}\n        isParentLocked={isLocked}\n      />\n    );\n  }\n\n  extraPropsForItem(_item) {\n    return {};\n  }\n\n  reordableNodesCnt() {\n    if (this.props.isLocked)\n      return 0;\n    return this.props.reordableNodesCnt;\n  }\n\n  totalRulesCntForItem(_item) {\n    return this.props.totalRulesCnt;\n  }\n\n  reordableNodesCntForItem(_item) {\n    if (this.props.isLocked)\n      return 0;\n    return this.reordableNodesCnt();\n  }\n\n  showDragIcon() {\n    const { config, isRoot, isLocked } = this.props;\n    const reordableNodesCnt = this.reordableNodesCnt();\n    return config.settings.canReorder && !isRoot && reordableNodesCnt > 1 && !isLocked;\n  }\n\n  renderDrag() {\n    const { handleDraggerMouseDown } = this.props;\n    const drag = this.showDragIcon()\n      && <span\n        key=\"group-drag-icon\"\n        className={\"qb-drag-handler group--drag-handler\"}\n        onMouseDown={handleDraggerMouseDown}\n      ><DragIcon /> </span>;\n    return drag;\n  }\n\n  conjunctionOptions() {\n    const { conjunctionOptions } = this.props;\n    return conjunctionOptions;\n  }\n\n  renderConjs() {\n    const {\n      config, children1, id,\n      selectedConjunction, setConjunction, not, setNot, isLocked\n    } = this.props;\n\n    const {immutableGroupsMode, renderConjs: Conjs, showNot: _showNot, notLabel} = config.settings;\n    const conjunctionOptions = this.conjunctionOptions();\n    if (!this.showConjs())\n      return null;\n    if (!children1 || !children1.size)\n      return null;\n\n    const renderProps = {\n      disabled: this.isOneChild(),\n      readonly: immutableGroupsMode || isLocked,\n      selectedConjunction: selectedConjunction,\n      setConjunction: immutableGroupsMode ? dummyFn : setConjunction,\n      conjunctionOptions: conjunctionOptions,\n      config: config,\n      not: not || false,\n      id: id,\n      setNot: immutableGroupsMode ? dummyFn : setNot,\n      notLabel: notLabel,\n      showNot: this.showNot(),\n      isLocked: isLocked\n    };\n    return <Conjs {...renderProps} />;\n  }\n\n  renderHeader() {\n    return (\n      <div className={\"group--conjunctions\"}>\n        {this.renderConjs()}\n        {this.renderDrag()}\n      </div>\n    );\n  }\n}\n\nexport default GroupContainer(Draggable(\"group\")(ConfirmFn(BasicGroup)));\n","import React, { PureComponent } from \"react\";\n\nexport class RuleGroupActions extends PureComponent {\n  render() {\n    const {\n      config, \n      addRule, canAddRule, canDeleteGroup, removeSelf, \n      setLock, isLocked, isTrueLocked, id,\n    } = this.props;\n    const {\n      immutableGroupsMode, addRuleLabel, delGroupLabel,\n      renderButton: Btn, renderSwitch: Switch, renderButtonGroup: BtnGrp,\n      lockLabel, lockedLabel, showLock, canDeleteLocked,\n    } = config.settings;\n\n    const setLockSwitch = showLock && !(isLocked && !isTrueLocked) && <Switch \n      type=\"lock\" id={id} value={isLocked} setValue={setLock} label={lockLabel} checkedLabel={lockedLabel} hideLabel={true} config={config}\n    />;\n\n    const addRuleBtn = !immutableGroupsMode && canAddRule && !isLocked && <Btn \n      type=\"addRuleGroup\" onClick={addRule} label={addRuleLabel} readonly={isLocked} config={config}\n    />;\n\n    const delGroupBtn = !immutableGroupsMode && canDeleteGroup && (!isLocked || isLocked && canDeleteLocked) && <Btn \n      type=\"delRuleGroup\" onClick={removeSelf} label={delGroupLabel} config={config}\n    />;\n\n    return (\n      <div className={\"group--actions\"}>\n        <BtnGrp config={config}>\n          {setLockSwitch}\n          {addRuleBtn}\n          {delGroupBtn}\n        </BtnGrp>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport GroupContainer from \"../containers/GroupContainer\";\nimport Draggable from \"../containers/Draggable\";\nimport {BasicGroup} from \"./Group\";\nimport {RuleGroupActions} from \"./RuleGroupActions\";\nimport FieldWrapper from \"../rule/FieldWrapper\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {ConfirmFn} from \"../utils\";\n\n\n@GroupContainer\n@Draggable(\"group rule_group\")\n@ConfirmFn\nclass RuleGroup extends BasicGroup {\n  static propTypes = {\n    ...BasicGroup.propTypes,\n    selectedField: PropTypes.string,\n    parentField: PropTypes.string,\n    setField: PropTypes.func,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n  }\n\n  childrenClassName = () => \"rule_group--children\";\n  \n  renderHeaderWrapper = () => null;\n  renderFooterWrapper = () => null;\n  renderConjs = () => null;\n  canAddGroup = () => false;\n  canAddRule = () => true;\n  canDeleteGroup = () => false;\n\n  reordableNodesCntForItem(_item) {\n    if (this.props.isLocked)\n      return 0;\n    const {children1} = this.props;\n    return children1.size;\n  }\n\n  renderChildrenWrapper() {\n    return (\n      <>\n        {this.renderDrag()}\n        {this.renderField()}\n        {this.renderActions()}\n        {super.renderChildrenWrapper()}\n      </>\n    );\n  }\n\n  renderField() {\n    const { config, selectedField, setField, parentField, id, groupId, isLocked } = this.props;\n    const { immutableFieldsMode } = config.settings;\n    return <FieldWrapper\n      key=\"field\"\n      classname={\"group--field\"}\n      config={config}\n      selectedField={selectedField}\n      setField={setField}\n      parentField={parentField}\n      readonly={immutableFieldsMode || isLocked}\n      id={id}\n      groupId={groupId}\n    />;\n  }\n\n  renderActions() {\n    const {config, addRule, isLocked, isTrueLocked, id} = this.props;\n\n    return <RuleGroupActions\n      config={config}\n      addRule={addRule}\n      canAddRule={this.canAddRule()}\n      canDeleteGroup={this.canDeleteGroup()}\n      removeSelf={this.removeSelf}\n      setLock={this.setLock}\n      isLocked={isLocked}\n      isTrueLocked={isTrueLocked}\n      id={id}\n    />;\n  }\n\n  extraPropsForItem(_item) {\n    return {\n      parentField: this.props.selectedField\n    };\n  }\n}\n\n\nexport default RuleGroup;\n","import React, { PureComponent } from \"react\";\n\nexport class RuleGroupExtActions extends PureComponent {\n  render() {\n    const {\n      config, \n      addRule, canAddRule, canDeleteGroup, removeSelf, \n      setLock, isLocked, isTrueLocked, id,\n    } = this.props;\n    const {\n      immutableGroupsMode, addSubRuleLabel, delGroupLabel,\n      renderButton: Btn, renderSwitch: Switch, renderButtonGroup: BtnGrp,\n      lockLabel, lockedLabel, showLock, canDeleteLocked,\n    } = config.settings;\n\n    const setLockSwitch = showLock && !(isLocked && !isTrueLocked) && <Switch \n      type=\"lock\" id={id} value={isLocked} setValue={setLock} label={lockLabel} checkedLabel={lockedLabel} config={config}\n    />;\n\n    const addRuleBtn = !immutableGroupsMode && canAddRule && !isLocked && <Btn \n      type=\"addRuleGroupExt\" onClick={addRule} label={addSubRuleLabel} readonly={isLocked} config={config}\n    />;\n\n    const delGroupBtn = !immutableGroupsMode && canDeleteGroup && (!isLocked || isLocked && canDeleteLocked) && <Btn \n      type=\"delRuleGroup\" onClick={removeSelf} label={delGroupLabel} config={config}\n    />;\n\n    return (\n      <div className={\"group--actions group--actions--tr\"}>\n        <BtnGrp config={config}>\n          {setLockSwitch}\n          {addRuleBtn}\n          {delGroupBtn}\n        </BtnGrp>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport GroupContainer from \"../containers/GroupContainer\";\nimport Draggable from \"../containers/Draggable\";\nimport {BasicGroup} from \"./Group\";\nimport {RuleGroupExtActions} from \"./RuleGroupExtActions\";\nimport FieldWrapper from \"../rule/FieldWrapper\";\nimport OperatorWrapper from \"../rule/OperatorWrapper\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {Col, dummyFn, ConfirmFn} from \"../utils\";\nimport {getFieldWidgetConfig, getFieldConfig} from \"../../utils/configUtils\";\nimport Widget from \"../rule/Widget\";\nconst classNames = require(\"classnames\");\n\n\n@GroupContainer\n@Draggable(\"group rule_group_ext\")\n@ConfirmFn\nclass RuleGroupExt extends BasicGroup {\n  static propTypes = {\n    ...BasicGroup.propTypes,\n    selectedField: PropTypes.string,\n    selectedOperator: PropTypes.string,\n    value: PropTypes.any,\n    parentField: PropTypes.string,\n    setField: PropTypes.func,\n    setOperator: PropTypes.func,\n    setValue: PropTypes.func,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n  }\n\n  childrenClassName = () => \"rule_group_ext--children\";\n  \n  renderFooterWrapper = () => null;\n  canAddGroup = () => false;\n  canAddRule = () => true;\n  canDeleteGroup = () => true;\n\n  renderHeaderWrapper() {\n    return (\n      <div key=\"group-header\" className={classNames(\n        \"group--header\", \n        this.isOneChild() ? \"one--child\" : \"\",\n        this.showDragIcon() ? \"with--drag\" : \"hide--drag\",\n        this.showConjs() && (!this.isOneChild() || this.showNot()) ? \"with--conjs\" : \"hide--conjs\"\n      )}>\n        {this.renderHeader()}\n        {this.renderGroupField()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n\n  renderHeader() {\n    return (\n      <div className={\"group--conjunctions\"}>\n        {this.renderConjs()}\n        {this.renderDrag()}\n      </div>\n    );\n  }\n\n  renderGroupField() {\n    return (\n      <div className={\"group--field--count--rule\"}>\n        {this.renderField()}\n        {this.renderOperator()}\n        {this.renderWidget()}\n      </div>\n    );\n  }\n\n  showNot() {\n    const {config, selectedField, selectedOperator} = this.props;\n    const selectedFieldConfig = getFieldConfig(config, selectedField) || {};\n    return selectedFieldConfig.showNot != undefined ? selectedFieldConfig.showNot : config.settings.showNot;\n  }\n\n  conjunctionOptions() {\n    const {config, selectedField, selectedOperator} = this.props;\n    const selectedFieldConfig = getFieldConfig(config, selectedField) || {};\n    let conjunctionOptions = super.conjunctionOptions();\n    if (selectedFieldConfig.conjunctions) {\n      let filtered = {};\n      for (let k of selectedFieldConfig.conjunctions) {\n        filtered[k] = conjunctionOptions[k];\n      }\n      conjunctionOptions = filtered;\n    }\n    return conjunctionOptions;\n  }\n\n  renderField() {\n    const { config, selectedField, setField, parentField, id, groupId, isLocked } = this.props;\n    const { immutableFieldsMode } = config.settings;\n    return <FieldWrapper\n      key=\"field\"\n      classname={\"rule--field\"}\n      config={config}\n      selectedField={selectedField}\n      setField={setField}\n      parentField={parentField}\n      readonly={immutableFieldsMode || isLocked}\n      id={id}\n      groupId={groupId}\n    />;\n  }\n\n  renderOperator() {\n    const {config, selectedField, selectedOperator, setField, setOperator, isLocked} = this.props;\n    const { immutableFieldsMode } = config.settings;\n    const selectedFieldWidgetConfig = getFieldWidgetConfig(config, selectedField, selectedOperator) || {};\n    const hideOperator = selectedFieldWidgetConfig.hideOperator;\n    const showOperatorLabel = selectedField && hideOperator && selectedFieldWidgetConfig.operatorInlineLabel;\n    const showOperator = selectedField && !hideOperator;\n\n    return <OperatorWrapper\n      key=\"operator\"\n      classname={\"group--operator\"}\n      config={config}\n      selectedField={selectedField}\n      selectedOperator={selectedOperator}\n      setField={setField}\n      setOperator={setOperator}\n      selectedFieldPartsLabels={[\"group\"]}\n      showOperator={showOperator}\n      showOperatorLabel={showOperatorLabel}\n      selectedFieldWidgetConfig={selectedFieldWidgetConfig}\n      readonly={immutableFieldsMode || isLocked}\n      id={this.props.id}\n      groupId={this.props.groupId}\n    />;\n  }\n\n  renderWidget() {\n    const {config, selectedField, selectedOperator, isLocked} = this.props;\n    const { immutableValuesMode } = config.settings;\n    const isFieldAndOpSelected = selectedField && selectedOperator;\n    const showWidget = isFieldAndOpSelected;\n    if (!showWidget) return null;\n\n    const widget = <Widget\n      key=\"values\"\n      isForRuleGruop={true}\n      field={this.props.selectedField}\n      operator={this.props.selectedOperator}\n      value={this.props.value}\n      valueSrc={\"value\"}\n      valueError={null}\n      config={config}\n      setValue={!immutableValuesMode ? this.props.setValue : dummyFn}\n      setValueSrc={dummyFn}\n      readonly={immutableValuesMode || isLocked}\n      id={this.props.id}\n      groupId={this.props.groupId}\n    />;\n\n    return (\n      <Col key={\"widget-for-\"+this.props.selectedOperator} className=\"rule--value\">\n        {widget}\n      </Col>\n    );\n  }\n\n  renderActions() {\n    const {config, addRule, isLocked, isTrueLocked, id} = this.props;\n\n    return <RuleGroupExtActions\n      config={config}\n      addRule={addRule}\n      canAddRule={this.canAddRule()}\n      canDeleteGroup={this.canDeleteGroup()}\n      removeSelf={this.removeSelf}\n      setLock={this.setLock}\n      isLocked={isLocked}\n      isTrueLocked={isTrueLocked}\n      id={id}\n    />;\n  }\n\n  reordableNodesCntForItem(_item) {\n    if (this.props.isLocked)\n      return 0;\n    const {children1} = this.props;\n    return children1.size;\n  }\n\n  extraPropsForItem(_item) {\n    return {\n      parentField: this.props.selectedField\n    };\n  }\n}\n\n\nexport default RuleGroupExt;\n","import React, { PureComponent } from \"react\";\n\nconst groupActionsPositionList = {\n  topLeft: \"group--actions--tl\",\n  topCenter: \"group--actions--tc\",\n  topRight: \"group--actions--tr\",\n  bottomLeft: \"group--actions--bl\",\n  bottomCenter: \"group--actions--bc\",\n  bottomRight: \"group--actions--br\"\n};\nconst defaultPosition = \"topRight\";\n\n\nexport class SwitchGroupActions extends PureComponent {\n  render() {\n    const {\n      config, \n      addCaseGroup, addDefaultCaseGroup, setLock, isLocked, isTrueLocked, id, canAddGroup, canAddDefault\n    } = this.props;\n    const {\n      immutableGroupsMode, addCaseLabel, addDefaultCaseLabel, groupActionsPosition, \n      renderButton: Btn, renderSwitch: Switch, renderButtonGroup: BtnGrp,\n      lockLabel, lockedLabel, showLock,\n    } = config.settings;\n    const position = groupActionsPositionList[groupActionsPosition || defaultPosition];\n\n    const setLockSwitch = showLock && !(isLocked && !isTrueLocked) && <Switch \n      type=\"lock\" id={id} value={isLocked} setValue={setLock} label={lockLabel} checkedLabel={lockedLabel} config={config}\n    />;\n\n    const addCaseGroupBtn = !immutableGroupsMode && canAddGroup && !isLocked && <Btn\n      type=\"addCaseGroup\" onClick={addCaseGroup} label={addCaseLabel} readonly={isLocked} config={config}\n    />;\n\n    const addDefaultCaseGroupBtn = !immutableGroupsMode && canAddDefault && !isLocked && <Btn\n      type=\"addDefaultCaseGroup\" onClick={addDefaultCaseGroup} label={addDefaultCaseLabel} readonly={isLocked} config={config}\n    />;\n\n    return (\n      <div className={`group--actions ${position}`}>\n        <BtnGrp config={config}>\n          {setLockSwitch}\n          {addCaseGroupBtn}\n          {addDefaultCaseGroupBtn}\n        </BtnGrp>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport GroupContainer from \"../containers/GroupContainer\";\nimport Draggable from \"../containers/Draggable\";\nimport {BasicGroup} from \"./Group\";\nimport {SwitchGroupActions} from \"./SwitchGroupActions\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {Col, dummyFn, ConfirmFn} from \"../utils\";\nimport {getTotalReordableNodesCountInTree, getTotalRulesCountInTree} from \"../../utils/treeUtils\";\nconst classNames = require(\"classnames\");\n\n\n@GroupContainer\n@Draggable(\"group switch_group\")\n@ConfirmFn\nclass SwitchGroup extends BasicGroup {\n  static propTypes = {\n    ...BasicGroup.propTypes,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n  }\n\n  childrenClassName = () => \"switch_group--children\";\n  \n  renderFooterWrapper = () => null;\n  hasDefaultCase = () => {\n    return this.props.children1.size && this.props.children1.filter(c => c.get(\"children1\") == null).size > 0;\n  };\n  canAddGroup() {\n    const { maxNumberOfCases } = this.props.config.settings;\n    const totalCasesCnt = this.props.children1.size;\n    if (maxNumberOfCases) {\n      return totalCasesCnt < maxNumberOfCases;\n    }\n    return true;\n  }\n  canAddRule() {\n    return false;\n  }\n\n  reordableNodesCnt() {\n    // result will be passed to each case's `parentReordableNodesCnt` prop\n    const totalCasesCnt = this.props.children1.size;\n    let casesToReorder = totalCasesCnt;\n    if (this.hasDefaultCase()) {\n      casesToReorder--;\n    }\n    return casesToReorder;\n  }\n\n  totalRulesCntForItem(item) {\n    return getTotalRulesCountInTree(item);\n  }\n\n  reordableNodesCntForItem(item) {\n    if (this.props.isLocked)\n      return 0;\n    const { canLeaveEmptyCase, canRegroupCases } = this.props.config.settings;\n\n    const totalCasesCnt = this.props.children1.size;\n    let casesToReorder = totalCasesCnt;\n    if (this.hasDefaultCase()) {\n      casesToReorder--;\n    }\n\n    const nodesInCase = getTotalReordableNodesCountInTree(item);\n    let cnt = nodesInCase;\n    if (cnt == 1 && canRegroupCases && canLeaveEmptyCase && casesToReorder > 1)\n      cnt = 111;\n    return cnt;\n  }\n\n  renderHeaderWrapper() {\n    return (\n      <div key=\"group-header\" className={classNames(\n        \"group--header\", \n        this.isOneChild() ? \"one--child\" : \"\",\n        this.showDragIcon() ? \"with--drag\" : \"hide--drag\",\n        this.showConjs() && (!this.isOneChild() || this.showNot()) ? \"with--conjs\" : \"hide--conjs\"\n      )}>\n        {this.renderHeader()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n\n  renderHeader() {\n    return (\n      <div className={\"group--conjunctions\"}>\n        {this.renderConjs()}\n        {this.renderDrag()}\n      </div>\n    );\n  }\n\n  renderConjs() {\n    const { renderSwitchPrefix } = this.props.config.settings;\n    return renderSwitchPrefix ? renderSwitchPrefix() : null;\n  }\n\n  showNot() {\n    return false;\n  }\n\n\n  renderActions() {\n    const {config, addCaseGroup, addDefaultCaseGroup, isLocked, isTrueLocked, id} = this.props;\n\n    return <SwitchGroupActions\n      config={config}\n      addCaseGroup={addCaseGroup}\n      addDefaultCaseGroup={addDefaultCaseGroup}\n      canAddDefault={!this.hasDefaultCase()}\n      canAddGroup={this.canAddGroup()}\n      setLock={this.setLock}\n      isLocked={isLocked}\n      isTrueLocked={isTrueLocked}\n      id={id}\n    />;\n  }\n\n}\n\n\nexport default SwitchGroup;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport GroupContainer from \"../containers/GroupContainer\";\nimport Draggable from \"../containers/Draggable\";\nimport {BasicGroup} from \"./Group\";\nimport {GroupActions} from \"./GroupActions\";\nimport {useOnPropsChanged} from \"../../utils/reactUtils\";\nimport {Col, dummyFn, ConfirmFn} from \"../utils\";\nimport Widget from \"../rule/Widget\";\nconst classNames = require(\"classnames\");\n\n\n@GroupContainer\n@Draggable(\"group case_group\")\n@ConfirmFn\nclass CaseGroup extends BasicGroup {\n  static propTypes = {\n    ...BasicGroup.propTypes,\n    parentReordableNodesCnt: PropTypes.number,\n    value: PropTypes.any,\n    setValue: PropTypes.func,\n  };\n\n  constructor(props) {\n    super(props);\n    useOnPropsChanged(this);\n    this.onPropsChanged(props);\n  }\n\n  onPropsChanged(nextProps) {\n  }\n\n  isDefaultCase() {\n    return this.props.children1 == undefined;\n  }\n\n  reordableNodesCnt() {\n    // `parentReordableNodesCnt` is number of cases to reorder\n    return this.props.parentReordableNodesCnt;\n  }\n\n  reordableNodesCntForItem(_item) {\n    // `reordableNodesCnt` is number of nodes is current case\n    if (this.props.isLocked)\n      return 0;\n    return this.props.reordableNodesCnt;\n  }\n\n  totalRulesCntForItem(_item) {\n    // `totalRulesCnt` is number of nodes is current case\n    return this.props.totalRulesCnt;\n  }\n\n  showDragIcon() {\n    // default impl of `showDragIcon()` uses `this.reordableNodesCnt()`\n    if (this.isDefaultCase())\n      return false;\n    return super.showDragIcon();\n  }\n\n  childrenClassName = () => \"case_group--children\";\n  \n  renderFooterWrapper = () => null;\n\n  renderHeaderWrapper() {\n    return (\n      <div key=\"group-header\" className={classNames(\n        \"group--header\", \n        this.isOneChild() ? \"one--child\" : \"\",\n        this.showDragIcon() ? \"with--drag\" : \"hide--drag\",\n        this.showConjs() && (!this.isOneChild() || this.showNot()) ? \"with--conjs\" : \"hide--conjs\"\n      )}>\n        {this.renderHeaderLeft()}\n        {this.renderHeaderCenter()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n\n  renderChildrenWrapper() {\n    if (this.isDefaultCase())\n      return null;\n    // body has 2 columns: condition & value\n    return (\n      <div className={\"case_group--body\"}>\n        {this.renderCondition()}\n        {this.renderValue()}\n      </div>\n    );\n  }\n\n  renderHeaderLeft() {\n    if (this.isDefaultCase()) {\n      const { defaultCaseLabel } = this.props.config.settings;\n      return defaultCaseLabel || \"\";\n    }\n    // default impl:\n    return (\n      <div className={\"group--conjunctions\"}>\n        {this.renderConjs()}\n        {this.renderDrag()}\n      </div>\n    );\n  }\n\n  renderCondition() {\n    if (this.isDefaultCase())\n      return null;\n    return super.renderChildrenWrapper();\n  }\n\n  renderHeaderCenter() {\n    if (this.isDefaultCase())\n      return this.renderValue();\n    else\n      return null;\n  }\n\n  canAddGroup() {\n    if (this.isDefaultCase())\n      return false;\n    return super.canAddGroup();\n  }\n\n  canAddRule() {\n    if (this.isDefaultCase())\n      return false;\n    return super.canAddRule();\n  }\n\n  renderValue() {\n    const { config, isLocked, value, setValue, id } = this.props;\n    const { immutableValuesMode } = config.settings;\n\n    const widget = <Widget\n      key=\"values\"\n      isCaseValue={true}\n      field={\"!case_value\"}\n      operator={null}\n      value={value}\n      valueSrc={\"value\"}\n      valueError={null}\n      config={config}\n      setValue={!immutableValuesMode ? setValue : dummyFn}\n      setValueSrc={dummyFn}\n      readonly={immutableValuesMode || isLocked}\n      id={id}\n      groupId={null}\n    />;\n\n    return (\n      <Col className=\"case_group--value\">\n        {widget}\n      </Col>\n    );\n  }\n\n  renderActions() {\n    const {config, addGroup, addRule, isLocked, isTrueLocked, id} = this.props;\n    return <GroupActions\n      config={config}\n      addGroup={addGroup}\n      addRule={addRule}\n      canAddRule={this.canAddRule()}\n      canAddGroup={this.canAddGroup()}\n      canDeleteGroup={this.canDeleteGroup()}\n      removeSelf={this.removeSelf}\n      setLock={this.setLock}\n      isLocked={isLocked}\n      isTrueLocked={isTrueLocked}\n      id={id}\n    />;\n  }\n\n  isEmptyCurrentGroup() {\n    // used to confirm self-deletion\n    const { value } = this.props;\n    const oneValue = value && value.size ? value.get(0) : null;\n    const hasValue = oneValue != null && (Array.isArray(oneValue) ? oneValue.length > 0 : true);\n    return super.isEmptyCurrentGroup() && !hasValue;\n  }\n\n}\n\n\nexport default CaseGroup;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Rule from \"./Rule\";\nimport Group from \"./Group\";\nimport RuleGroup from \"./RuleGroup\";\nimport RuleGroupExt from \"./RuleGroupExt\";\nimport SwitchGroup from \"./SwitchGroup\";\nimport CaseGroup from \"./CaseGroup\";\n\nconst types = [\n  \"rule\",\n  \"group\",\n  \"rule_group\",\n  \"switch_group\",\n  \"case_group\"\n];\n\nconst getProperties = (props) => {\n  const properties = props.properties.toObject();\n  const result = {...properties};\n  if (props.isParentLocked) {\n    result.isLocked = true;\n  }\n  if (properties.isLocked) {\n    result.isTrueLocked = true;\n  }\n  return result;\n};\n\nconst typeMap = {\n  rule: (props) => (\n    <Rule\n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      config={props.config}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      parentField={props.parentField}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n  group: (props) => (\n    <Group \n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      config={props.config}\n      //tree={props.tree}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      children1={props.children1}\n      parentField={null}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n  rule_group: (props) => (\n    <RuleGroup \n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      config={props.config}\n      //tree={props.tree}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      children1={props.children1}\n      parentField={props.parentField}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n  rule_group_ext: (props) => (\n    <RuleGroupExt \n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      config={props.config}\n      //tree={props.tree}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      children1={props.children1}\n      parentField={props.parentField}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n  switch_group: (props) => (\n    <SwitchGroup \n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      config={props.config}\n      //tree={props.tree}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      children1={props.children1}\n      parentField={null}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n  case_group: (props) => (\n    <CaseGroup \n      {...getProperties(props)}\n      id={props.id}\n      groupId={props.groupId}\n      path={props.path}\n      actions={props.actions}\n      config={props.config}\n      //tree={props.tree}\n      reordableNodesCnt={props.reordableNodesCnt}\n      totalRulesCnt={props.totalRulesCnt}\n      onDragStart={props.onDragStart}\n      isDraggingTempo={props.isDraggingTempo}\n      children1={props.children1}\n      parentField={null}\n      parentReordableNodesCnt={props.parentReordableNodesCnt}\n    />\n  ),\n};\n\n\nclass Item extends PureComponent {\n  static propTypes = {\n    //tree: PropTypes.instanceOf(Immutable.Map).isRequired,\n    config: PropTypes.object.isRequired,\n    id: PropTypes.string.isRequired,\n    groupId: PropTypes.string,\n    type: PropTypes.oneOf(types).isRequired,\n    path: PropTypes.any.isRequired, //instanceOf(Immutable.List)\n    properties: PropTypes.any.isRequired, //instanceOf(Immutable.Map)\n    children1: PropTypes.any, //instanceOf(Immutable.OrderedMap)\n    actions: PropTypes.object.isRequired,\n    reordableNodesCnt: PropTypes.number,\n    onDragStart: PropTypes.func,\n    parentField: PropTypes.string, //from RuleGroup\n    isDraggingTempo: PropTypes.bool,\n    isParentLocked: PropTypes.bool,\n  };\n\n  render() {\n    const { type, ...props } = this.props;\n    const mode = props.properties.get(\"mode\");\n    const postfix = mode == \"array\" ? \"_ext\" : \"\";    \n    const renderItem = props.config.settings.renderItem;\n    let Cmp = typeMap[type + postfix];\n    if (renderItem) {\n      return renderItem({...props, type, itemComponent: Cmp});\n    }\n    if (!Cmp) return null;\n    return Cmp(props);\n  }\n}\n\nexport { Item };\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Immutable, {Map} from \"immutable\";\nimport { Item } from \"./item/Item\";\nimport SortableContainer from \"./containers/SortableContainer\";\nimport {getTotalReordableNodesCountInTree, getTotalRulesCountInTree} from \"../utils/treeUtils\";\nimport uuid from \"../utils/uuid\";\nimport {pureShouldComponentUpdate} from \"../utils/reactUtils\";\n\n\n@SortableContainer\nexport default class Builder extends Component {\n  static propTypes = {\n    tree: PropTypes.any.isRequired, //instanceOf(Immutable.Map)\n    config: PropTypes.object.isRequired,\n    actions: PropTypes.object.isRequired,\n    onDragStart: PropTypes.func,\n  };\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const prevProps = this.props;\n    let should = pureShouldComponentUpdate(this)(nextProps, nextState);\n    if (should) {\n      let chs = [];\n      for (let k in nextProps) {\n        let changed = (nextProps[k] !== prevProps[k]);\n        if (changed && k != \"__isInternalValueChange\") {\n          chs.push(k);\n        }\n      }\n      if (!chs.length)\n        should = false;\n      //optimize render\n      if (chs.length == 1 && chs[0] == \"tree\" && nextProps.__isInternalValueChange)\n        should = false;\n    }\n    return should;\n  }\n\n  constructor(props) {\n    super(props);\n\n    this._updPath(props);\n  }\n\n  _updPath (props) {\n    const id = props.tree.get(\"id\");\n    this.path = Immutable.List.of(id);\n  }\n\n  render() {\n    const tree = this.props.tree;\n    const rootType = tree.get(\"type\");\n    const isTernary = rootType == \"switch_group\";\n    const reordableNodesCnt = isTernary ? null : getTotalReordableNodesCountInTree(tree);\n    const totalRulesCnt = isTernary ? null : getTotalRulesCountInTree(tree);\n    const id = tree.get(\"id\");\n    return (\n      <Item \n        key={id}\n        id={id}\n        path={this.path}\n        type={rootType}\n        properties={tree.get(\"properties\") || new Map()}\n        config={this.props.config}\n        actions={this.props.actions}\n        children1={tree.get(\"children1\") || new Map()}\n        //tree={tree}\n        reordableNodesCnt={reordableNodesCnt}\n        totalRulesCnt={totalRulesCnt}\n        parentReordableNodesCnt={0}\n        onDragStart={this.props.onDragStart}\n      />\n    );\n  }\n}\n","import {defaultValue} from \"../utils/stuff\";\nimport {getFieldConfig, getOperatorConfig} from \"../utils/configUtils\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {formatFieldName} from \"../utils/ruleUtils\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport {Map} from \"immutable\";\n\n/*\n Build tree to http://querybuilder.js.org/ like format\n\n Example:\n {\n    \"condition\": \"AND\",\n    \"rules\": [\n        {\n            \"id\": \"price\",\n            \"field\": \"price\",\n            \"type\": \"double\",\n            \"input\": \"text\",\n            \"operator\": \"less\",\n            \"value\": \"10.25\"\n        },\n        {\n            \"condition\": \"OR\",\n            \"rules\": [\n                {\n                    \"id\": \"category\",\n                    \"field\": \"category\",\n                    \"type\": \"integer\",\n                    \"input\": \"select\",\n                    \"operator\": \"equal\",\n                    \"value\": \"2\"\n                },\n                {\n                    \"id\": \"category\",\n                    \"field\": \"category\",\n                    \"type\": \"integer\",\n                    \"input\": \"select\",\n                    \"operator\": \"equal\",\n                    \"value\": \"1\"\n                }\n            ]\n        }\n    ]\n }\n */\n\n\nexport const queryBuilderFormat = (item, config) => {\n  //meta is mutable\n  let meta = {\n    usedFields: []\n  };\n  const res = formatItem(item, config, meta);\n  if (!res)\n    return undefined;\n  return {\n    ...res, \n    ...meta\n  };\n};\n\n\nconst formatItem = (item, config, meta) => {\n  if (!item) return undefined;\n\n  const type = item.get(\"type\");\n  const children = item.get(\"children1\");\n\n  if ((type === \"group\" || type === \"rule_group\") && children && children.size) {\n    return formatGroup(item, config, meta);\n  } else if (type === \"rule\") {\n    return formatRule(item, config, meta);\n  }\n  return undefined;\n};\n\n\nconst formatGroup = (item, config, meta) => {\n  const properties = item.get(\"properties\") || new Map();\n  const children = item.get(\"children1\");\n  const id = item.get(\"id\");\n\n  const list = children\n    .map((currentChild) => formatItem(currentChild, config, meta))\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n  if (!list.size)\n    return undefined;\n\n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  const not = properties.get(\"not\");\n\n  const resultQuery = {\n    id,\n    rules: list.toList(),\n    condition: conjunction.toUpperCase(),\n    not,\n  };\n  return resultQuery;\n};\n\n\nconst formatRule = (item, config, meta) => {\n  const properties = item.get(\"properties\") || new Map();\n  const id = item.get(\"id\");\n\n  const operator = properties.get(\"operator\");\n  const options = properties.get(\"operatorOptions\");\n  let field = properties.get(\"field\");\n  let value = properties.get(\"value\");\n  let valueSrc = properties.get(\"valueSrc\");\n  let valueType = properties.get(\"valueType\");\n  const hasUndefinedValues = value.filter(v => v === undefined).size > 0;\n\n  if (field == null || operator == null || hasUndefinedValues)\n    return undefined;\n\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  const operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  const fieldType = fieldDefinition.type || \"undefined\";\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  const typeConfig = config.types[fieldDefinition.type] || {};\n  const fieldName = formatFieldName(field, config, meta);\n\n  if (value.size < cardinality)\n    return undefined;\n\n  if (meta.usedFields.indexOf(field) == -1)\n    meta.usedFields.push(field);\n  value = value.toArray();\n  valueSrc = valueSrc.toArray();\n  valueType = valueType.toArray();\n  let values = [];\n  for (let i = 0 ; i < value.length ; i++) {\n    const val = {\n      type: valueType[i],\n      value: value[i],\n    };\n    values.push(val);\n    if (valueSrc[i] == \"field\") {\n      const secondField = value[i];\n      if (meta.usedFields.indexOf(secondField) == -1)\n        meta.usedFields.push(secondField);\n    }\n  }\n  let operatorOptions = options ? options.toJS() : null;\n  if (operatorOptions && !Object.keys(operatorOptions).length)\n    operatorOptions = null;\n      \n  let ruleQuery = {\n    id,\n    fieldName,\n    type: fieldType,\n    input: typeConfig.mainWidget,\n    operator,\n  };\n  if (operatorOptions)\n    ruleQuery.operatorOptions = operatorOptions;\n  ruleQuery.values = values;\n  return ruleQuery;\n};\n","import {defaultValue} from \"../utils/stuff\";\nimport {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig\n} from \"../utils/configUtils\";\nimport {getWidgetForFieldOp} from \"../utils/ruleUtils\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport {Map} from \"immutable\";\nimport omit from \"lodash/omit\";\nimport pick from \"lodash/pick\";\n\n// http://jsonlogic.com/\n\n\nexport const jsonLogicFormat = (item, config) => {\n  //meta is mutable\n  let meta = {\n    usedFields: [],\n    errors: []\n  };\n  \n  const logic = formatItem(item, config, meta, true);\n  \n  // build empty data\n  const {errors, usedFields} = meta;\n  const {fieldSeparator} = config.settings;\n  let data = {};\n  for (let ff of usedFields) {\n    const def = getFieldConfig(config, ff) || {};\n    const parts = ff.split(fieldSeparator);\n    let tmp = data;\n    for (let i = 0 ; i < parts.length ; i++) {\n      const p = parts[i];\n      const pdef = getFieldConfig(config, parts.slice(0, i+1)) || {};\n      if (i != parts.length - 1) {\n        if (pdef.type == \"!group\" && pdef.mode != \"struct\") {\n          if (!tmp[p])\n            tmp[p] = [{}];\n          tmp = tmp[p][0];\n        } else {\n          if (!tmp[p])\n            tmp[p] = {};\n          tmp = tmp[p];\n        }\n      } else {\n        if (!tmp[p])\n          tmp[p] = null; // can use def.type for sample values\n      }\n    }\n  }\n    \n  return {\n    errors,\n    logic,\n    data,\n  };\n};\n\n\nconst formatItem = (item, config, meta, isRoot, parentField = null) => {\n  if (!item) return undefined;\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const isLocked = properties.get(\"isLocked\");\n  const {lockedOp} = config.settings.jsonLogic;\n  let ret;\n  if (type === \"group\" || type === \"rule_group\") {\n    ret = formatGroup(item, config, meta, isRoot, parentField);\n  } else if (type === \"rule\") {\n    ret = formatRule(item, config, meta, parentField);\n  }\n  if (isLocked && ret && lockedOp) {\n    ret = { [lockedOp] : ret };\n  }\n  return ret;\n};\n\n\nconst formatGroup = (item, config, meta, isRoot, parentField = null) => {\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const mode = properties.get(\"mode\");\n  const children = item.get(\"children1\");\n  const field = properties.get(\"field\");\n  if (!children) return undefined;\n  \n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  const conjunctionDefinition = config.conjunctions[conjunction];\n  const conj = conjunctionDefinition.jsonLogicConj || conjunction.toLowerCase();\n  const not = properties.get(\"not\");\n  if (conj != \"and\" && conj != \"or\") {\n    meta.errors.push(`Conjunction ${conj} is not supported`);\n    return undefined;\n  }\n\n  const isRuleGroup = (type === \"rule_group\" && !isRoot);\n  const groupField = isRuleGroup && mode != \"struct\" ? field : parentField;\n  const groupOperator = properties.get(\"operator\");\n  const groupOperatorDefinition = groupOperator && getOperatorConfig(config, groupOperator, field) || null;\n  const formattedValue = formatItemValue(config, properties, meta, groupOperator, parentField);\n  const isGroup0 = isRuleGroup && (!groupOperator || groupOperatorDefinition.cardinality == 0);\n\n  const list = children\n    .map((currentChild) => formatItem(currentChild, config, meta, false, groupField))\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n  \n  if (isRuleGroup && mode != \"struct\" && !isGroup0) {\n    // \"count\" rule can have no \"having\" children, but should have number value\n    if (formattedValue == undefined)\n      return undefined;\n  } else {\n    if (!list.size)\n      return undefined;\n  }\n\n  let resultQuery = {};\n  if (list.size == 1 && !isRoot)\n    resultQuery = list.first();\n  else\n    resultQuery[conj] = list.toList().toJS();\n  \n  // revert\n  if (not) {\n    resultQuery = { \"!\": resultQuery };\n  }\n\n  // rule_group (issue #246)\n  if (isRuleGroup && mode != \"struct\") {\n    const formattedField = formatField(meta, config, field, parentField);\n    if (isGroup0) {\n      // config.settings.groupOperators\n      const op = groupOperator || \"some\";\n      resultQuery = {\n        [op]: [\n          formattedField,\n          resultQuery\n        ]\n      };\n    } else {\n      // there is rule for count\n      const filter = !list.size \n        ? formattedField\n        : {\n          \"filter\": [\n            formattedField,\n            resultQuery\n          ]\n        };\n      const count = {\n        \"reduce\": [\n          filter,\n          { \"+\": [1, { var: \"accumulator\" }] },\n          0\n        ]\n      };\n      resultQuery = formatLogic(config, properties, count, formattedValue, groupOperator);\n    }\n  }\n  \n  return resultQuery;\n};\n\n\nconst formatRule = (item, config, meta, parentField = null) => {\n  const properties = item.get(\"properties\") || new Map();\n  const field = properties.get(\"field\");\n\n  let operator = properties.get(\"operator\");\n  let operatorOptions = properties.get(\"operatorOptions\");\n  operatorOptions = operatorOptions ? operatorOptions.toJS() : null;\n  if (operatorOptions && !Object.keys(operatorOptions).length)\n    operatorOptions = null;\n\n  if (field == null || operator == null)\n    return undefined;\n\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  let operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  let reversedOp = operatorDefinition.reversedOp;\n  let revOperatorDefinition = getOperatorConfig(config, reversedOp, field) || {};\n\n  // check op\n  let isRev = false;\n  if (!operatorDefinition.jsonLogic && !revOperatorDefinition.jsonLogic) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n  if (!operatorDefinition.jsonLogic && revOperatorDefinition.jsonLogic) {\n    isRev = true;\n    [operator, reversedOp] = [reversedOp, operator];\n    [operatorDefinition, revOperatorDefinition] = [revOperatorDefinition, operatorDefinition];\n  }\n\n  const formattedValue = formatItemValue(config, properties, meta, operator, parentField);\n  if (formattedValue === undefined)\n    return undefined;\n\n  const formattedField = formatField(meta, config, field, parentField);\n\n  return formatLogic(config, properties, formattedField, formattedValue, operator, operatorOptions, fieldDefinition, isRev);\n};\n\n\nconst formatItemValue = (config, properties, meta, operator, parentField) => {\n  const field = properties.get(\"field\");\n  const iValueSrc = properties.get(\"valueSrc\");\n  const iValueType = properties.get(\"valueType\");\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  const operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  const iValue = properties.get(\"value\");\n  const asyncListValues = properties.get(\"asyncListValues\");\n  if (iValue == undefined)\n    return undefined;\n  \n  let valueSrcs = [];\n  let valueTypes = [];\n  let oldUsedFields = meta.usedFields;\n  const fvalue = iValue.map((currentValue, ind) => {\n    const valueSrc = iValueSrc ? iValueSrc.get(ind) : null;\n    const valueType = iValueType ? iValueType.get(ind) : null;\n    const cValue = completeValue(currentValue, valueSrc, config);\n    const widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n    const fieldWidgetDef = omit(getFieldWidgetConfig(config, field, operator, widget, valueSrc), [\"factory\"]);\n    const fv = formatValue(\n      meta, config, cValue, valueSrc, valueType, fieldWidgetDef, fieldDefinition, operator, operatorDefinition, parentField, asyncListValues\n    );\n    if (fv !== undefined) {\n      valueSrcs.push(valueSrc);\n      valueTypes.push(valueType);\n    }\n    return fv;\n  });\n  const hasUndefinedValues = fvalue.filter(v => v === undefined).size > 0;\n  if (fvalue.size < cardinality || hasUndefinedValues) {\n    meta.usedFields = oldUsedFields; // restore\n    return undefined;\n  }\n  return cardinality > 1 ? fvalue.toArray() : (cardinality == 1 ? fvalue.first() : null);\n};\n\n\nconst formatValue = (meta, config, currentValue, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, operatorDef, parentField = null, asyncListValues) => {\n  if (currentValue === undefined)\n    return undefined;\n  let ret;\n  if (valueSrc == \"field\") {\n    ret = formatField(meta, config, currentValue, parentField);\n  } else if (valueSrc == \"func\") {\n    ret = formatFunc(meta, config, currentValue, parentField);\n  } else if (typeof fieldWidgetDef.jsonLogic === \"function\") {\n    const fn = fieldWidgetDef.jsonLogic;\n    const args = [\n      currentValue,\n      {\n        ...pick(fieldDef, [\"fieldSettings\", \"listValues\"]),\n        asyncListValues\n      },\n      //useful options: valueFormat for date/time\n      omit(fieldWidgetDef, [\"formatValue\", \"mongoFormatValue\", \"sqlFormatValue\", \"jsonLogic\", \"elasticSearchFormatValue\", \"spelFormatValue\"]),\n    ];\n    if (operator) {\n      args.push(operator);\n      args.push(operatorDef);\n    }\n    ret = fn(...args);\n  } else {\n    ret = currentValue;\n  }\n  return ret;\n};\n\n\nconst formatFunc = (meta, config, currentValue, parentField = null) => {\n  const funcKey = currentValue.get(\"func\");\n  const args = currentValue.get(\"args\");\n  const funcConfig = getFuncConfig(config, funcKey);\n  if (!funcConfig.jsonLogic) {\n    meta.errors.push(`Func ${funcKey} is not supported`);\n    return undefined;\n  }\n\n  let formattedArgs = {};\n  for (const argKey in funcConfig.args) {\n    const argConfig = funcConfig.args[argKey];\n    const fieldDef = getFieldConfig(config, argConfig);\n    const argVal = args ? args.get(argKey) : undefined;\n    const argValue = argVal ? argVal.get(\"value\") : undefined;\n    const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n    const formattedArgVal = formatValue(\n      meta, config, argValue, argValueSrc, argConfig.type, fieldDef, argConfig, null, null, parentField\n    );\n    if (argValue != undefined && formattedArgVal === undefined) {\n      meta.errors.push(`Can't format value of arg ${argKey} for func ${funcKey}`);\n      return undefined;\n    }\n    if (formattedArgVal !== undefined) { // skip optional in the end\n      formattedArgs[argKey] = formattedArgVal;\n    }\n  }\n  const formattedArgsArr = Object.values(formattedArgs);\n\n  let ret;\n  if (typeof funcConfig.jsonLogic === \"function\") {\n    const fn = funcConfig.jsonLogic;\n    const args = [\n      formattedArgs,\n    ];\n    ret = fn(...args);\n  } else {\n    const funcName = funcConfig.jsonLogic || funcKey;\n    const isMethod = !!funcConfig.jsonLogicIsMethod;\n    if (isMethod) {\n      const [obj, ...params] = formattedArgsArr;\n      if (params.length) {\n        ret = { \"method\": [ obj, funcName, params ] };\n      } else {\n        ret = { \"method\": [ obj, funcName ] };\n      }\n    } else {\n      ret = { [funcName]: formattedArgsArr };\n    }\n  }\n  return ret;\n};\n\n\nconst formatField = (meta, config, field, parentField = null) => {\n  const {fieldSeparator, jsonLogic} = config.settings;\n\n  let ret;\n  if (field) {\n    if (Array.isArray(field))\n      field = field.join(fieldSeparator);\n    const fieldDef = getFieldConfig(config, field) || {};\n    let fieldName = field;\n    if (fieldDef.fieldName) {\n      fieldName = fieldDef.fieldName;\n    }\n    if (parentField) {\n      const parentFieldDef = getFieldConfig(config, parentField) || {};\n      let parentFieldName = parentField;\n      if (parentFieldDef.fieldName) {\n        parentFieldName = parentFieldDef.fieldName;\n      }\n      if (fieldName.indexOf(parentFieldName + fieldSeparator) == 0) {\n        fieldName = fieldName.slice((parentFieldName + fieldSeparator).length);\n      } else {\n        meta.errors.push(`Can't cut group ${parentFieldName} from field ${fieldName}`);\n      }\n    }\n    let varName = fieldDef.jsonLogicVar || (fieldDef.type == \"!group\" ? jsonLogic.groupVarKey : \"var\");\n    ret = { [varName] : fieldName };\n    if (meta.usedFields.indexOf(field) == -1)\n      meta.usedFields.push(field);\n  }\n  return ret;\n};\n\nconst buildFnToFormatOp = (operator, operatorDefinition, formattedField, formattedValue) => {\n  let formatteOp = operator;\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  const isReverseArgs = defaultValue(operatorDefinition._jsonLogicIsRevArgs, false);\n  if (typeof operatorDefinition.jsonLogic == \"string\")\n    formatteOp = operatorDefinition.jsonLogic;\n  const rangeOps = [\"<\", \"<=\", \">\", \">=\"];\n  const eqOps = [\"==\", \"!=\"];\n  const fn = (field, op, val, opDef, opOpts) => {\n    if (cardinality == 0 && eqOps.includes(formatteOp))\n      return { [formatteOp]: [formattedField, null] };\n    else if (cardinality == 0)\n      return { [formatteOp]: formattedField };\n    else if (cardinality == 1 && isReverseArgs)\n      return { [formatteOp]: [formattedValue, formattedField] };\n    else if (cardinality == 1)\n      return { [formatteOp]: [formattedField, formattedValue] };\n    else if (cardinality == 2 && rangeOps.includes(formatteOp))\n      return { [formatteOp]: [formattedValue[0], formattedField, formattedValue[1]] };\n    else\n      return { [formatteOp]: [formattedField, ...formattedValue] };\n  };\n  return fn;\n};\n\nconst formatLogic = (config, properties, formattedField, formattedValue, operator, operatorOptions = null, fieldDefinition = null, isRev = false) => {\n  const field = properties.get(\"field\");\n  const operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  let fn = typeof operatorDefinition.jsonLogic == \"function\" \n    ? operatorDefinition.jsonLogic \n    : buildFnToFormatOp(operator, operatorDefinition, formattedField, formattedValue);\n  const args = [\n    formattedField,\n    operator,\n    formattedValue,\n    omit(operatorDefinition, [\"formatOp\", \"mongoFormatOp\", \"sqlFormatOp\", \"jsonLogic\", \"spelFormatOp\"]),\n    operatorOptions,\n    fieldDefinition,\n  ];\n  let ruleQuery = fn(...args);\n\n  if (isRev) {\n    ruleQuery = { \"!\": ruleQuery };\n  }\n\n  return ruleQuery;\n};\n","import {defaultValue} from \"../utils/stuff\";\nimport {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig\n} from \"../utils/configUtils\";\nimport {getFieldPath, getFieldPathLabels, getWidgetForFieldOp} from \"../utils/ruleUtils\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport omit from \"lodash/omit\";\nimport pick from \"lodash/pick\";\nimport {Map} from \"immutable\";\nimport {settings as defaultSettings} from \"../config/default\";\n\n\n// helpers\nconst isObject = (v) => (typeof v == \"object\" && v !== null && !Array.isArray(v));\n\nexport const mongodbFormat = (tree, config) => {\n  return _mongodbFormat(tree, config, false);\n};\n\nexport const _mongodbFormat = (tree, config, returnErrors = true) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n\n  const res = formatItem([], tree, config, meta);\n\n  if (returnErrors) {\n    return [res, meta.errors];\n  } else {\n    if (meta.errors.length)\n      console.warn(\"Errors while exporting to MongoDb:\", meta.errors);\n    return res;\n  }\n};\n\n\nconst formatItem = (parents, item, config, meta, _not = false, _canWrapExpr = true, _fieldName = undefined, _value = undefined) => {\n  if (!item) return undefined;\n\n  const type = item.get(\"type\");\n\n  if ((type === \"group\" || type === \"rule_group\")) {\n    return formatGroup(parents, item, config, meta, _not, _canWrapExpr, _fieldName, _value);\n  } else if (type === \"rule\") {\n    return formatRule(parents, item, config, meta, _not, _canWrapExpr, _fieldName, _value);\n  }\n  return undefined;\n};\n\n\nconst formatGroup = (parents, item, config, meta, _not = false, _canWrapExpr = true, _fieldName = undefined, _value = undefined) => {\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const children = item.get(\"children1\");\n  const {canShortMongoQuery} = config.settings;\n  if (!children) return undefined;\n\n  const hasParentRuleGroup = parents.filter(it => it.get(\"type\") == \"rule_group\").length > 0;\n  const parentPath = parents\n    .filter(it => it.get(\"type\") == \"rule_group\")\n    .map(it => it.get(\"properties\").get(\"field\"))\n    .slice(-1).pop();\n  const realParentPath = hasParentRuleGroup && parentPath;\n\n  const groupField = type === \"rule_group\" ? properties.get(\"field\") : null;\n  const groupFieldName = formatFieldName(groupField, config, meta, realParentPath);\n  const groupFieldDef = getFieldConfig(config, groupField) || {};\n  const mode = groupFieldDef.mode; //properties.get(\"mode\");\n  const canHaveEmptyChildren = groupField && mode == \"array\";\n\n  const not = _not ? !(properties.get(\"not\")) : (properties.get(\"not\"));\n  const list = children\n    .map((currentChild) => formatItem(\n      [...parents, item], currentChild, config, meta, not, true, mode == \"array\" ? (f => `$$el.${f}`) : undefined)\n    )\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n  if (!canHaveEmptyChildren && !list.size)\n    return undefined;\n\n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  let conjunctionDefinition = config.conjunctions[conjunction];\n  const reversedConj = conjunctionDefinition.reversedConj;\n  if (not && reversedConj) {\n    conjunction = reversedConj;\n    conjunctionDefinition = config.conjunctions[conjunction];\n  }\n  const mongoConj = conjunctionDefinition.mongoConj;\n\n  let resultQuery;\n  if (list.size == 1) {\n    resultQuery = list.first();\n  } else if (list.size > 1) {\n    const rules = list.toList().toJS();\n    const canShort = canShortMongoQuery && (mongoConj == \"$and\");\n    if (canShort) {\n      resultQuery = rules.reduce((acc, rule) => {\n        if (!acc) return undefined;\n        for (let k in rule) {\n          if (k[0] == \"$\") {\n            acc = undefined;\n            break;\n          }\n          if (acc[k] == undefined) {\n            acc[k] = rule[k];\n          } else {\n            // https://github.com/ukrbublik/react-awesome-query-builder/issues/182\n            let prev = acc[k], next = rule[k];\n            if (!isObject(prev)) {\n              prev = {\"$eq\": prev};\n            }\n            if (!isObject(next)) {\n              next = {\"$eq\": next};\n            }\n            const prevOp = Object.keys(prev)[0], nextOp = Object.keys(next)[0];\n            if (prevOp == nextOp) {\n              acc = undefined;\n              break;\n            }\n            acc[k] = Object.assign({}, prev, next);\n          }\n        }\n        return acc;\n      }, {});\n    }\n    if (!resultQuery) // can't be shorten\n      resultQuery = { [mongoConj] : rules };\n  }\n\n  if (groupField) {\n    if (mode == \"array\") {\n      const totalQuery = {\n        \"$size\": groupFieldName\n      };\n      const filterQuery = resultQuery ? {\n        \"$size\": {\n          \"$filter\": {\n            input: \"$\" + groupFieldName,\n            as: \"el\",\n            cond: resultQuery\n          }\n        }\n      } : totalQuery;\n      resultQuery = formatItem(\n        parents, item.set(\"type\", \"rule\"), config, meta, false, false, (_f => filterQuery), totalQuery\n      );\n      resultQuery = { \"$expr\": resultQuery };\n    } else {\n      resultQuery = { [groupFieldName]: {\"$elemMatch\": resultQuery} };\n    }\n  }\n  return resultQuery;\n};\n\n\nconst formatRule = (parents, item, config, meta, _not = false, _canWrapExpr = true, _fieldName = undefined, _value = undefined) => {\n  const properties = item.get(\"properties\") || new Map();\n\n  const hasParentRuleGroup = parents.filter(it => it.get(\"type\") == \"rule_group\").length > 0;\n  const parentPath = parents\n    .filter(it => it.get(\"type\") == \"rule_group\")\n    .map(it => it.get(\"properties\").get(\"field\"))\n    .slice(-1).pop();\n  const realParentPath = hasParentRuleGroup && parentPath;\n\n  let operator = properties.get(\"operator\");\n  const operatorOptions = properties.get(\"operatorOptions\");\n  const field = properties.get(\"field\");\n  const iValue = properties.get(\"value\");\n  const iValueSrc = properties.get(\"valueSrc\");\n  const iValueType = properties.get(\"valueType\");\n  const asyncListValues = properties.get(\"asyncListValues\");\n\n  if (field == null || operator == null || iValue === undefined)\n    return undefined;\n\n  const fieldDef = getFieldConfig(config, field) || {};\n  let operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  let reversedOp = operatorDefinition.reversedOp;\n  let revOperatorDefinition = getOperatorConfig(config, reversedOp, field) || {};\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n\n  let not = _not;\n  if (not && reversedOp) {\n    [operator, reversedOp] = [reversedOp, operator];\n    [operatorDefinition, revOperatorDefinition] = [revOperatorDefinition, operatorDefinition];\n    not = false;\n  }\n\n  const fieldName = formatFieldName(field, config, meta, realParentPath);\n\n  //format value\n  let valueSrcs = [];\n  let valueTypes = [];\n  let useExpr = false;\n  const fvalue = iValue.map((currentValue, ind) => {\n    const valueSrc = iValueSrc ? iValueSrc.get(ind) : null;\n    const valueType = iValueType ? iValueType.get(ind) : null;\n    const cValue = completeValue(currentValue, valueSrc, config);\n    const widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n    const fieldWidgetDef = omit(getFieldWidgetConfig(config, field, operator, widget, valueSrc), [\"factory\"]);\n    const [fv, fvUseExpr] = formatValue(\n      meta, config, cValue, valueSrc, valueType, fieldWidgetDef, fieldDef, realParentPath,  operator, operatorDefinition, asyncListValues\n    );\n    if (fv !== undefined) {\n      useExpr = useExpr || fvUseExpr;\n      valueSrcs.push(valueSrc);\n      valueTypes.push(valueType);\n    }\n    return fv;\n  });\n  if (_fieldName)\n    useExpr = true;\n  const wrapExpr = useExpr && _canWrapExpr;\n  const hasUndefinedValues = fvalue.filter(v => v === undefined).size > 0;\n  if (fvalue.size < cardinality || hasUndefinedValues)\n    return undefined;\n  const formattedValue = cardinality > 1 ? fvalue.toArray() : (cardinality == 1 ? fvalue.first() : null);\n  \n  //build rule\n  const fn = operatorDefinition.mongoFormatOp;\n  if (!fn) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n  const args = [\n    _fieldName ? _fieldName(fieldName) : fieldName,\n    operator,\n    _value !== undefined && formattedValue == null ? _value : formattedValue,\n    useExpr,\n    (valueSrcs.length > 1 ? valueSrcs : valueSrcs[0]),\n    (valueTypes.length > 1 ? valueTypes : valueTypes[0]),\n    omit(operatorDefinition, [\"formatOp\", \"mongoFormatOp\", \"sqlFormatOp\", \"jsonLogic\", \"spelFormatOp\"]),\n    operatorOptions,\n    fieldDef,\n  ];\n  let ruleQuery = fn(...args);\n  if (wrapExpr) {\n    ruleQuery = { \"$expr\": ruleQuery };\n  }\n  if (not) {\n    ruleQuery = { \"$not\": ruleQuery };\n  }\n  return ruleQuery;\n};\n\n\nconst formatValue = (meta, config, currentValue, valueSrc, valueType, fieldWidgetDef, fieldDef, parentPath, operator, operatorDef, asyncListValues) => {\n  if (currentValue === undefined)\n    return [undefined, false];\n  \n  let ret;\n  let useExpr = false;\n\n  if (valueSrc == \"field\") {\n    [ret, useExpr] = formatRightField(meta, config, currentValue, parentPath);\n  } else if (valueSrc == \"func\") {\n    [ret, useExpr] = formatFunc(meta, config, currentValue, parentPath);\n  } else {\n    if (typeof fieldWidgetDef.mongoFormatValue === \"function\") {\n      const fn = fieldWidgetDef.mongoFormatValue;\n      const args = [\n        currentValue,\n        {\n          ...pick(fieldDef, [\"fieldSettings\", \"listValues\"]),\n          asyncListValues\n        },\n        //useful options: valueFormat for date/time\n        omit(fieldWidgetDef, [\"formatValue\", \"mongoFormatValue\", \"sqlFormatValue\", \"jsonLogic\", \"elasticSearchFormatValue\", \"spelFormatValue\"]),\n      ];\n      if (operator) {\n        args.push(operator);\n        args.push(operatorDef);\n      }\n      ret = fn(...args);\n    } else {\n      ret = currentValue;\n    }\n  }\n\n  return [ret, useExpr];\n};\n\n\n\nconst formatFieldName = (field, config, meta, parentPath) => {\n  if (!field) return;\n  const fieldDef = getFieldConfig(config, field) || {};\n  const {fieldSeparator} = config.settings;\n  const fieldParts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  let fieldName = Array.isArray(field) ? field.join(fieldSeparator) : field;\n  // if (fieldDef.tableName) { // legacy\n  //     const fieldPartsCopy = [...fieldParts];\n  //     fieldPartsCopy[0] = fieldDef.tableName;\n  //     fieldName = fieldPartsCopy.join(fieldSeparator);\n  // }\n  if (fieldDef.fieldName) {\n    fieldName = fieldDef.fieldName;\n  }\n\n  if (parentPath) {\n    const parentFieldDef = getFieldConfig(config, parentPath) || {};\n    let parentFieldName = parentPath;\n    if (parentFieldDef.fieldName) {\n      parentFieldName = parentFieldDef.fieldName;\n    }\n    if (fieldName.indexOf(parentFieldName+\".\") == 0) {\n      fieldName = fieldName.slice((parentFieldName+\".\").length);\n    } else {\n      meta.errors.push(`Can't cut group ${parentFieldName} from field ${fieldName}`);\n    }\n  }\n  return fieldName;\n};\n\nconst formatRightField = (meta, config, rightField, parentPath) => {\n  const {fieldSeparator} = config.settings;\n  let ret;\n  const useExpr = true;\n\n  if (rightField) {\n    const rightFieldDefinition = getFieldConfig(config, rightField) || {};\n    const fieldParts = Array.isArray(rightField) ? rightField : rightField.split(fieldSeparator);\n    const _fieldKeys = getFieldPath(rightField, config);\n    const fieldPartsLabels = getFieldPathLabels(rightField, config);\n    const fieldFullLabel = fieldPartsLabels ? fieldPartsLabels.join(fieldSeparator) : null;\n    const formatFieldFn = config.settings.formatField || defaultSettings.formatField;\n    const rightFieldName = formatFieldName(rightField, config, meta, parentPath);\n    const formattedField = formatFieldFn(rightFieldName, fieldParts, fieldFullLabel, rightFieldDefinition, config, false);\n    ret = \"$\" + formattedField;\n  }\n\n  return [ret, useExpr];\n};\n\n\nconst formatFunc = (meta, config, currentValue, parentPath) => {\n  const useExpr = true;\n  let ret;\n\n  const funcKey = currentValue.get(\"func\");\n  const args = currentValue.get(\"args\");\n  const funcConfig = getFuncConfig(config, funcKey);\n  const funcName = funcConfig.mongoFunc || funcKey;\n  const mongoArgsAsObject = funcConfig.mongoArgsAsObject;\n\n  let formattedArgs = {};\n  let argsCnt = 0;\n  let lastArg = undefined;\n  for (const argKey in funcConfig.args) {\n    const argConfig = funcConfig.args[argKey];\n    const fieldDef = getFieldConfig(config, argConfig);\n    const argVal = args ? args.get(argKey) : undefined;\n    const argValue = argVal ? argVal.get(\"value\") : undefined;\n    const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n    const argAsyncListValues = argVal ? argVal.get(\"asyncListValues\") : undefined;\n    const widget = getWidgetForFieldOp(config, fieldDef, null, argValueSrc);\n    const fieldWidgetDef = omit(getFieldWidgetConfig(config, fieldDef, null, widget, argValueSrc), [\"factory\"]);\n    const [formattedArgVal, _argUseExpr] = formatValue(\n      meta, config, argValue, argValueSrc, argConfig.type, fieldWidgetDef, fieldDef, parentPath, null, null, argAsyncListValues\n    );\n    if (argValue != undefined && formattedArgVal === undefined) {\n      meta.errors.push(`Can't format value of arg ${argKey} for func ${funcKey}`);\n      return [undefined, false];\n    }\n    argsCnt++;\n    if (formattedArgVal !== undefined) { // skip optional in the end\n      formattedArgs[argKey] = formattedArgVal;\n      lastArg = formattedArgVal;\n    }\n  }\n\n  if (typeof funcConfig.mongoFormatFunc === \"function\") {\n    const fn = funcConfig.mongoFormatFunc;\n    const args = [\n      formattedArgs,\n    ];\n    ret = fn(...args);\n  } else if (funcConfig.mongoFormatFunc === null) {\n    meta.errors.push(`Functon ${funcName} is not supported`);\n    return [undefined, false];\n  } else {\n    if (mongoArgsAsObject)\n      ret = { [funcName]: formattedArgs };\n    else if (argsCnt == 1 && lastArg !== undefined)\n      ret = { [funcName]: lastArg };\n    else\n      ret = { [funcName]: Object.values(formattedArgs) };\n  }\n\n  return [ret, useExpr];\n};\n\n\n","import {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig\n} from \"../utils/configUtils\";\nimport {\n  getFieldPath, getFieldPathLabels, getWidgetForFieldOp, formatFieldName\n} from \"../utils/ruleUtils\";\nimport omit from \"lodash/omit\";\nimport pick from \"lodash/pick\";\nimport {defaultValue} from \"../utils/stuff\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {settings as defaultSettings} from \"../config/default\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport {Map} from \"immutable\";\nimport {SqlString} from \"../utils/export\";\n\nexport const sqlFormat = (tree, config) => {\n  return _sqlFormat(tree, config, false);\n};\n\nexport const _sqlFormat = (tree, config, returnErrors = true) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n\n  const res = formatItem(tree, config, meta);\n\n  if (returnErrors) {\n    return [res, meta.errors];\n  } else {\n    if (meta.errors.length)\n      console.warn(\"Errors while exporting to SQL:\", meta.errors);\n    return res;\n  }\n};\n\n\nconst formatItem = (item, config, meta) => {\n  if (!item) return undefined;\n  const type = item.get(\"type\");\n  const children = item.get(\"children1\");\n\n  if ((type === \"group\" || type === \"rule_group\") && children && children.size) {\n    return formatGroup(item, config, meta);\n  } else if (type === \"rule\") {\n    return formatRule(item, config, meta);\n  }\n\n  return undefined;\n};\n\n\nconst formatGroup = (item, config, meta) => {\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const children = item.get(\"children1\");\n\n  const groupField = type === \"rule_group\" ? properties.get(\"field\") : null;\n  const groupFieldDef = getFieldConfig(config, groupField) || {};\n  if (groupFieldDef.mode == \"array\") {\n    meta.errors.push(`Aggregation is not supported for ${groupField}`);\n  }\n\n  const not = properties.get(\"not\");\n  const list = children\n    .map((currentChild) => formatItem(currentChild, config, meta))\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n  if (!list.size)\n    return undefined;\n\n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  const conjunctionDefinition = config.conjunctions[conjunction];\n\n  return conjunctionDefinition.sqlFormatConj(list, conjunction, not);\n};\n\nconst buildFnToFormatOp = (operator, operatorDefinition) => {\n  const sqlOp = operatorDefinition.sqlOp || operator;\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  let fn;\n  if (cardinality == 0) {\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      return `${field} ${sqlOp}`;\n    };\n  } else if (cardinality == 1) {\n    fn = (field, op, value, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      return `${field} ${sqlOp} ${value}`;\n    };\n  } else if (cardinality == 2) {\n    // between\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      const valFrom = values.first();\n      const valTo = values.get(1);\n      return `${field} ${sqlOp} ${valFrom} AND ${valTo}`;\n    };\n  }\n  return fn;\n};\n\nconst formatRule = (item, config, meta) => {\n  const properties = item.get(\"properties\") || new Map();\n  const field = properties.get(\"field\");\n  let operator = properties.get(\"operator\");\n  const operatorOptions = properties.get(\"operatorOptions\");\n  const iValueSrc = properties.get(\"valueSrc\");\n  const iValueType = properties.get(\"valueType\");\n  const iValue = properties.get(\"value\");\n  const asyncListValues = properties.get(\"asyncListValues\");\n  if (field == null || operator == null)\n    return undefined;\n\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  let opDef = getOperatorConfig(config, operator, field) || {};\n  let reversedOp = opDef.reversedOp;\n  let revOpDef = getOperatorConfig(config, reversedOp, field) || {};\n  const cardinality = defaultValue(opDef.cardinality, 1);\n\n  // check op\n  let isRev = false;\n  const canFormatOp = opDef.sqlOp || opDef.sqlFormatOp;\n  const canFormatRevOp = revOpDef.sqlOp || revOpDef.sqlFormatOp;\n  if (!canFormatOp && !canFormatRevOp) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n  if (!canFormatRevOp && canFormatRevOp) {\n    isRev = true;\n    [operator, reversedOp] = [reversedOp, operator];\n    [opDef, revOpDef] = [revOpDef, opDef];\n  }\n\n  //format value\n  let valueSrcs = [];\n  let valueTypes = [];\n  const fvalue = iValue.map((currentValue, ind) => {\n    const valueSrc = iValueSrc ? iValueSrc.get(ind) : null;\n    const valueType = iValueType ? iValueType.get(ind) : null;\n    const cValue = completeValue(currentValue, valueSrc, config);\n    const widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n    const fieldWidgetDefinition = omit(getFieldWidgetConfig(config, field, operator, widget, valueSrc), [\"factory\"]);\n    let fv = formatValue(\n      meta, config, cValue, valueSrc, valueType, fieldWidgetDefinition, fieldDefinition, operator, opDef, asyncListValues\n    );\n    if (fv !== undefined) {\n      valueSrcs.push(valueSrc);\n      valueTypes.push(valueType);\n    }\n    return fv;\n  });\n  const hasUndefinedValues = fvalue.filter(v => v === undefined).size > 0;\n  if (hasUndefinedValues || fvalue.size < cardinality)\n    return undefined;\n  const formattedValue = (cardinality == 1 ? fvalue.first() : fvalue);\n\n  //find fn to format expr\n  const fn = opDef.sqlFormatOp || buildFnToFormatOp(operator, opDef);\n  if (!fn) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n      \n  //format field\n  const formattedField = formatField(meta, config, field);\n      \n  //format expr\n  const args = [\n    formattedField,\n    operator,\n    formattedValue,\n    (valueSrcs.length > 1 ? valueSrcs : valueSrcs[0]),\n    (valueTypes.length > 1 ? valueTypes : valueTypes[0]),\n    omit(opDef, [\"formatOp\", \"mongoFormatOp\", \"sqlFormatOp\", \"jsonLogic\", \"spelFormatOp\"]),\n    operatorOptions,\n    fieldDefinition,\n  ];\n\n  let ret;\n  ret = fn(...args);\n  if (isRev) {\n    ret = config.settings.sqlFormatReverse(ret);\n  }\n  if (ret === undefined) {\n    meta.errors.push(`Operator ${operator} is not supported for value source ${valueSrcs.join(\", \")}`);\n    return undefined;\n  }\n  return ret;\n};\n\n\nconst formatValue = (meta, config, currentValue, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, operatorDef, asyncListValues) => {\n  if (currentValue === undefined)\n    return undefined;\n  let ret;\n  if (valueSrc == \"field\") {\n    ret = formatField(meta, config, currentValue);\n  } else if (valueSrc == \"func\") {\n    ret = formatFunc(meta, config, currentValue);\n  } else {\n    if (typeof fieldWidgetDef.sqlFormatValue === \"function\") {\n      const fn = fieldWidgetDef.sqlFormatValue;\n      const args = [\n        currentValue,\n        {\n          ...pick(fieldDef, [\"fieldSettings\", \"listValues\"]),\n          asyncListValues\n        },\n        //useful options: valueFormat for date/time\n        omit(fieldWidgetDef, [\"formatValue\", \"mongoFormatValue\", \"sqlFormatValue\", \"jsonLogic\", \"elasticSearchFormatValue\", \"spelFormatValue\"]),\n      ];\n      if (operator) {\n        args.push(operator);\n        args.push(operatorDef);\n      }\n      if (valueSrc == \"field\") {\n        const valFieldDefinition = getFieldConfig(config, currentValue) || {}; \n        args.push(valFieldDefinition);\n      }\n      ret = fn(...args);\n    } else {\n      if (Array.isArray(currentValue)) {\n        ret = currentValue.map(v => SqlString.escape(v));\n      } else {\n        ret = SqlString.escape(currentValue);\n      }\n    }\n  }\n  return ret;\n};\n\nconst formatField = (meta, config, field) => {\n  if (!field) return;\n  const {fieldSeparator} = config.settings;\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  const fieldParts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  const _fieldKeys = getFieldPath(field, config);\n  const fieldPartsLabels = getFieldPathLabels(field, config);\n  const fieldFullLabel = fieldPartsLabels ? fieldPartsLabels.join(fieldSeparator) : null;\n  const formatFieldFn = config.settings.formatField || defaultSettings.formatField;\n  const fieldName = formatFieldName(field, config, meta);\n  const formattedField = formatFieldFn(fieldName, fieldParts, fieldFullLabel, fieldDefinition, config);\n  return formattedField;\n};\n\n\nconst formatFunc = (meta, config, currentValue) => {\n  const funcKey = currentValue.get(\"func\");\n  const args = currentValue.get(\"args\");\n  const funcConfig = getFuncConfig(config, funcKey);\n  const funcName = funcConfig.sqlFunc || funcKey;\n\n  let formattedArgs = {};\n  for (const argKey in funcConfig.args) {\n    const argConfig = funcConfig.args[argKey];\n    const fieldDef = getFieldConfig(config, argConfig);\n    const argVal = args ? args.get(argKey) : undefined;\n    const argValue = argVal ? argVal.get(\"value\") : undefined;\n    const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n    const argAsyncListValues = argVal ? argVal.get(\"asyncListValues\") : undefined;\n    const formattedArgVal = formatValue(\n      meta, config, argValue, argValueSrc, argConfig.type, fieldDef, argConfig, null, null, argAsyncListValues\n    );\n    if (argValue != undefined && formattedArgVal === undefined) {\n      meta.errors.push(`Can't format value of arg ${argKey} for func ${funcKey}`);\n      return undefined;\n    }\n    if (formattedArgVal !== undefined) { // skip optional in the end\n      formattedArgs[argKey] = formattedArgVal;\n    }\n  }\n\n  let ret;\n  if (typeof funcConfig.sqlFormatFunc === \"function\") {\n    const fn = funcConfig.sqlFormatFunc;\n    const args = [\n      formattedArgs\n    ];\n    ret = fn(...args);\n  } else {\n    const argsStr = Object.entries(formattedArgs)\n      .map(([k, v]) => v)\n      .join(\", \");\n    ret = `${funcName}(${argsStr})`;\n  }\n  return ret;\n};\n","import {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig\n} from \"../utils/configUtils\";\nimport {\n  getFieldPath, getWidgetForFieldOp, formatFieldName, getFieldPartsConfigs\n} from \"../utils/ruleUtils\";\nimport omit from \"lodash/omit\";\nimport pick from \"lodash/pick\";\nimport {defaultValue, logger} from \"../utils/stuff\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {settings as defaultSettings} from \"../config/default\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport {Map} from \"immutable\";\nimport {spelEscape} from \"../utils/export\";\n\nexport const spelFormat = (tree, config) => {\n  return _spelFormat(tree, config, false);\n};\n\nexport const _spelFormat = (tree, config, returnErrors = true) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n\n  const res = formatItem(tree, config, meta, null);\n\n  if (returnErrors) {\n    return [res, meta.errors];\n  } else {\n    if (meta.errors.length)\n      console.warn(\"Errors while exporting to SpEL:\", meta.errors);\n    return res;\n  }\n};\n\n\nconst formatItem = (item, config, meta, parentField = null) => {\n  if (!item) return undefined;\n  const type = item.get(\"type\");\n\n  if ((type === \"group\" || type === \"rule_group\")) {\n    return formatGroup(item, config, meta, parentField);\n  } else if (type === \"rule\") {\n    return formatRule(item, config, meta, parentField);\n  } else if (type == \"switch_group\") {\n    return formatSwitch(item, config, meta, parentField);\n  } else if (type == \"case_group\") {\n    return formatCase(item, config, meta, parentField);\n  }\n\n  return undefined;\n};\n\nconst formatCase = (item, config, meta, parentField = null) => {\n  const type = item.get(\"type\");\n  if (type != \"case_group\") {\n    meta.errors.push(`Unexpected child of type ${type} inside switch`);\n    return undefined;\n  }\n  const properties = item.get(\"properties\") || new Map();\n  \n  const [formattedValue, valueSrc, valueType] = formatItemValue(\n    config, properties, meta, null, parentField, \"!case_value\"\n  );\n\n  const cond = formatGroup(item, config, meta, parentField);\n  return [cond, formattedValue];\n};\n\nconst formatSwitch = (item, config, meta, parentField = null) => {\n  const properties = item.get(\"properties\") || new Map();\n  const children = item.get(\"children1\");\n  if (!children) return undefined;\n  const cases = children\n    .map((currentChild) => formatCase(currentChild, config, meta, null))\n    .filter((currentChild) => typeof currentChild !== \"undefined\")\n    .toArray();\n  \n  if (!cases.length) return undefined;\n\n  if (cases.length == 1 && !cases[0][0]) {\n    // only 1 case without condition\n    return cases[0][1];\n  }\n\n  let filteredCases = [];\n  for (let i = 0 ; i < cases.length ; i++) {\n    if (i != (cases.length - 1) && !cases[i][0]) {\n      meta.errors.push(`No condition for case ${i}`);\n    } else {\n      filteredCases.push(cases[i]);\n      if (i == (cases.length - 1) && cases[i][0]) {\n        // no default - add null as default\n        filteredCases.push([undefined, null]);\n      }\n    }\n  }\n\n  let left = \"\", right = \"\";\n  for (let i = 0 ; i < filteredCases.length ; i++) {\n    let [cond, value] = filteredCases[i];\n    if (value == undefined)\n      value = \"null\";\n    if (cond == undefined)\n      cond = \"true\";\n    if (i != (filteredCases.length - 1)) {\n      left += `(${cond} ? ${value} : `;\n      right += \")\";\n    } else {\n      left += `${value}`;\n    }\n  }\n  return left + right;\n};\n\nconst formatGroup = (item, config, meta, parentField = null) => {\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const mode = properties.get(\"mode\");\n  const children = item.get(\"children1\");\n  const field = properties.get(\"field\");\n  if (!children) return undefined;\n\n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  const conjunctionDefinition = config.conjunctions[conjunction];\n  const not = properties.get(\"not\");\n\n  const isRuleGroup = type === \"rule_group\";\n  const isRuleGroupArray = isRuleGroup && mode != \"struct\";\n  const groupField = isRuleGroupArray ? field : parentField;\n  const groupFieldDef = getFieldConfig(config, groupField) || {};\n  const isSpelArray = groupFieldDef.isSpelArray;\n  \n  // check op for reverse\n  let groupOperator = properties.get(\"operator\");\n  if (!groupOperator && (!mode || mode == \"some\")) {\n    groupOperator = \"some\";\n  }\n  const realGroupOperator = checkOp(config, groupOperator, field);\n  const isGroupOpRev = realGroupOperator != groupOperator;\n  const realGroupOperatorDefinition = groupOperator && getOperatorConfig(config, realGroupOperator, field) || null;\n  const isGroup0 = isRuleGroup && (!realGroupOperator || realGroupOperatorDefinition.cardinality == 0);\n  \n  // build value for aggregation op\n  const [formattedValue, valueSrc, valueType] = formatItemValue(\n    config, properties, meta, realGroupOperator, parentField, null\n  );\n  \n  // build filter in aggregation\n  const list = children\n    .map((currentChild) => formatItem(currentChild, config, meta, groupField))\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n\n  if (isRuleGroupArray && !isGroup0) {\n    // \"count\" rule can have no \"having\" children, but should have number value\n    if (formattedValue == undefined)\n      return undefined;\n  } else {\n    if (!list.size)\n      return undefined;\n  }\n\n  const omitBrackets = isRuleGroup;\n  const filter = list.size ? conjunctionDefinition.spelFormatConj(list, conjunction, not, omitBrackets) : null;\n\n  // build result\n  let ret;\n  if (isRuleGroupArray) {\n    const formattedField = formatField(meta, config, field, parentField);\n    const getSize = isSpelArray ? \".length\" : \".size()\";\n    const fullSize = `${formattedField}${getSize}`;\n    // https://docs.spring.io/spring-framework/docs/3.2.x/spring-framework-reference/html/expressions.html#expressions-collection-selection\n    const filteredSize = filter ? `${formattedField}.?[${filter}]${getSize}` : fullSize;\n    const groupValue = isGroup0 ? fullSize : formattedValue;\n    // format expression\n    ret = formatExpression(\n      meta, config, properties, filteredSize, groupValue, realGroupOperator, valueSrc, valueType, isGroupOpRev\n    );\n  } else {\n    ret = filter;\n  }\n  \n  return ret;\n};\n\nconst buildFnToFormatOp = (operator, operatorDefinition) => {\n  const spelOp = operatorDefinition.spelOp;\n  if (!spelOp) return undefined;\n  const objectIsFirstArg = spelOp[0] == \"$\";\n  const isMethod = spelOp[0] == \".\" || objectIsFirstArg;\n  const sop = isMethod ? spelOp.slice(1) : spelOp;\n  let fn;\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  if (cardinality == 0) {\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (isMethod)\n        return `${field}.${sop}()`;\n      else\n        return `${field} ${sop}`;\n    };\n  } else if (cardinality == 1) {\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, fieldDef) => {\n      if (objectIsFirstArg)\n        return `${values}.${sop}(${field})`;\n      else if (isMethod)\n        return `${field}.${sop}(${values})`;\n      else\n        return `${field} ${sop} ${values}`;\n    };\n  }\n  return fn;\n};\n\nconst formatExpression = (meta, config, properties, formattedField, formattedValue, operator, valueSrc, valueType, isRev = false) => {\n  const field = properties.get(\"field\");\n  const opDef = getOperatorConfig(config, operator, field) || {};\n  const fieldDef = getFieldConfig(config, field) || {};\n  const operatorOptions = properties.get(\"operatorOptions\");\n\n  //find fn to format expr\n  const fn = opDef.spelFormatOp || buildFnToFormatOp(operator, opDef);\n  if (!fn) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n\n  //format expr\n  const args = [\n    formattedField,\n    operator,\n    formattedValue,\n    valueSrc,\n    valueType,\n    omit(opDef, [\"formatOp\", \"mongoFormatOp\", \"sqlFormatOp\", \"jsonLogic\", \"spelFormatOp\"]),\n    operatorOptions,\n    fieldDef,\n  ];\n  let ret;\n  ret = fn(...args);\n\n  //rev\n  if (isRev) {\n    ret = config.settings.spelFormatReverse(ret);\n  }\n\n  if (ret === undefined) {\n    meta.errors.push(`Operator ${operator} is not supported for value source ${valueSrc}`);\n  }\n\n  return ret;\n};\n\nconst checkOp = (config, operator, field) => {\n  if (!operator) return undefined;\n  let opDef = getOperatorConfig(config, operator, field) || {};\n  let reversedOp = opDef.reversedOp;\n  let revOpDef = getOperatorConfig(config, reversedOp, field) || {};\n\n  let isRev = false;\n  const canFormatOp = opDef.spelOp || opDef.spelFormatOp;\n  const canFormatRevOp = revOpDef.spelOp || revOpDef.spelFormatOp;\n  if (!canFormatOp && !canFormatRevOp) {\n    return undefined;\n  }\n  if (!canFormatOp && canFormatRevOp) {\n    isRev = true;\n    [operator, reversedOp] = [reversedOp, operator];\n    [opDef, revOpDef] = [revOpDef, opDef];\n  }\n  return operator;\n};\n\nconst formatRule = (item, config, meta, parentField = null) => {\n  const properties = item.get(\"properties\") || new Map();\n  const field = properties.get(\"field\");\n  let operator = properties.get(\"operator\");\n  if (field == null || operator == null)\n    return undefined;\n\n  // check op for reverse\n  const realOp = checkOp(config, operator, field);\n  if (!realOp) {\n    meta.errors.push(`Operator ${operator} is not supported`);\n    return undefined;\n  }\n  const isRev = realOp != operator;\n\n  //format value\n  const [formattedValue, valueSrc, valueType] = formatItemValue(\n    config, properties, meta, realOp, parentField, null\n  );\n  if (formattedValue === undefined)\n    return undefined;\n      \n  //format field\n  const formattedField = formatField(meta, config, field, parentField);\n  \n  // format expression\n  let res = formatExpression(\n    meta, config, properties, formattedField, formattedValue, realOp, valueSrc, valueType, isRev\n  );\n  return res;\n};\n\nconst formatItemValue = (config, properties, meta, operator, parentField, expectedValueType = null) => {\n  let field = properties.get(\"field\");\n  const iValueSrc = properties.get(\"valueSrc\");\n  const iValueType = properties.get(\"valueType\");\n  if (expectedValueType == \"!case_value\" || iValueType && iValueType.get(0) == \"case_value\") {\n    field = \"!case_value\";\n  }\n  const fieldDef = getFieldConfig(config, field) || {};\n  const operatorDefinition = getOperatorConfig(config, operator, field) || {};\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  const iValue = properties.get(\"value\");\n  const asyncListValues = properties.get(\"asyncListValues\");\n  \n  let valueSrcs = [];\n  let valueTypes = [];\n  let formattedValue;\n  \n  if (iValue != undefined) {\n    const fvalue = iValue.map((currentValue, ind) => {\n      const valueSrc = iValueSrc ? iValueSrc.get(ind) : null;\n      const valueType = iValueType ? iValueType.get(ind) : null;\n      const cValue = completeValue(currentValue, valueSrc, config);\n      const widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n      const fieldWidgetDef = omit(getFieldWidgetConfig(config, field, operator, widget, valueSrc), [\"factory\"]);\n      const fv = formatValue(\n        meta, config, cValue, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, operatorDefinition, parentField, asyncListValues\n      );\n      if (fv !== undefined) {\n        valueSrcs.push(valueSrc);\n        valueTypes.push(valueType);\n      }\n      return fv;\n    });\n    const hasUndefinedValues = fvalue.filter(v => v === undefined).size > 0;\n    if (!( fvalue.size < cardinality || hasUndefinedValues )) {\n      formattedValue = cardinality > 1 ? fvalue.toArray() : (cardinality == 1 ? fvalue.first() : null);\n    }\n  }\n  \n  return [\n    formattedValue, \n    (valueSrcs.length > 1 ? valueSrcs : valueSrcs[0]),\n    (valueTypes.length > 1 ? valueTypes : valueTypes[0]),\n  ];\n};\n\nconst formatValue = (meta, config, currentValue, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, operatorDef, parentField = null, asyncListValues) => {\n  if (currentValue === undefined)\n    return undefined;\n  let ret;\n  if (valueSrc == \"field\") {\n    ret = formatField(meta, config, currentValue, parentField);\n  } else if (valueSrc == \"func\") {\n    ret = formatFunc(meta, config, currentValue, parentField);\n  } else {\n    if (typeof fieldWidgetDef.spelFormatValue === \"function\") {\n      const fn = fieldWidgetDef.spelFormatValue;\n      const args = [\n        currentValue,\n        {\n          ...pick(fieldDef, [\"fieldSettings\", \"listValues\"]),\n          asyncListValues\n        },\n        //useful options: valueFormat for date/time\n        omit(fieldWidgetDef, [\"formatValue\", \"mongoFormatValue\", \"sqlFormatValue\", \"jsonLogic\", \"elasticSearchFormatValue\", \"spelFormatValue\"]),\n      ];\n      if (operator) {\n        args.push(operator);\n        args.push(operatorDef);\n      }\n      if (valueSrc == \"field\") {\n        const valFieldDefinition = getFieldConfig(config, currentValue) || {}; \n        args.push(valFieldDefinition);\n      }\n      ret = fn(...args);\n    } else {\n      ret = spelEscape(currentValue);\n    }\n  }\n  return ret;\n};\n\nconst formatField = (meta, config, field, parentField = null) => {\n  if (!field) return;\n  const {fieldSeparator} = config.settings;\n  const fieldDefinition = getFieldConfig(config, field) || {};\n  const fieldParts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  const _fieldKeys = getFieldPath(field, config, parentField);\n  const fieldPartsConfigs = getFieldPartsConfigs(field, config, parentField);\n  const formatFieldFn = config.settings.formatSpelField;\n  let fieldName = formatFieldName(field, config, meta);\n  if (parentField) {\n    const parentFieldDef = getFieldConfig(config, parentField) || {};\n    let parentFieldName = parentField;\n    if (parentFieldDef.fieldName) {\n      parentFieldName = parentFieldDef.fieldName;\n    }\n    if (fieldName.indexOf(parentFieldName + fieldSeparator) == 0) {\n      fieldName = fieldName.slice((parentFieldName + fieldSeparator).length);\n      // fieldName = \"#this.\" + fieldName;\n    } else {\n      meta.errors.push(`Can't cut group ${parentFieldName} from field ${fieldName}`);\n    }\n  }\n  const fieldPartsMeta = fieldPartsConfigs.map(([key, cnf, parentCnf]) => {\n    let parent;\n    if (parentCnf) {\n      if (parentCnf.type == \"!struct\" || parentCnf.type == \"!group\" && parentCnf.mode == \"struct\")\n        parent = cnf.isSpelMap ? \"map\" : \"class\";\n      else if (parentCnf.type == \"!group\")\n        parent = cnf.isSpelItemMap ? \"[map]\" : \"[class]\";\n      else\n        parent = \"class\";\n    }\n    const isSpelVariable = cnf?.isSpelVariable;\n    return {\n      key,\n      parent,\n      isSpelVariable\n    };\n  });\n  const formattedField = formatFieldFn(fieldName, parentField, fieldParts, fieldPartsMeta, fieldDefinition, config);\n  return formattedField;\n};\n\n\nconst formatFunc = (meta, config, currentValue, parentField = null) => {\n  const funcKey = currentValue.get(\"func\");\n  const args = currentValue.get(\"args\");\n  const funcConfig = getFuncConfig(config, funcKey);\n  const funcName = funcConfig.spelFunc || funcKey;\n\n  let formattedArgs = {};\n  for (const argKey in funcConfig.args) {\n    const argConfig = funcConfig.args[argKey];\n    const fieldDef = getFieldConfig(config, argConfig);\n    const argVal = args ? args.get(argKey) : undefined;\n    const argValue = argVal ? argVal.get(\"value\") : undefined;\n    const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n    const argAsyncListValues = argVal ? argVal.get(\"asyncListValues\") : undefined;\n    const formattedArgVal = formatValue(\n      meta, config, argValue, argValueSrc, argConfig.type, fieldDef, argConfig, null, null, parentField, argAsyncListValues\n    );\n    if (argValue != undefined && formattedArgVal === undefined) {\n      meta.errors.push(`Can't format value of arg ${argKey} for func ${funcKey}`);\n      return undefined;\n    }\n    if (formattedArgVal !== undefined) { // skip optional in the end\n      formattedArgs[argKey] = formattedArgVal;\n    }\n  }\n\n  let ret;\n  if (typeof funcConfig.spelFormatFunc === \"function\") {\n    const fn = funcConfig.spelFormatFunc;\n    const args = [\n      formattedArgs\n    ];\n    ret = fn(...args);\n  } else {\n    const args = Object.entries(formattedArgs).map(([k, v]) => v);\n    if (funcName[0] == \".\" && args.length) {\n      const [obj, ...params] = args;\n      ret = `${obj}${funcName}(${params.join(\", \")})`;\n    } else {\n      ret = `${funcName}(${args.join(\", \")})`;\n    }\n  }\n  return ret;\n};\n","import {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig\n} from \"../utils/configUtils\";\nimport {\n  getFieldPath, getFieldPathLabels, getWidgetForFieldOp, formatFieldName\n} from \"../utils/ruleUtils\";\nimport omit from \"lodash/omit\";\nimport pick from \"lodash/pick\";\nimport {defaultValue} from \"../utils/stuff\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\nimport {settings as defaultSettings} from \"../config/default\";\nimport {completeValue} from \"../utils/funcUtils\";\nimport {Map} from \"immutable\";\n\n\nexport const queryString = (item, config, isForDisplay = false) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n\n  const res = formatItem(item, config, meta, isForDisplay, null);\n\n  if (meta.errors.length)\n    console.warn(\"Errors while exporting to string:\", meta.errors);\n  return res;\n};\n\n\nconst formatItem = (item, config, meta, isForDisplay = false, parentField = null) => {\n  if (!item) return undefined;\n  const type = item.get(\"type\");\n  const children = item.get(\"children1\");\n\n  if ((type === \"group\" || type === \"rule_group\") ) {\n    return formatGroup(item, config, meta, isForDisplay, parentField);\n  } else if (type === \"rule\") {\n    return formatRule(item, config, meta, isForDisplay, parentField);\n  }\n\n  return undefined;\n};\n\n\nconst formatGroup = (item, config, meta, isForDisplay = false, parentField = null) => {\n  const type = item.get(\"type\");\n  const properties = item.get(\"properties\") || new Map();\n  const mode = properties.get(\"mode\");\n  const children = item.get(\"children1\");\n  if (!children) return undefined;\n\n  const isRuleGroup = (type === \"rule_group\");\n  // TIP: don't cut group for mode == 'struct' and don't do aggr format (maybe later)\n  const groupField = isRuleGroup && mode == \"array\" ? properties.get(\"field\") : null;\n  const canHaveEmptyChildren = isRuleGroup && mode == \"array\";\n  const not = properties.get(\"not\");\n  const list = children\n    .map((currentChild) => formatItem(currentChild, config, meta, isForDisplay, groupField))\n    .filter((currentChild) => typeof currentChild !== \"undefined\");\n  if (!canHaveEmptyChildren && !list.size)\n    return undefined;\n\n  let conjunction = properties.get(\"conjunction\");\n  if (!conjunction)\n    conjunction = defaultConjunction(config);\n  const conjunctionDefinition = config.conjunctions[conjunction];\n\n  const conjStr = list.size ? conjunctionDefinition.formatConj(list, conjunction, not, isForDisplay) : null;\n  \n  let ret;\n  if (groupField) {\n    const aggrArgs = formatRule(item, config, meta, isForDisplay, parentField, true);\n    if (aggrArgs) {\n      const isRev = aggrArgs.pop();\n      const args = [\n        conjStr,\n        ...aggrArgs\n      ];\n      ret = config.settings.formatAggr(...args);\n      if (isRev) {\n        ret = config.settings.formatReverse(ret, null, null, null, null, isForDisplay);\n      }\n    }\n  } else {\n    ret = conjStr;\n  }\n\n  return ret;\n};\n\n\nconst formatItemValue = (config, properties, meta, _operator, isForDisplay, parentField) => {\n  const field = properties.get(\"field\");\n  const iValueSrc = properties.get(\"valueSrc\");\n  const iValueType = properties.get(\"valueType\");\n  const fieldDef = getFieldConfig(config, field) || {};\n  const operator = _operator || properties.get(\"operator\");\n  const operatorDef = getOperatorConfig(config, operator, field) || {};\n  const cardinality = defaultValue(operatorDef.cardinality, 1);\n  const iValue = properties.get(\"value\");\n  const asyncListValues = properties.get(\"asyncListValues\");\n\n  let valueSrcs = [];\n  let valueTypes = [];\n  let formattedValue;\n\n  if (iValue != undefined) {\n    const fvalue = iValue.map((currentValue, ind) => {\n      const valueSrc = iValueSrc ? iValueSrc.get(ind) : null;\n      const valueType = iValueType ? iValueType.get(ind) : null;\n      const cValue = completeValue(currentValue, valueSrc, config);\n      const widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n      const fieldWidgetDef = omit(getFieldWidgetConfig(config, field, operator, widget, valueSrc), [\"factory\"]);\n      let fv = formatValue(\n        config, meta, cValue, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, operatorDef, isForDisplay, parentField, asyncListValues\n      );\n      if (fv !== undefined) {\n        valueSrcs.push(valueSrc);\n        valueTypes.push(valueType);\n      }\n      return fv;\n    });\n    const hasUndefinedValues = fvalue.filter(v => v === undefined).size > 0;\n    if (!( hasUndefinedValues || fvalue.size < cardinality )) {\n      formattedValue = (cardinality == 1 ? fvalue.first() : fvalue);\n    }\n  }\n\n  return [\n    formattedValue, \n    (valueSrcs.length > 1 ? valueSrcs : valueSrcs[0]),\n    (valueTypes.length > 1 ? valueTypes : valueTypes[0]),\n  ];\n};\n\nconst buildFnToFormatOp = (operator, operatorDefinition) => {\n  const fop = operatorDefinition.labelForFormat || operator;\n  const cardinality = defaultValue(operatorDefinition.cardinality, 1);\n  let fn;\n  if (cardinality == 0) {\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return `${field} ${fop}`;\n    };\n  } else if (cardinality == 1) {\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      return `${field} ${fop} ${values}`;\n    };\n  } else if (cardinality == 2) {\n    // between\n    fn = (field, op, values, valueSrc, valueType, opDef, operatorOptions, isForDisplay) => {\n      const valFrom = values.first();\n      const valTo = values.get(1);\n      return `${field} ${fop} ${valFrom} AND ${valTo}`;\n    };\n  }\n  return fn;\n};\n\nconst formatRule = (item, config, meta, isForDisplay = false, parentField = null, returnArgs = false) => {\n  const properties = item.get(\"properties\") || new Map();\n  const field = properties.get(\"field\");\n  let operator = properties.get(\"operator\");\n  let operatorOptions = properties.get(\"operatorOptions\");\n  if (field == null || operator == null)\n    return undefined;\n  \n  const fieldDef = getFieldConfig(config, field) || {};\n  let operatorDef = getOperatorConfig(config, operator, field) || {};\n  let reversedOp = operatorDef.reversedOp;\n  let revOperatorDef = getOperatorConfig(config, reversedOp, field) || {};\n  \n  //check op\n  let isRev = false;\n  let fn = operatorDef.formatOp;\n  if (!fn && reversedOp) {\n    fn = revOperatorDef.formatOp;\n    if (fn) {\n      isRev = true;\n      [operator, reversedOp] = [reversedOp, operator];\n      [operatorDef, revOperatorDef] = [revOperatorDef, operatorDef];\n    }\n  }\n\n  //find fn to format expr\n  if (!fn)\n    fn = buildFnToFormatOp(operator, operatorDef);\n  if (!fn)\n    return undefined;\n\n  //format field\n  const formattedField = formatField(config, meta, field, isForDisplay, parentField);\n\n  //format value\n  const [formattedValue, valueSrc, valueType] = formatItemValue(\n    config, properties, meta, operator, isForDisplay, parentField\n  );\n  if (formattedValue === undefined)\n    return undefined;\n\n  const args = [\n    formattedField,\n    operator,\n    formattedValue,\n    valueSrc,\n    valueType,\n    omit(operatorDef, [\"formatOp\", \"mongoFormatOp\", \"sqlFormatOp\", \"jsonLogic\", \"spelFormatOp\"]),\n    operatorOptions,\n    isForDisplay,\n    fieldDef,\n    isRev,\n  ];\n\n  if (returnArgs) {\n    return args;\n  } else {\n    //format expr\n    let ret = fn(...args);\n\n    //rev\n    if (isRev) {\n      ret = config.settings.formatReverse(ret, operator, reversedOp, operatorDef, revOperatorDef, isForDisplay);\n    }\n\n    return ret;\n  }\n};\n\n\nconst formatValue = (config, meta, value, valueSrc, valueType, fieldWidgetDef, fieldDef, operator, opDef, isForDisplay, parentField = null, asyncListValues) => {\n  if (value === undefined)\n    return undefined;\n  let ret;\n  if (valueSrc == \"field\") {\n    ret = formatField(config, meta, value, isForDisplay, parentField);\n  } else if (valueSrc == \"func\") {\n    ret = formatFunc(config, meta, value, isForDisplay, parentField);\n  } else {\n    if (typeof fieldWidgetDef.formatValue === \"function\") {\n      const fn = fieldWidgetDef.formatValue;\n      const args = [\n        value,\n        {\n          ...pick(fieldDef, [\"fieldSettings\", \"listValues\"]),\n          asyncListValues\n        },\n        //useful options: valueFormat for date/time\n        omit(fieldWidgetDef, [\"formatValue\", \"mongoFormatValue\", \"sqlFormatValue\", \"jsonLogic\", \"elasticSearchFormatValue\", \"spelFormatValue\"]),\n        isForDisplay\n      ];\n      if (operator) {\n        args.push(operator);\n        args.push(opDef);\n      }\n      if (valueSrc == \"field\") {\n        const valFieldDefinition = getFieldConfig(config, value) || {}; \n        args.push(valFieldDefinition);\n      }\n      ret = fn(...args);\n    } else {\n      ret = value;\n    }\n  }\n  return ret;\n};\n\n\nconst formatField = (config, meta, field, isForDisplay, parentField = null, cutParentField = true) => {\n  const {fieldSeparator, fieldSeparatorDisplay} = config.settings;\n  let ret = null;\n  if (field) {\n    const fieldDefinition = getFieldConfig(config, field) || {};\n    const fieldParts = Array.isArray(field) ? field : field.split(fieldSeparator);\n    const _fieldKeys = getFieldPath(field, config);\n    const fieldPartsLabels = getFieldPathLabels(field, config, cutParentField ? parentField : null);\n    const fieldFullLabel = fieldPartsLabels ? fieldPartsLabels.join(fieldSeparatorDisplay) : null;\n    const fieldLabel2 = fieldDefinition.label2 || fieldFullLabel;\n    const formatFieldFn = config.settings.formatField || defaultSettings.formatField;\n    const fieldName = formatFieldName(field, config, meta, cutParentField ? parentField : null);\n    ret = formatFieldFn(fieldName, fieldParts, fieldLabel2, fieldDefinition, config, isForDisplay);\n  }\n  return ret;\n};\n\n\nconst formatFunc = (config, meta, funcValue, isForDisplay, parentField = null) => {\n  const funcKey = funcValue.get(\"func\");\n  const args = funcValue.get(\"args\");\n  const funcConfig = getFuncConfig(config, funcKey);\n  const funcName = isForDisplay && funcConfig.label || funcKey;\n\n  let formattedArgs = {};\n  let formattedArgsWithNames = {};\n  for (const argKey in funcConfig.args) {\n    const argConfig = funcConfig.args[argKey];\n    const fieldDef = getFieldConfig(config, argConfig);\n    const argVal = args ? args.get(argKey) : undefined;\n    const argValue = argVal ? argVal.get(\"value\") : undefined;\n    const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n    const argAsyncListValues = argVal ? argVal.get(\"asyncListValues\") : undefined;\n    const formattedArgVal = formatValue(\n      config, meta, argValue, argValueSrc, argConfig.type, fieldDef, argConfig, null, null, isForDisplay, parentField, argAsyncListValues\n    );\n    const argName = isForDisplay && argConfig.label || argKey;\n    if (formattedArgVal !== undefined) { // skip optional in the end\n      formattedArgs[argKey] = formattedArgVal;\n      formattedArgsWithNames[argName] = formattedArgVal;\n    }\n  }\n\n  let ret = null;\n  if (typeof funcConfig.formatFunc === \"function\") {\n    const fn = funcConfig.formatFunc;\n    const args = [\n      formattedArgs,\n      isForDisplay\n    ];\n    ret = fn(...args);\n  } else {\n    const argsStr = Object.entries(formattedArgsWithNames)\n      .map(([k, v]) => (isForDisplay ? `${k}: ${v}` : `${v}`))\n      .join(\", \");\n    ret = `${funcName}(${argsStr})`;\n  }\n  return ret;\n};\n","import {getWidgetForFieldOp} from \"../utils/ruleUtils\";\nimport {defaultConjunction} from \"../utils/defaultUtils\";\n\n\n/**\n * Converts a string representation of top_left and bottom_right cords to\n * a ES geo_point required for query\n *\n * @param {string} geoPointString - comma separated string of lat/lon coods\n * @returns {{top_left: {lon: number, lat: number}, bottom_right: {lon: number, lat: number}}} - ES geoPoint formatted object\n * @private\n */\nfunction buildEsGeoPoint(geoPointString) {\n  if (geoPointString == null) {\n    return null;\n  }\n\n  const coordsNumberArray = geoPointString.split(\",\").map(Number);\n  return {\n    top_left: {\n      lat: coordsNumberArray[0],\n      lon: coordsNumberArray[1]\n    },\n    bottom_right: {\n      lat: coordsNumberArray[2],\n      lon: coordsNumberArray[3]\n    }\n  };\n}\n\n/**\n * Converts a dateTime string from the query builder to a ES range formatted object\n *\n * @param {string} dateTime - dateTime formatted string\n * @param {string} operator - query builder operator type, see constants.js and query builder docs\n * @returns {{lt: string}|{lte: string}|{gte: string}|{gte: string, lte: string}|undefined} - ES range query parameter\n *\n * @private\n */\nfunction buildEsRangeParameters(value, operator) {\n  // -- if value is greater than 1 then we assume this is a between operator : BUG this is wrong, a selectable list can have multiple values\n  if (value.length > 1) {\n    return {\n      gte: \"\".concat(value[0]),\n      lte: \"\".concat(value[1])\n    };\n  } // -- if value is only one we assume this is a date time query for a specific day\n\n  const dateTime = value[0]; //TODO: Rethink about this part, what if someone adds a new type of opperator\n\n  //todo: move this logic into config\n  switch (operator) {\n  case \"on_date\": //todo: not used\n  case \"not_on_date\":\n  case \"equal\":\n  case \"select_equals\":\n  case \"not_equal\":\n    return {\n      gte: \"\".concat(dateTime, \"||/d\"),\n      lte: \"\".concat(dateTime, \"||+1d\")\n    };\n\n  case \"less_or_equal\":\n    return {\n      lte: \"\".concat(dateTime)\n    };\n\n  case \"greater_or_equal\":\n    return {\n      gte: \"\".concat(dateTime)\n    };\n\n  case \"less\":\n    return {\n      lt: \"\".concat(dateTime)\n    };\n\n  case \"greater\":\n    return {\n      gt: \"\".concat(dateTime)\n    };\n\n  default:\n    return undefined;\n  }\n}\n\n/**\n * Builds the DSL parameters for a Wildcard query\n *\n * @param {string} value - The match value\n * @returns {{value: string}} - The value = value parameter surrounded with * on each end\n * @private\n */\nfunction buildEsWildcardParameters(value) {\n  return {\n    value: \"*\" + value + \"*\"\n  };\n}\n\n/**\n * Takes the match type string from awesome query builder like 'greater_or_equal' and\n * returns the ES occurrence required for bool queries\n *\n * @param {string} combinator - query group type or rule condition\n * @param {bool} not\n * @returns {string} - ES occurrence type. See constants.js\n * @private\n */\nfunction determineOccurrence(combinator, not) {\n  //todo: move into config, like mongoConj\n  switch (combinator) {\n  case \"AND\":\n    return not ? \"must_not\" : \"must\";\n    // -- AND\n\n  case \"OR\":\n    return not ? \"should_not\" : \"should\";\n    // -- OR\n\n  case \"NOT\":\n    return not ? \"must\" : \"must_not\";\n    // -- NOT AND\n\n  default:\n    return undefined;\n  }\n}\n\n/**\n * Determines what field to query off of given the operator type\n *\n * @param {string} fieldDataType - The type of data\n * @param {string} fullFieldName - A '.' separated string containing the property lineage (including self)\n * @param {string} queryType - The query type\n * @returns {string|*} - will be either the fullFieldName or fullFieldName.keyword\n * @private\n */\n//todo: not used\nfunction determineQueryField(fieldDataType, fullFieldName, queryType) {\n  if (fieldDataType === \"boolean\") {\n    return fullFieldName;\n  }\n\n  switch (queryType) {\n  case \"term\":\n  case \"wildcard\":\n    return \"\".concat(fullFieldName, \".keyword\");\n\n  case \"geo_bounding_box\":\n  case \"range\":\n  case \"match\":\n    return fullFieldName;\n\n  default:\n    console.error(\"Can't determine query field for query type \".concat(queryType));\n    return null;\n  }\n}\n\nfunction buildRegexpParameters(value) {\n  return {\n    value: value\n  };\n}\n\nfunction determineField(fieldName, config) {\n  //todo: ElasticSearchTextField - not used\n  //return config.fields[fieldName].ElasticSearchTextField || fieldName;\n  return fieldName;\n}\n\nfunction buildParameters(queryType, value, operator, fieldName, config) {\n  const textField = determineField(fieldName, config);\n  switch (queryType) {\n  case \"filter\":\n    //todo: elasticSearchScript - not used\n    return {\n      script: config.operators[operator].elasticSearchScript(fieldName, value)\n    };\n\n  case \"exists\":\n    return { field: fieldName };\n\n  case \"match\":\n    return { [textField]: value[0] };\n\n  case \"term\":\n    return { [fieldName]: value[0] };\n\n  //todo: not used\n  // need to add geo type into RAQB or remove this code\n  case \"geo_bounding_box\":\n    return { [fieldName]: buildEsGeoPoint(value[0]) };\n\n  case \"range\":\n    return { [fieldName]: buildEsRangeParameters(value, operator) };\n\n  case \"wildcard\":\n    return { [fieldName]: buildEsWildcardParameters(value[0]) };\n\n  case \"regexp\":\n    return { [fieldName]: buildRegexpParameters(value[0]) };\n\n  default:\n    return undefined;\n  }\n}\n/**\n * Handles the building of the group portion of the DSL\n *\n * @param {string} fieldName - The name of the field you are building a rule for\n * @param {string} fieldDataType - The type of data this field holds\n * @param {string} value - The value of this rule\n * @param {string} operator - The condition on how the value is matched\n * @returns {object} - The ES rule\n * @private\n */\nfunction buildEsRule(fieldName, value, operator, config, valueSrc) {\n  if (!fieldName || !operator || value == undefined)\n    return undefined; // rule is not fully entered\n  let op = operator;\n  let opConfig = config.operators[op];\n  if (!opConfig)\n    return undefined; // unknown operator\n  let { elasticSearchQueryType } = opConfig;\n\n  // not\n  let not = false;\n  if (!elasticSearchQueryType && opConfig.reversedOp) {\n    not = true;\n    op = opConfig.reversedOp;\n    opConfig = config.operators[op];\n    ({ elasticSearchQueryType } = opConfig);\n  }\n  \n  // handle if value 0 has multiple values like a select in a array\n  const widget = getWidgetForFieldOp(config, fieldName, op, valueSrc);\n  const widgetConfig = config.widgets[widget];\n  if (!widgetConfig)\n    return undefined; // unknown widget\n  const { elasticSearchFormatValue } = widgetConfig;\n\n  /** In most cases the queryType will be static however in some casese (like between) the query type will change\n   * based on the data type. i.e. a between time will be different than between number, date, letters etc... */\n  let queryType;\n  if (typeof elasticSearchQueryType === \"function\") {\n    queryType = elasticSearchQueryType(widget);\n  } else {\n    queryType = elasticSearchQueryType;\n  }\n\n  if (!queryType) {\n    // Not supported\n    return undefined;\n  }\n\n  /** If a widget has a rule on how to format that data then use that otherwise use default way of determineing search parameters\n   * */\n  let parameters;\n  if (typeof elasticSearchFormatValue === \"function\") {\n    parameters = elasticSearchFormatValue(queryType, value, op, fieldName, config);\n  } else {\n    parameters = buildParameters(queryType, value, op, fieldName, config);\n  }\n\n  if (not) {\n    return {\n      bool: {\n        must_not: {\n          [queryType]: {...parameters}\n        }\n      }\n    };\n  } else {\n    return {\n      [queryType]: {...parameters}\n    };\n  }\n}\n\n/**\n * Handles the building of the group portion of the DSL\n *\n * @param {object} children - The contents of the group\n * @param {string} conjunction - The way the contents of the group are joined together i.e. AND OR\n * @param {bool} not\n * @param {Function} recursiveFxn - The recursive fxn to build the contents of the groups children\n * @private\n * @returns {object} - The ES group\n */\nfunction buildEsGroup(children, conjunction, not, recursiveFxn, config) {\n  if (!children || !children.size)\n    return undefined;\n  const childrenArray = children.valueSeq().toArray();\n  const occurrence = determineOccurrence(conjunction, not);\n  const result = childrenArray.map((c) => recursiveFxn(c, config)).filter(v => v !== undefined);\n  if (!result.length)\n    return undefined;\n  const resultFlat = result.flat(Infinity);\n  return {\n    bool: {\n      [occurrence]: resultFlat\n    }\n  };\n}\n\nexport function elasticSearchFormat(tree, config) {\n  // -- format the es dsl here\n  if (!tree) return undefined;\n  const type = tree.get(\"type\");\n  const properties = tree.get(\"properties\") || new Map();\n\n  if (type === \"rule\" && properties.get(\"field\")) {\n    // -- field is null when a new blank rule is added\n    const operator = properties.get(\"operator\");\n    const field = properties.get(\"field\");\n    const value = properties.get(\"value\").toJS();\n    const _valueType = properties.get(\"valueType\")?.get(0);\n    const valueSrc = properties.get(\"valueSrc\")?.get(0);\n\n    if (valueSrc === \"func\") {\n      // -- elastic search doesn't support functions (that is post processing)\n      return;\n    }\n\n    if (value && Array.isArray(value[0])) {\n      //TODO : Handle case where the value has multiple values such as in the case of a list\n      return value[0].map((val) => \n        buildEsRule(field, [val], operator, config, valueSrc)\n      );\n    } else {\n      return buildEsRule(field, value, operator, config, valueSrc);\n    }\n  }\n\n  if (type === \"group\" || type === \"rule_group\") {\n    const not = properties.get(\"not\");\n    let conjunction = properties.get(\"conjunction\");\n    if (!conjunction)\n      conjunction = defaultConjunction(config);\n    const children = tree.get(\"children1\");\n    return buildEsGroup(children, conjunction, not, elasticSearchFormat, config);\n  }\n}\n","import Immutable, { fromJS, Map } from \"immutable\";\nimport {validateTree} from \"../utils/validation\";\nimport {extendConfig} from \"../utils/configUtils\";\nimport {getTreeBadFields, getLightTree} from \"../utils/treeUtils\";\nimport {isJsonLogic} from \"../utils/stuff\";\n\nexport const getTree = (immutableTree, light = true, children1AsArray = true) => {\n  if (!immutableTree) return undefined;\n  let tree = immutableTree;\n  tree = tree.toJS();\n  if (light)\n    tree = getLightTree(tree, children1AsArray);\n  return tree;\n};\n\nexport const loadTree = (serTree) => {\n  if (isImmutableTree(serTree)) {\n    return serTree;\n  } else if (isTree(serTree)) {\n    return jsTreeToImmutable(serTree);\n  } else if (typeof serTree == \"string\" && serTree.startsWith('[\"~#iM\"')) {\n    //tip: old versions of RAQB were saving tree with `transit.toJSON()`\n    // https://github.com/ukrbublik/react-awesome-query-builder/issues/69\n    throw \"You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17\";\n  } else if (typeof serTree == \"string\") {\n    return jsTreeToImmutable(JSON.parse(serTree));\n  } else throw \"Can't load tree!\";\n};\n\nexport const checkTree = (tree, config) => {\n  if (!tree) return undefined;\n  const extendedConfig = extendConfig(config);\n  return validateTree(tree, null, extendedConfig, extendedConfig);\n};\n\nexport const isValidTree = (tree) => {\n  return getTreeBadFields(tree).length == 0;\n};\n\nexport const isImmutableTree = (tree) => {\n  return Map.isMap(tree);\n};\n\nexport const isTree = (tree) => {\n  return typeof tree == \"object\" && (tree.type == \"group\" || tree.type == \"switch_group\");\n};\n\nexport {isJsonLogic};\n\nfunction jsTreeToImmutable(tree) {\n  return fromJS(tree, function (key, value) {\n    let outValue;\n    if (key == \"properties\") {\n      outValue = value.toOrderedMap();\n\n      // `value` should be undefined instead of null\n      // JSON doesn't support undefined and replaces undefined -> null\n      // So fix: null -> undefined\n      for (let i = 0 ; i < 2 ; i++) {\n        if (outValue.get(\"value\")?.get(i) === null) {\n          outValue = outValue.setIn([\"value\", i], undefined);\n        }\n      }\n    } else if (key == \"value\" && value.get(0) && value.get(0).toJS !== undefined) {\n      const valueJs = value.get(0).toJS();\n      if (valueJs.func) {\n        outValue = value.toOrderedMap();\n      } else {\n        // only for raw values keep JS representation\n        outValue = Immutable.List.of(valueJs);\n      }\n    } else if (key == \"asyncListValues\") {\n      // keep in JS format\n      outValue = value.toJS();\n    } else if (key == \"children1\" && Immutable.Iterable.isIndexed(value)) {\n      outValue = new Immutable.OrderedMap(value.map(child => [child.get(\"id\"), child]));\n    } else {\n      outValue = Immutable.Iterable.isIndexed(value) ? value.toList() : value.toOrderedMap();\n    }\n    return outValue;\n  });\n}\n\n","import uuid from \"../utils/uuid\";\nimport {defaultValue, isJsonLogic, shallowEqual, logger} from \"../utils/stuff\";\nimport {getFieldConfig, extendConfig, normalizeField} from \"../utils/configUtils\";\nimport {getWidgetForFieldOp} from \"../utils/ruleUtils\";\nimport {loadTree} from \"./tree\";\nimport {defaultConjunction, defaultGroupConjunction} from \"../utils/defaultUtils\";\n\nimport moment from \"moment\";\n\n// http://jsonlogic.com/\n\n// helpers\nconst arrayUniq = (arr) => Array.from(new Set(arr));\nconst arrayToObject = (arr) => arr.reduce((acc, [f, fc]) => ({ ...acc, [f]: fc }), {});\n\nexport const loadFromJsonLogic = (logicTree, config) => {\n  return _loadFromJsonLogic(logicTree, config, false);\n};\n\nexport const _loadFromJsonLogic = (logicTree, config, returnErrors = true) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n  const extendedConfig = extendConfig(config);\n  const conv = buildConv(extendedConfig);\n  let jsTree = logicTree ? convertFromLogic(logicTree, conv, extendedConfig, \"rule\", meta) : undefined;\n  if (jsTree && jsTree.type != \"group\") {\n    jsTree = wrapInDefaultConj(jsTree, extendedConfig);\n  }\n  const immTree = jsTree ? loadTree(jsTree) : undefined;\n\n  if (returnErrors) {\n    return [immTree, meta.errors];\n  } else {\n    if (meta.errors.length)\n      console.warn(\"Errors while importing from JsonLogic:\", meta.errors);\n    return immTree;\n  }\n};\n\n\nconst buildConv = (config) => {\n  let operators = {};\n  for (let opKey in config.operators) {\n    const opConfig = config.operators[opKey];\n    if (typeof opConfig.jsonLogic == \"string\") {\n      // example: \"</2\", \"#in/1\"\n      const opk = (opConfig._jsonLogicIsRevArgs ? \"#\" : \"\") + opConfig.jsonLogic + \"/\" + defaultValue(opConfig.cardinality, 1);\n      if (!operators[opk])\n        operators[opk] = [];\n      operators[opk].push(opKey);\n    } else if(typeof opConfig.jsonLogic2 == \"string\") {\n      // example: all-in/1\"\n      const opk = opConfig.jsonLogic2 + \"/\" + defaultValue(opConfig.cardinality, 1);\n      if (!operators[opk])\n        operators[opk] = [];\n      operators[opk].push(opKey);\n    }\n  }\n\n  let conjunctions = {};\n  for (let conjKey in config.conjunctions) {\n    const conjunctionDefinition = config.conjunctions[conjKey];\n    const ck = conjunctionDefinition.jsonLogicConj || conjKey.toLowerCase();\n    conjunctions[ck] = conjKey;\n  }\n\n  let funcs = {};\n  for (let funcKey in config.funcs) {\n    const funcConfig = config.funcs[funcKey];\n    let fk;\n    if (funcConfig.jsonLogicIsMethod) {\n      fk = \"#\" + funcConfig.jsonLogic;\n    } else if (typeof funcConfig.jsonLogic == \"string\") {\n      fk = funcConfig.jsonLogic;\n    }\n    if (fk) {\n      if (!funcs[fk])\n        funcs[fk] = [];\n      funcs[fk].push(funcKey);\n    }\n  }\n\n  const {groupVarKey, altVarKey} = config.settings.jsonLogic;\n\n  return {\n    operators,\n    conjunctions,\n    funcs,\n    varKeys: [\"var\", groupVarKey, altVarKey],\n  };\n};\n\n\nconst convertFromLogic = (logic, conv, config, expectedType, meta, not = false, fieldConfig, widget, parentField = null, _isLockedLogic = false) => {\n  let op, vals;\n  if (isJsonLogic(logic)) {\n    op = Object.keys(logic)[0];\n    vals = logic[op];\n    if (!Array.isArray(vals))\n      vals = [ vals ];\n  }\n  \n  let ret;\n  let beforeErrorsCnt = meta.errors.length;\n\n  const {lockedOp} = config.settings.jsonLogic;\n  const isEmptyOp = op == \"!\" && (vals.length == 1 && vals[0] && isJsonLogic(vals[0]) && conv.varKeys.includes(Object.keys(vals[0])[0]));\n  const isRev = op == \"!\" && !isEmptyOp;\n  const isLocked = lockedOp && op == lockedOp;\n  if (isLocked) {\n    ret = convertFromLogic(vals[0], conv, config, expectedType, meta, not, fieldConfig, widget, parentField, true);\n  } else if (isRev) {\n    // reverse with not\n    ret = convertFromLogic(vals[0], conv, config, expectedType, meta, !not, fieldConfig, widget, parentField);\n  } else if(expectedType == \"val\") {\n    // not is not used here\n    ret = convertField(op, vals, conv, config, not, meta, parentField) \n      || convertFunc(op, vals, conv, config, not, fieldConfig, meta, parentField) \n      || convertVal(logic, fieldConfig, widget, config, meta);\n  } else if(expectedType == \"rule\") {\n    ret = convertConj(op, vals, conv, config, not, meta, parentField, false) \n    || convertOp(op, vals, conv, config, not, meta, parentField);\n  }\n\n  let afterErrorsCnt = meta.errors.length;\n  if (op != \"!\" && ret === undefined && afterErrorsCnt == beforeErrorsCnt) {\n    meta.errors.push(`Can't parse logic ${JSON.stringify(logic)}`);\n  }\n\n  if (isLocked) {\n    ret.properties.isLocked = true;\n  }\n\n  return ret;\n};\n\n\nconst convertVal = (val, fieldConfig, widget, config, meta) => {\n  if (val === undefined) return undefined;\n  const widgetConfig = config.widgets[widget || fieldConfig.mainWidget];\n\n  if (!widgetConfig) {\n    meta.errors.push(`No widget for type ${fieldConfig.type}`);\n    return undefined;\n  }\n\n  if (isJsonLogic(val)) {\n    meta.errors.push(`Unexpected logic in value: ${JSON.stringify(val)}`);\n    return undefined;\n  }\n\n  // number of seconds -> time string\n  if (fieldConfig && fieldConfig.type == \"time\" && typeof val == \"number\") {\n    const [h, m, s] = [Math.floor(val / 60 / 60) % 24, Math.floor(val / 60) % 60, val % 60];\n    const valueFormat = widgetConfig.valueFormat;\n    if (valueFormat) {\n      const dateVal = new Date(val);\n      dateVal.setMilliseconds(0);\n      dateVal.setHours(h);\n      dateVal.setMinutes(m);\n      dateVal.setSeconds(s);\n      val = moment(dateVal).format(valueFormat);\n    } else {\n      val = `${h}:${m}:${s}`;\n    }\n  }\n\n  // \"2020-01-08T22:00:00.000Z\" -> Date object\n  if (fieldConfig && [\"date\", \"datetime\"].includes(fieldConfig.type) && val && !(val instanceof Date)) {\n    try {\n      const dateVal = new Date(val);\n      if (dateVal instanceof Date && dateVal.toISOString() === val) {\n        val = dateVal;\n      }\n    } catch(e) {\n      meta.errors.push(`Can't convert value ${val} as Date`);\n      val = undefined;\n    }\n  }\n\n  // Date object -> formatted string\n  if (val instanceof Date && fieldConfig) {\n    const valueFormat = widgetConfig.valueFormat;\n    if (valueFormat) {\n      val = moment(val).format(valueFormat);\n    }\n  }\n\n  let asyncListValues;\n  if (val && fieldConfig.fieldSettings && fieldConfig.fieldSettings.asyncFetch) {\n    const vals = Array.isArray(val) ? val : [val];\n    asyncListValues = vals;\n  }\n\n  return {\n    valueSrc: \"value\",\n    value: val,\n    valueType: widgetConfig.type,\n    asyncListValues\n  };\n};\n\n\nconst convertField = (op, vals, conv, config, not, meta, parentField = null) => {\n  const {fieldSeparator} = config.settings;\n  if (conv.varKeys.includes(op) && typeof vals[0] == \"string\") {\n    let field = vals[0];\n    if (parentField)\n      field = [parentField, field].join(fieldSeparator);\n    field = normalizeField(config, field);\n    const fieldConfig = getFieldConfig(config, field);\n    if (!fieldConfig) {\n      meta.errors.push(`No config for field ${field}`);\n      return undefined;\n    }\n\n    return {\n      valueSrc: \"field\",\n      value: field,\n      valueType: fieldConfig.type,\n    };\n  }\n\n  return undefined;\n};\n\n\nconst convertFunc = (op, vals, conv, config, not, fieldConfig, meta, parentField = null) => {\n  if (!op) return undefined;\n  let func, argsArr, funcKey;\n  const jsonLogicIsMethod = (op == \"method\");\n  if (jsonLogicIsMethod) {\n    let obj, opts;\n    [obj, func, ...opts] = vals;\n    argsArr = [obj, ...opts];\n  } else {\n    func = op;\n    argsArr = vals;\n  }\n\n  const fk = (jsonLogicIsMethod ? \"#\" : \"\") + func;\n  const funcKeys = (conv.funcs[fk] || []).filter(k => \n    (fieldConfig ? config.funcs[k].returnType == fieldConfig.type : true)\n  );\n  if (funcKeys.length) {\n    funcKey = funcKeys[0];\n  } else {\n    const v = {[op]: vals};\n    for (const [f, fc] of Object.entries(config.funcs || {})) {\n      if (fc.jsonLogicImport && fc.returnType == fieldConfig.type) {\n        let parsed;\n        try {\n          parsed = fc.jsonLogicImport(v);\n        } catch(_e) {\n          // given expression `v` can't be parsed into function\n        }\n        if (parsed) {\n          funcKey = f;\n          argsArr = parsed;\n        }\n      }\n    }\n  }\n  if (!funcKey)\n    return undefined;\n\n  if (funcKey) {\n    const funcConfig = config.funcs[funcKey];\n    const argKeys = Object.keys(funcConfig.args || {});\n    let args = argsArr.reduce((acc, val, ind) => {\n      const argKey = argKeys[ind];\n      const argConfig = funcConfig.args[argKey];\n      let argVal = convertFromLogic(val, conv, config, \"val\", meta, false, argConfig, null, parentField);\n      if (argVal === undefined) {\n        argVal = argConfig.defaultValue;\n        if (argVal === undefined) {\n          meta.errors.push(`No value for arg ${argKey} of func ${funcKey}`);\n          return undefined;\n        }\n      }\n      return {...acc, [argKey]: argVal};\n    }, {});\n\n    return {\n      valueSrc: \"func\",\n      value: {\n        func: funcKey,\n        args: args\n      },\n      valueType: funcConfig.returnType,\n    };\n  }\n\n  return undefined;\n};\n\n\nconst convertConj = (op, vals, conv, config, not, meta, parentField = null, isRuleGroup = false) => {\n  const conjKey = conv.conjunctions[op];\n  const {fieldSeparator} = config.settings;\n  const parentFieldConfig = parentField ? getFieldConfig(config, parentField) : null;\n  const isParentGroup = parentFieldConfig?.type == \"!group\";\n  if (conjKey) {\n    let type = \"group\";\n    const children = vals\n      .map(v => convertFromLogic(v, conv, config, \"rule\", meta, false, null, null, parentField))\n      .filter(r => r !== undefined)\n      .reduce((acc, r) => ({...acc, [r.id] : r}), {});\n    const complexFields = Object.values(children)\n      .map(v => v?.properties?.field)\n      .filter(f => f && f.includes(fieldSeparator));\n    const complexFieldsGroupAncestors = Object.fromEntries(\n      arrayUniq(complexFields).map(f => {\n        const parts = f.split(fieldSeparator);\n        const ancs = Object.fromEntries(\n          parts.slice(0, -1)\n            .map((f, i, parts) => [...parts.slice(0, i), f])\n            .map(fp => [fp.join(fieldSeparator), getFieldConfig(config, fp)])\n            .filter(([_f, fc]) => fc.type == \"!group\")\n        );\n        return [f, Object.keys(ancs)];\n      })\n    );\n    const childrenInRuleGroup = Object.values(children)\n      .map(v => v?.properties?.field)\n      .map(f => complexFieldsGroupAncestors[f])\n      .filter(ancs => ancs && ancs.length);\n    const usedRuleGroups = arrayUniq(Object.values(complexFieldsGroupAncestors).flat());\n    const usedTopRuleGroups = topLevelFieldsFilter(usedRuleGroups);\n    \n    let properties = {\n      conjunction: conjKey,\n      not: not\n    };\n    const id = uuid();\n\n    let children1 = {};\n    let groupToId = {};\n    Object.entries(children).map(([k, v]) => {\n      if (v.type == \"group\" || v.type == \"rule_group\") {\n        // put as-is\n        children1[k] = v;\n      } else {\n        const field = v?.properties?.field;\n        const groupAncestors = complexFieldsGroupAncestors[field];\n        const groupField = groupAncestors?.at(-1);\n        if (!groupField) {\n          // not in rule_group (can be simple field or in struct) - put as-is\n          children1[k] = v;\n        } else {\n          // wrap field in rule_group (with creating hierarchy if need)\n          let ch = children1;\n          let parentFieldParts = parentField ? parentField.split(fieldSeparator) : [];\n          const isInParent = shallowEqual(parentFieldParts, groupField.split(fieldSeparator).slice(0, parentFieldParts.length));\n          if (!isInParent)\n            parentFieldParts = []; // should not be\n          const traverseGroupFields = groupField\n            .split(fieldSeparator)\n            .slice(parentFieldParts.length)\n            .map((f, i, parts) => [...parentFieldParts, ...parts.slice(0, i), f].join(fieldSeparator))\n            .map(f => normalizeField(config, f))\n            .map((f) => ({f, fc: getFieldConfig(config, f) || {}}))\n            .filter(({fc}) => (fc.type != \"!struct\"));\n          traverseGroupFields.map(({f: gf, fc: gfc}, i) => {\n            let groupId = groupToId[gf];\n            if (!groupId) {\n              groupId = uuid();\n              groupToId[gf] = groupId;\n              ch[groupId] = {\n                type: \"rule_group\",\n                id: groupId,\n                children1: {},\n                properties: {\n                  conjunction: conjKey,\n                  not: false,\n                  field: gf,\n                  mode: gfc.mode,\n                }\n              };\n            }\n            ch = ch[groupId].children1;\n          });\n          ch[k] = v;\n        }\n      }\n    });\n\n    // tip: for isRuleGroup=true correct type and properties will be set out of this func\n\n    return {\n      type: type,\n      id: id,\n      children1: children1,\n      properties: properties\n    };\n  }\n\n  return undefined;\n};\n\n\nconst topLevelFieldsFilter = (fields) => {\n  let arr = [...fields].sort((a, b) => (a.length - b.length));\n  for (let i = 0 ; i < arr.length ; i++) {\n    for (let j = i + 1 ; j < arr.length ; j++) {\n      if (arr[j].indexOf(arr[i]) == 0) {\n        // arr[j] is inside arr[i] (eg. \"a.b\" inside \"a\")\n        arr.splice(j, 1);\n        j--;\n      }\n    }\n  }\n  return arr;\n};\n\nconst wrapInDefaultConjRuleGroup = (rule, parentField, parentFieldConfig, config, conj) => {\n  if (!rule) return undefined;\n  return {\n    type: \"rule_group\",\n    id: uuid(),\n    children1: { [rule.id]: rule },\n    properties: {\n      conjunction: conj || defaultGroupConjunction(config, parentFieldConfig),\n      not: false,\n      field: parentField,\n    }\n  };\n};\n\nconst wrapInDefaultConj = (rule, config, not = false) => {\n  return {\n    type: \"group\",\n    id: uuid(),\n    children1: { [rule.id]: rule },\n    properties: {\n      conjunction: defaultConjunction(config),\n      not: not\n    }\n  };\n};\n\nconst parseRule = (op, arity, vals, parentField, conv, config, meta) => {\n  let errors = [];\n  let res = _parseRule(op, arity, vals, parentField, conv, config, errors, false) \n         || _parseRule(op, arity, vals, parentField, conv, config, errors, true) ;\n\n  if (!res) {\n    meta.errors.push(errors.join(\"; \") || `Unknown op ${op}/${arity}`);\n    return undefined;\n  }\n  \n  return res;\n};\n\nconst _parseRule = (op, arity, vals, parentField, conv, config, errors, isRevArgs) => {\n  // config.settings.groupOperators are used for group count (cardinality = 0 is exception)\n  // but don't confuse with \"all-in\" for multiselect\n  const isAllInForMultiselect = op == \"all\" && isJsonLogic(vals[1]) && Object.keys(vals[1])[0] == \"in\";\n  const isGroup0 = !isAllInForMultiselect && config.settings.groupOperators.includes(op);\n  const eqOps = [\"==\", \"!=\"];\n  let cardinality = isGroup0 ? 0 : arity - 1;\n  if (isGroup0)\n    cardinality = 0;\n  else if (eqOps.includes(op) && cardinality == 1 && vals[1] === null)\n    cardinality = 0;\n\n  const opk = op + \"/\" + cardinality;\n  const {fieldSeparator} = config.settings;\n  let opKeys = conv.operators[(isRevArgs ? \"#\" : \"\") + opk];\n  if (!opKeys)\n    return;\n  \n  let jlField, args = [];\n  const rangeOps = [\"<\", \"<=\", \">\", \">=\"];\n  if (rangeOps.includes(op) && arity == 3) {\n    jlField = vals[1];\n    args = [ vals[0], vals[2] ];\n  } else if (isRevArgs) {\n    jlField = vals[1];\n    args = [ vals[0] ];\n  } else {\n    [jlField, ...args] = vals;\n  }\n\n  if (!isJsonLogic(jlField)) {\n    errors.push(`Incorrect operands for ${op}: ${JSON.stringify(vals)}`);\n    return;\n  }\n  let k = Object.keys(jlField)[0];\n  let v = Object.values(jlField)[0];\n  \n  let field, having, isGroup;\n  if (conv.varKeys.includes(k) && typeof v == \"string\") {\n    field = v;\n  }\n  if (isGroup0) {\n    isGroup = true;\n    having = args[0];\n    args = [];\n  }\n  // reduce/filter for group ext\n  if (k == \"reduce\" && Array.isArray(v) && v.length == 3) {\n    let [filter, acc, init] = v;\n    if (isJsonLogic(filter) && init == 0 && isJsonLogic(acc) && Array.isArray(acc[\"+\"]) && acc[\"+\"][0] == 1 && isJsonLogic(acc[\"+\"][1]) && acc[\"+\"][1][\"var\"] == \"accumulator\") {\n      k = Object.keys(filter)[0];\n      v = Object.values(filter)[0];\n      if (k == \"filter\") {\n        let [group, filter] = v;\n        if (isJsonLogic(group)) {\n          k = Object.keys(group)[0];\n          v = Object.values(group)[0];\n          if (conv.varKeys.includes(k) && typeof v == \"string\") {\n            field = v;\n            having = filter;\n            isGroup = true;\n          }\n        }\n      } else if (conv.varKeys.includes(k) && typeof v == \"string\") {\n        field = v;\n        isGroup = true;\n      }\n    }\n  }\n  \n  if (!field) {\n    errors.push(`Unknown field ${JSON.stringify(jlField)}`);\n    return;\n  }\n  if (parentField)\n    field = [parentField, field].join(fieldSeparator);\n  field = normalizeField(config, field);\n\n  const fieldConfig = getFieldConfig(config, field);\n  if (!fieldConfig) {\n    errors.push(`No config for field ${field}`);\n    return;\n  }\n\n  let opKey = opKeys[0];\n  if (opKeys.length > 1 && fieldConfig && fieldConfig.operators) {\n    // eg. for \"equal\" and \"select_equals\"\n    opKeys = opKeys\n      .filter(k => fieldConfig.operators.includes(k));\n    if (opKeys.length == 0) {\n      errors.push(`No corresponding ops for field ${field}`);\n      return;\n    }\n    opKey = opKeys[0];\n  }\n  \n  return {\n    field, fieldConfig, opKey, args, having\n  };\n};\n\nconst convertOp = (op, vals, conv, config, not, meta, parentField = null) => {\n  if (!op) return undefined;\n\n  const arity = vals.length;\n  if (op == \"all\" && isJsonLogic(vals[1])) {\n    // special case for \"all-in\"\n    const op2 = Object.keys(vals[1])[0];\n    if (op2 == \"in\") {\n      vals = [\n        vals[0],\n        vals[1][op2][1]\n      ];\n      op = op + \"-\" + op2; // \"all-in\"\n    }\n  }\n\n  const parseRes = parseRule(op, arity, vals, parentField, conv, config, meta);\n  if (!parseRes) return undefined;\n  let {field, fieldConfig, opKey, args, having} = parseRes;\n  let opConfig = config.operators[opKey];\n\n  // Group component in array mode can show NOT checkbox, so do nothing in this case\n  // Otherwise try to revert\n  const showNot = fieldConfig.showNot !== undefined ? fieldConfig.showNot : config.settings.showNot; \n  let canRev = true;\n  // if (fieldConfig.type == \"!group\" && fieldConfig.mode == \"array\" && showNot)\n  //   canRev = false;\n\n  let conj;\n  let havingVals;\n  if (fieldConfig.type == \"!group\" && having) {\n    conj = Object.keys(having)[0];\n    havingVals = having[conj];\n    if (!Array.isArray(havingVals))\n      havingVals = [ havingVals ];\n\n    // Preprocess \"!\": Try to reverse op in single rule in having\n    // Eg. use `not_equal` instead of `not` `equal`\n    const isEmptyOp = conj == \"!\" && (havingVals.length == 1 && havingVals[0] && isJsonLogic(havingVals[0]) && conv.varKeys.includes(Object.keys(havingVals[0])[0]));\n    if (conj == \"!\" && !isEmptyOp) {\n      not = !not;\n      having = having[\"!\"];\n      conj = Object.keys(having)[0];\n      havingVals = having[conj];\n      if (!Array.isArray(havingVals))\n        havingVals = [ havingVals ];\n    }\n  }\n\n  // Use reversed op\n  if (not && canRev && opConfig.reversedOp) {\n    not = false;\n    opKey = opConfig.reversedOp;\n    opConfig = config.operators[opKey];\n  }\n\n  const widget = getWidgetForFieldOp(config, field, opKey);\n\n  const convertedArgs = args\n    .map(v => convertFromLogic(v, conv, config, \"val\", meta, false, fieldConfig, widget, parentField));\n  if (convertedArgs.filter(v => v === undefined).length) {\n    //meta.errors.push(`Undefined arg for field ${field} and op ${opKey}`);\n    return undefined;\n  }\n\n  let res;\n\n  if (fieldConfig.type == \"!group\" && having) {\n    if (conv.conjunctions[conj] !== undefined) {\n      res = convertConj(conj, havingVals, conv, config, not, meta, field, true);\n      not = false; // not was applied to group\n    } else {\n      // need to be wrapped in `rule_group`\n      const rule = convertOp(conj, havingVals, conv, config, not && canRev, meta, field);\n      if (not && canRev && !rule?.properties?.not) {\n        not = false; // op was reversed in rule\n      }\n      res = wrapInDefaultConjRuleGroup(rule, field, fieldConfig, config, conv.conjunctions[\"and\"]);\n    }\n    if (!res)\n      return undefined;\n    \n    res.type = \"rule_group\";\n    if (not) {\n      Object.assign(res.properties, {\n        not: not,\n      });\n    }\n    Object.assign(res.properties, {\n      field: field,\n      mode: fieldConfig.mode,\n      operator: opKey,\n    });\n    if (fieldConfig.mode == \"array\") {\n      Object.assign(res.properties, {\n        value: convertedArgs.map(v => v.value),\n        valueSrc: convertedArgs.map(v => v.valueSrc),\n        valueType: convertedArgs.map(v => v.valueType),\n      });\n    }\n  } else if (fieldConfig.type == \"!group\" && !having) {\n    res = {\n      type: \"rule_group\",\n      id: uuid(),\n      children1: {},\n      properties: {\n        conjunction: defaultGroupConjunction(config, fieldConfig),\n        not: not,\n        mode: fieldConfig.mode,\n        field: field,\n        operator: opKey,\n      }\n    };\n    if (fieldConfig.mode == \"array\") {\n      Object.assign(res.properties, {\n        value: convertedArgs.map(v => v.value),\n        valueSrc: convertedArgs.map(v => v.valueSrc),\n        valueType: convertedArgs.map(v => v.valueType),\n      });\n    }\n  } else {\n    const asyncListValuesArr = convertedArgs.map(v => v.asyncListValues).filter(v => v != undefined);\n    const asyncListValues = asyncListValuesArr.length ? asyncListValuesArr[0] : undefined;\n    res = {\n      type: \"rule\",\n      id: uuid(),\n      properties: {\n        field: field,\n        operator: opKey,\n        value: convertedArgs.map(v => v.value),\n        valueSrc: convertedArgs.map(v => v.valueSrc),\n        valueType: convertedArgs.map(v => v.valueType),\n        asyncListValues,\n      }\n    };\n    if (not) {\n      //meta.errors.push(`No rev op for ${opKey}`);\n      res = wrapInDefaultConj(res, config, not);\n    }\n  }\n\n  return res;\n};\n\n","import { SpelExpressionEvaluator } from \"spel2js\";\nimport uuid from \"../utils/uuid\";\nimport {getFieldConfig, extendConfig, normalizeField} from \"../utils/configUtils\";\nimport {getWidgetForFieldOp} from \"../utils/ruleUtils\";\nimport {loadTree} from \"./tree\";\nimport {defaultConjunction, defaultGroupConjunction} from \"../utils/defaultUtils\";\nimport {logger} from \"../utils/stuff\";\nimport moment from \"moment\";\n\nexport const loadFromSpel = (logicTree, config) => {\n  return _loadFromSpel(logicTree, config, true);\n};\n\nexport const _loadFromSpel = (spelStr, config, returnErrors = true) => {\n  //meta is mutable\n  let meta = {\n    errors: []\n  };\n  const extendedConfig = extendConfig(config);\n  const conv = buildConv(extendedConfig);\n  \n  let compiledExpression;\n  let convertedObj;\n  let jsTree = undefined;\n  try {\n    const compileRes = SpelExpressionEvaluator.compile(spelStr);\n    compiledExpression = compileRes._compiledExpression;\n  } catch (e) {\n    meta.errors.push(e);\n  }\n  \n  if (compiledExpression) {\n    logger.debug(\"compiledExpression:\", compiledExpression);\n    convertedObj = convertCompiled(compiledExpression, meta);\n    logger.debug(\"convertedObj:\", convertedObj, meta);\n\n    jsTree = convertToTree(convertedObj, conv, extendedConfig, meta);\n    if (jsTree && jsTree.type != \"group\" && jsTree.type != \"switch_group\") {\n      jsTree = wrapInDefaultConj(jsTree, extendedConfig, convertedObj[\"not\"]);\n    }\n    logger.debug(\"jsTree:\", jsTree);\n  }\n\n  const immTree = jsTree ? loadTree(jsTree) : undefined;\n\n  if (returnErrors) {\n    return [immTree, meta.errors];\n  } else {\n    if (meta.errors.length)\n      console.warn(\"Errors while importing from SpEL:\", meta.errors);\n    return immTree;\n  }\n};\n\nconst convertCompiled = (expr, meta, parentExpr = null) => {\n  const type = expr.getType();\n  let children = expr.getChildren().map(child => convertCompiled(child, meta, expr));\n\n  // flatize OR/AND\n  if (type == \"op-or\" || type == \"op-and\") {\n    children = children.reduce((acc, child) => {\n      const canFlatize = child.type == type && !child.not;\n      const flat = canFlatize ? child.children : [child];\n      return [...acc, ...flat];\n    }, []);\n  }\n\n  // unwrap NOT\n  if (type == \"op-not\") {\n    if (children.length != 1) {\n      meta.errors.push(`Operator NOT should have 1 child, but got ${children.length}}`);\n    }\n    return {\n      ...children[0],\n      not: !(children[0].not || false)\n    };\n  }\n\n  if (type == \"compound\") {\n    // remove `.?[true]`\n    children = children.filter(child => {\n      const isListFix = child.type == \"selection\" && child.children.length == 1 && child.children[0].type == \"boolean\" && child.children[0].val == true;\n      return !isListFix;\n    });\n    // aggregation\n    // eg. `results.?[product == 'abc'].length`\n    const selection = children.find(child => \n      child.type == \"selection\"\n    );\n    if (selection && selection.children.length != 1) {\n      meta.errors.push(`Selection should have 1 child, but got ${selection.children.length}`);\n    }\n    const filter = selection ? selection.children[0] : null;\n    const lastChild = children[children.length - 1];\n    const isSize = lastChild.type == \"method\" && lastChild.val.methodName == \"size\" \n      || lastChild.type == \"!func\" && lastChild.methodName == \"size\" ;\n    const isLength = lastChild.type == \"property\" && lastChild.val == \"length\";\n    const sourceParts = children.filter(child => \n      child !== selection && child !== lastChild\n    );\n    const source = {\n      type: \"compound\",\n      children: sourceParts\n    };\n    if (isSize || isLength) {\n      return {\n        type: \"!aggr\",\n        filter,\n        source\n      };\n    }\n    // remove `#this`, `#root`\n    children = children.filter(child => {\n      const isThis = child.type == \"variable\" && child.val == \"this\";\n      const isRoot = child.type == \"variable\" && child.val == \"root\";\n      return !(isThis || isRoot);\n    });\n    // indexer\n    children = children.map(child => {\n      if (child.type == \"indexer\" && child.children.length == 1) {\n        return {\n          type: \"indexer\", \n          val: child.children[0].val,\n          itype: child.children[0].type\n        };\n      } else {\n        return child;\n      }\n    });\n    // method\n    if (lastChild.type == \"method\") {\n      const obj = children.filter(child => \n        child !== lastChild\n      );\n      return {\n        type: \"!func\",\n        obj,\n        methodName: lastChild.val.methodName,\n        args: lastChild.val.args\n      };\n    }\n    // !func\n    if (lastChild.type == \"!func\") {\n      const obj = children.filter(child => \n        child !== lastChild\n      );\n      return {\n        ...lastChild,\n        obj,\n      };\n    }\n  }\n\n  // getRaw || getValue\n  let val;\n  try {\n    if (expr.getRaw) { // use my fork\n      val = expr.getRaw();\n    } else if (expr.getValue.length == 0) { // getValue not requires context arg -> can use\n      val = expr.getValue();\n    }\n  } catch(e) {\n    logger.error(\"[spel2js] Error in getValue()\", e);\n  }\n\n  // ternary\n  if (type == \"ternary\") {\n    val = flatizeTernary(children);\n  }\n\n  // convert method/function args\n  if (typeof val === \"object\" && val !== null) {\n    if (val.methodName || val.functionName) {\n      val.args = val.args.map(child => convertCompiled(child, meta, expr));\n    }\n  }\n  // convert list\n  if (type == \"list\") {\n    val = val.map(item => convertCompiled(item, meta, expr));\n\n    // fix whole expression wrapped in `{}`\n    if (!parentExpr && val.length == 1) {\n      return val[0];\n    }\n  }\n  // convert constructor\n  if (type == \"constructorref\") {\n    const qid = children.find(child => child.type == \"qualifiedidentifier\");\n    const cls = qid?.val;\n    if (!cls) {\n      meta.errors.push(`Can't find qualifiedidentifier in constructorref children: ${JSON.stringify(children)}`);\n      return undefined;\n    }\n    const args = children.filter(child => child.type != \"qualifiedidentifier\");\n    return {\n      type: \"!new\",\n      cls,\n      args\n    };\n  }\n  // convert type\n  if (type == \"typeref\") {\n    const qid = children.find(child => child.type == \"qualifiedidentifier\");\n    const cls = qid?.val;\n    if (!cls) {\n      meta.errors.push(`Can't find qualifiedidentifier in typeref children: ${JSON.stringify(children)}`);\n      return undefined;\n    }\n    const _args = children.filter(child => child.type != \"qualifiedidentifier\");\n    return {\n      type: \"!type\",\n      cls\n    };\n  }\n  // convert function/method\n  if (type == \"function\" || type == \"method\") {\n    // `foo()` is method, `#foo()` is function\n    // let's use common property `methodName` and just add `isVar` for function\n    const {functionName, methodName, args} = val;\n    return {\n      type: \"!func\",\n      methodName: functionName || methodName,\n      isVar: type == \"function\",\n      args\n    };\n  }\n\n  return {\n    type,\n    children,\n    val,\n  };\n};\n\nconst flatizeTernary = (children) => {\n  let flat = [];\n  function _processTernaryChildren(tern) {\n    let [cond, if_val, else_val] = tern;\n    flat.push([cond, if_val]);\n    if (else_val?.type == \"ternary\") {\n      _processTernaryChildren(else_val.children);\n    } else {\n      flat.push([undefined, else_val]);\n    }\n  }\n  _processTernaryChildren(children);\n  return flat;\n};\n\nconst buildConv = (config) => {\n  let operators = {};\n  for (let opKey in config.operators) {\n    const opConfig = config.operators[opKey];\n    if (opConfig.spelOps) {\n      // examples: \"==\", \"eq\", \".contains\", \"matches\" (can be used for starts_with, ends_with)\n      opConfig.spelOps.forEach(spelOp => {\n        const opk = spelOp; // + \"/\" + defaultValue(opConfig.cardinality, 1);\n        if (!operators[opk])\n          operators[opk] = [];\n        operators[opk].push(opKey);\n      });\n    } else if (opConfig.spelOp) {\n      const opk = opConfig.spelOp; // + \"/\" + defaultValue(opConfig.cardinality, 1);\n      if (!operators[opk])\n        operators[opk] = [];\n      operators[opk].push(opKey);\n    } else {\n      logger.log(`[spel] No spelOp for operator ${opKey}`);\n    }\n  }\n\n  let conjunctions = {};\n  for (let conjKey in config.conjunctions) {\n    const conjunctionDefinition = config.conjunctions[conjKey];\n    const ck = conjunctionDefinition.spelConj || conjKey.toLowerCase();\n    conjunctions[ck] = conjKey;\n  }\n\n  let funcs = {};\n  for (let funcKey in config.funcs) {\n    const funcConfig = config.funcs[funcKey];\n    let fk;\n    if (typeof funcConfig.spelFunc == \"string\") {\n      fk = funcConfig.spelFunc;\n    }\n    if (fk) {\n      if (!funcs[fk])\n        funcs[fk] = [];\n      funcs[fk].push(funcKey);\n    }\n  }\n\n  return {\n    operators,\n    conjunctions,\n    funcs,\n  };\n};\n\nconst convertPath = (parts, meta) => {\n  let isError = false;\n  const res = parts.map(c => {\n    if (c.type == \"variable\" || c.type == \"property\" || c.type == \"indexer\" && c.itype == \"string\") {\n      return c.val;\n    } else {\n      isError = true;\n      meta.errors.push(`Unexpected item in compound: ${JSON.stringify(c)}`);\n    }\n  });\n  return !isError ? res : undefined;\n};\n\nconst convertArg = (spel, conv, config, meta, parentSpel) => {\n  if (spel == undefined)\n    return undefined;\n  const {fieldSeparator} = config.settings;\n  const literalTypes = {\n    number: \"number\",\n    string: \"text\",\n    boolean: \"boolean\",\n    null: \"null\" // should not be\n  };\n  \n  const groupFieldParts = parentSpel?._groupField ? [parentSpel?._groupField] : [];\n  if (spel.type == \"compound\") {\n    // complex field\n    const parts = convertPath(spel.children, meta);\n    if (!parts) {\n      return undefined;\n    }\n    const fullParts = [...groupFieldParts, ...parts];\n    const isVariable = spel.children?.[0]?.type == \"variable\";\n    return {\n      valueSrc: \"field\",\n      //valueType: todo\n      isVariable,\n      value: fullParts.join(fieldSeparator),\n    };\n  } else if (spel.type == \"variable\" || spel.type == \"property\") {\n    // normal field\n    const fullParts = [...groupFieldParts, spel.val];\n    const isVariable = spel.type == \"variable\";\n    return {\n      valueSrc: \"field\",\n      //valueType: todo\n      isVariable,\n      value: fullParts.join(fieldSeparator),\n    };\n  } else if (literalTypes[spel.type]) {\n    let value = spel.val;\n    let valueType = literalTypes[spel.type];\n    if (parentSpel?.isUnary) {\n      value = -value;\n    }\n    return {\n      valueSrc: \"value\",\n      valueType,\n      value,\n    };\n  } else if (spel.type == \"list\") {\n    const values = spel.val.map(v => convertArg(v, conv, config, meta, spel));\n    const _itemType = values.length ? values[0]?.valueType : null;\n    const value = values.map(v => v?.value);\n    const valueType = \"multiselect\";\n    return {\n      valueSrc: \"value\",\n      valueType,\n      value,\n    };\n  } else if (spel.type == \"!func\") {\n    const {obj, methodName, args, isVar} = spel;\n    \n    // todo: get from conv\n    const funcToOpMap = {\n      [\".contains\"]: \"like\",\n      [\".startsWith\"]: \"starts_with\",\n      [\".endsWith\"]: \"ends_with\",\n      [\"$contains\"]: \"select_any_in\",\n    };\n\n    const convertedArgs = args.map(v => convertArg(v, conv, config, meta, {\n      ...spel,\n      _groupField: parentSpel?._groupField\n    }));\n\n    //todo: make dynamic: use funcToOpMap and check obj type in basic config\n    if (methodName == \"contains\" && obj && obj[0].type == \"list\") {\n      const convertedObj = obj.map(v => convertArg(v, conv, config, meta, spel));\n      // {'yellow', 'green'}.?[true].contains(color)\n      if (!( convertedArgs.length == 1 && convertedArgs[0].valueSrc == \"field\" )) {\n        meta.errors.push(`Expected arg to method ${methodName} to be field but got: ${JSON.stringify(convertedArgs)}`);\n        return undefined;\n      }\n      const field = convertedArgs[0].value;\n      if (!( convertedObj.length == 1 && convertedObj[0].valueType == \"multiselect\" )) {\n        meta.errors.push(`Expected object of method ${methodName} to be inline list but got: ${JSON.stringify(convertedObj)}`);\n        return undefined;\n      }\n      const opKey = funcToOpMap[\"$\"+methodName];\n      const list = convertedObj[0];\n      return buildRule(config, meta, field, opKey, [list]);\n    } else if (funcToOpMap[\".\"+methodName]) {\n      // user.login.startsWith('gg')\n      const opKey = funcToOpMap[\".\"+methodName];\n      const parts = convertPath(obj, meta);\n      if (parts && convertedArgs.length == 1) {\n        const fullParts = [...groupFieldParts, ...parts];\n        const field = fullParts.join(fieldSeparator);\n        return buildRule(config, meta, field, opKey, convertedArgs);\n      }\n    } else if (methodName == \"parse\" && obj && obj[0].type == \"!new\" && obj[0].cls.at(-1) == \"SimpleDateFormat\") {\n      // new java.text.SimpleDateFormat('yyyy-MM-dd').parse('2022-01-15')\n      const args = obj[0].args.map(v => convertArg(v, conv, config, meta, {\n        ...spel,\n        _groupField: parentSpel?._groupField\n      }));\n      if (!( args.length == 1 && args[0].valueType == \"text\" )) {\n        meta.errors.push(`Expected args of ${obj[0].cls.join(\".\")}.${methodName} to be 1 string but got: ${JSON.stringify(args)}`);\n        return undefined;\n      }\n      if (!( convertedArgs.length == 1 && convertedArgs[0].valueType == \"text\" )) {\n        meta.errors.push(`Expected args of ${obj[0].cls.join(\".\")} to be 1 string but got: ${JSON.stringify(convertedArgs)}`);\n        return undefined;\n      }\n      const dateFormat = args[0].value;\n      const dateString = convertedArgs[0].value;\n      const valueType = dateFormat.includes(\" \") ? \"datetime\" : \"date\";\n      const field = null; // todo\n      const widget = valueType;\n      const fieldConfig = getFieldConfig(config, field);\n      const widgetConfig = config.widgets[widget || fieldConfig?.mainWidget];\n      const valueFormat = widgetConfig.valueFormat;\n      const dateVal = moment(dateString, moment.ISO_8601);\n      const value = dateVal.isValid() ? dateVal.format(valueFormat) : undefined;\n      return {\n        valueSrc: \"value\",\n        valueType,\n        value,\n      };\n    } else if (methodName == \"parse\" && obj && obj[0].type == \"!type\" && obj[0].cls.at(-1) == \"LocalTime\") {\n      // time == T(java.time.LocalTime).parse('02:03:00')\n      if (!( convertedArgs.length == 1 && convertedArgs[0].valueType == \"text\" )) {\n        meta.errors.push(`Expected args of ${obj[0].cls.join(\".\")} to be 1 string but got: ${JSON.stringify(convertedArgs)}`);\n        return undefined;\n      }\n      const timeString = convertedArgs[0].value;\n      const valueType = \"time\";\n      const field = null; // todo\n      const widget = valueType;\n      const fieldConfig = getFieldConfig(config, field);\n      const widgetConfig = config.widgets[widget || fieldConfig?.mainWidget];\n      const valueFormat = widgetConfig.valueFormat;\n      const dateVal = moment(timeString, \"HH:mm:ss\");\n      const value = dateVal.isValid() ? dateVal.format(valueFormat) : undefined;\n      return {\n        valueSrc: \"value\",\n        valueType,\n        value,\n      };\n    } else {\n      // todo: conv.funcs\n      meta.errors.push(`Unsupported method ${methodName}`);\n    }\n  } else if (spel.type == \"op-plus\" && parentSpel?.type == \"ternary\") {\n    return buildCaseValueConcat(spel, conv, config, meta);\n  } else {\n    meta.errors.push(`Can't convert arg of type ${spel.type}`);\n  }\n  return undefined;\n};\n\nconst buildRule = (config, meta, field, opKey, convertedArgs) => {\n  if (convertedArgs.filter(v => v === undefined).length) {\n    return undefined;\n  }\n  const fieldConfig = getFieldConfig(config, field);\n  if (!fieldConfig) {\n    meta.errors.push(`No config for field ${field}`);\n    return undefined;\n  }\n  const widget = getWidgetForFieldOp(config, field, opKey);\n  const widgetConfig = config.widgets[widget || fieldConfig.mainWidget];\n  const asyncListValuesArr = convertedArgs.map(v => v.asyncListValues).filter(v => v != undefined);\n  const asyncListValues = asyncListValuesArr.length ? asyncListValuesArr[0] : undefined;\n  let res = {\n    type: \"rule\",\n    id: uuid(),\n    properties: {\n      field: field,\n      operator: opKey,\n      value: convertedArgs.map(v => v.value),\n      valueSrc: convertedArgs.map(v => v.valueSrc),\n      valueType: convertedArgs.map(v => {\n        if (v.valueSrc == \"value\") {\n          return widgetConfig?.type || fieldConfig?.type || v.valueType;\n        }\n        return v.valueType;\n      }),\n      asyncListValues,\n    }\n  };\n  return res;\n};\n\nconst buildRuleGroup = ({groupFilter, groupFieldValue}, opKey, convertedArgs, config, meta) => {\n  if (groupFieldValue.valueSrc != \"field\")\n    throw `Bad groupFieldValue: ${JSON.stringify(groupFieldValue)}`;\n  const groupField = groupFieldValue.value;\n  let groupOpRule = buildRule(config, meta, groupField, opKey, convertedArgs);\n  if (!groupOpRule)\n    return undefined;\n  const fieldConfig = getFieldConfig(config, groupField);\n  const mode = fieldConfig?.mode;\n  let res = {\n    ...(groupFilter || {}),\n    type: \"rule_group\",\n    properties: {\n      ...groupOpRule.properties,\n      ...(groupFilter?.properties || {}),\n      mode\n    }\n  };\n  if (!res.id)\n    res.id = uuid();\n  return res;\n};\n\n\nconst compareArgs = (left, right,  spel, conv, config, meta, parentSpel = null) => {\n  if (left.type == right.type) {\n    if (left.type == \"!aggr\") {\n      const [leftSource, rightSource] = [left.source, right.source].map(v => convertArg(v, conv, config, meta, {\n        ...spel,\n        _groupField: parentSpel?._groupField\n      }));\n      //todo: check same filter\n      return leftSource.value == rightSource.value;\n    } else {\n      const [leftVal, rightVal] = [left, right].map(v => convertArg(v, conv, config, meta, {\n        ...spel,\n        _groupField: parentSpel?._groupField\n      }));\n      return leftVal.value == rightVal.value;\n    }\n  }\n  return false;\n};\n\nconst convertToTree = (spel, conv, config, meta, parentSpel = null) => {\n  if(!spel) return undefined;\n  let res;\n  if (spel.type.indexOf(\"op-\") == 0) {\n    let op = spel.type.slice(\"op-\".length);\n\n    // unary\n    const isUnary = (op == \"minus\" || op == \"plus\") && spel.children.length == 1;\n    if (isUnary) {\n      spel.isUnary = true;\n      return convertToTree(spel.children[0], conv, config, meta, spel);\n    }\n\n    // between\n    let isBetweenNormal = (op == \"and\" && spel.children.length == 2 && spel.children[0].type == \"op-ge\" && spel.children[1].type == \"op-le\");\n    let isBetweenRev = (op == \"or\" && spel.children.length == 2 && spel.children[0].type == \"op-lt\" && spel.children[1].type == \"op-gt\");\n    let isBetween = isBetweenNormal || isBetweenRev;\n    if (isBetween) {\n      const [left, from] = spel.children[0].children;\n      const [right, to] = spel.children[1].children;\n      const isNumbers = from.type == \"number\" && to.type == \"number\";\n      const isSameSource = compareArgs(left, right,  spel, conv, config, meta, parentSpel);\n      if (isNumbers && isSameSource) {\n        const _fromValue = from.val;\n        const _toValue = to.val;\n        const oneSpel = {\n          type: \"op-between\",\n          children: [\n            left,\n            from,\n            to\n          ]\n        };\n        return convertToTree(oneSpel, conv, config, meta, parentSpel);\n      }\n    }\n\n    // find op\n    let opKeys = conv.operators[op];\n    let opKey;\n    // todo: make dynamic, use basic config\n    if (op == \"eq\" && spel.children[1].type == \"null\") {\n      opKey = \"is_null\";\n    } else if (op == \"ne\" && spel.children[1].type == \"null\") {\n      opKey = \"is_not_null\";\n    } else if (op == \"le\" && spel.children[1].type == \"string\" && spel.children[1].val == \"\") {\n      opKey = \"is_empty\";\n      opKeys = [\"is_empty\"];\n    } else if (op == \"gt\" && spel.children[1].type == \"string\" && spel.children[1].val == \"\") {\n      opKey = \"is_not_empty\";\n      opKeys = [\"is_not_empty\"];\n    } else if (op == \"between\") {\n      opKey = \"between\";\n      opKeys = [\"between\"];\n    }\n\n    // convert children\n    const convertChildren = () => spel.children.map(child => \n      convertToTree(child, conv, config, meta, {\n        ...spel,\n        _groupField: parentSpel?._groupField\n      })\n    );\n    \n    if (op == \"and\" || op == \"or\") {\n      const children1 = {};\n      const vals = convertChildren();\n      vals.forEach(v => {\n        if (v) {\n          const id = uuid();\n          v.id = id;\n          if (v.type != undefined) {\n            children1[id] = v;\n          } else {\n            meta.errors.push(`Bad item in AND/OR: ${JSON.stringify(v)}`);\n          }\n        }\n      });\n      res = {\n        type: \"group\",\n        id: uuid(),\n        children1,\n        properties: {\n          conjunction: conv.conjunctions[op],\n          not: spel.not\n        }\n      };\n    } else if (opKeys) {\n      const vals = convertChildren();\n      const fieldObj = vals[0];\n      let convertedArgs = vals.slice(1);\n      opKey = opKeys[0];\n      \n      if (!fieldObj) {\n        // LHS can't be parsed\n      } else if (fieldObj.groupFieldValue) {\n        // 1. group\n        if (fieldObj.groupFieldValue.valueSrc != \"field\") {\n          meta.errors.push(`Expected group field ${JSON.stringify(fieldObj)}`);\n        }\n        const groupField = fieldObj.groupFieldValue.value;\n        \n        // some/all/none\n        const opArg = convertedArgs[0];\n        if (opArg && opArg.groupFieldValue && opArg.groupFieldValue.valueSrc == \"field\" && opArg.groupFieldValue.value == groupField) {\n          // group.?[...].size() == group.size()\n          opKey = \"all\";\n          convertedArgs = [];\n        } else if (opKey == \"equal\" && opArg.valueSrc == \"value\" && opArg.valueType == \"number\" && opArg.value == 0) {\n          opKey = \"none\";\n          convertedArgs = [];\n        } else if (opKey == \"greater\" && opArg.valueSrc == \"value\" && opArg.valueType == \"number\" && opArg.value == 0) {\n          opKey = \"some\";\n          convertedArgs = [];\n        }\n\n        res = buildRuleGroup(fieldObj, opKey, convertedArgs, config, meta);\n      } else {\n        // 2. not group\n        if (fieldObj.valueSrc != \"field\") {\n          meta.errors.push(`Expected field ${JSON.stringify(fieldObj)}`);\n        }\n        const field = fieldObj.value;\n\n        if (opKeys.length > 1) {\n          logger.warn(`[spel] Spel operator ${op} can be mapped to ${opKeys}`);\n\n          //todo: it's naive\n          const widgets = opKeys.map(op => ({op, widget: getWidgetForFieldOp(config, field, op)}));\n          \n          if (op == \"eq\" || op == \"ne\") {\n            const ws = widgets.find(({ op, widget }) => (widget && widget != \"field\"));\n            opKey = ws.op;\n          }\n        }\n        res = buildRule(config, meta, field, opKey, convertedArgs);\n      }\n    } else {\n      if (!parentSpel) {\n        // try to parse whole `\"str\" + prop + #var` as ternary\n        res = buildSimpleSwitch(spel, conv, config, meta);\n      }\n      if (!res) {\n        meta.errors.push(`Can't convert op ${op}`);\n      }\n    }\n  } else if (spel.type == \"!aggr\") {\n    const groupFieldValue = convertToTree(spel.source, conv, config, meta, {\n      ...spel, \n      _groupField: parentSpel?._groupField\n    });\n    let groupFilter = convertToTree(spel.filter, conv, config, meta, {\n      ...spel, \n      _groupField: groupFieldValue?.value\n    });\n    if (groupFilter?.type == \"rule\") {\n      groupFilter = wrapInDefaultConj(groupFilter, config);\n    }\n    res = {\n      groupFilter,\n      groupFieldValue\n    };\n    if (!parentSpel) {\n      // !aggr can't be in root, it should be compared with something\n      res = undefined;\n      meta.errors.push(\"Unexpected !aggr in root\");\n    }\n  } else if (spel.type == \"ternary\") {\n    const children1 = {};\n    spel.val.forEach(v => {\n      const [cond, val] = v;\n      const caseI = buildCase(cond, val, conv, config, meta, spel);\n      if (caseI) {\n        children1[caseI.id] = caseI;\n      }\n    });\n    res = {\n      type: \"switch_group\",\n      id: uuid(),\n      children1,\n      properties: {}\n    };\n  } else {\n    res = convertArg(spel, conv, config, meta, parentSpel);\n    if (res && !res.type && !parentSpel) {\n      // try to parse whole `\"1\"` as ternary\n      const sw = buildSimpleSwitch(spel, conv, config, meta);\n      if (sw) {\n        res = sw;\n      } else {\n        res = undefined;\n        meta.errors.push(`Can't convert rule of type ${spel.type}, it looks like var/literal`);\n      }\n    }\n  }\n  return res;\n};\n\nconst buildSimpleSwitch = (val, conv, config, meta) => {\n  let children1 = {};\n  const cond = null;\n  const caseI = buildCase(cond, val, conv, config, meta);\n  if (caseI) {\n    children1[caseI.id] = caseI;\n  }\n  let res = {\n    type: \"switch_group\",\n    id: uuid(),\n    children1,\n    properties: {}\n  };\n  return res;\n};\n\nconst buildCase = (cond, val, conv, config, meta, spel = null) => {\n  const valProperties = buildCaseValProperties(config, meta, conv, val, spel);\n\n  let caseI;\n  if (cond) {\n    caseI = convertToTree(cond, conv, config, meta, spel);\n    if (caseI && caseI.type) {\n      if (caseI.type != \"group\") {\n        caseI = wrapInDefaultConj(caseI, config);\n      }\n      caseI.type = \"case_group\";\n    } else {\n      meta.errors.push(`Unexpected case: ${JSON.stringify(caseI)}`);\n      caseI = undefined;\n    }\n  } else {\n    caseI = {\n      id: uuid(),\n      type: \"case_group\",\n      properties: {}\n    };\n  }\n\n  if (caseI) {\n    caseI.properties = {\n      ...caseI.properties,\n      ...valProperties\n    };\n  }\n\n  return caseI;\n};\n\nconst buildCaseValueConcat = (spel, conv, config, meta) => {\n  let flat = [];\n  function _processConcatChildren(children) {\n    children.map(child => {\n      if (child.type == \"op-plus\") {\n        _processConcatChildren(child.children);\n      } else {\n        const convertedChild = convertArg(child, conv, config, meta, spel);\n        if (convertedChild) {\n          flat.push(convertedChild);\n        } else {\n          meta.errors.push(`Can't convert ${child.type} in concatenation`);\n        }\n      }\n    });\n  }\n  _processConcatChildren(spel.children);\n  return {\n    valueSrc: \"value\",\n    valueType: \"case_value\",\n    value: flat,\n  };\n};\n\nconst buildCaseValProperties = (config, meta, conv, val, spel = null) => {\n  let valProperties = {};\n  let convVal;\n  if (val?.type == \"op-plus\") {\n    convVal = buildCaseValueConcat(val, conv, config, meta);\n  } else {\n    convVal = convertArg(val, conv, config, meta, spel);\n  }\n  const widgetDef = config.widgets[\"case_value\"];\n  const importCaseValue = widgetDef?.spelImportValue;\n  if (importCaseValue) {\n    const [normVal, normErrors] = importCaseValue(convVal);\n    normErrors.map(e => meta.errors.push(e));\n    if (normVal) {\n      valProperties = {\n        value: [normVal],\n        valueSrc: [\"value\"],\n        valueType: [\"case_value\"]\n      };\n    }\n  } else {\n    meta.errors.push(\"No fucntion to import case value\");\n  }\n  return valProperties;\n};\n\nconst wrapInDefaultConjRuleGroup = (rule, parentField, parentFieldConfig, config, conj) => {\n  if (!rule) return undefined;\n  return {\n    type: \"rule_group\",\n    id: uuid(),\n    children1: { [rule.id]: rule },\n    properties: {\n      conjunction: conj || defaultGroupConjunction(config, parentFieldConfig),\n      not: false,\n      field: parentField,\n    }\n  };\n};\n\nconst wrapInDefaultConj = (rule, config, not = false) => {\n  return {\n    type: \"group\",\n    id: uuid(),\n    children1: { [rule.id]: rule },\n    properties: {\n      conjunction: defaultConjunction(config),\n      not: not || false\n    }\n  };\n};\n","import moment from \"moment\";\n\nconst NOW = {\n  label: \"Now\",\n  returnType: \"datetime\",\n  jsonLogic: \"now\",\n  //todo: document option `jsonLogicCustomOps`\n  //todo: add util to return all used custom ops to be added by user with `jsonLogic.add_operation`\n  jsonLogicCustomOps: {\n    now: () => new Date(),\n  },\n  spelFunc: \"new java.util.Date()\",\n  sqlFormatFunc: () => \"NOW()\",\n  mongoFormatFunc: () => new Date(),\n  formatFunc: () => \"NOW\",\n};\n\nconst RELATIVE_DATETIME = {\n  label: \"Relative\",\n  returnType: \"datetime\",\n  renderBrackets: [\"\", \"\"],\n  renderSeps: [\"\", \"\", \"\"],\n  jsonLogic: ({date, op, val, dim}) => ({\n    \"date_add\": [\n      date,\n      val * (op == \"minus\" ? -1 : +1),\n      dim\n    ]\n  }),\n  jsonLogicImport: (v) => {\n    const date = v[\"date_add\"][0];\n    const val = Math.abs(v[\"date_add\"][1]);\n    const op = v[\"date_add\"][1] >= 0 ? \"plus\" : \"minus\";\n    const dim = v[\"date_add\"][2];\n    return [date, op, val, dim];\n  },\n  jsonLogicCustomOps: {\n    date_add: (date, val, dim) => moment(date).add(val, dim).toDate()\n  },\n  // MySQL\n  //todo: other SQL dialects?\n  sqlFormatFunc: ({date, op, val, dim}) => `DATE_ADD(${date}, INTERVAL ${parseInt(val) * (op == \"minus\" ? -1 : +1)} ${dim.replace(/^'|'$/g, \"\")})`,\n  mongoFormatFunc: null, //todo: support?\n  //todo: spel\n  formatFunc: ({date, op, val, dim}) => (!val ? date : `${date} ${op == \"minus\" ? \"-\" : \"+\"} ${val} ${dim}`),\n  args: {\n    date: {\n      label: \"Date\",\n      type: \"datetime\",\n      defaultValue: {func: \"NOW\", args: []},\n      valueSources: [\"func\", \"field\"],\n    },\n    op: {\n      label: \"Op\",\n      type: \"select\",\n      defaultValue: \"plus\",\n      valueSources: [\"value\"],\n      mainWidgetProps: {\n        customProps: {\n          showSearch: false\n        }\n      },\n      fieldSettings: {\n        listValues: {\n          plus: \"+\",\n          minus: \"-\",\n        },\n      }\n    },\n    val: {\n      label: \"Value\",\n      type: \"number\",\n      fieldSettings: {\n        min: 0,\n      },\n      defaultValue: 0,\n      valueSources: [\"value\"],\n    },\n    dim: {\n      label: \"Dimension\",\n      type: \"select\",\n      defaultValue: \"day\",\n      valueSources: [\"value\"],\n      mainWidgetProps: {\n        customProps: {\n          showSearch: false\n        }\n      },\n      fieldSettings: {\n        listValues: {\n          day: \"day\",\n          week: \"week\",\n          month: \"month\",\n          year: \"year\",\n        },\n      }\n    },\n  }\n};\n\nconst LOWER = {\n  label: \"Lowercase\",\n  mongoFunc: \"$toLower\",\n  jsonLogic: \"toLowerCase\",\n  spelFunc: \".toLowerCase\",\n  //jsonLogicIsMethod: true, // Removed in JsonLogic 2.x due to Prototype Pollution\n  jsonLogicCustomOps: {\n    toLowerCase: (str) => str.toLowerCase(),\n  },\n  returnType: \"text\",\n  args: {\n    str: {\n      label: \"String\",\n      type: \"text\",\n      valueSources: [\"value\", \"field\"],\n    },\n  }\n};\n\nconst UPPER = {\n  label: \"Uppercase\",\n  mongoFunc: \"$toUpper\",\n  jsonLogic: \"toUpperCase\",\n  spelFunc: \".toUpperCase\",\n  //jsonLogicIsMethod: true, // Removed in JsonLogic 2.x due to Prototype Pollution\n  jsonLogicCustomOps: {\n    toUpperCase: (str) => str.toUpperCase(),\n  },\n  returnType: \"text\",\n  args: {\n    str: {\n      label: \"String\",\n      type: \"text\",\n      valueSources: [\"value\", \"field\"],\n    },\n  }\n};\n\nconst LINEAR_REGRESSION = {\n  label: \"Linear regression\",\n  returnType: \"number\",\n  formatFunc: ({coef, bias, val}, _) => `(${coef} * ${val} + ${bias})`,\n  sqlFormatFunc: ({coef, bias, val}) => `(${coef} * ${val} + ${bias})`,\n  spelFormatFunc: ({coef, bias, val}) => `(${coef} * ${val} + ${bias})`,\n  mongoFormatFunc: ({coef, bias, val}) => ({\"$sum\": [{\"$multiply\": [coef, val]}, bias]}),\n  jsonLogic: ({coef, bias, val}) => ({ \"+\": [ {\"*\": [coef, val]}, bias ] }),\n  jsonLogicImport: (v) => {\n    const coef = v[\"+\"][0][\"*\"][0];\n    const val = v[\"+\"][0][\"*\"][1];\n    const bias = v[\"+\"][1];\n    return [coef, val, bias];\n  },\n  renderBrackets: [\"\", \"\"],\n  renderSeps: [\" * \", \" + \"],\n  args: {\n    coef: {\n      label: \"Coef\",\n      type: \"number\",\n      defaultValue: 1,\n      valueSources: [\"value\"],\n    },\n    val: {\n      label: \"Value\",\n      type: \"number\",\n      valueSources: [\"value\", \"field\"],\n    },\n    bias: {\n      label: \"Bias\",\n      type: \"number\",\n      defaultValue: 0,\n      valueSources: [\"value\"],\n    }\n  }\n};\n\nexport {\n  LOWER,\n  UPPER,\n  NOW,\n  RELATIVE_DATETIME,\n  LINEAR_REGRESSION,\n};\n","export { default as Query } from \"./components/QueryContainer\";\nexport { default as Builder } from \"./components/Builder\";\n\nimport * as Export from \"./export\";\nimport * as Import from \"./import\";\nimport * as Widgets from \"./components/widgets/index\";\nimport * as Operators from \"./components/operators\";\nimport * as BasicUtils from \"./utils\";\nimport * as BasicFuncs from \"./config/funcs\";\nconst Utils = {...BasicUtils, ...Export, ...Import};\nexport {Widgets, Operators, Utils, Export, Import, BasicFuncs};\n\nexport {default as BasicConfig} from \"./config/basic\";\n\n","import {listValuesToArray, sleep, mapListValues} from \"./stuff\";\n\nexport const simulateAsyncFetch = (all, cPageSize = 0, delay = 1000) => async (search, offset, meta) => {\n  const pageSize = meta.pageSize != undefined ? meta.pageSize : cPageSize;\n  const filtered = listValuesToArray(all)\n    .filter(({title}) => search == null ? true : title.toUpperCase().indexOf(search.toUpperCase()) != -1);\n  const pages = pageSize ? Math.ceil(filtered.length / pageSize) : 0;\n  const currentOffset = offset || 0;\n  const currentPage = pageSize ? Math.ceil(currentOffset / pageSize) : null;\n  const values = pageSize ? filtered.slice(currentOffset, currentOffset + pageSize) : filtered;\n  const newOffset = pageSize ? currentOffset + values.length : null;\n  const hasMore = pageSize ? (newOffset < filtered.length) : false;\n  console.debug(\"simulateAsyncFetch\", {\n    search, offset, values, hasMore, filtered\n  });\n  await sleep(delay);\n  return {\n    values,\n    hasMore\n  };\n};\n\nexport const mergeListValues = (values, newValues, toStart = false) => {\n  if (!newValues)\n    return values;\n  const old = values || [];\n  const newFiltered = newValues.filter(v => old.find(av => av.value == v.value) == undefined);\n  const merged = toStart ? [...newFiltered, ...old] : [...old, ...newFiltered];\n  return merged;\n};\n\nexport const listValueToOption = (lv) => {\n  if (lv == null) return null;\n  const {title, value, disabled, groupTitle, renderTitle} = lv;\n  let option = {title, value};\n  if (disabled)\n    option.disabled = disabled;\n  if (groupTitle)\n    option.groupTitle = groupTitle;\n  if (renderTitle)\n    option.renderTitle = renderTitle;\n  return option;\n};\n\nexport const getListValue = (selectedValue, listValues) => \n  mapListValues(listValues, (lv) => (lv.value === selectedValue ? lv : null))\n    .filter(v => v !== null)\n    .shift();\n","import merge from \"lodash/merge\";\nimport uuid from \"../utils/uuid\";\nimport mergeWith from \"lodash/mergeWith\";\nimport {settings as defaultSettings} from \"../config/default\";\nimport moment from \"moment\";\nimport {normalizeListValues, mergeArraysSmart} from \"./stuff\";\nimport {getWidgetForFieldOp} from \"./ruleUtils\";\nimport clone from \"clone\";\nimport pick from \"lodash/pick\";\n\n\nconst configKeys = [\"conjunctions\", \"fields\", \"types\", \"operators\", \"widgets\", \"settings\", \"funcs\"];\n\nconst pickConfig = (props) => {\n  return pick(props, configKeys);\n};\n\nexport const createConfigMemo = () => {\n  const configStore = new Map();\n  const maxSize = 2; // current and prev\n  let configId = 0;\n\n  const extendAndStore = (config) => {\n    const extendedConfig = extendConfig(config, ++configId);\n    if ((configStore.size + 1) > maxSize) {\n      configStore.delete(configStore.keys()[0]);\n    }\n    configStore.set(config, extendedConfig);\n    return extendedConfig;\n  };\n\n  const findExtended = (findConfig) => {\n    // strict find:\n    // return configStore.get(findConfig) || configStore.values().find(ec => ec === findConfig);\n\n    for (const savedConfig of configStore.keys()) {\n      const found = configKeys.map(k => savedConfig[k] === findConfig[k]).filter(v => !v).length === 0;\n      if (found) {\n        return configStore.get(savedConfig);\n      }\n    }\n\n    for (const extendedConfig of configStore.values()) {\n      const found = configKeys.map(k => extendedConfig[k] === findConfig[k]).filter(v => !v).length === 0;\n      if (found) {\n        return extendedConfig;\n      }\n    }\n\n    return null;\n  };\n\n  const findOrExtend = (config) => {\n    return findExtended(config) || extendAndStore(config);\n  };\n  \n  return (props) => findOrExtend(pickConfig(props));\n};\n\n\n\nexport const extendConfig = (config, configId) => {\n  //operators, defaultOperator - merge\n  //widgetProps (including valueLabel, valuePlaceholder, hideOperator, operatorInlineLabel) - concrete by widget\n\n  if (config.__configId) {\n    return config;\n  }\n  \n  config = {...config};\n  config.settings = merge({}, defaultSettings, config.settings);\n  config._fieldsCntByType = {};\n  config._funcsCntByType = {};\n\n  config.types = clone(config.types);\n  _extendTypesConfig(config.types, config);\n\n  config.fields = clone(config.fields);\n  config.__fieldNames = {};\n  _extendFieldsConfig(config.fields, config);\n\n  config.funcs = clone(config.funcs);\n  _extendFuncArgsConfig(config.funcs, config);\n\n  moment.locale(config.settings.locale.moment);\n\n  Object.defineProperty(config, \"__configId\", {\n    enumerable: false,\n    writable: false,\n    value: configId || uuid()\n  });\n\n  return config;\n};\n\nfunction _extendTypesConfig(typesConfig, config) {\n  for (let type in typesConfig) {\n    let typeConfig = typesConfig[type];\n    _extendTypeConfig(type, typeConfig, config);\n  }\n}\n\nfunction _extendTypeConfig(type, typeConfig, config) {\n  let operators = null, defaultOperator = null;\n  typeConfig.mainWidget = typeConfig.mainWidget || Object.keys(typeConfig.widgets).filter(w => w != \"field\" && w != \"func\")[0];\n  for (let widget in typeConfig.widgets) {\n    let typeWidgetConfig = typeConfig.widgets[widget];\n    if (typeWidgetConfig.operators) {\n      let typeWidgetOperators = typeWidgetConfig.operators;\n      if (typeConfig.excludeOperators) {\n        typeWidgetOperators = typeWidgetOperators.filter(op => !typeConfig.excludeOperators.includes(op));\n      }\n      operators = mergeArraysSmart(operators, typeWidgetOperators);\n    }\n    if (typeWidgetConfig.defaultOperator)\n      defaultOperator = typeWidgetConfig.defaultOperator;\n    if (widget == typeConfig.mainWidget) {\n      typeWidgetConfig = merge({}, {widgetProps: typeConfig.mainWidgetProps || {}}, typeWidgetConfig);\n    }\n    typeConfig.widgets[widget] = typeWidgetConfig;\n  }\n  if (!typeConfig.valueSources)\n    typeConfig.valueSources = Object.keys(config.settings.valueSourcesInfo);\n  for (let valueSrc of typeConfig.valueSources) {\n    if (valueSrc != \"value\" && !typeConfig.widgets[valueSrc]) {\n      typeConfig.widgets[valueSrc] = {\n      };\n    }\n  }\n  if (!typeConfig.operators && operators)\n    typeConfig.operators = Array.from(new Set(operators)); //unique\n  if (!typeConfig.defaultOperator && defaultOperator)\n    typeConfig.defaultOperator = defaultOperator;\n}\n\nfunction _extendFieldsConfig(subconfig, config, path = []) {\n  for (let field in subconfig) {\n    _extendFieldConfig(subconfig[field], config, [...path, field]);\n    if (subconfig[field].subfields) {\n      _extendFieldsConfig(subconfig[field].subfields, config, [...path, field]);\n    }\n  }\n}\n\nfunction _extendFuncArgsConfig(subconfig, config) {\n  if (!subconfig) return;\n  for (let funcKey in subconfig) {\n    const funcDef = subconfig[funcKey];\n    if (funcDef.returnType) {\n      if (!config._funcsCntByType[funcDef.returnType])\n        config._funcsCntByType[funcDef.returnType] = 0;\n      config._funcsCntByType[funcDef.returnType]++;\n    }\n    for (let argKey in funcDef.args) {\n      _extendFieldConfig(funcDef.args[argKey], config, null, true);\n    }\n\n    // isOptional can be only in the end\n    if (funcDef.args) {\n      const argKeys = Object.keys(funcDef.args);\n      let tmpIsOptional = true;\n      for (const argKey of argKeys.reverse()) {\n        const argDef = funcDef.args[argKey];\n        if (!tmpIsOptional && argDef.isOptional) {\n          delete argDef.isOptional;\n        }\n        if (!argDef.isOptional)\n          tmpIsOptional = false;\n      }\n    }\n\n    if (funcDef.subfields) {\n      _extendFuncArgsConfig(funcDef.subfields, config);\n    }\n  }\n}\n\nfunction _extendFieldConfig(fieldConfig, config, path = null, isFuncArg = false) {\n  let operators = null, defaultOperator = null;\n  const typeConfig = config.types[fieldConfig.type];\n  const excludeOperatorsForField = fieldConfig.excludeOperators || [];\n  if (fieldConfig.type != \"!struct\" && fieldConfig.type != \"!group\") {\n    const keysToPutInFieldSettings = [\"listValues\", \"allowCustomValues\", \"validateValue\"];\n    if (!fieldConfig.fieldSettings)\n      fieldConfig.fieldSettings = {};\n    for (const k of keysToPutInFieldSettings) {\n      if (fieldConfig[k]) {\n        fieldConfig.fieldSettings[k] = fieldConfig[k];\n        delete fieldConfig[k];\n      }\n    }\n\n    if (fieldConfig.fieldSettings.listValues) {\n      fieldConfig.fieldSettings.listValues = normalizeListValues(fieldConfig.fieldSettings.listValues, fieldConfig.type, fieldConfig.fieldSettings);\n    }\n\n    if (!typeConfig) {\n      //console.warn(`No type config for ${fieldConfig.type}`);\n      fieldConfig.disabled = true;\n      return;\n    }\n    if (!isFuncArg) {\n      if (!config._fieldsCntByType[fieldConfig.type])\n        config._fieldsCntByType[fieldConfig.type] = 0;\n      config._fieldsCntByType[fieldConfig.type]++;\n    }\n\n    if (!fieldConfig.widgets)\n      fieldConfig.widgets = {};\n    if (isFuncArg)\n      fieldConfig._isFuncArg = true;\n    fieldConfig.mainWidget = fieldConfig.mainWidget || typeConfig.mainWidget;\n    fieldConfig.valueSources = fieldConfig.valueSources || typeConfig.valueSources;\n    const excludeOperatorsForType = typeConfig.excludeOperators || [];\n    for (let widget in typeConfig.widgets) {\n      let fieldWidgetConfig = fieldConfig.widgets[widget] || {};\n      const typeWidgetConfig = typeConfig.widgets[widget] || {};\n      if (!isFuncArg) {\n        //todo: why I've excluded isFuncArg ?\n        const excludeOperators = [...excludeOperatorsForField, ...excludeOperatorsForType];\n        const shouldIncludeOperators = fieldConfig.preferWidgets\n          && (widget == \"field\" || fieldConfig.preferWidgets.includes(widget))\n          || excludeOperators.length > 0;\n        if (fieldWidgetConfig.operators) {\n          const addOperators = fieldWidgetConfig.operators.filter(o => !excludeOperators.includes(o));\n          operators = [...(operators || []), ...addOperators];\n        } else if (shouldIncludeOperators && typeWidgetConfig.operators) {\n          const addOperators = typeWidgetConfig.operators.filter(o => !excludeOperators.includes(o));\n          operators = [...(operators || []), ...addOperators];\n        }\n        if (fieldWidgetConfig.defaultOperator)\n          defaultOperator = fieldWidgetConfig.defaultOperator;\n      }\n\n      if (widget == fieldConfig.mainWidget) {\n        fieldWidgetConfig = merge({}, {widgetProps: fieldConfig.mainWidgetProps || {}}, fieldWidgetConfig);\n      }\n      fieldConfig.widgets[widget] = fieldWidgetConfig;\n    }\n    if (!isFuncArg) {\n      if (!fieldConfig.operators && operators)\n        fieldConfig.operators = Array.from(new Set(operators));\n      if (!fieldConfig.defaultOperator && defaultOperator)\n        fieldConfig.defaultOperator = defaultOperator;\n    }\n  }\n\n  const computedFieldName = computeFieldName(config, path);\n  if (computedFieldName) {\n    fieldConfig.fieldName = computedFieldName;\n  }\n\n  if (path && fieldConfig.fieldName) {\n    config.__fieldNames[fieldConfig.fieldName] = path;\n  }\n}\n\nexport const getFieldRawConfig = (config, field, fieldsKey = \"fields\", subfieldsKey = \"subfields\") => {\n  if (!field)\n    return null;\n  if (field == \"!case_value\") {\n    return {\n      type: \"case_value\",\n      mainWidget: \"case_value\",\n      widgets: {\n        \"case_value\": config.widgets[\"case_value\"]\n      }\n    };\n  }\n  const fieldSeparator = config.settings.fieldSeparator;\n  //field = normalizeField(config, field);\n  const parts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  const targetFields = config[fieldsKey];\n  if (!targetFields)\n    return null;\n\n  let fields = targetFields;\n  let fieldConfig = null;\n  let path = [];\n  for (let i = 0 ; i < parts.length ; i++) {\n    const part = parts[i];\n    path.push(part);\n    const pathKey = path.join(fieldSeparator);\n    fieldConfig = fields[pathKey];\n    if (i < parts.length-1) {\n      if (fieldConfig && fieldConfig[subfieldsKey]) {\n        fields = fieldConfig[subfieldsKey];\n        path = [];\n      } else {\n        fieldConfig = null;\n      }\n    }\n  }\n\n  return fieldConfig;\n};\n\nconst computeFieldName = (config, path) => {\n  if (!path)\n    return null;\n  const fieldSeparator = config.settings.fieldSeparator;\n  let l = [...path], r = [], f, fConfig;\n  while ((f = l.pop()) !== undefined && l.length > 0) {\n    r.unshift(f);\n    fConfig = getFieldRawConfig(config, l);\n    if (fConfig.fieldName) {\n      return [fConfig.fieldName, ...r].join(fieldSeparator);\n    }\n  }\n  return null;\n};\n\nexport const normalizeField = (config, field) => {\n  const fieldSeparator = config.settings.fieldSeparator;\n  const fieldStr = Array.isArray(field) ? field.join(fieldSeparator) : field;\n  if (config.__fieldNames[fieldStr]) {\n    return config.__fieldNames[fieldStr].join(fieldSeparator);\n  }\n  return fieldStr;\n};\n\nexport const getFuncConfig = (config, func) => {\n  if (!func)\n    return null;\n  const funcConfig = getFieldRawConfig(config, func, \"funcs\", \"subfields\");\n  if (!funcConfig)\n    return null; //throw new Error(\"Can't find func \" + func + \", please check your config\");\n  return funcConfig;\n};\n\nexport const getFuncArgConfig = (config, funcKey, argKey) => {\n  const funcConfig = getFuncConfig(config, funcKey);\n  if (!funcConfig)\n    return null; //throw new Error(`Can't find func ${funcKey}, please check your config`);\n  const argConfig = funcConfig.args && funcConfig.args[argKey] || null;\n  if (!argConfig)\n    return null; //throw new Error(`Can't find arg ${argKey} for func ${funcKey}, please check your config`);\n\n  //merge, but don't merge operators (rewrite instead)\n  const typeConfig = config.types[argConfig.type] || {};\n  let ret = mergeWith({}, typeConfig, argConfig || {}, (objValue, srcValue, _key, _object, _source, _stack) => {\n    if (Array.isArray(objValue)) {\n      return srcValue;\n    }\n  });\n\n  return ret;\n};\n\nexport const getFieldConfig = (config, field) => {\n  if (!field)\n    return null;\n  if (typeof field == \"object\" && !field.func && !!field.type)\n    return field;\n  if (typeof field == \"object\" && field.func && field.arg)\n    return getFuncArgConfig(config, field.func, field.arg);\n  const fieldConfig = getFieldRawConfig(config, field);\n  if (!fieldConfig)\n    return null; //throw new Error(\"Can't find field \" + field + \", please check your config\");\n\n  //merge, but don't merge operators (rewrite instead)\n  const typeConfig = config.types[fieldConfig.type] || {};\n  let ret = mergeWith({}, typeConfig, fieldConfig || {}, (objValue, srcValue, _key, _object, _source, _stack) => {\n    if (Array.isArray(objValue)) {\n      return srcValue;\n    }\n  });\n\n  return ret;\n};\n\nexport const getOperatorConfig = (config, operator, field = null) => {\n  if (!operator)\n    return null;\n  const opConfig = config.operators[operator];\n  if (field) {\n    const fieldConfig = getFieldConfig(config, field);\n    const widget = getWidgetForFieldOp(config, field, operator);\n    const widgetConfig = config.widgets[widget] || {};\n    const fieldWidgetConfig = (fieldConfig && fieldConfig.widgets ? fieldConfig.widgets[widget] : {}) || {};\n    const widgetOpProps = (widgetConfig.opProps || {})[operator];\n    const fieldWidgetOpProps = (fieldWidgetConfig.opProps || {})[operator];\n    const mergedOpConfig = merge({}, opConfig, widgetOpProps, fieldWidgetOpProps);\n    return mergedOpConfig;\n  } else {\n    return opConfig;\n  }\n};\n\nexport const getFieldWidgetConfig = (config, field, operator, widget = null, valueSrc = null) => {\n  if (!field)\n    return null;\n  if (!(operator || widget) && valueSrc != \"const\" && field != \"!case_value\")\n    return null;\n  const fieldConfig = getFieldConfig(config, field);\n  if (!widget)\n    widget = getWidgetForFieldOp(config, field, operator, valueSrc);\n  const widgetConfig = config.widgets[widget] || {};\n  const fieldWidgetConfig = (fieldConfig && fieldConfig.widgets ? fieldConfig.widgets[widget] : {}) || {};\n  const fieldWidgetProps = (fieldWidgetConfig.widgetProps || {});\n  const valueFieldSettings = (valueSrc == \"value\" || !valueSrc) && fieldConfig && fieldConfig.fieldSettings || {}; // useful to take 'validateValue'\n  const mergedConfig = merge({}, widgetConfig, fieldWidgetProps, valueFieldSettings);\n  return mergedConfig;\n};\n","import Immutable from \"immutable\";\nimport uuid from \"./uuid\";\nimport {getFieldConfig, getOperatorConfig} from \"./configUtils\";\nimport {getNewValueForFieldOp, getFirstField, getFirstOperator} from \"../utils/ruleUtils\";\n\n\nexport const defaultField = (config, canGetFirst = true, parentRuleGroupPath = null) => {\n  return typeof config.settings.defaultField === \"function\"\n    ? config.settings.defaultField(parentRuleGroupPath) \n    : (config.settings.defaultField || (canGetFirst ? getFirstField(config, parentRuleGroupPath) : null));\n};\n\nexport const defaultOperator = (config, field, canGetFirst = true) => {\n  let fieldConfig = getFieldConfig(config, field);\n  let fieldOperators = fieldConfig && fieldConfig.operators || [];\n  let fieldDefaultOperator = fieldConfig && fieldConfig.defaultOperator;\n  if (!fieldOperators.includes(fieldDefaultOperator))\n    fieldDefaultOperator = null;\n  if (!fieldDefaultOperator && canGetFirst)\n    fieldDefaultOperator = getFirstOperator(config, field);\n  let op = typeof config.settings.defaultOperator === \"function\"\n    ? config.settings.defaultOperator(field, fieldConfig) : fieldDefaultOperator;\n  return op;\n};\n\n//used for complex operators like proximity\nexport const defaultOperatorOptions = (config, operator, field) => {\n  let operatorConfig = operator ? getOperatorConfig(config, operator, field) : null;\n  if (!operatorConfig)\n    return null; //new Immutable.Map();\n  return operatorConfig.options ? new Immutable.Map(\n    operatorConfig.options\n    && operatorConfig.options.defaults || {}\n  ) : null;\n};\n\nexport const defaultRuleProperties = (config, parentRuleGroupPath = null, item = null) => {\n  let field = null, operator = null;\n  const {setDefaultFieldAndOp, showErrorMessage} = config.settings;\n  if (item) {\n    field = item?.properties?.field;\n    operator = item?.properties?.operator;\n  } else if (setDefaultFieldAndOp) {\n    field = defaultField(config, true, parentRuleGroupPath);\n    operator = defaultOperator(config, field);\n  }\n  let current = new Immutable.Map({\n    field: field,\n    operator: operator,\n    value: new Immutable.List(),\n    valueSrc: new Immutable.List(),\n    //used for complex operators like proximity\n    operatorOptions: defaultOperatorOptions(config, operator, field),\n  });\n  if (showErrorMessage) {\n    current = current.set(\"valueError\", new Immutable.List());\n  }\n  \n  if (field && operator) {\n    let {newValue, newValueSrc, newValueType, newValueError} = getNewValueForFieldOp(\n      config, config, current, field, operator, \"operator\", false\n    );\n    current = current\n      .set(\"value\", newValue)\n      .set(\"valueSrc\", newValueSrc)\n      .set(\"valueType\", newValueType);\n    if (showErrorMessage) {\n      current = current\n        .set(\"valueError\", newValueError);\n    }\n  }\n  return current; \n};\n\n\nexport const defaultGroupConjunction = (config, fieldConfig = null) => {\n  fieldConfig = getFieldConfig(config, fieldConfig); // if `fieldConfig` is field name, not config\n  const conjs = fieldConfig && fieldConfig.conjunctions || Object.keys(config.conjunctions);\n  if (conjs.length == 1)\n    return conjs[0];\n  return config.settings.defaultGroupConjunction || config.settings.defaultConjunction || conjs[0];\n};\n\nexport const defaultConjunction = (config) =>\n  config.settings.defaultConjunction || Object.keys(config.conjunctions)[0];\n\nexport const defaultGroupProperties = (config, fieldConfig = null) => new Immutable.Map({\n  conjunction: defaultGroupConjunction(config, fieldConfig),\n  not: false\n});\n\nexport const defaultItemProperties = (config, item) => {\n  return item && item.type == \"group\" \n    ? defaultGroupProperties(config, item?.properties?.field) \n    : defaultRuleProperties(config, null, item);\n};\n\nexport const defaultRule = (id, config) => ({\n  [id]: new Immutable.Map({\n    type: \"rule\",\n    id: id,\n    properties: defaultRuleProperties(config)\n  })\n});\n\nexport const defaultRoot = (config) => {\n  return new Immutable.Map({\n    type: \"group\",\n    id: uuid(),\n    children1: new Immutable.OrderedMap({ ...defaultRule(uuid(), config) }),\n    properties: defaultGroupProperties(config)\n  });\n};\n","let SqlString = require(\"sqlstring\");\n\nSqlString.trim = (val) => {\n  if (val.charAt(0) == \"'\")\n    return val.substring(1, val.length-1);\n  else\n    return val;\n};\n\nSqlString.escapeLike = (val, any_start = true, any_end = true) => {\n  // normal escape\n  let res = SqlString.escape(val);\n  // unwrap ''\n  res = SqlString.trim(res);\n  // escape % and _\n  res = res.replace(/[%_]/g, \"\\\\$&\");\n  // wrap with % for LIKE\n  res = (any_start ? \"%\" : \"\") + res + (any_end ? \"%\" : \"\");\n  // wrap ''\n  res = \"'\" + res + \"'\";\n  return res;\n};\n\nconst sqlEmptyValue = (fieldDef) => {\n  let v = \"''\";\n  const type = fieldDef?.type;\n  if (type == \"date\") {\n    //todo: support other SQL dialects?  0001-01-01 for oracle, 1970-01-01 for timestamp\n    v = \"'0000-00-00'\";\n  } else if (type == \"datetime\") {\n    v = \"'0000-00-00 00:00'\";\n  } else if (type == \"time\") {\n    v = \"'00:00'\";\n  } else if (type == \"number\") {\n    v = \"0\";\n  }\n  return v;\n};\n\nconst mongoEmptyValue = (fieldDef) => {\n  let v = \"\";\n  const type = fieldDef?.type;\n  if (type == \"number\") {\n    v = 0;\n  }\n  return v;\n};\n\n\nconst spelEscapeString = (val) => {\n  // Strings are delimited by single quotes. To put a single quote itself in a string, use two single quote characters. \n  return \"'\" + val.replace(/'/g, \"''\") + \"'\";\n};\n\nconst spelInlineList = (vals, toArray = false) => {\n  // find java type of values\n  let javaType;\n  let jt;\n  const numberJavaTypes = [\"int\", \"float\"];\n  vals.map(v => {\n    if (v !== undefined && v !== null) {\n      if (typeof v === \"string\") {\n        jt = \"String\";\n      } else if (typeof v === \"number\") {\n        jt = Number.isInteger(v) ? \"int\" : \"float\";\n      } else throw new Error(`spelEscape: Can't use value ${v} in array`);\n\n      if (!javaType) {\n        javaType = jt;\n      } else if (javaType != jt) {\n        if (numberJavaTypes.includes(javaType) && numberJavaTypes.includes(jt)) {\n          // found int and float in collecton - use float\n          javaType = \"float\";\n        } else throw new Error(`spelEscape: Can't use different types in array: found ${javaType} and ${jt}`);\n      }\n    }\n  });\n  if (!javaType) {\n    javaType = \"String\"; //default if empty array\n  }\n\n  // for floats we should add 'f' to all items\n  let escapedVals;\n  if (javaType == \"float\") {\n    escapedVals = vals.map(v => spelEscape(v, true));\n  } else {\n    escapedVals = vals.map(v => spelEscape(v));\n  }\n\n  // build inline list or array\n  let res;\n  if (toArray) {\n    res = `new ${javaType}[]{${escapedVals.join(\", \")}}`;\n  } else {\n    res = `{${escapedVals.join(\", \")}}`;\n  }\n  \n  return res;\n};\n\nconst spelFixList = (val) => {\n  // `{1,2}.contains(1)` NOT works\n  // `{1,2}.?[true].contains(1)` works\n  return `${val}.?[true]`;\n};\n\nconst spelEscape = (val, numberToFloat = false, arrayToArray = false) => {\n  // https://docs.spring.io/spring-framework/docs/3.2.x/spring-framework-reference/html/expressions.html#expressions-ref-literal\n  if (val === undefined || val === null) {\n    return \"null\";\n  }\n  switch (typeof val) {\n  case \"boolean\":\n    return (val) ? \"true\" : \"false\";\n  case \"number\":\n    if (!Number.isFinite(val) || isNaN(val))\n      return undefined;\n    return val + (!Number.isInteger(val) || numberToFloat ? \"f\" : \"\");\n  case \"object\":\n    if (Array.isArray(val)) {\n      return spelInlineList(val, arrayToArray);\n    } else {\n      // see `spelFormatValue` for Date, LocalTime\n      throw new Error(\"spelEscape: Object is not supported\");\n    }\n  default: return spelEscapeString(val);\n  }\n};\n\nconst spelFormatConcat = (parts) => {\n  if (parts && Array.isArray(parts) && parts.length) {\n    return parts\n      .map(part => {\n        if (part.type == \"const\") {\n          return spelEscape(part.value);\n        } else if (part.type == \"property\") {\n          return \"\"+part.value;\n        } else if (part.type == \"variable\") {\n          return \"#\"+part.value;\n        } return undefined;\n      })\n      .filter(r => r != undefined)\n      .join(\" + \");\n  } else {\n    return \"null\";\n  }\n};\n\n// `val` is {value, valueType, valueSrc}\n// If `valueType` == \"case_value\", `value` is array of such items (to be considered as concatenation)\nconst spelImportConcat = (val) => {\n  if (val == undefined)\n    return [undefined, []];\n  let errors = [];\n  const parts = val.valueType == \"case_value\" ? val.value : [val];\n  const res = parts.map(child => {\n    if (child.valueSrc == \"value\") {\n      if (child.value === null) {\n        return undefined;\n      } else {\n        return {\n          type: \"const\", \n          value: child.value\n        };\n      }\n    } else if (child.valueSrc == \"field\") {\n      return {\n        type: (child.isVariable ? \"variable\" : \"property\"), \n        value: child.value\n      };\n    } else {\n      errors.push(`Unsupported valueSrc ${child.valueSrc} in concatenation`);\n    }\n  }).filter(v => v != undefined);\n  return [res, errors];\n};\n\nexport {\n  SqlString, sqlEmptyValue, \n  mongoEmptyValue, spelEscape, spelFixList, spelFormatConcat, spelImportConcat\n};\n","\nimport {getFieldConfig, getFuncConfig} from \"../utils/configUtils\";\nimport {filterValueSourcesForField} from \"../utils/ruleUtils\";\nimport Immutable from \"immutable\";\n\n// helpers\nconst isObject = (v) => (typeof v == \"object\" && v !== null && !Array.isArray(v));\n\n/**\n * @param {*} value\n * @param {string} valueSrc - 'value' | 'field' | 'func'\n * @param {object} config\n * @return {* | undefined} - undefined if func value is not complete (missing required arg vals); can return completed value != value\n */\nexport const completeValue = (value, valueSrc, config) => {\n  if (valueSrc == \"func\")\n    return completeFuncValue(value, config);\n  else\n    return value;\n};\n\n/**\n * @param {Immutable.Map} value\n * @param {object} config\n * @return {Immutable.Map | undefined} - undefined if func value is not complete (missing required arg vals); can return completed value != value\n */\nexport const completeFuncValue = (value, config) => {\n  const _checkFuncValue = (value) => {\n    if (!value)\n      return undefined;\n    const funcKey = value.get(\"func\");\n    const funcConfig = funcKey && getFuncConfig(config, funcKey);\n    if (!funcConfig)\n      return undefined;\n    let complValue = value;\n    let tmpHasOptional = false;\n    for (const argKey in funcConfig.args) {\n      const argConfig = funcConfig.args[argKey];\n      const {valueSources, isOptional, defaultValue} = argConfig;\n      const filteredValueSources = filterValueSourcesForField(config, valueSources, argConfig);\n      const args = complValue.get(\"args\");\n      const argDefaultValueSrc = filteredValueSources.length == 1 ? filteredValueSources[0] : undefined;\n      const argVal = args ? args.get(argKey) : undefined;\n      const argValue = argVal ? argVal.get(\"value\") : undefined;\n      const argValueSrc = (argVal ? argVal.get(\"valueSrc\") : undefined) || argDefaultValueSrc;\n      if (argValue !== undefined) {\n        const completeArgValue = completeValue(argValue, argValueSrc, config);\n        if (completeArgValue === undefined) {\n          return undefined;\n        } else if (completeArgValue !== argValue) {\n          complValue = complValue.setIn([\"args\", argKey, \"value\"], completeArgValue);\n        }\n        if (tmpHasOptional) {\n          // has gap\n          return undefined;\n        }\n      } else if (defaultValue !== undefined && !isObject(defaultValue)) {\n        complValue = complValue.setIn([\"args\", argKey, \"value\"], getDefaultArgValue(argConfig));\n        complValue = complValue.setIn([\"args\", argKey, \"valueSrc\"], \"value\");\n      } else if (isOptional) {\n        // optional\n        tmpHasOptional = true;\n      } else {\n        // missing value\n        return undefined;\n      }\n    }\n    return complValue;\n  };\n\n  return _checkFuncValue(value);\n};\n\n\n/**\n * @param {Immutable.Map} value \n * @return {array} - [usedFields, badFields]\n */\nconst getUsedFieldsInFuncValue = (value, config) => {\n  let usedFields = [];\n  let badFields = [];\n\n  const _traverse = (value) => {\n    const args = value && value.get(\"args\");\n    if (!args) return;\n    for (const arg of args.values()) {\n      if (arg.get(\"valueSrc\") == \"field\") {\n        const rightField = arg.get(\"value\");\n        if (rightField) {\n          const rightFieldDefinition = config ? getFieldConfig(config, rightField) : undefined;\n          if (config && !rightFieldDefinition)\n            badFields.push(rightField);\n          else\n            usedFields.push(rightField);\n        }\n      } else if (arg.get(\"valueSrc\") == \"func\") {\n        _traverse(arg.get(\"value\"));\n      }\n    }\n  };\n\n  _traverse(value);\n\n  return [usedFields, badFields];\n};\n\n\n/**\n * Used @ FuncWidget\n * @param {Immutable.Map} value \n * @param {string} funcKey \n * @param {object} config \n */\nexport const setFunc = (value, funcKey, config) => {\n  const fieldSeparator = config.settings.fieldSeparator;\n  value = value || new Immutable.Map();\n  if (Array.isArray(funcKey)) {\n    // fix for cascader\n    funcKey = funcKey.join(fieldSeparator);\n  }\n  value = value.set(\"func\", funcKey);\n  value = value.set(\"args\", new Immutable.Map());\n\n  // defaults\n  const funcConfig = funcKey && getFuncConfig(config, funcKey);\n  if (funcConfig) {\n    for (const argKey in funcConfig.args) {\n      const argConfig = funcConfig.args[argKey];\n      const {valueSources, defaultValue} = argConfig;\n      const filteredValueSources = filterValueSourcesForField(config, valueSources, argConfig);\n      const firstValueSrc = filteredValueSources.length ? filteredValueSources[0] : undefined;\n      const defaultValueSrc = defaultValue ? (isObject(defaultValue) && !!defaultValue.func ? \"func\" : \"value\") : undefined;\n      const argDefaultValueSrc = defaultValueSrc || firstValueSrc;\n      if (defaultValue !== undefined) {\n        value = value.setIn([\"args\", argKey, \"value\"], getDefaultArgValue(argConfig));\n      }\n      if (argDefaultValueSrc) {\n        value = value.setIn([\"args\", argKey, \"valueSrc\"], argDefaultValueSrc);\n      }\n    }\n  }\n\n  return value;\n};\n\nconst getDefaultArgValue = ({defaultValue: value}) => {\n  if (isObject(value) && !Immutable.Map.isMap(value) && value.func) {\n    return Immutable.fromJS(value, function (k, v) {\n      return Immutable.Iterable.isIndexed(v) ? v.toList() : v.toOrderedMap();\n    });\n  }\n  return value;\n};\n\n/**\n* Used @ FuncWidget\n* @param {Immutable.Map} value \n* @param {string} argKey \n* @param {*} argVal \n* @param {object} argConfig \n*/\nexport const setArgValue = (value, argKey, argVal, argConfig, config) => {\n  if (value && value.get(\"func\")) {\n    value = value.setIn([\"args\", argKey, \"value\"], argVal);\n\n    // set default arg value sorce\n    const {valueSources} = argConfig;\n    const filteredValueSources = filterValueSourcesForField(config, valueSources, argConfig);\n    const argDefaultValueSrc = filteredValueSources.length == 1 ? filteredValueSources[0] : undefined;\n    if (argDefaultValueSrc) {\n      value = value.setIn([\"args\", argKey, \"valueSrc\"], argDefaultValueSrc);\n    }\n  }\n  return value;\n};\n\n/**\n* Used @ FuncWidget\n* @param {Immutable.Map} value \n* @param {string} argKey \n* @param {string} argValSrc \n* @param {object} argConfig \n*/\nexport const setArgValueSrc = (value, argKey, argValSrc, _argConfig, _config) => {\n  if (value && value.get(\"func\")) {\n    value = value.setIn([\"args\", argKey], new Immutable.Map({valueSrc: argValSrc}));\n  }\n  return value;\n};\n","import React from \"react\";\nimport mapValues from \"lodash/mapValues\";\nimport {shallowEqual} from \"./stuff\";\n\nconst getReactContainerType = (el) => {\n  if (el._reactRootContainer) {\n    return \"root\";\n  }\n  if (Object.getOwnPropertyNames(el).filter(k => k.startsWith(\"__reactContainer\")).length > 0) {\n    return \"container\";\n  }\n  return undefined;\n};\n\nconst getReactRootNodeType = (node) => {\n  if (!node) {\n    return undefined;\n  }\n  const type = getReactContainerType(node);\n  if (type !== undefined) {\n    return type;\n  } else {\n    return getReactRootNodeType(node.parentNode);\n  }\n};\n\nexport const isUsingLegacyReactDomRender = (node) => {\n  return getReactRootNodeType(node) === \"root\";\n};\n\n\nexport const liteShouldComponentUpdate = (self, config) => (nextProps, nextState) => {\n  const prevProps = self.props;\n  const prevState = self.state;\n\n  let should = nextProps != prevProps || nextState != prevState;\n  if (should) {\n    if (prevState == nextState && prevProps != nextProps) {\n      let chs = [];\n      for (let k in nextProps) {\n        let changed = (nextProps[k] != prevProps[k]);\n        if (changed) {\n          if (config[k] == \"ignore\")\n            changed = false;\n          else if (config[k] == \"shallow_deep\")\n            changed = !shallowEqual(nextProps[k], prevProps[k], true);\n          else if (config[k] == \"shallow\")\n            changed = !shallowEqual(nextProps[k], prevProps[k]);\n          else if (typeof config[k] == \"function\")\n            changed = config[k](nextProps[k], prevProps[k], nextState);\n        }\n        if (changed)\n          chs.push(k);\n      }\n      if (!chs.length)\n        should = false;\n    }\n  }\n  return should;\n};\n\nexport const pureShouldComponentUpdate = (self) => function(nextProps, nextState) {\n  return (\n    !shallowEqual(self.props, nextProps)\n    || !shallowEqual(self.state, nextState)\n  );\n};\n\nconst canUseUnsafe = () => {\n  const v = React.version.split(\".\").map(parseInt.bind(null, 10));\n  return v[0] == 16 && v[1] >= 3 || v[0] > 16;\n};\n\nexport const useOnPropsChanged = (obj) => {\n  if (canUseUnsafe) {\n    obj.UNSAFE_componentWillReceiveProps = (nextProps) => {\n      obj.onPropsChanged(nextProps);\n    };\n  } else {\n    obj.componentWillReceiveProps = (nextProps) => {\n      obj.onPropsChanged(nextProps);\n    };\n  }\n};\n\nexport const bindActionCreators = (actionCreators, config, dispatch) =>\n  mapValues(actionCreators, (actionCreator) =>\n    (...args) => dispatch(actionCreator(config, ...args))\n  );\n","import {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFieldRawConfig\n} from \"./configUtils\";\nimport {defaultValue, getFirstDefined} from \"../utils/stuff\";\nimport Immutable from \"immutable\";\nimport {validateValue} from \"../utils/validation\";\nimport last from \"lodash/last\";\n\nconst selectTypes = [\n  \"select\",\n  \"multiselect\",\n  \"treeselect\",\n  \"treemultiselect\",\n];\n\n/**\n * @param {object} config\n * @param {object} oldConfig\n * @param {Immutable.Map} current\n * @param {string} newField\n * @param {string} newOperator\n * @param {string} changedProp\n * @return {object} - {canReuseValue, newValue, newValueSrc, newValueType, newValueError}\n */\nexport const getNewValueForFieldOp = function (config, oldConfig = null, current, newField, newOperator, changedProp = null, canFix = true, isEndValue = false) {\n  if (!oldConfig)\n    oldConfig = config;\n  const currentField = current.get(\"field\");\n  const currentOperator = current.get(\"operator\");\n  const currentValue = current.get(\"value\");\n  const currentValueSrc = current.get(\"valueSrc\", new Immutable.List());\n  const currentValueType = current.get(\"valueType\", new Immutable.List());\n  const currentAsyncListValues = current.get(\"asyncListValues\");\n\n  //const isValidatingTree = (changedProp === null);\n  const {convertableWidgets, clearValueOnChangeField, clearValueOnChangeOp, showErrorMessage} = config.settings;\n\n  //const currentOperatorConfig = getOperatorConfig(oldConfig, currentOperator, currentField);\n  const newOperatorConfig = getOperatorConfig(config, newOperator, newField);\n  //const currentOperatorCardinality = currentOperator ? defaultValue(currentOperatorConfig.cardinality, 1) : null;\n  const operatorCardinality = newOperator ? defaultValue(newOperatorConfig.cardinality, 1) : null;\n  const currentFieldConfig = getFieldConfig(oldConfig, currentField);\n  const newFieldConfig = getFieldConfig(config, newField);\n\n  let canReuseValue = currentField && currentOperator && newOperator && currentValue != undefined\n    && (!changedProp \n      || changedProp == \"field\" && !clearValueOnChangeField \n      || changedProp == \"operator\" && !clearValueOnChangeOp)\n    && (currentFieldConfig && newFieldConfig && currentFieldConfig.type == newFieldConfig.type);\n  if (canReuseValue && selectTypes.includes(currentFieldConfig.type) && changedProp == \"field\") {\n    // different fields of select types has different listValues\n    canReuseValue = false;\n  }\n\n  // compare old & new widgets\n  for (let i = 0 ; i < operatorCardinality ; i++) {\n    const vs = currentValueSrc.get(i) || null;\n    const currentWidget = getWidgetForFieldOp(oldConfig, currentField, currentOperator, vs);\n    const newWidget = getWidgetForFieldOp(config, newField, newOperator, vs);\n    // need to also check value widgets if we changed operator and current value source was 'field'\n    // cause for select type op '=' requires single value and op 'in' requires array value\n    const currentValueWidget = vs == \"value\" ? currentWidget : getWidgetForFieldOp(oldConfig, currentField, currentOperator, \"value\");\n    const newValueWidget = vs == \"value\" ? newWidget : getWidgetForFieldOp(config, newField, newOperator, \"value\");\n\n    const canReuseWidget = newValueWidget == currentValueWidget || (convertableWidgets[currentValueWidget] || []).includes(newValueWidget);\n    if (!canReuseWidget)\n      canReuseValue = false;\n  }\n\n  if (currentOperator != newOperator && [currentOperator, newOperator].includes(\"proximity\"))\n    canReuseValue = false;\n\n  const firstWidgetConfig = getFieldWidgetConfig(config, newField, newOperator, null, currentValueSrc.first());\n  const valueSources = getValueSourcesForFieldOp(config, newField, newOperator);\n  \n  let valueFixes = {};\n  let valueErrors = Array.from({length: operatorCardinality}, () => null);\n  if (canReuseValue) {\n    for (let i = 0 ; i < operatorCardinality ; i++) {\n      const v = currentValue.get(i);\n      const vType = currentValueType.get(i) || null;\n      const vSrc = currentValueSrc.get(i) || null;\n      let isValidSrc = (valueSources.find(v => v == vSrc) != null);\n      if (!isValidSrc && i > 0 && vSrc == null)\n        isValidSrc = true; // make exception for range widgets (when changing op from '==' to 'between')\n      const asyncListValues = currentAsyncListValues;\n      const [validateError, fixedValue] = validateValue(\n        config, newField, newField, newOperator, v, vType, vSrc, asyncListValues, canFix, isEndValue\n      );\n      const isValid = !validateError;\n      // Allow bad value with error message\n      // But not on field change - in that case just drop bad value that can't be reused\n      // ? Maybe we should also drop bad value on op change?\n      // For bad multiselect value we have both error message + fixed value.\n      //  If we show error message, it will gone on next tree validation\n      const fixValue = fixedValue !== v;\n      const dropValue = !isValidSrc || !isValid && (changedProp == \"field\" || !showErrorMessage && !fixValue);\n      const showValueError = !!validateError && showErrorMessage && !dropValue && !fixValue;\n      if (showValueError) {\n        valueErrors[i] = validateError;\n      }\n      if (fixValue) {\n        valueFixes[i] = fixedValue;\n      }\n      if (dropValue) {\n        canReuseValue = false;\n        break;\n      }\n    }\n  }\n\n  // reuse value OR get defaultValue for cardinality 1 (it means default range values is not supported yet, todo)\n  let newValue = null, newValueSrc = null, newValueType = null, newValueError = null;\n  newValue = new Immutable.List(Array.from({length: operatorCardinality}, (_ignore, i) => {\n    let v = undefined;\n    if (canReuseValue) {\n      if (i < currentValue.size) {\n        v = currentValue.get(i);\n        if (valueFixes[i] !== undefined) {\n          v = valueFixes[i];\n        }\n      }\n    } else if (operatorCardinality == 1) {\n      v = getFirstDefined([\n        newFieldConfig?.defaultValue,\n        newFieldConfig?.fieldSettings?.defaultValue,\n        firstWidgetConfig?.defaultValue\n      ]);\n    }\n    return v;\n  }));\n\n  newValueSrc = new Immutable.List(Array.from({length: operatorCardinality}, (_ignore, i) => {\n    let vs = null;\n    if (canReuseValue) {\n      if (i < currentValueSrc.size)\n        vs = currentValueSrc.get(i);\n    } else if (valueSources.length == 1) {\n      vs = valueSources[0];\n    } else if (valueSources.length > 1) {\n      vs = valueSources[0];\n    }\n    return vs;\n  }));\n\n  if (showErrorMessage) {\n    if (newOperatorConfig && newOperatorConfig.validateValues && newValueSrc.toJS().filter(vs => vs == \"value\" || vs == null).length == operatorCardinality) {\n      // last element in `valueError` list is for range validation error\n      const jsValues = firstWidgetConfig && firstWidgetConfig.toJS \n        ? newValue.toJS().map(v => firstWidgetConfig.toJS(v, firstWidgetConfig)) \n        : newValue.toJS();\n      const rangeValidateError = newOperatorConfig.validateValues(jsValues);\n      if (showErrorMessage) {\n        valueErrors.push(rangeValidateError);\n      }\n    }\n    newValueError = new Immutable.List(valueErrors);\n  }\n\n  newValueType = new Immutable.List(Array.from({length: operatorCardinality}, (_ignore, i) => {\n    let vt = null;\n    if (canReuseValue) {\n      if (i < currentValueType.size)\n        vt = currentValueType.get(i);\n    } else if (operatorCardinality == 1 && firstWidgetConfig && firstWidgetConfig.type !== undefined) {\n      vt = firstWidgetConfig.type;\n    } else if (operatorCardinality == 1 && newFieldConfig && newFieldConfig.type !== undefined) {\n      vt = newFieldConfig.type == \"!group\" ? \"number\" : newFieldConfig.type;\n    }\n    return vt;\n  }));\n\n  return {canReuseValue, newValue, newValueSrc, newValueType, newValueError, operatorCardinality};\n};\n\nexport const getFirstField = (config, parentRuleGroupPath = null) => {\n  const fieldSeparator = config.settings.fieldSeparator;\n  const parentPathArr = typeof parentRuleGroupPath == \"string\" ? parentRuleGroupPath.split(fieldSeparator) : parentRuleGroupPath;\n  const parentField = parentRuleGroupPath ? getFieldRawConfig(config, parentRuleGroupPath) : config;\n\n  let firstField = parentField, key = null, keysPath = [];\n  do {\n    const subfields = firstField === config ? config.fields : firstField.subfields;\n    if (!subfields || !Object.keys(subfields).length) {\n      firstField = key = null;\n      break;\n    }\n    key = Object.keys(subfields)[0];\n    keysPath.push(key);\n    firstField = subfields[key];\n  } while (firstField.type == \"!struct\" || firstField.type == \"!group\");\n  return (parentPathArr || []).concat(keysPath).join(fieldSeparator);\n};\n\nexport const getOperatorsForField = (config, field) => {\n  const fieldConfig = getFieldConfig(config, field);\n  const fieldOps = fieldConfig ? fieldConfig.operators : [];\n  return fieldOps;\n};\n\nexport const getFirstOperator = (config, field) => {\n  const fieldOps = getOperatorsForField(config, field);\n  return fieldOps ? fieldOps[0] : null;\n};\n\nexport const getFieldPath = (field, config, onlyKeys = false) => {\n  if (!field)\n    return null;\n  const fieldSeparator = config.settings.fieldSeparator;\n  const parts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  if (onlyKeys)\n    return parts;\n  else\n    return parts\n      .map((_curr, ind, arr) => arr.slice(0, ind+1))\n      .map((parts) => parts.join(fieldSeparator));\n};\n\nexport const getFuncPathLabels = (field, config, parentField = null) => {\n  return getFieldPathLabels(field, config, parentField, \"funcs\", \"subfields\");\n};\n\nexport const getFieldPathLabels = (field, config, parentField = null, fieldsKey = \"fields\", subfieldsKey = \"subfields\") => {\n  if (!field)\n    return null;\n  const fieldSeparator = config.settings.fieldSeparator;\n  const parts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  const parentParts = parentField ? (Array.isArray(parentField) ? parentField : parentField.split(fieldSeparator)) : [];\n  return parts\n    .slice(parentParts.length)\n    .map((_curr, ind, arr) => arr.slice(0, ind+1))\n    .map((parts) => [...parentParts, ...parts].join(fieldSeparator))\n    .map(part => {\n      const cnf = getFieldRawConfig(config, part, fieldsKey, subfieldsKey);\n      return cnf && cnf.label || cnf && last(part.split(fieldSeparator));\n    })\n    .filter(label => label != null);\n};\n\nexport const getFieldPartsConfigs = (field, config, parentField = null) => {\n  if (!field)\n    return null;\n  const parentFieldDef = parentField && getFieldRawConfig(config, parentField) || null;\n  const fieldSeparator = config.settings.fieldSeparator;\n  const parts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  const parentParts = parentField ? (Array.isArray(parentField) ? parentField : parentField.split(fieldSeparator)) : [];\n  return parts\n    .slice(parentParts.length)\n    .map((_curr, ind, arr) => arr.slice(0, ind+1))\n    .map((parts) => ({\n      part: [...parentParts, ...parts].join(fieldSeparator),\n      key: parts[parts.length - 1]\n    }))\n    .map(({part, key}) => {\n      const cnf = getFieldRawConfig(config, part);\n      return {key, cnf};\n    })\n    .map(({key, cnf}, ind, arr) => {\n      const parentCnf = ind > 0 ? arr[ind - 1].cnf : parentFieldDef;\n      return [key, cnf, parentCnf];\n    });\n};\n\nexport const getValueLabel = (config, field, operator, delta, valueSrc = null, isSpecialRange = false) => {\n  const isFuncArg = field && typeof field == \"object\" && !!field.func && !!field.arg;\n  const {showLabels} = config.settings;\n  const fieldConfig = getFieldConfig(config, field);\n  const fieldWidgetConfig = getFieldWidgetConfig(config, field, operator, null, valueSrc) || {};\n  const mergedOpConfig = getOperatorConfig(config, operator, field) || {};\n    \n  const cardinality = isSpecialRange ? 1 : mergedOpConfig.cardinality;\n  let ret = null;\n  if (cardinality > 1) {\n    const valueLabels = fieldWidgetConfig.valueLabels || mergedOpConfig.valueLabels;\n    if (valueLabels)\n      ret = valueLabels[delta];\n    if (ret && typeof ret != \"object\") {\n      ret = {label: ret, placeholder: ret};\n    }\n    if (!ret) {\n      ret = {\n        label: config.settings.valueLabel + \" \" + (delta+1),\n        placeholder: config.settings.valuePlaceholder + \" \" + (delta+1),\n      };\n    }\n  } else {\n    let label = fieldWidgetConfig.valueLabel;\n    let placeholder = fieldWidgetConfig.valuePlaceholder;\n    if (isFuncArg) {\n      if (!label)\n        label = fieldConfig.label || field.arg;\n      if (!placeholder && !showLabels)\n        placeholder = fieldConfig.label || field.arg;\n    }\n\n    ret = {\n      label: label || config.settings.valueLabel, \n      placeholder: placeholder || config.settings.valuePlaceholder,\n    };\n  }\n  return ret;\n};\n\nfunction _getWidgetsAndSrcsForFieldOp (config, field, operator = null, valueSrc = null) {\n  let widgets = [];\n  let valueSrcs = [];\n  if (!field)\n    return {widgets, valueSrcs};\n  const isFuncArg = typeof field == \"object\" && (!!field.func && !!field.arg || field._isFuncArg);\n  const fieldConfig = getFieldConfig(config, field);\n  const opConfig = operator ? config.operators[operator] : null;\n  \n  if (fieldConfig && fieldConfig.widgets) {\n    for (const widget in fieldConfig.widgets) {\n      const widgetConfig = fieldConfig.widgets[widget];\n      // if (!config.widgets[widget]) {\n      //   continue;\n      // }\n      const widgetValueSrc = config.widgets[widget].valueSrc || \"value\";\n      let canAdd = true;\n      if (widget == \"field\") {\n        canAdd = canAdd && filterValueSourcesForField(config, [\"field\"], fieldConfig).length > 0;\n      }\n      if (widget == \"func\") {\n        canAdd = canAdd && filterValueSourcesForField(config, [\"func\"], fieldConfig).length > 0;\n      }\n      // If can't check operators, don't add\n      // Func args don't have operators\n      if (valueSrc == \"value\" && !widgetConfig.operators && !isFuncArg && field != \"!case_value\")\n        canAdd = false;\n      if (widgetConfig.operators && operator)\n        canAdd = canAdd && widgetConfig.operators.indexOf(operator) != -1;\n      if (valueSrc && valueSrc != widgetValueSrc && valueSrc != \"const\")\n        canAdd = false;\n      if (opConfig && opConfig.cardinality == 0 && (widgetValueSrc != \"value\"))\n        canAdd = false;\n      if (canAdd) {\n        widgets.push(widget);\n        let canAddValueSrc = fieldConfig.valueSources && fieldConfig.valueSources.indexOf(widgetValueSrc) != -1;\n        if (opConfig && opConfig.valueSources && opConfig.valueSources.indexOf(widgetValueSrc) == -1)\n          canAddValueSrc = false;\n        if (canAddValueSrc && !valueSrcs.find(v => v == widgetValueSrc))\n          valueSrcs.push(widgetValueSrc);\n      }\n    }\n  }\n\n  const widgetWeight = (w) => {\n    let wg = 0;\n    if (fieldConfig.preferWidgets) {\n      if (fieldConfig.preferWidgets.includes(w))\n        wg += (10 - fieldConfig.preferWidgets.indexOf(w));\n    } else if (w == fieldConfig.mainWidget) {\n      wg += 100;\n    }\n    if (w == \"field\") {\n      wg -= 1;\n    }\n    if (w == \"func\") {\n      wg -= 2;\n    }\n    return wg;\n  };\n\n  widgets.sort((w1, w2) => (widgetWeight(w2) - widgetWeight(w1)));\n    \n  return {widgets, valueSrcs};\n}\n\nexport const getWidgetsForFieldOp = (config, field, operator, valueSrc = null) => {\n  const {widgets} = _getWidgetsAndSrcsForFieldOp(config, field, operator, valueSrc);\n  return widgets;\n};\n\nexport const filterValueSourcesForField = (config, valueSrcs, fieldDefinition) => {\n  if (!fieldDefinition)\n    return valueSrcs;\n  return valueSrcs.filter(vs => {\n    let canAdd = true;\n    if (vs == \"field\") {\n      if (config._fieldsCntByType) {\n        // tip: LHS field can be used as arg in RHS function\n        const minCnt = fieldDefinition._isFuncArg ? 0 : 1;\n        canAdd = canAdd && config._fieldsCntByType[fieldDefinition.type] > minCnt;\n      }\n    }\n    if (vs == \"func\") {\n      if (config._funcsCntByType)\n        canAdd = canAdd && !!config._funcsCntByType[fieldDefinition.type];\n      if (fieldDefinition.funcs)\n        canAdd = canAdd && fieldDefinition.funcs.length > 0;\n    }\n    return canAdd;\n  });\n};\n\nexport const getValueSourcesForFieldOp = (config, field, operator, fieldDefinition = null, leftFieldForFunc = null) => {\n  const {valueSrcs} = _getWidgetsAndSrcsForFieldOp(config, field, operator, null);\n  const filteredValueSrcs = filterValueSourcesForField(config, valueSrcs, fieldDefinition);\n  return filteredValueSrcs;\n};\n\nexport const getWidgetForFieldOp = (config, field, operator, valueSrc = null) => {\n  const {widgets} = _getWidgetsAndSrcsForFieldOp(config, field, operator, valueSrc);\n  let widget = null;\n  if (widgets.length)\n    widget = widgets[0];\n  return widget;\n};\n\nexport const formatFieldName = (field, config, meta, parentField = null) => {\n  if (!field) return;\n  const fieldDef = getFieldConfig(config, field) || {};\n  const {fieldSeparator} = config.settings;\n  const fieldParts = Array.isArray(field) ? field : field.split(fieldSeparator);\n  let fieldName = Array.isArray(field) ? field.join(fieldSeparator) : field;\n  if (fieldDef.tableName) { // legacy\n    const fieldPartsCopy = [...fieldParts];\n    fieldPartsCopy[0] = fieldDef.tableName;\n    fieldName = fieldPartsCopy.join(fieldSeparator);\n  }\n  if (fieldDef.fieldName) {\n    fieldName = fieldDef.fieldName;\n  }\n  if (parentField) {\n    const parentFieldDef = getFieldConfig(config, parentField) || {};\n    let parentFieldName = parentField;\n    if (parentFieldDef.fieldName) {\n      parentFieldName = parentFieldDef.fieldName;\n    }\n    if (fieldName.indexOf(parentFieldName + fieldSeparator) == 0) {\n      fieldName = fieldName.slice((parentFieldName + fieldSeparator).length);\n    } else {\n      meta.errors.push(`Can't cut group ${parentFieldName} from field ${fieldName}`);\n    }\n  }\n  return fieldName;\n};\n\n","import Immutable, { Map } from \"immutable\";\n\n// RegExp.quote = function (str) {\n//     return str.replace(/([.?*+^$[\\]\\\\(){}|-])/g, \"\\\\$1\");\n// };\n\nexport const defaultValue = (value, _default) => {\n  return (typeof value === \"undefined\") ? _default : value;\n};\n\nexport const truncateString = (str, n, useWordBoundary) => {\n  if (!n || str.length <= n) { return str; }\n  var subString = str.substr(0, n-1);\n  return (useWordBoundary \n    ? subString.substr(0, subString.lastIndexOf(\" \")) \n    : subString) + \"...\";\n};\n\nexport const immutableEqual = function(v1, v2) {\n  if (v1 === v2) {\n    return true;\n  } else {\n    return v1.equals(v2);\n  }\n};\n\nexport const deepEqual = function(v1, v2) {\n  if (v1 === v2) {\n    return true;\n  } else if (Map.isMap(v1)) {\n    return v1.equals(v2);\n  } else {\n    return JSON.stringify(v1) == JSON.stringify(v2);\n  }\n};\n\n//Do sets have same values?\nexport const eqSet = function (as, bs) {\n  if (as.size !== bs.size) return false;\n  for (var a of as) if (!bs.has(a)) return false;\n  return true;\n};\n\n\n//Do arrays have same values?\nexport const eqArrSet = function (arr1, arr2) {\n  return eqSet(new Set(arr1), new Set(arr2));\n};\n\nexport const shallowEqual = (a, b, deep = false) => {\n  if (a === b) {\n    return true;\n  } else if (Array.isArray(a))\n    return shallowEqualArrays(a, b, deep);\n  else if (Map.isMap(a))\n    return a.equals(b);\n  else if (typeof a == \"object\")\n    return shallowEqualObjects(a, b, deep);\n  else\n    return a === b;\n};\n\nfunction shallowEqualArrays(arrA, arrB, deep = false) {\n  if (arrA === arrB) {\n    return true;\n  }\n\n  if (!arrA || !arrB) {\n    return false;\n  }\n\n  var len = arrA.length;\n\n  if (arrB.length !== len) {\n    return false;\n  }\n\n  for (var i = 0; i < len; i++) {\n    var isEqual = deep ? shallowEqual(arrA[i], arrB[i], deep) : arrA[i] === arrB[i];\n    if (!isEqual) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction shallowEqualObjects(objA, objB, deep = false) {\n  if (objA === objB) {\n    return true;\n  }\n\n  if (!objA || !objB) {\n    return false;\n  }\n\n  var aKeys = Object.keys(objA);\n  var bKeys = Object.keys(objB);\n  var len = aKeys.length;\n\n  if (bKeys.length !== len) {\n    return false;\n  }\n\n  for (var i = 0; i < len; i++) {\n    var key = aKeys[i];\n    var isEqual = deep ? shallowEqual(objA[key], objB[key], deep) : objA[key] === objB[key];\n    if (!isEqual) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport const escapeRegExp = (string) => {\n  return string.replace(/[.*+?^${}()|[\\]\\\\/]/g, \"\\\\$&\"); // $& means the whole matched string\n};\n\n\nconst isObject = (v) => (typeof v == \"object\" && v !== null); // object or array\nconst listValue = (v, title) => (isObject(v) ? v : {value: v, title: (title !== undefined ? title : v)});\n\n// convert {<value>: <title>, ..} or [value, ..] to normal [{value, title}, ..]\nexport const listValuesToArray = (listValuesObj) => {\n  if (!isObject(listValuesObj))\n    return listValuesObj;\n  if (Array.isArray(listValuesObj))\n    return listValuesObj.map(v => listValue(v));\n  \n  let listValuesArr = [];\n  for (let v in listValuesObj) {\n    const title = listValuesObj[v];\n    listValuesArr.push(listValue(v, title));\n  }\n  return listValuesArr;\n};\n\n// listValues can be {<value>: <title>, ..} or [{value, title}, ..] or [value, ..]\nexport const getItemInListValues = (listValues, value) => {\n  if (Array.isArray(listValues)) {\n    const values = listValues.map(v => listValue(v));\n    return values.find(v => (v.value === value)) || values.find(v => (`${v.value}` === value));\n  } else {\n    return listValues[value] !== undefined ? listValue(value, listValues[value]) : undefined;\n  }\n};\n\nexport const getTitleInListValues = (listValues, value) => {\n  if (listValues == undefined)\n    return value;\n  const it = getItemInListValues(listValues, value);\n  return it !== undefined ? it.title : value;\n};\n\nexport const getValueInListValues = (listValues, value) => {\n  if (listValues == undefined)\n    return value;\n  const it = getItemInListValues(listValues, value);\n  return it !== undefined ? it.value : value;\n};\n\nexport const mapListValues = (listValues, mapFn) => {\n  let ret = [];\n  if (Array.isArray(listValues)) {\n    for (let v of listValues) {\n      const lv = mapFn(listValue(v));\n      if (lv != null)\n        ret.push(lv);\n    }\n  } else {\n    for (let value in listValues) {\n      const lv = mapFn(listValue(value, listValues[value]));\n      if (lv != null)\n        ret.push(lv);\n    }\n  }\n  return ret;\n};\n\nexport const defaultTreeDataMap = {id: \"value\", pId: \"parent\", rootPId: undefined};\n\n// converts from treeData to treeDataSimpleMode format (https://ant.design/components/tree-select/)\n// ! modifies value of `treeData`\nexport const flatizeTreeData = (treeData) => {\n  const tdm = defaultTreeDataMap;\n\n  let rind;\n  let len;\n\n  const _flatize = (node, root, lev) => {\n    if (node.children) {\n      if (lev == 1)\n        node[tdm.pId] = tdm.rootPId; //optional?\n      const childrenCount = node.children.length;\n      for (let c of node.children) {\n        c[tdm.pId] = node[tdm.id];\n        rind++;\n        root.splice(rind, 0, c); //instead of just push\n        len++;\n        _flatize(c, root, lev + 1);\n      }\n      delete node.children;\n      if (childrenCount == 0) {\n        root.splice(rind, 1);\n        rind--;\n        len--;\n      }\n    }\n  };\n\n  if (Array.isArray(treeData)) {\n    len = treeData.length;\n    for (rind = 0 ; rind < len ; rind++) {\n      const c = treeData[rind];\n      if (!isObject(c))\n        continue;\n      if (c[tdm.pId] !== undefined && c[tdm.pId] != tdm.rootPId)\n        continue; //not lev 1\n      _flatize(c, treeData, 1);\n    }\n  }\n  \n  return treeData;\n};\n\nconst getPathInListValues = (listValues, value) => {\n  const tdm = defaultTreeDataMap;\n  const it = getItemInListValues(listValues, value);\n  const parentId = it ? it[tdm.pId] : undefined;\n  const parent = parentId ? listValues.find(v => v[tdm.id] === parentId) : undefined;\n  return parent ? [parent.value, ...getPathInListValues(listValues, parent.value)] : [];\n};\n\nconst getChildrenInListValues = (listValues, value) => {\n  const tdm = defaultTreeDataMap;\n  const it = getItemInListValues(listValues, value);\n  return it ? listValues.filter(v => v[tdm.pId] === it[tdm.id]).map(v => v.value) : [];\n};\n\n// ! modifies value of `treeData`\nconst extendTreeData = (treeData, fieldSettings, isMulti) => {\n  for (let node of treeData) {\n    node.path = getPathInListValues(treeData, node.value);\n    if (fieldSettings.treeSelectOnlyLeafs != false) {\n      const childrenValues = getChildrenInListValues(treeData, node.value);\n      if (!isMulti) {\n        node.selectable = (childrenValues.length == 0);\n      }\n    }\n  }\n  return treeData;\n};\n\nexport const normalizeListValues = (listValues, type, fieldSettings) => {\n  const isTree = [\"treeselect\", \"treemultiselect\"].includes(type);\n  const isMulti = [\"multiselect\", \"treemultiselect\"].includes(type);\n  if (isTree) {\n    listValues = listValuesToArray(listValues);\n    listValues = flatizeTreeData(listValues);\n    listValues = extendTreeData(listValues, fieldSettings, isMulti);\n  }\n  return listValues;\n};\n\nexport const removePrefixPath = (selectedPath, parentPath) => {\n  if (!selectedPath)\n    return selectedPath;\n  let isPrefix = true;\n  for (let i = 0 ; i < parentPath.length ; i++) {\n    const part = parentPath[i];\n    if (selectedPath[i] !== undefined && part == selectedPath[i]) {\n      //ok\n    } else {\n      isPrefix = false;\n      break;\n    }\n  }\n  return isPrefix ? selectedPath.slice(parentPath.length) : selectedPath;\n};\n\nexport const isJsonLogic = (logic) => (\n  typeof logic === \"object\" // An object\n  && logic !== null // but not null\n  && !Array.isArray(logic) // and not an array\n  && Object.keys(logic).length === 1 // with exactly one key\n);\n\nexport function sleep(delay) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, delay);\n  });\n}\n\nexport const isImmutable = (v) => {\n  return typeof v === \"object\" && v !== null && typeof v.toJS === \"function\";\n};\n\nexport function applyToJS(v) {\n  return (isImmutable(v) ? v.toJS() : v);\n}\n\nexport function toImmutableList(v) {\n  return (isImmutable(v) ? v : new Immutable.List(v));\n}\n\n// [1, 4, 9] + [1, 5, 9] => [1, 4, 5, 9]\n// Used for merging arrays of operators for different widgets of 1 type\nexport function mergeArraysSmart(arr1, arr2) {\n  if (!arr1) arr1 = [];\n  if (!arr2) arr2 = [];\n  return arr2\n    .map(op => [op, arr1.indexOf(op)])\n    .map(([op, ind], i, orig) => {\n      if (ind == -1) {\n        const next = orig.slice(i+1);\n        const prev = orig.slice(0, i);\n        const after = prev.reverse().find(([_cop, ci]) => ci != -1);\n        const before = next.find(([_cop, ci]) => ci != -1);\n        if (before)\n          return [op, \"before\", before[0]];\n        else if (after)\n          return [op, \"after\", after[0]];\n        else\n          return [op, \"append\", null];\n      } else {\n      // already exists\n        return null;\n      }\n    })\n    .filter(x => x !== null)\n    .reduce((acc, [newOp, rel, relOp]) => {\n      const ind = acc.indexOf(relOp);\n      if (acc.indexOf(newOp) == -1) {\n        if (ind > -1) {\n        // insert after or before\n          acc.splice( ind + (rel == \"after\" ? 1 : 0), 0, newOp );\n        } else {\n        // insert to end or start\n          acc.splice( (rel == \"append\" ? Infinity : 0), 0, newOp );\n        }\n      }\n      return acc;\n    }, arr1.slice());\n}\n\nconst isDev = () => (typeof process !== \"undefined\" && process.env && process.env.NODE_ENV == \"development\");\n\nexport const getLogger = (devMode = false) => {\n  const verbose = devMode != undefined ? devMode : isDev(); \n  return verbose ? console : {\n    error: () => {},\n    log: () => {},\n    warn: () => {},\n    debug: () => {},\n    info: () => {},\n  };\n};\n\nexport const getFirstDefined = (arr = []) => {\n  let ret;\n  for (let i = 0 ; i < arr.length ; i++) {\n    const v = arr[i];\n    if (v !== undefined) {\n      ret = v;\n      break;\n    }\n  }\n  return ret;\n};\n\nexport const logger = getLogger();\n\n","import Immutable  from \"immutable\";\n\n/**\n * @param {Immutable.List} path\n * @param {...string} suffix\n * @return {Immutable.List}\n */\nexport const expandTreePath = (path, ...suffix) =>\n  path.interpose(\"children1\").withMutations((list) => {\n    list.skip(1);\n    list.push.apply(list, suffix);\n    return list;\n  });\n\n\n/**\n * @param {Immutable.List} path\n * @param {...string} suffix\n * @return {Immutable.List}\n */\nexport const expandTreeSubpath = (path, ...suffix) =>\n  path.interpose(\"children1\").withMutations((list) => {\n    list.push.apply(list, suffix);\n    return list;\n  });\n\n\n/**\n * @param {Immutable.Map} path\n * @param {Immutable.List} path\n * @return {Immutable.Map}\n */\nexport const getItemByPath = (tree, path) => {\n  let children = new Immutable.OrderedMap({ [tree.get(\"id\")] : tree });\n  let res = tree;\n  path.forEach((id) => {\n    res = children.get(id);\n    children = res.get(\"children1\");\n  });\n  return res;\n};\n\n\n/**\n * Remove `path` in every item\n * @param {Immutable.Map} tree\n * @return {Immutable.Map} tree\n */\nexport const removePathsInTree = (tree) => {\n  let newTree = tree;\n\n  function _processNode (item, path) {\n    const itemPath = path.push(item.get(\"id\"));\n    if (item.get(\"path\")) {\n      newTree = newTree.removeIn(expandTreePath(itemPath, \"path\"));\n    }\n\n    const children = item.get(\"children1\");\n    if (children) {\n      children.map((child, _childId) => {\n        _processNode(child, itemPath);\n      });\n    }\n  }\n\n  _processNode(tree, new Immutable.List());\n\n  return newTree;\n};\n\n\n/**\n * Remove `isLocked` in items that inherit parent's `isLocked`\n * @param {Immutable.Map} tree\n * @return {Immutable.Map} tree\n */\nexport const removeIsLockedInTree = (tree) => {\n  let newTree = tree;\n\n  function _processNode (item, path, isParentLocked = false) {\n    const itemPath = path.push(item.get(\"id\"));\n    const isLocked = item.getIn([\"properties\", \"isLocked\"]);\n    if (isParentLocked && isLocked) {\n      newTree = newTree.deleteIn(expandTreePath(itemPath, \"properties\", \"isLocked\"));\n    }\n\n    const children = item.get(\"children1\");\n    if (children) {\n      children.map((child, _childId) => {\n        _processNode(child, itemPath, isLocked || isParentLocked);\n      });\n    }\n  }\n\n  _processNode(tree, new Immutable.List());\n\n  return newTree;\n};\n\n\n/**\n * Set correct `path` and `id` in every item\n * @param {Immutable.Map} tree\n * @return {Immutable.Map} tree\n */\nexport const fixPathsInTree = (tree) => {\n  let newTree = tree;\n\n  function _processNode (item, path, lev, nodeId) {\n    if (!item) return;\n    const currPath = item.get(\"path\");\n    const currId = item.get(\"id\");\n    const itemId = currId || nodeId;\n    const itemPath = path.push(itemId);\n    if (!currPath || !currPath.equals(itemPath)) {\n      newTree = newTree.setIn(expandTreePath(itemPath, \"path\"), itemPath);\n    }\n    if (!currId) {\n      newTree = newTree.setIn(expandTreePath(itemPath, \"id\"), itemId);\n    }\n\n    const children = item.get(\"children1\");\n    if (children) {\n      if (children.constructor.name == \"Map\") {\n        // protect: should me OrderedMap, not Map (issue #501)\n        newTree = newTree.setIn(\n          expandTreePath(itemPath, \"children1\"), \n          new Immutable.OrderedMap(children)\n        );\n      }\n      children.map((child, childId) => {\n        _processNode(child, itemPath, lev + 1, childId);\n      });\n    }\n  }\n\n  _processNode(tree, new Immutable.List(), 0);\n\n\n  return newTree;\n};\n\nexport const fixEmptyGroupsInTree = (tree) => {\n  let newTree = tree;\n\n  function _processNode (item, path, lev, nodeId) {\n    if (!item) return false;\n    const itemId = item.get(\"id\") || nodeId;\n    const itemPath = path.push(itemId);\n\n    const children = item.get(\"children1\");\n    if (children) {\n      const allChildrenGone = children.map((child, childId) => {\n        return _processNode(child, itemPath, lev + 1, childId);\n      }).reduce((curr, v) => (curr && v), true);\n      if ((children.size == 0 || allChildrenGone) && lev > 0) {\n        newTree = newTree.deleteIn(expandTreePath(itemPath));\n        return true;\n      }\n    }\n    return false;\n  }\n\n  _processNode(tree, new Immutable.List(), 0);\n\n\n  return newTree;\n};\n\n/**\n * @param {Immutable.Map} tree\n * @return {Object} {flat, items}\n */\nexport const getFlatTree = (tree) => {\n  let flat = [];\n  let items = {};\n  let realHeight = 0;\n\n  function _flatizeTree (item, path, insideCollapsed, insideLocked, insideRuleGroup, lev, info, parentType, caseId) {\n    const type = item.get(\"type\");\n    const collapsed = item.get(\"collapsed\");\n    const id = item.get(\"id\");\n    const children = item.get(\"children1\");\n    const isLocked = item.getIn([\"properties\", \"isLocked\"]);\n    const childrenIds = children ? children.map((_child, childId) => childId) : null;\n    const isRuleGroup = type == \"rule_group\";\n    // tip: count rule_group as 1 rule\n    const isLeaf = !insideRuleGroup && (!children || isRuleGroup);\n\n    const itemsBefore = flat.length;\n    const top = realHeight;\n    flat.push(id);\n    if (!insideCollapsed)\n      realHeight += 1;\n    info.height = (info.height || 0) + 1;\n\n    items[id] = {\n      type: type,\n      parent: path.length ? path[path.length-1] : null,\n      parentType: parentType,\n      caseId: type == \"case_group\" ? id : caseId,\n      isDefaultCase: type == \"case_group\" && !children,\n      path: path.concat(id),\n      lev: lev,\n      leaf: !children,\n      index: itemsBefore,\n      id: id,\n      children: childrenIds,\n      leafsCount: 0,\n      _top: itemsBefore,\n      _height: (itemsAfter - itemsBefore),\n      top: (insideCollapsed ? null : top),\n      height: height,\n      bottom: (insideCollapsed ? null : top) + height,\n      collapsed: collapsed,\n      node: item,\n      isLocked: isLocked || insideLocked,\n    };\n\n    if (children) {\n      let subinfo = {};\n      children.map((child, _childId) => {\n        _flatizeTree(\n          child, path.concat(id), \n          insideCollapsed || collapsed, insideLocked || isLocked, insideRuleGroup || isRuleGroup,\n          lev + 1, subinfo, type, type == \"case_group\" ? id : caseId\n        );\n      });\n      if (!collapsed) {\n        info.height = (info.height || 0) + (subinfo.height || 0);\n      }\n    }\n    \n    if (caseId && isLeaf) {\n      items[caseId].leafsCount++;\n    }\n\n    const itemsAfter = flat.length;\n    const _bottom = realHeight;\n    const height = info.height;\n        \n    Object.assign(items[id], {\n      _height: (itemsAfter - itemsBefore),\n      height: height,\n      bottom: (insideCollapsed ? null : top) + height,\n    });\n  }\n\n  _flatizeTree(tree, [], false, false, false, 0, {}, null, null);\n\n  for (let i = 0 ; i < flat.length ; i++) {\n    const prevId = i > 0 ? flat[i-1] : null;\n    const nextId = i < (flat.length-1) ? flat[i+1] : null;\n    let item = items[flat[i]];\n    item.prev = prevId;\n    item.next = nextId;\n  }\n\n  return {flat, items};\n};\n\n\n/**\n * Returns count of reorderable(!) nodes\n * @param {Immutable.Map} tree\n * @return {Integer}\n */\nexport const getTotalReordableNodesCountInTree = (tree) => {\n  if (!tree)\n    return -1;\n  let cnt = 0;\n\n  function _processNode (item, path, lev) {\n    let id, children, type;\n    if (typeof item.get === \"function\") {\n      id = item.get(\"id\");\n      children = item.get(\"children1\");\n      type = item.get(\"type\");\n    } else {\n      id = item.id;\n      children = item.children1;\n      type = item.type;\n    }\n    const isRuleGroup = type == \"rule_group\";\n    cnt++;\n    //tip: rules in rule-group can be reordered only inside\n    if (children && !isRuleGroup) {\n      children.map((child, _childId) => {\n        _processNode(child, path.concat(id), lev + 1);\n      });\n    }\n  }\n\n  _processNode(tree, [], 0);\n    \n  return cnt - 1; // -1 for root\n};\n\n/**\n * Returns count of rules (leafs, i.e. don't count groups)\n * @param {Immutable.Map} tree\n * @return {Integer}\n */\nexport const getTotalRulesCountInTree = (tree) => {\n  if (!tree)\n    return -1;\n  let cnt = 0;\n\n  function _processNode (item, path, lev) {\n    let id, children, type;\n    if (typeof item.get === \"function\") {\n      id = item.get(\"id\");\n      children = item.get(\"children1\");\n      type = item.get(\"type\");\n    } else {\n      id = item.id;\n      children = item.children1;\n      type = item.type;\n    }\n    \n    if (type == \"rule\" || type == \"rule_group\") {\n      // tip: count rule_group as 1 rule\n      cnt++;\n    } else if (children) {\n      children.map((child, _childId) => {\n        _processNode(child, path.concat(id), lev + 1);\n      });\n    }\n  }\n\n  _processNode(tree, [], 0);\n    \n  return cnt;\n};\n\nexport const getTreeBadFields = (tree) => {\n  let badFields = [];\n\n  function _processNode (item, path, lev) {\n    const id = item.get(\"id\");\n    const children = item.get(\"children1\");\n    const valueError = item.getIn([\"properties\", \"valueError\"]);\n    const field = item.getIn([\"properties\", \"field\"]);\n    if (valueError && valueError.size > 0 && valueError.filter(v => v != null).size > 0) {\n      badFields.push(field);\n    }\n    if (children) {\n      children.map((child, _childId) => {\n        _processNode(child, path.concat(id), lev + 1);\n      });\n    }\n  }\n\n  if (tree)\n    _processNode(tree, [], 0);\n    \n  return Array.from(new Set(badFields));\n};\n\n\n// Remove fields that can be calced: \"id\", \"path\"\n// Remove empty fields: \"operatorOptions\"\nexport const getLightTree = (tree, children1AsArray = false) => {\n  let newTree = tree;\n\n  function _processNode (item, itemId) {\n    if (item.path)\n      delete item.path;\n    if (!children1AsArray && itemId)\n      delete item.id;\n    let properties = item.properties;\n    if (properties) {\n      if (properties.operatorOptions == null)\n        delete properties.operatorOptions;\n    }\n\n    const children = item.children1;\n    if (children) {\n      for (let id in children) {\n        _processNode(children[id], id);\n      }\n      if (children1AsArray) {\n        item.children1 = Object.values(children);\n      }\n    }\n  }\n\n  _processNode(tree, null);\n\n  return newTree;\n};\n\nexport const getSwitchValues = (tree) => {\n  let vals = [];\n  const children = tree.get(\"children1\");\n  if (children) {\n    children.map((child) => {\n      const value = child.getIn([\"properties\", \"value\"]);\n      let caseValue;\n      if (value && value.size == 1) {\n        caseValue = value.get(0);\n        if (Array.isArray(caseValue) && caseValue.length == 0) {\n          caseValue = null;\n        }\n      } else {\n        caseValue = null;\n      }\n      vals = [...vals, caseValue];\n    });\n  }\n\n  return vals;\n};\n\nexport const isEmptyTree = (tree) => (!tree.get(\"children1\") || tree.get(\"children1\").size == 0);\n\nexport const hasChildren = (tree, path) => tree.getIn(expandTreePath(path, \"children1\")).size > 0;\n","// Had to make uuid use a constant seed so it would generate same sequence across runs. This was needed\n// so server side rendering and client side rendering yield same results (e.g. the uuid is used when rendering\n// the concunctions with their name and id)\nvar query_builder_seed = 0;\nexport default () => {\n  // Generate a random GUID http://stackoverflow.com/a/2117523.\n  const timePart = (new Date().getTime().toString(16)+\"FF\").substr(0,11);\n  const s = \"ssssssss-xxxx-4xxx-yxxx-x\".replace(/[xys]/g, (c) => {\n    const r = c === \"s\" ? Math.floor(Math.random() * 16) : (query_builder_seed++) & 0xf;\n    const v = c === \"x\" ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n  return s + timePart;\n};\n","import {\n  getFieldConfig, getOperatorConfig, getFieldWidgetConfig, getFuncConfig,\n} from \"./configUtils\";\nimport {getOperatorsForField, getWidgetForFieldOp, getNewValueForFieldOp} from \"../utils/ruleUtils\";\nimport {defaultValue, deepEqual, getItemInListValues, logger, immutableEqual} from \"../utils/stuff\";\nimport {defaultOperatorOptions} from \"../utils/defaultUtils\";\nimport {fixPathsInTree} from \"../utils/treeUtils\";\nimport omit from \"lodash/omit\";\nimport { List } from \"immutable\";\n\n\nconst typeOf = (v) => {\n  if (typeof v == \"object\" && v !== null && Array.isArray(v))\n    return \"array\";\n  else\n    return (typeof v);\n};\n\nconst isTypeOf = (v, type) => {\n  if (typeOf(v) == type)\n    return true;\n  if (type == \"number\" && !isNaN(v))\n    return true; //can be casted\n  return false;\n};\n\nexport const createValidationMemo = () => {\n  let originalTree;\n  let validatedTree;\n  let configId;\n\n  return (config, tree, oldConfig) => {\n    if (!tree) {\n      return null;\n    }\n    if (config.__configId === configId && (immutableEqual(tree, originalTree) || immutableEqual(tree, validatedTree))) {\n      return validatedTree;\n    } else {\n      configId = config.__configId;\n      originalTree = tree;\n      validatedTree = validateAndFixTree(tree, null, config, oldConfig || config);\n      return validatedTree;\n    }\n  };\n};\n\nexport const validateAndFixTree = (newTree, _oldTree, newConfig, oldConfig) => {\n  let tree = validateTree(newTree, _oldTree, newConfig, oldConfig);\n  tree = fixPathsInTree(tree);\n  return tree;\n};\n\nexport const validateTree = (tree, _oldTree, config, oldConfig, removeEmptyGroups, removeIncompleteRules) => {\n  if (removeEmptyGroups === undefined) {\n    removeEmptyGroups = config.settings.removeEmptyGroupsOnLoad;\n  }\n  if (removeIncompleteRules === undefined) {\n    removeIncompleteRules = config.settings.removeIncompleteRulesOnLoad;\n  }\n  const c = {\n    config, oldConfig, removeEmptyGroups, removeIncompleteRules\n  };\n  return validateItem(tree, [], null, {}, c);\n};\n\nfunction validateItem (item, path, itemId, meta, c) {\n  const type = item.get(\"type\");\n  const children = item.get(\"children1\");\n\n  if ((type === \"group\" || type === \"rule_group\" || type == \"case_group\" || type == \"switch_group\") && children && children.size) {\n    return validateGroup(item, path, itemId, meta, c);\n  } else if (type === \"rule\") {\n    return validateRule(item, path, itemId, meta, c);\n  } else {\n    return item;\n  }\n}\n\nfunction validateGroup (item, path, itemId, meta, c) {\n  const {removeEmptyGroups} = c;\n  let id = item.get(\"id\");\n  let children = item.get(\"children1\");\n  const oldChildren = children;\n\n  if (!id && itemId) {\n    id = itemId;\n    item = item.set(\"id\", id);\n    meta.sanitized = true;\n  }\n\n  //validate children\n  let submeta = {};\n  children = children\n    .map( (currentChild, childId) => validateItem(currentChild, path.concat(id), childId, submeta, c) );\n  if (removeEmptyGroups)\n    children = children.filter((currentChild) => (currentChild != undefined));\n  let sanitized = submeta.sanitized || (oldChildren.size != children.size);\n  if (!children.size && removeEmptyGroups && path.length) {\n    sanitized = true;\n    item = undefined;\n  }\n\n  if (sanitized)\n    meta.sanitized = true;\n  if (sanitized && item)\n    item = item.set(\"children1\", children);\n  return item;\n}\n\n\nfunction validateRule (item, path, itemId, meta, c) {\n  const {removeIncompleteRules, config, oldConfig} = c;\n  const {showErrorMessage} = config.settings;\n  let id = item.get(\"id\");\n  let properties = item.get(\"properties\");\n  let field = properties.get(\"field\") || null;\n  let operator = properties.get(\"operator\") || null;\n  let operatorOptions = properties.get(\"operatorOptions\");\n  let valueSrc = properties.get(\"valueSrc\");\n  let value = properties.get(\"value\");\n  let valueError = properties.get(\"valueError\");\n  const oldSerialized = {\n    field,\n    operator,\n    operatorOptions: operatorOptions ? operatorOptions.toJS() : {},\n    valueSrc: valueSrc ? valueSrc.toJS() : null,\n    value: value ? value.toJS() : null,\n    valueError: valueError ? valueError.toJS() : null,\n  };\n  let _wasValid = field && operator && value && !value.includes(undefined);\n\n  if (!id && itemId) {\n    id = itemId;\n    item = item.set(\"id\", id);\n    meta.sanitized = true;\n  }\n\n  //validate field\n  const fieldDefinition = field ? getFieldConfig(config, field) : null;\n  if (field && !fieldDefinition) {\n    logger.warn(`No config for field ${field}`);\n    field = null;\n  }\n  if (field == null) {\n    properties = [\"operator\", \"operatorOptions\", \"valueSrc\", \"value\"].reduce((map, key) => map.delete(key), properties);\n    operator = null;\n  }\n\n  //validate operator\n  // Backward compatibility: obsolete operator range_between\n  if (operator == \"range_between\" || operator == \"range_not_between\") {\n    operator = operator == \"range_between\" ? \"between\" : \"not_between\";\n    console.info(`Fixed operator ${properties.get(\"operator\")} to ${operator}`);\n    properties = properties.set(\"operator\", operator);\n  }\n  const operatorDefinition = operator ? getOperatorConfig(config, operator, field) : null;\n  if (operator && !operatorDefinition) {\n    console.warn(`No config for operator ${operator}`);\n    operator = null;\n  }\n  const availOps = field ? getOperatorsForField(config, field) : [];\n  if (!availOps) {\n    console.warn(`Type of field ${field} is not supported`);\n    operator = null;\n  } else if (operator && availOps.indexOf(operator) == -1) {\n    if (operator == \"is_empty\" || operator == \"is_not_empty\") {\n      // Backward compatibility: is_empty #494\n      operator = operator == \"is_empty\" ? \"is_null\" : \"is_not_null\";\n      console.info(`Fixed operator ${properties.get(\"operator\")} to ${operator} for ${field}`);\n      properties = properties.set(\"operator\", operator);\n    } else {\n      console.warn(`Operator ${operator} is not supported for field ${field}`);\n      operator = null;\n    }\n  }\n  if (operator == null) {\n    properties = properties.delete(\"operatorOptions\");\n    properties = properties.delete(\"valueSrc\");\n    properties = properties.delete(\"value\");\n  }\n\n  //validate operator options\n  operatorOptions = properties.get(\"operatorOptions\");\n  let _operatorCardinality = operator ? defaultValue(operatorDefinition.cardinality, 1) : null;\n  if (!operator || operatorOptions && !operatorDefinition.options) {\n    operatorOptions = null;\n    properties = properties.delete(\"operatorOptions\");\n  } else if (operator && !operatorOptions && operatorDefinition.options) {\n    operatorOptions = defaultOperatorOptions(config, operator, field);\n    properties = properties.set(\"operatorOptions\", operatorOptions);\n  }\n\n  //validate values\n  valueSrc = properties.get(\"valueSrc\");\n  value = properties.get(\"value\");\n  const canFix = !showErrorMessage;\n  const isEndValue = true;\n  let {newValue, newValueSrc, newValueError} = getNewValueForFieldOp(config, oldConfig, properties, field, operator, null, canFix, isEndValue);\n  value = newValue;\n  valueSrc = newValueSrc;\n  valueError = newValueError;\n  properties = properties.set(\"value\", value);\n  properties = properties.set(\"valueSrc\", valueSrc);\n  if (showErrorMessage) {\n    properties = properties.set(\"valueError\", valueError);\n  }\n\n  const newSerialized = {\n    field,\n    operator,\n    operatorOptions: operatorOptions ? operatorOptions.toJS() : {},\n    valueSrc: valueSrc ? valueSrc.toJS() : null,\n    value: value ? value.toJS() : null,\n    valueError: valueError ? valueError.toJS() : null,\n  };\n  const sanitized = !deepEqual(oldSerialized, newSerialized);\n  const isComplete = field && operator && value && !value.includes(undefined);\n  if (sanitized)\n    meta.sanitized = true;\n  if (!isComplete && removeIncompleteRules)\n    item = undefined;\n  else if (sanitized)\n    item = item.set(\"properties\", properties);\n\n  return item;\n}\n\n\n/**\n * \n * @param {bool} canFix true is useful for func values to remove bad args\n * @param {bool} isEndValue false if value is in process of editing by user\n * @param {bool} isRawValue false is used only internally from validateFuncValue\n * @return {array} [validError, fixedValue] - if validError === null and canFix == true, fixedValue can differ from value if was fixed\n */\nexport const validateValue = (config, leftField, field, operator, value, valueType, valueSrc, asyncListValues, canFix = false, isEndValue = false, isRawValue = true) => {\n  let validError = null;\n  let fixedValue = value;\n\n  if (value != null) {\n    if (valueSrc == \"field\") {\n      [validError, fixedValue] = validateFieldValue(leftField, field, value, valueSrc, valueType, asyncListValues, config, operator, isEndValue, canFix);\n    } else if (valueSrc == \"func\") {\n      [validError, fixedValue] = validateFuncValue(leftField, field, value, valueSrc, valueType, asyncListValues, config, operator, isEndValue, canFix);\n    } else if (valueSrc == \"value\" || !valueSrc) {\n      [validError, fixedValue] = validateNormalValue(leftField, field, value, valueSrc, valueType, asyncListValues, config, operator, isEndValue, canFix);\n    }\n\n    if (!validError) {\n      const fieldConfig = getFieldConfig(config, field);\n      const w = getWidgetForFieldOp(config, field, operator, valueSrc);\n      const operatorDefinition = operator ? getOperatorConfig(config, operator, field) : null;\n      const fieldWidgetDefinition = omit(getFieldWidgetConfig(config, field, operator, w, valueSrc), [\"factory\"]);\n      const rightFieldDefinition = (valueSrc == \"field\" ? getFieldConfig(config, value) : null);\n      const fieldSettings = fieldWidgetDefinition; // widget definition merged with fieldSettings\n\n      const fn = fieldWidgetDefinition.validateValue;\n      if (typeof fn == \"function\") {\n        const args = [\n          fixedValue, \n          fieldSettings,\n          operator,\n          operatorDefinition\n        ];\n        if (valueSrc == \"field\")\n          args.push(rightFieldDefinition);\n        const validResult = fn(...args);\n        if (typeof validResult == \"boolean\") {\n          if (validResult == false)\n            validError = \"Invalid value\";\n        } else {\n          validError = validResult;\n        }\n      }\n    }\n  }\n\n  if (isRawValue && validError) {\n    console.warn(\"[RAQB validate]\", `Field ${field}: ${validError}`);\n  }\n  \n  return [validError, fixedValue];\n};\n\nconst validateValueInList = (value, listValues, canFix, isEndValue, removeInvalidMultiSelectValuesOnLoad) => {\n  const values = List.isList(value) ? value.toJS() : (value instanceof Array ? [...value] : undefined);\n  if (values) {\n    const [goodValues, badValues] = values.reduce(([goodVals, badVals], val) => {\n      const vv = getItemInListValues(listValues, val);\n      if (vv == undefined) {\n        return [goodVals, [...badVals, val]];\n      } else {\n        return [[...goodVals, vv.value], badVals];\n      }\n    }, [[], []]);\n    const plural = badValues.length > 1;\n    const err = badValues.length ? `${plural ? \"Values\" : \"Value\"} ${badValues.join(\", \")} ${plural ? \"are\" : \"is\"} not in list of values` : null;\n    // always remove bad values at tree validation as user can't unselect them (except AntDesign widget)\n    if (removeInvalidMultiSelectValuesOnLoad !== undefined) {\n      canFix = removeInvalidMultiSelectValuesOnLoad;\n    } else {\n      canFix = canFix || isEndValue;\n    }\n    return [err, canFix ? goodValues : value];\n  } else {\n    const vv = getItemInListValues(listValues, value);\n    if (vv == undefined) {\n      return [`Value ${value} is not in list of values`, value];\n    } else {\n      value = vv.value;\n    }\n    return [null, value];\n  }\n};\n\n/**\n* \n*/\nconst validateNormalValue = (leftField, field, value, valueSrc, valueType, asyncListValues, config, operator = null, isEndValue = false, canFix = false) => {\n  if (field) {\n    const fieldConfig = getFieldConfig(config, field);\n    const w = getWidgetForFieldOp(config, field, operator, valueSrc);\n    const wConfig = config.widgets[w];\n    const wType = wConfig.type;\n    const jsType = wConfig.jsType;\n    const fieldSettings = fieldConfig.fieldSettings;\n\n    if (valueType != wType)\n      return [`Value should have type ${wType}, but got value of type ${valueType}`, value];\n    if (jsType && !isTypeOf(value, jsType) && !fieldSettings.listValues) { //tip: can skip tye check for listValues\n      return [`Value should have JS type ${jsType}, but got value of type ${typeof value}`, value];\n    }\n\n    if (fieldSettings) {\n      const listValues = asyncListValues || fieldSettings.listValues;\n      if (listValues && !fieldSettings.allowCustomValues) {\n        return validateValueInList(value, listValues, canFix, isEndValue, config.settings.removeInvalidMultiSelectValuesOnLoad);\n      }\n      if (fieldSettings.min != null && value < fieldSettings.min) {\n        return [`Value ${value} < min ${fieldSettings.min}`, canFix ? fieldSettings.min : value];\n      }\n      if (fieldSettings.max != null && value > fieldSettings.max) {\n        return [`Value ${value} > max ${fieldSettings.max}`, canFix ? fieldSettings.max : value];\n      }\n    }\n  }\n\n  return [null, value];\n};\n\n\n/**\n* \n*/\nconst validateFieldValue = (leftField, field, value, _valueSrc, valueType, asyncListValues, config, operator = null, isEndValue = false, canFix = false) => {\n  const {fieldSeparator} = config.settings;\n  const isFuncArg = typeof field == \"object\" && field?._isFuncArg;\n  const leftFieldStr = Array.isArray(leftField) ? leftField.join(fieldSeparator) : leftField;\n  const rightFieldStr = Array.isArray(value) ? value.join(fieldSeparator) : value;\n  const rightFieldDefinition = getFieldConfig(config, value);\n  if (!rightFieldDefinition)\n    return [`Unknown field ${value}`, value];\n  if (rightFieldStr == leftFieldStr && !isFuncArg)\n    return [`Can't compare field ${leftField} with itself`, value];\n  if (valueType && valueType != rightFieldDefinition.type)\n    return [`Field ${value} is of type ${rightFieldDefinition.type}, but expected ${valueType}`, value];\n  return [null, value];\n};\n\n/**\n* \n*/\nconst validateFuncValue = (leftField, field, value, _valueSrc, valueType, asyncListValues, config, operator = null, isEndValue = false, canFix = false) => {\n  let fixedValue = value;\n\n  if (value) {\n    const funcKey = value.get(\"func\");\n    if (funcKey) {\n      const funcConfig = getFuncConfig(config, funcKey);\n      if (funcConfig) {\n        if (valueType && funcConfig.returnType != valueType)\n          return [`Function ${funcKey} should return value of type ${funcConfig.returnType}, but got ${valueType}`, value];\n        for (const argKey in funcConfig.args) {\n          const argConfig = funcConfig.args[argKey];\n          const args = fixedValue.get(\"args\");\n          const argVal = args ? args.get(argKey) : undefined;\n          const fieldDef = getFieldConfig(config, argConfig);\n          const argValue = argVal ? argVal.get(\"value\") : undefined;\n          const argValueSrc = argVal ? argVal.get(\"valueSrc\") : undefined;\n          if (argValue !== undefined) {\n            const [argValidError, fixedArgVal] = validateValue(\n              config, leftField, fieldDef, operator, argValue, argConfig.type, argValueSrc, asyncListValues, canFix, isEndValue, false\n            );\n            if (argValidError !== null) {\n              if (canFix) {\n                fixedValue = fixedValue.deleteIn([\"args\", argKey]);\n                if (argConfig.defaultValue !== undefined) {\n                  fixedValue = fixedValue.setIn([\"args\", argKey, \"value\"], argConfig.defaultValue);\n                  fixedValue = fixedValue.setIn([\"args\", argKey, \"valueSrc\"], \"value\");\n                }\n              } else {\n                return [`Invalid value of arg ${argKey} for func ${funcKey}: ${argValidError}`, value];\n              }\n            } else if (fixedArgVal !== argValue) {\n              fixedValue = fixedValue.setIn([\"args\", argKey, \"value\"], fixedArgVal);\n            }\n          } else if (isEndValue && argConfig.defaultValue === undefined && !canFix) {\n            return [`Value of arg ${argKey} for func ${funcKey} is required`, value];\n          }\n        }\n      } else return [`Unknown function ${funcKey}`, value];\n    } // else it's not function value\n  } // empty value\n\n  return [null, fixedValue];\n};\n","var map = {\n\t\"./es-us\": 73099,\n\t\"./es-us.js\": 73099,\n\t\"./ru\": 21753,\n\t\"./ru.js\": 21753,\n\t\"moment/locale/es-us\": 73099,\n\t\"moment/locale/es-us.js\": 73099,\n\t\"moment/locale/ru\": 21753,\n\t\"moment/locale/ru.js\": 21753\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 13837;"],"names":["Proximity","handleChange","value","props","setOption","parseInt","this","defaults","options","config","optionLabel","optionPlaceholder","customProps","minProximity","maxProximity","optionTextBefore","readonly","settings","widgets","defaultProximity","proximity","undefined","showLabels","selectedProximity","get","proxValues","range","map","item","title","Select","select","factory","className","listValues","setValue","placeholder","children","PureComponent","propTypes","PropTypes","defaultProps","delta","isFuncArg","immValue","valueSrc","immValueError","valueError","asyncListValues","isSpecialRange","fieldDefinition","widgetDefinition","widget","widgetValueLabel","valueLabels","textSeparators","setValueHandler","field","operator","parentField","parentFuncs","id","groupId","widgetFactory","fieldWidgetProps","isConst","valueSources","length","defaultValue","fieldSettings","widgetProps","Object","assign","label","placeholders","labelYes","labelNo","Array","isArray","v","getTitleInListValues","join","funcArgDummyOpDef","cardinality","Widget","_setValue","widgetType","__isInternal","oldRange","_onChangeValueSrc","srcKey","setValueSrc","renderWidget","meta","leftField","values","iValues","aField","valueLabel","widgetLabel","key","WidgetFactory","pick","renderValueSources","setValueSrcHandler","valueSourcesInfo","ValueSources","valueSourcesOptions","sourceLabel","valueSourcesPopupTitle","renderSep","sepText","sepLabel","renderWidgetDelta","useOnPropsChanged","onPropsChanged","nextProps","prevProps","k","filter","ch","getMeta","simpleField","fieldFunc","fieldArg","valueSrcs","isForRuleGruop","isCaseValue","func","arg","iValueSrcs","Immutable","getFieldConfig","defaultWidget","getWidgetForFieldOp","operatorDefinition","getWidgetsForFieldOp","getOperatorConfig","isSpecialRangeForSrcField","isTrueSpecialRange","getValueSourcesForFieldOp","getFieldWidgetConfig","singleWidget","type","getValueLabel","bind","name","toUpperCase","Col","dummyFn","DragIcon","xmlns","viewBox","fill","width","height","d","ConfirmFn","Cmp","useConfirm","confirmFn","ValueField","needUpdateItems","items","needUpdateMeta","getItems","canCompareFieldWithField","fieldSeparator","parentFieldPath","split","parentFieldConfig","sourceFields","subfields","fields","filteredFields","filterFields","buildOptions","customPlaceholder","fieldPlaceholder","fieldSeparatorDisplay","selectedKey","isFieldSelected","leftFieldWidgetField","leftFieldWidgetFieldProps","valuePlaceholder","currField","selectedOpts","selectedKeys","getFieldPath","selectedPath","selectedLabel","getFieldLabel","partsLabels","getFieldPathLabels","selectedFullLabel","selectedAltLabel","label2","leftFieldFullkey","clone","expectedType","leftFieldConfig","_filter","list","path","rightFieldKey","subpath","concat","rightFieldFullkey","rightFieldConfig","canUse","fn","keys","optGroupLabel","prefix","fieldKey","fullLabel","altLabel","tooltip","hideForCompare","grouplabel","o","fieldOpts","maxLabelsLength","fieldParts","last","truncateString","renderField","renderProps","setField","FuncSelect","canUseFuncForField","filteredFuncs","filterFuncs","funcs","funcPlaceholder","selectedFuncKey","isFuncSelected","currFunc","getFuncConfig","getFuncLabel","getFuncPathLabels","targetDefinition","funcKey","funcFullkey","funcConfig","returnType","includes","allowSelfNesting","funcOpts","funcParts","renderFunc","FuncWidget","setFunc","setArgValue","argKey","argVal","argDefinition","funcDefinition","args","setArgValueSrc","argValSrc","renderFuncSelect","selectProps","funcLabel","renderArgLabel","showPrefix","renderArgLabelSep","renderArgVal","getIn","defaultValueSource","ArgWidget","renderArgSep","argIndex","renderSeps","renderBracketBefore","renderBrackets","renderBracketAfter","renderFuncArgs","_delta","_widgetType","customRadioYesProps","radioYes","customRadioNoProps","radioNo","onRadioChange","e","target","uuid","id2","checked","disabled","onChange","style","display","htmlFor","maxLength","textValue","val","fullWidth","maxRows","valueFormat","use12Hours","dtValue","moment","format","Date","allowCustomValues","multiple","multiselect","i","opt","selected","push","getMultiSelectValues","omit","mapListValues","hasValue","min","max","step","numberValue","Number","customInputProps","input","customSliderProps","slider","renderOptions","postfix","not","setNot","conjunctionOptions","setConjunction","showNot","notLabel","conjsCount","lessThenTwo","showConj","forceShowConj","isDummyFn","onClick","btnLabel","info","onOk","okText","cancelText","confirm","VanillaProvider","VanillaBooleanWidget","Widgets","VanillaTextWidget","VanillaTextAreaWidget","VanillaDateWidget","VanillaTimeWidget","VanillaDateTimeWidget","VanillaMultiSelectWidget","VanillaSelectWidget","VanillaNumberWidget","VanillaSliderWidget","ValueFieldWidget","ProximityOperator","Operators","mongoFormatOp1","mop","mc","_op","useExpr","valueType","opDef","operatorOptions","fieldDef","$field","startsWith","mv","mongoFormatOp2","mops","valueTypes","operators","equal","labelForFormat","sqlOp","spelOp","spelOps","reversedOp","formatOp","op","isForDisplay","opStr","mongoFormatOp","jsonLogic","elasticSearchQueryType","not_equal","isNotOp","less","less_or_equal","greater","greater_or_equal","like","escapeRegExp","_jsonLogicIsRevArgs","not_like","starts_with","ends_with","between","valFrom","first","valTo","spelFormatOp","validateValues","not_between","is_empty","sqlFormatOp","empty","sqlEmptyValue","mongoEmptyValue","is_not_empty","is_null","is_not_null","select_equals","select_not_equals","select_any_in","select_not_any_in","multiselect_equals","SqlString","jsonLogic2","vals","multiselect_not_equals","val1","val2","prox","aVal1","aVal2","some","filteredSize","all","fullSize","none","stringifyForDisplay","toString","conjunctions","AND","mongoConj","jsonLogicConj","sqlConj","spelConj","spelConjs","reversedConj","formatConj","conj","size","sqlFormatConj","spelFormatConj","omitBrackets","OR","text","jsType","formatValue","wgtDef","JSON","stringify","spelFormatValue","regex","spelEscape","sqlFormatValue","toJS","mongoFormatValue","textarea","number","isFloat","isInteger","valLabel","valsLabels","isCallable","res","spelFixList","date","dateFormat","useKeyboard","dateVal","toDate","isValid","time","timeFormat","elasticSearchFormatValue","queryType","fieldName","script","source","params","datetime","boolean","rightFieldDef","showSearch","case_value","spelImportValue","types","defaultOperator","mainWidget","opProps","defaultSettings","formatField","parts","formatSpelField","partsExt","ind","parent","isSpelVariable","sqlFormatReverse","q","spelFormatReverse","formatReverse","revOperatorDefinition","formatAggr","whereStr","aggrField","aggrFieldDef","cond","rightField","customFieldSelectProps","defaultSliderWidth","defaultSelectWidth","defaultSearchWidth","defaultMaxRows","VanillaFieldSelect","VanillaConjs","VanillaButton","VanillaButtonGroup","VanillaValueSources","vanillaConfirm","VanillaSwitch","renderOperator","renderConjs","renderSwitch","renderButton","renderButtonGroup","renderProvider","renderConfirm","renderSwitchPrefix","renderSize","canReorder","canRegroup","showLock","canDeleteLocked","canLeaveEmptyGroup","shouldCreateEmptyGroup","canShortMongoQuery","removeEmptyGroupsOnLoad","removeIncompleteRulesOnLoad","removeInvalidMultiSelectValuesOnLoad","groupActionsPosition","setOpOnChangeField","groupOperators","convertableWidgets","locale","fieldLabel","operatorLabel","operatorPlaceholder","lockLabel","lockedLabel","deleteLabel","addGroupLabel","addCaseLabel","addDefaultCaseLabel","defaultCaseLabel","addRuleLabel","addSubRuleLabel","delGroupLabel","removeRuleConfirmOptions","removeGroupConfirmOptions","defaultGroupConjunction","groupVarKey","altVarKey","lockedOp","nonCheckedIcon","CheckBoxOutlineBlank","fontSize","checkedIcon","CheckBox","defaultFilterOptions","createFilterOptions","emptyArray","selectedValue","groupBy","filterOptionsConfig","filterOptionsFn","useListValuesAutocomplete","debounceTimeout","open","onOpen","onClose","onInputChange","inputValue","isInitialLoading","isLoading","aPlaceholder","extendOptions","getOptionSelected","getOptionDisabled","getOptionLabel","showCheckboxes","rest","inputWidth","customAutocompleteProps","minWidth","useStyles","makeStyles","theme","classesChip","root","marginTop","marginBottom","useStylesChip","classes","FormControl","Autocomplete","disableCloseOnSelect","freeSolo","loading","readOnly","renderInput","TextField","InputProps","endAdornment","CircularProgress","color","renderTags","getTagProps","option","index","Chip","renderOption","specialValue","renderTitle","Checkbox","icon","marginRight","filterOptions","filtered","itemsToListValues","level","repeat","groupTitle","flat","Infinity","paper","padding","spacing","MaterialTextWidget","inputProps","MaterialTextAreaWidget","multiline","MaterialDateWidget","Picker","KeyboardDatePicker","DatePicker","formatSingleValue","MaterialDateTimeWidget","KeyboardDateTimePicker","DateTimePicker","dateTimeFormat","ampm","MaterialTimeWidget","KeyboardTimePicker","TimePicker","hasSeconds","indexOf","timeValue","views","MaterialSelectWidget","autoWidth","displayEmpty","renderValue","shift","getListValueTitle","MenuItem","MaterialNumberWidget","MaterialSliderWidget","marks","sliderValue","muiMarks","InputCmp","onBlur","SliderCmp","Slider","_e","newValue","valueLabelDisplay","stylesSliderWrapper","marginLeft","paddingLeft","alignItems","MaterialRangeWidget","useEffect","valueFrom","valueTo","setTimeout","oneValue","handleInputBlur","FromInputCmp","ToInputCmp","newValues","stylesInputWrapper","MaterialBooleanWidget","Typography","component","Grid","container","Switch","MaterialMultiSelectWidget","selectedValues","selectedTitles","ListItemText","primary","MaterialAutocompleteWidget","MaterialFieldSelect","findLabel","pop","ListSubheader","disableSticky","MaterialFieldAutocomplete","MaterialAutocomplete","_asyncValues","MaterialButton","typeToOnlyIcon","Delete","Add","typeToIcon","typeToColor","IconButton","Button","startIcon","MaterialButtonGroup","MaterialConjs","ButtonGroup","disableElevation","variant","MaterialSwitch","checkedLabel","hideLabel","showLabel","Lock","LockOpen","FormControlLabel","control","MaterialValueSources","React","anchorEl","setAnchorEl","handleClose","Boolean","event","currentTarget","handleOpen","ExpandMoreSharp","Popover","anchorOrigin","vertical","horizontal","transformOrigin","disablePortal","FormLabel","RadioGroup","Radio","MaterialConfirm","description","confirmationText","cancellationText","then","MaterialUseConfirm","MaterialProvider","settingsTheme","settingsLocale","themeConfig","material","createTheme","base","withProviders","M","utils","MomentUtils","ThemeProvider","MaterialWidgets","BasicConfig","asyncFetch","rangeslider","useLoadMore","useAsyncSearch","forceAsyncSearch","selectedAsyncListValues","staticListValues","knownSpecialValues","loadMoreTitle","loadingMoreTitle","setOpen","asyncFetchMeta","setAsyncFetchMeta","loadingCnt","setLoadingCnt","isLoadingMore","setIsLoadingMore","setInputValue","setAsyncListValues","asyncFectchCnt","componentIsMounted","isSelectedLoadMore","nSelectedAsyncListValues","listValuesToArray","mergeListValues","canInitialLoad","canLoadMore","hasMore","canShowLoadMore","listValueToOption","fetchListValues","isLoadMore","offset","pageSize","newAsyncFetchCnt","current","newMeta","nValues","assumeHasMore","realNewMeta","loadListValues","x","loadListValuesDebounced","debounce","find","newSelectedListValues","getListValue","customItem","newSelectedValues","newInputValue","onSearch","onDropdownVisibleChange","isSpecialValue","valueOrOption","ADD_GROUP","ADD_CASE_GROUP","REMOVE_GROUP","SET_CONJUNCTION","SET_NOT","ADD_RULE","REMOVE_RULE","SET_FIELD","SET_OPERATOR","SET_VALUE","SET_VALUE_SRC","SET_OPERATOR_OPTION","SET_LOCK","SET_TREE","MOVE_ITEM","PLACEMENT_AFTER","PLACEMENT_BEFORE","PLACEMENT_APPEND","PLACEMENT_PREPEND","SET_DRAG_PROGRESS","SET_DRAG_START","SET_DRAG_END","addNewGroup","state","groupUuid","properties","groupPath","canAddNewRule","isDefaultCase","origState","addItem","defaultGroupProperties","merge","setIn","expandTreePath","defaultRuleProperties","fixPathsInTree","removeGroup","removeItem","parentPath","slice","hasChildren","fixEmptyGroupsInTree","isEmptyTree","removeRule","parentOperator","parentOperatorConfig","hasGroupCountRule","isParentRuleGroup","isEmptyParentGroup","canLeaveEmpty","initialEmptyWhere","deleteIn","setLock","lock","removeIsLockedInTree","conjunction","_addChildren1","children1","reduce","it","id1","it1","defaultItemProperties","Error","currentNumber","maxNumber","maxNumberOfCases","maxNumberOfRules","maxNesting","rootType","isTernary","targetItem","caseGroup","take","childrenPath","targetChildren","targetChildrenSize","getTotalRulesCountInTree","canAdd","isLastDefaultCase","newChildren","newChildrenWithLast","mergeIn","moveItem","fromPath","toPath","placement","from","getItemByPath","sourcePath","sourceChildren","to","targetPath","constants","isSameParent","isSourceInsideTarget","deepEqual","toArray","isTargetInsideSource","sourceSubpathFromTarget","targetSubpathFromSource","newTargetChildren","newSourceChildren","updateIn","expandTreeSubpath","_oldChildren","withMutations","r","entries","itemId","set","newField","showErrorMessage","currentType","currentProperties","wasRuleGroup","newFieldConfig","isRuleGroup","isRuleGroupExt","mode","isChangeToAnotherType","currentOperator","currentOperatorOptions","lastOp","newOperator","availOps","getOperatorsForField","strategy","getFirstOperator","console","warn","getNewValueForFieldOp","canReuseValue","newValueSrc","newValueType","operatorCardinality","groupProperties","newValueError","newOperatorOptions","defaultOperatorOptions","setOperator","currentField","operatorConfig","isInternalValueChange","calculatedValueType","calculateValueType","validateValue","validateError","fixedValue","w","fieldWidgetDefinition","_","vs","jsValues","rangeValidateError","isLastEmpty","isLastError","tree","setOperatorOption","checkEmptyGroups","fieldConfig","emptyDrag","dragging","y","h","mousePos","dragStart","getActionMeta","action","actionTypesToIgnore","mapValues","applyToJS","affectedField","getField","setTree","addRule","ruleType","toImmutableList","addDefaultCaseGroup","addCaseGroup","addGroup","setDragProgress","setDragStart","setDragEnd","Query","shouldComponentUpdate","liteShouldComponentUpdate","nextValue","oldValidatedTree","validatedTree","_updateActions","getMemoizedTree","dispatch","actions","bindActionCreators","oldConfig","newTree","newConfig","immutableEqual","__lastAction","renderBuilder","__isInternalValueChange","Component","ConnectedQuery","connect","context","displayName","QueryContainer","prevValue","getMemoizedConfig","createConfigMemo","createValidationMemo","reducer","emptyTree","defaultRoot","emptyState","unset","actionMeta","treeStoreReducer","store","createStore","nextConfig","isConfigChanged","storeValue","getState","isTreeChanged","currentTree","setState","Promise","resolve","get_children","QueryWrapper","classNames","require","_isReorderingTree","createSortableContainer","Builder","CanMoveFn","_getEventTarget","__mocked_window","document","body","window","onDragStart","dom","treeEl","closest","_isUsingLegacyReactDomRender","isUsingLegacyReactDomRender","classList","add","groupPadding","treeElContainer","scrollTop","_getScrollParent","tmpAllGroups","_getDraggableNodeEl","_getPlaceholderNodeEl","querySelectorAll","anyGroup","getComputedStyle","getPropertyValue","offsetLeft","offsetTop","offsetWidth","offsetHeight","itemInfo","clientX","clientY","eventTarget","addEventListener","onDrag","onDragEnd","doHandleDrag","startDragging","startMousePos","__mock_dom","dragEl","plhEl","plX","getBoundingClientRect","left","scrollX","plY","top","scrollY","startX","startY","startClientX","startClientY","startScrollTop","pos","moved","handleDrag","preventDefault","remove","_cacheEls","removeEventListener","getFlatTree","nextState","prevState","should","pureShouldComponentUpdate","chs","_prevProps","_prevState","oldPlX","oldPlY","indexId","ignoreCache","el","contains","querySelector","els","getElementsByClassName","node","overflowY","scrollHeight","_isScrollable","parentNode","dragInfo","canMoveFn","dragRect","plhRect","hovRect","treeRect","moveInfo","dragId","dragDirs","hrz","vrt","bottom","hovCNodeEl","trgCoord","right","__mocked_hov_container","hovNodeEl","elementFromPoint","rootGroupContainer","firstChild","isGroup","hovNodeId","getAttribute","hovEl","doAppend","doPrepend","hovHeight","hovII","trgRect","trgEl","trgII","altII","hovInnerEl","hovEl2","hovRect2","hovHeight2","lev","isSamePos","dragLeftOffset","dragLev","Math","round","availMoves","altMoves","isToRoot","isToCase","prevCaseId","prev","caseId","nextCaseId","next","prevCase","nextCase","addCaseII","am","toII","fromCaseII","toCaseII","bestMode","filteredMoves","trg","collapsed","isInside","tmp","toParentII","canMove","levs","curLev","allLevs","closestDragLev","logger","move","fromII","canRegroupCases","canLeaveEmptyCase","newLev","isBeforeAfter","isPend","isLev1","isParentChange","isStructChange","isForbiddenStructChange","parentType","isLockedChange","isLocked","isLastFromCase","_height","newRulesInTargetCase","leafsCount","GroupOrRule","handleDraggerMouseDown","nodeId","wrapper","isDraggingTempo","isDraggingMe","otherProps","isTrueLocked","styles","cn","ref","Operator","selectedField","selectedOperator","pickBy","_opts","isOpSelected","ops","sort","a","b","OperatorWrapper","selectedFieldPartsLabels","showOperator","showOperatorLabel","selectedFieldWidgetConfig","operatorInlineLabel","Field","hideForSelect","FieldWrapper","classname","OperatorOptions","operatorDefinitions","optionsFactory","basicOptionsProps","optionsCmp","Rule","ConnectedRuleContainer","removeSelf","changed","isInDraggingTempo","hasError","reordableNodesCnt","totalRulesCnt","parentReordableNodesCnt","createRuleContainer","RuleContainer","Draggable","selectedFieldConfig","isSelectedGroup","isFieldAndOpSelected","selectedOperatorConfig","selectedOperatorHasOptions","hideOperator","showDragIcon","showWidget","showOperatorOptions","confirmOptions","doRemove","isEmptyCurrentRule","onCancel","immutableFieldsMode","immutableOpsMode","immutableValuesMode","opOpts","renderBeforeWidget","renderAfterWidget","renderRuleError","oneValueError","error","onMouseDown","immutableGroupsMode","Btn","canShrinkValue","BtnGrp","renderOperatorOptions","renderError","drag","renderDrag","renderLock","del","renderDel","Group","ConnectedGroupContainer","_selectedConjunction","selectedConjunction","_getConjunctionOptions","oldConjunction","currentNesting","allowFurtherNesting","isRoot","createGroupContainer","groupActionsPositionList","topLeft","topCenter","topRight","bottomLeft","bottomCenter","bottomRight","GroupActions","canAddGroup","canAddRule","canDeleteGroup","position","setLockSwitch","addRuleBtn","addGroupBtn","delGroupBtn","BasicGroup","childrenClassName","renderBeforeActions","BeforeActions","renderAfterActions","AfterActions","renderItem","isEmptyCurrentGroup","isEmpty","isEmptyGroup","isEmptyRule","group","rule","renderHeaderWrapper","renderChildrenWrapper","renderFooterWrapper","showConjs","isOneChild","renderChildren","isGroupTopPosition","renderHeader","renderActions","toList","Item","extraPropsForItem","reordableNodesCntForItem","totalRulesCntForItem","isParentLocked","_item","Conjs","GroupContainer","RuleGroupActions","RuleGroup","RuleGroupExtActions","RuleGroupExt","renderGroupField","SwitchGroupActions","canAddDefault","addCaseGroupBtn","addDefaultCaseGroupBtn","SwitchGroup","hasDefaultCase","c","totalCasesCnt","casesToReorder","cnt","getTotalReordableNodesCountInTree","CaseGroup","renderHeaderLeft","renderHeaderCenter","renderCondition","getProperties","toObject","result","typeMap","rule_group","rule_group_ext","switch_group","case_group","itemComponent","isRequired","ConnectedSortableContainer","SortableContainer","_updPath","Map","queryBuilderFormat","usedFields","formatItem","formatGroup","formatRule","currentChild","defaultConjunction","rules","condition","hasUndefinedValues","fieldType","typeConfig","formatFieldName","secondField","ruleQuery","jsonLogicFormat","errors","logic","data","ff","p","pdef","ret","conjunctionDefinition","toLowerCase","groupField","groupOperator","groupOperatorDefinition","formattedValue","formatItemValue","isGroup0","resultQuery","formattedField","count","var","formatLogic","isRev","iValueSrc","iValueType","iValue","oldUsedFields","fvalue","currentValue","cValue","completeValue","fieldWidgetDef","fv","operatorDef","formatFunc","formattedArgs","argConfig","argValue","argValueSrc","formattedArgVal","formattedArgsArr","funcName","isMethod","jsonLogicIsMethod","obj","parentFieldDef","parentFieldName","varName","jsonLogicVar","buildFnToFormatOp","formatteOp","isReverseArgs","rangeOps","eqOps","isObject","mongodbFormat","_mongodbFormat","returnErrors","parents","_not","_canWrapExpr","_fieldName","_value","hasParentRuleGroup","realParentPath","groupFieldName","groupFieldDef","canHaveEmptyChildren","f","canShort","acc","totalQuery","filterQuery","as","_f","fvUseExpr","wrapExpr","formatRightField","rightFieldDefinition","fieldPartsLabels","fieldFullLabel","mongoFunc","mongoArgsAsObject","argsCnt","lastArg","argAsyncListValues","mongoFormatFunc","sqlFormat","_sqlFormat","revOpDef","canFormatOp","canFormatRevOp","valFieldDefinition","sqlFunc","sqlFormatFunc","argsStr","spelFormat","_spelFormat","formatSwitch","formatCase","cases","filteredCases","isRuleGroupArray","isSpelArray","realGroupOperator","checkOp","isGroupOpRev","realGroupOperatorDefinition","getSize","groupValue","formatExpression","objectIsFirstArg","sop","realOp","expectedValueType","fieldPartsConfigs","getFieldPartsConfigs","formatFieldFn","fieldPartsMeta","cnf","parentCnf","isSpelMap","isSpelItemMap","spelFunc","spelFormatFunc","queryString","conjStr","aggrArgs","_operator","fop","returnArgs","revOperatorDef","cutParentField","fieldLabel2","funcValue","formattedArgsWithNames","argName","buildEsRule","opConfig","widgetConfig","parameters","textField","determineField","elasticSearchScript","geoPointString","coordsNumberArray","top_left","lat","lon","bottom_right","buildEsGeoPoint","gte","lte","dateTime","lt","gt","buildEsRangeParameters","buildEsWildcardParameters","buildRegexpParameters","buildParameters","bool","must_not","elasticSearchFormat","recursiveFxn","childrenArray","valueSeq","occurrence","combinator","determineOccurrence","resultFlat","buildEsGroup","getTree","immutableTree","light","children1AsArray","getLightTree","loadTree","serTree","isImmutableTree","isTree","jsTreeToImmutable","parse","checkTree","extendedConfig","extendConfig","validateTree","isValidTree","getTreeBadFields","fromJS","outValue","toOrderedMap","valueJs","child","arrayUniq","arr","Set","loadFromJsonLogic","logicTree","_loadFromJsonLogic","conv","buildConv","jsTree","convertFromLogic","wrapInDefaultConj","immTree","opKey","opk","conjKey","fk","varKeys","isJsonLogic","beforeErrorsCnt","isEmptyOp","convertField","convertFunc","convertVal","convertConj","convertOp","afterErrorsCnt","floor","m","s","setMilliseconds","setHours","setMinutes","setSeconds","toISOString","normalizeField","argsArr","opts","funcKeys","fc","jsonLogicImport","parsed","argKeys","complexFields","complexFieldsGroupAncestors","fromEntries","ancs","fp","usedRuleGroups","topLevelFieldsFilter","groupToId","groupAncestors","at","parentFieldParts","shallowEqual","gf","gfc","j","splice","wrapInDefaultConjRuleGroup","parseRule","arity","_parseRule","isRevArgs","opKeys","jlField","having","init","op2","parseRes","havingVals","canRev","convertedArgs","asyncListValuesArr","loadFromSpel","_loadFromSpel","spelStr","compiledExpression","convertedObj","compileRes","SpelExpressionEvaluator","_compiledExpression","convertCompiled","convertToTree","expr","parentExpr","getType","getChildren","selection","lastChild","isSize","methodName","isLength","sourceParts","isThis","itype","getRaw","getValue","flatizeTernary","functionName","qid","cls","isVar","_processTernaryChildren","tern","if_val","else_val","forEach","convertPath","isError","convertArg","spel","parentSpel","literalTypes","string","null","groupFieldParts","_groupField","fullParts","isVariable","isUnary","funcToOpMap","buildRule","dateString","timeString","buildCaseValueConcat","buildRuleGroup","groupFilter","groupFieldValue","groupOpRule","compareArgs","leftSource","rightSource","leftVal","rightVal","isBetweenNormal","isBetweenRev","isBetween","isNumbers","isSameSource","oneSpel","convertChildren","fieldObj","opArg","ws","buildSimpleSwitch","caseI","buildCase","sw","valProperties","buildCaseValProperties","_processConcatChildren","convertedChild","convVal","widgetDef","importCaseValue","normVal","normErrors","NOW","jsonLogicCustomOps","now","RELATIVE_DATETIME","dim","abs","date_add","replace","mainWidgetProps","plus","minus","day","week","month","year","LOWER","str","UPPER","LINEAR_REGRESSION","coef","bias","Utils","BasicUtils","Export","Import","simulateAsyncFetch","cPageSize","delay","search","ceil","currentOffset","newOffset","debug","sleep","toStart","old","newFiltered","av","merged","lv","configKeys","configStore","configId","pickConfig","findConfig","savedConfig","findExtended","extendAndStore","__configId","_fieldsCntByType","_funcsCntByType","typesConfig","_extendTypeConfig","_extendTypesConfig","__fieldNames","_extendFieldsConfig","_extendFuncArgsConfig","defineProperty","enumerable","writable","typeWidgetConfig","typeWidgetOperators","excludeOperators","mergeArraysSmart","subconfig","_extendFieldConfig","funcDef","tmpIsOptional","reverse","argDef","isOptional","excludeOperatorsForField","keysToPutInFieldSettings","normalizeListValues","_isFuncArg","excludeOperatorsForType","fieldWidgetConfig","shouldIncludeOperators","preferWidgets","addOperators","computedFieldName","computeFieldName","getFieldRawConfig","fieldsKey","subfieldsKey","targetFields","part","pathKey","fConfig","l","unshift","fieldStr","getFuncArgConfig","mergeWith","objValue","srcValue","_key","_object","_source","_stack","widgetOpProps","fieldWidgetOpProps","mergedOpConfig","valueFieldSettings","mergedConfig","defaultField","canGetFirst","parentRuleGroupPath","getFirstField","fieldOperators","fieldDefaultOperator","setDefaultFieldAndOp","conjs","defaultRule","trim","charAt","substring","escapeLike","any_start","any_end","escape","spelEscapeString","spelInlineList","javaType","jt","escapedVals","numberJavaTypes","numberToFloat","arrayToArray","isFinite","isNaN","spelFormatConcat","spelImportConcat","completeFuncValue","complValue","tmpHasOptional","filteredValueSources","filterValueSourcesForField","argDefaultValueSrc","completeArgValue","getDefaultArgValue","_checkFuncValue","firstValueSrc","_argConfig","_config","getReactRootNodeType","_reactRootContainer","getOwnPropertyNames","self","canUseUnsafe","UNSAFE_componentWillReceiveProps","componentWillReceiveProps","actionCreators","actionCreator","selectTypes","changedProp","canFix","isEndValue","currentValueSrc","currentValueType","currentAsyncListValues","clearValueOnChangeField","clearValueOnChangeOp","newOperatorConfig","currentFieldConfig","currentWidget","newWidget","currentValueWidget","newValueWidget","canReuseWidget","firstWidgetConfig","valueFixes","valueErrors","vType","vSrc","isValidSrc","fixValue","dropValue","_ignore","getFirstDefined","vt","parentPathArr","firstField","keysPath","fieldOps","onlyKeys","_curr","parentParts","_getWidgetsAndSrcsForFieldOp","widgetValueSrc","canAddValueSrc","widgetWeight","wg","w1","w2","minCnt","filteredValueSrcs","tableName","fieldPartsCopy","_default","n","useWordBoundary","subString","substr","lastIndexOf","v1","v2","equals","deep","shallowEqualArrays","shallowEqualObjects","arrA","arrB","len","isEqual","objA","objB","aKeys","bKeys","listValue","listValuesObj","listValuesArr","getItemInListValues","mapFn","defaultTreeDataMap","pId","rootPId","getPathInListValues","tdm","parentId","getChildrenInListValues","isMulti","treeData","treeSelectOnlyLeafs","childrenValues","selectable","extendTreeData","rind","_flatize","childrenCount","flatizeTreeData","removePrefixPath","isPrefix","isImmutable","arr1","arr2","orig","after","before","newOp","rel","relOp","isDev","process","devMode","verbose","log","getLogger","suffix","interpose","skip","apply","removePathsInTree","_processNode","itemPath","removeIn","_childId","currPath","currId","constructor","childId","allChildrenGone","curr","realHeight","_flatizeTree","insideCollapsed","insideLocked","insideRuleGroup","childrenIds","_child","isLeaf","itemsBefore","leaf","_top","itemsAfter","subinfo","prevId","nextId","badFields","getSwitchValues","caseValue","query_builder_seed","timePart","getTime","random","isTypeOf","typeOf","originalTree","validateAndFixTree","_oldTree","removeEmptyGroups","removeIncompleteRules","validateItem","oldChildren","sanitized","submeta","validateGroup","oldSerialized","newSerialized","isComplete","validateRule","isRawValue","validError","validateFieldValue","validateFuncValue","validateNormalValue","validResult","validateValueInList","List","goodVals","badVals","vv","goodValues","badValues","plural","wConfig","wType","_valueSrc","leftFieldStr","rightFieldStr","argValidError","fixedArgVal","webpackContext","req","webpackContextResolve","__webpack_require__","code","module","exports"],"sourceRoot":""}