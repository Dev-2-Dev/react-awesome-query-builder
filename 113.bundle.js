(self.webpackChunkreact_awesome_query_builder_demo_local=self.webpackChunkreact_awesome_query_builder_demo_local||[]).push([[113],{70328:(e,t,r)=>{"use strict";r.d(t,{q:()=>g});var n=r(25773),o=r(22951),i=r(91976),a=r(67591),l=r(99492),u=r(27597),s=r(27378),c=r(23615),p=r.n(c),d=r(4215),f=r.n(d);var g=function(e){(0,a.Z)(p,e);var t,r,c=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var o=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function p(){var e;(0,o.Z)(this,p);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.call.apply(c,[this].concat(r))).handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return(0,i.Z)(p,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,o=e.config,i=e.optionLabel,a=e.optionPlaceholder,l=e.customProps,u=e.minProximity,c=e.maxProximity,p=e.optionTextBefore,d=e.readonly,g=o.settings,v=o.widgets,h=t?t.proximity:void 0,m=g.showLabels,y=r.get("proximity",h),b=f()(u,c+1).map((function(e){return{title:e,value:e}})),O=v.select.factory;return s.createElement("div",{className:"operator--PROXIMITY"},s.createElement("div",{className:"operator--options"},m&&s.createElement("label",{className:"rule--label"},i),!m&&p&&s.createElement("div",{className:"operator--options--sep"},s.createElement("span",null,p)),s.createElement(O,(0,n.Z)({config:o,value:y,listValues:b,setValue:this.handleChange,readonly:d,placeholder:a},l))),s.createElement("div",{className:"operator--widgets"},this.props.children))}}]),p}(s.PureComponent);g.propTypes={config:p().object.isRequired,setOption:p().func.isRequired,options:p().any.isRequired,minProximity:p().number,maxProximity:p().number,optionPlaceholder:p().string,optionTextBefore:p().string,optionLabel:p().string,customProps:p().object,readonly:p().bool},g.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null}},24900:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var n=r(25773),o=r(22951),i=r(91976),a=r(47169),l=r(67591),u=r(99492),s=r(27597),c=r(27378),p=r(23615),d=r.n(p),f=r(4215),g=r.n(f),v=r(64779),h=r(46752),m=r(30888),y=r(93168),b=r(14648),O=r.n(b),j=r(90046),F=r.n(j),w=r(53782),S=["factory"];const C=function(e){var t=e.delta,r=e.isFuncArg,n=(e.valueSrc,e.value),o=e.valueError,i=e.asyncListValues,a=e.isSpecialRange,l=e.fieldDefinition,u=(e.widget,e.widgetDefinition),s=e.widgetValueLabel,c=e.valueLabels,p=e.textSeparators,d=e.setValueHandler,f=e.config,g=e.field,v=e.operator,h=e.readonly,y=e.parentField,b=e.parentFuncs,O=e.id,j=e.groupId,F=u.factory,C=(0,w.Z)(u,S),E=r&&l.valueSources&&1==l.valueSources.length&&"const"==l.valueSources[0],k=l.defaultValue;if(!F)return"?";var P=a?[n.get(0),n.get(1)]:n?n.get(t):void 0,L=o&&(a?[o.get(0),o.get(1)]:o.get(t))||null;a&&void 0===P[0]&&void 0===P[1]&&(P=void 0);var Z=(l||{}).fieldSettings,_=Object.assign({},C,Z,{config:f,field:g,parentField:y,parentFuncs:b,fieldDefinition:l,operator:v,delta:t,isSpecialRange:a,isFuncArg:r,value:P,valueError:L,label:s.label,placeholder:s.placeholder,placeholders:c?c.placeholder:null,textSeparators:p,setValue:d,readonly:h,asyncListValues:i,id:O,groupId:j});return E&&k?"boolean"==typeof k?k?_.labelYes||"YES":_.labelNo||"NO":Z.listValues?Array.isArray(k)?k.map((function(e){return(0,m.w1)(Z.listValues,e)||e})).join(", "):(0,m.w1)(Z.listValues,k)||k:""+k:F(_)};var E=r(67103);var k={cardinality:1},P=function(e){(0,l.Z)(d,e);var t,r,p=(t=d,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var o=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function d(e){var t;return(0,o.Z)(this,d),(t=p.call(this,e))._setValue=function(e,r,n,o,i,a){if(e&&Array.isArray(o)){var l=[t.props.value.get(0),t.props.value.get(1)];l[0]!=o[0]&&t.props.setValue(0,o[0],n,i,a),l[1]!=o[1]&&t.props.setValue(1,o[1],n,i,a)}else t.props.setValue(r,o,n,i,a)},t._onChangeValueSrc=function(e,r){t.props.setValueSrc(e,r)},t.renderWidget=function(e,t,r){var o=r.config,i=r.isFuncArg,a=r.leftField,l=r.operator,u=r.value,s=r.valueError,p=r.readonly,d=r.parentField,f=r.parentFuncs,g=r.id,v=r.groupId,h=o.settings,m=t.widgets,y=t.iValues,b=t.aField,j=i?y:u,F=i?a:b,w=m[e],S=w.valueSrc,E=w.valueLabel,k=h.showLabels?c.createElement("label",{className:"rule--label"},E.label):null;return c.createElement("div",{key:"widget-"+F+"-"+e,className:"widget--widget"},"func"==S?null:k,c.createElement(C,(0,n.Z)({id:g,groupId:v,valueSrc:S,delta:e,value:j,valueError:s,isFuncArg:i},O()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),O()(m[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValueHandler"]),{config:o,field:F,parentField:d,parentFuncs:f,operator:l,readonly:p})))},t.renderValueSources=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,a=r.operator,l=r.readonly,u=n.settings,s=t.valueSources,p=t.widgets,d=t.aField,f=o?i:d,g=p[e],v=g.valueSrc,h=g.setValueSrcHandler,m=u.valueSourcesInfo,y=u.renderValueSources,b=s.map((function(e){return[e,{label:m[e].label}]})),O=u.showLabels?c.createElement("label",{className:"rule--label"}," "):null;return s.length>1&&!l&&c.createElement("div",{key:"valuesrc-"+f+"-"+e,className:"widget--valuesrc"},O,c.createElement(y,{key:"valuesrc-"+e,delta:e,valueSources:b,valueSrc:v,config:n,field:f,operator:a,setValueSrc:h,readonly:l,title:u.valueSourcesPopupTitle}))},t.renderSep=function(e,t,r){var n=r.config,o=t.widgets,i=n.settings,a=o[e].sepText,l=i.showLabels?c.createElement("label",{className:"rule--label"}," "):null;return a&&c.createElement("div",{key:"widget-separators-"+e,className:"widget--sep"},l,c.createElement("span",null,a))},t.renderWidgetDelta=function(e){return[t.renderSep(e,t.meta,t.props),t.renderValueSources(e,t.meta,t.props),t.renderWidget(e,t.meta,t.props)]},(0,y.EM)((0,a.Z)(t)),t.onPropsChanged(e),t}return(0,i.Z)(d,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","fieldFunc","fieldArg","leftField","operator","valueSrc","isFuncArg","asyncListValues"].map((function(r){return e[r]!==t[r]||"isFuncArg"==r&&e.isFuncArg&&e.value!==t.value})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=this,r=e.config,n=e.field,o=e.fieldFunc,i=e.fieldArg,a=e.operator,l=e.valueSrc,u=e.value,s=e.isForRuleGruop,c=e.isCaseValue,p=e.isFuncArg,d=e.leftField,f=e.asyncListValues,y=p?{func:o,arg:i}:n,b=l,O=u;(p||s||c)&&(b=F().List([l]),O=F().List([u]));var j=(0,v.getFieldConfig)(r,y),w=(0,h.wg)(r,y,a),S=((0,h.CD)(r,y,a),p?k:(0,v.getOperatorConfig)(r,a,y));if((null==j||null==S)&&!c)return null;var C=null==S?void 0:S.isSpecialRange,E=C&&("field"==b.get(0)||"field"==b.get(1)),P=C&&!E,L=P?1:(0,m.LS)(null==S?void 0:S.cardinality,1);if(0===L)return null;var Z=(0,h.eI)(r,y,a,j,p?d:null),_=g()(0,L).map((function(e){var n,o=b.get(e)||null,i=(0,h.wg)(r,y,a,o),l=(0,v.getFieldWidgetConfig)(r,y,a,i,o);E&&(i=l.singleWidget,l=(0,v.getFieldWidgetConfig)(r,y,a,i,o));var u=null===(n=l)||void 0===n?void 0:n.type,s=(0,h.gk)(r,y,a,e,o,P),c=(0,h.gk)(r,y,a,e,null,P),p=null!=S&&S.textSeparators?null==S?void 0:S.textSeparators[e]:null,d=t._onChangeValueSrc.bind(t,e),f=null,g=null;return C&&(f={placeholder:[(f=[(0,h.gk)(r,y,a,0),(0,h.gk)(r,y,a,1)])[0].placeholder,f[1].placeholder],label:[f[0].label,f[1].label]},g=null==S?void 0:S.textSeparators),{valueSrc:o,valueLabel:s,widget:i,sepText:p,setValueSrcHandler:d,widgetDefinition:l,widgetValueLabel:c,valueLabels:f,textSeparators:g,setValueHandler:t._setValue.bind(t,C,e,u)}}));return{defaultWidget:w,fieldDefinition:j,operatorDefinition:S,isSpecialRange:P,cardinality:L,valueSources:Z,widgets:_,iValues:O,aField:y,asyncListValues:f}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality;if(!t)return null;var n=t;return c.createElement(E.JX,{className:"rule--widget rule--widget--".concat(n.toUpperCase()),key:"widget-col-"+n},g()(0,r).map(this.renderWidgetDelta))}}]),d}(c.PureComponent);P.propTypes={config:d().object.isRequired,value:d().any,valueSrc:d().any,valueError:d().any,field:d().string,operator:d().string,readonly:d().bool,asyncListValues:d().array,id:d().string,groupId:d().string,setValue:d().func,setValueSrc:d().func,isFuncArg:d().bool,fieldFunc:d().string,fieldArg:d().string,leftField:d().string,isForRuleGruop:d().bool,parentField:d().string,parentFuncs:d().array,isCaseValue:d().bool}},67103:(e,t,r)=>{"use strict";r.d(t,{JX:()=>l,Vn:()=>s,ig:()=>u,rB:()=>c});var n=r(25773),o=r(53782),i=r(27378),a=["children"],l=function(e){var t=e.children,r=(0,o.Z)(e,a);return i.createElement("div",r,t)},u=function(){},s=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},c=function(e){return function(t){var r=t.config.settings.useConfirm,o=r?r():null;return i.createElement(e,(0,n.Z)({},t,{confirmFn:o}))}}},26333:(e,t,r)=>{"use strict";r.d(t,{Zr:()=>V,rk:()=>S,yK:()=>x,TD:()=>Q,hO:()=>ee,P9:()=>X,DI:()=>W,f5:()=>B,E$:()=>K,$g:()=>$,Bz:()=>U,lU:()=>oe,eI:()=>H,OH:()=>Y,pm:()=>re,Cq:()=>A,_w:()=>I,MY:()=>G,H_:()=>te,kB:()=>ne});var n=r(64649),o=r(22951),i=r(91976),a=r(47169),l=r(67591),u=r(99492),s=r(27597),c=r(27378),p=r(23615),d=r.n(p),f=r(64779),g=r(46752),v=r(30888),h=r(93168),m=r(31159),y=r.n(m),b=r(50098),O=r.n(b),j=r(43023),F=r.n(j);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var S=function(e){(0,l.Z)(p,e);var t,r,c=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var o=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function p(e){var t;return(0,o.Z)(this,p),t=c.call(this,e),(0,h.EM)((0,a.Z)(t)),t.onPropsChanged(e),t}return(0,i.Z)(p,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.operator,o=e.parentField,i=e.isFuncArg,a=e.fieldDefinition,l=t.settings.canCompareFieldWithField,u=t.settings.fieldSeparator,s="string"==typeof o?o.split(u):o,c=o?(0,f.getFieldConfig)(t,o):null,p=o?c&&c.subfields:t.fields,d=this.filterFields(t,p,r,o,s,n,l,i,a);return this.buildOptions(s,t,d,s)}},{key:"getMeta",value:function(e){var t=e.config,r=e.field,n=(e.operator,e.value),o=e.placeholder,i=e.isFuncArg,a=e.parentField,l=t.settings,u=l.fieldPlaceholder,s=l.fieldSeparatorDisplay,c=n,p=!!n,d=(0,f.getFieldConfig)(t,r).widgets.field,v=d&&d.widgetProps||{},h=p?null:i&&o||v.valuePlaceholder||u,m=p?(0,f.getFieldConfig)(t,c):null,y=m||{},b=(0,g.rA)(c,t),O=(0,g.rA)(c,t,!0),j=this.getFieldLabel(m,c,t),F=(0,g.fY)(c,t),w=F?F.join(s):null;return(w==j||a)&&(w=null),{placeholder:h,selectedKey:c,selectedKeys:b,selectedPath:O,selectedLabel:j,selectedOpts:y,selectedAltLabel:y.label2,selectedFullLabel:w}}},{key:"filterFields",value:function(e,t,r,n,o,i,a,l,u){t=F()(t);var s,c=e.settings.fieldSeparator,p=(0,f.getFieldConfig)(e,r),d=(0,g.wg)(e,r,i,"value");if(l&&u)s=u.type;else if(d){var v=e.widgets[d].type;s=v}else s=p.type;return function t(n,o){for(var u in n){var d=n[u].subfields,g=(o||[]).concat(u),v=g.join(c),h=(0,f.getFieldConfig)(e,v);if(h)if("!struct"==h.type||"!group"==h.type)0==t(d,g)&&delete n[u];else{var m=h.type==s&&(!!l||v!=r),y=a||e.settings.canCompareFieldWithField;y&&(m=m&&y(r,p,v,h,i)),m||delete n[u]}else delete n[u]}return O()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var a=t.settings,l=a.fieldSeparator,u=a.fieldSeparatorDisplay,s=o?o.join(l)+l:"";return O()(r).map((function(a){var l=r[a],c=n.getFieldLabel(l,a,t),p=(0,g.fY)(a,t).join(u);(p==c||e)&&(p=null);var d=l.label2,f=l.tooltip,v=(o||[]).concat(a);if(!l.hideForCompare)return"!struct"==l.type||"!group"==l.type?{key:a,path:s+a,label:c,fullLabel:p,altLabel:d,tooltip:f,items:n.buildOptions(e,t,l.subfields,v,c)}:{key:a,path:s+a,label:c,fullLabel:p,altLabel:d,tooltip:f,grouplabel:i}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.fieldSeparator,o=r.settings.maxLabelsLength,i=Array.isArray(t)?t:t.split(n),a=e.label||y()(i);return(0,v.aS)(a,o)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,o=e.setValue,i=e.readonly,a=e.id,l=e.groupId,u=t.settings.renderField,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,setField:o,readonly:i,items:this.items,id:a,groupId:l},this.meta);return u(s)}}]),p}(c.PureComponent);S.propTypes={id:d().string,groupId:d().string,setValue:d().func.isRequired,config:d().object.isRequired,field:d().string.isRequired,value:d().string,operator:d().string,customProps:d().object,readonly:d().bool,parentField:d().string,fieldDefinition:d().object,isFuncArg:d().bool};var C=r(25773),E=r(649),k=r(11026);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var L=function(e){(0,l.Z)(p,e);var t,r,c=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var o=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function p(e){var t;return(0,o.Z)(this,p),t=c.call(this,e),(0,h.EM)((0,a.Z)(t)),t.onPropsChanged(e),t}return(0,i.Z)(p,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","operator","isFuncArg"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","value"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.operator,o=e.parentFuncs,i=e.fieldDefinition,a=e.isFuncArg,l=t.settings.canUseFuncForField,u=this.filterFuncs(t,t.funcs,r,n,l,o,a,i);return this.buildOptions(t,u)}},{key:"getMeta",value:function(e){var t=e.config,r=e.field,n=e.value,o=t.settings,i=o.funcPlaceholder,a=o.fieldSeparatorDisplay,l=n,u=!!n,s=(0,f.getFieldConfig)(t,r).widgets.field,c=(s&&s.widgetProps,u?null:i),p=u?(0,f.getFuncConfig)(t,l):null,d=p||{},v=(0,g.rA)(l,t),h=(0,g.rA)(l,t,!0),m=this.getFuncLabel(p,l,t),y=(0,g.lC)(l,t),b=y?y.join(a):null;return b==m&&(b=null),{placeholder:c,selectedKey:l,selectedKeys:v,selectedPath:h,selectedLabel:m,selectedOpts:d,selectedFullLabel:b}}},{key:"filterFuncs",value:function(e,t,r,n,o,i,a,l){t=F()(t);var u,s=e.settings.fieldSeparator,c=(0,f.getFieldConfig)(e,r),p=c,d=(0,g.wg)(e,r,n,"value");if(a&&l)p=l,u=l.type;else if(d){var v=e.widgets[d].type;u=v}else u=c.type;return function t(a,l){for(var d in a){var g=a[d].subfields,v=(l||[]).concat(d),h=v.join(s),m=(0,f.getFuncConfig)(e,h);if("!struct"==m.type)0==t(g,v)&&delete a[d];else{var y=m.returnType==u;p.funcs&&(y=y&&p.funcs.includes(h)),o&&(y=y&&o(r,c,h,m,n)),!m.allowSelfNesting&&i&&i.map((function(e){var t=(0,k.Z)(e,2),r=t[0];return t[1],r})).includes(h)&&(y=!1),y||delete a[d]}}return O()(a).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!t)return null;var i=e.settings,a=i.fieldSeparator,l=i.fieldSeparatorDisplay,u=n?n.join(a)+a:"";return O()(t).map((function(i){var a=t[i],s=r.getFuncLabel(a,i,e),c=(0,g.lC)(i,e).join(l);c==s&&(c=null);var p=a.tooltip,d=(n||[]).concat(i);return"!struct"==a.type?{key:i,path:u+i,label:s,fullLabel:c,tooltip:p,items:r.buildOptions(e,a.subfields,d,s)}:{key:i,path:u+i,label:s,fullLabel:c,tooltip:p,grouplabel:o}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.fieldSeparator,o=r.settings.maxLabelsLength,i=Array.isArray(t)?t:t.split(n),a=e.label||y()(i);return(0,v.aS)(a,o)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,o=e.setValue,i=e.readonly,a=e.id,l=e.groupId,u=t.settings.renderFunc,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:i,setField:o,items:this.items,id:a,groupId:l},this.meta);return u(s)}}]),p}(c.PureComponent);L.propTypes={id:d().string,groupId:d().string,config:d().object.isRequired,field:d().string.isRequired,operator:d().string,customProps:d().object,value:d().string,setValue:d().func.isRequired,readonly:d().bool,parentFuncs:d().array,fieldDefinition:d().object,isFuncArg:d().bool};var Z=r(24900),_=r(67103),R=r(86893);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var o=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var V=function(e){(0,l.Z)(r,e);var t=T(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).setFunc=function(e){n.props.setValue((0,R.hq)(n.props.value,e,n.props.config))},n.setArgValue=function(e,t){var r=n.props.config,o=n.meta.funcDefinition.args[e];n.props.setValue((0,R.K9)(n.props.value,e,t,o,r))},n.setArgValueSrc=function(e,t){var r=n.props.config,o=n.meta.funcDefinition.args[e];n.props.setValue((0,R.z7)(n.props.value,e,t,o,r))},n.renderFuncSelect=function(){var e=n.props,t=e.config,r=e.field,o=e.operator,i=e.customProps,a=e.value,l=e.readonly,u=e.parentFuncs,s=e.id,p=e.groupId,d=e.isFuncArg,f=e.fieldDefinition,g={value:a?a.get("func"):null,setValue:n.setFunc,config:t,field:r,operator:o,customProps:i,readonly:l,parentFuncs:u,isFuncArg:d,fieldDefinition:f,id:s,groupId:p},v=t.settings,h=v.showLabels,m=v.funcLabel,y=h?c.createElement("label",{className:"rule--label"},m):null;return c.createElement(_.JX,{key:"func",className:"rule--func"},y,c.createElement(L,g))},n.renderArgLabel=function(e,t){var r=t.valueSources,o=t.type,i=t.showPrefix,a=t.label,l=n.props.config,u=r&&1==r.length&&"const"==r[0];return l.settings.showLabels||"boolean"!=o&&!u||!i?null:c.createElement(_.JX,{className:"rule--func--arg-label"},a||e)},n.renderArgLabelSep=function(e,t){var r=t.valueSources,o=t.type,i=t.showPrefix,a=n.props.config,l=r&&1==r.length&&"const"==r[0];return a.settings.showLabels||"boolean"!=o&&!l||!i?null:c.createElement(_.JX,{className:"rule--func--arg-label-sep"},":")},n.renderArgVal=function(e,t,r){var o=n.props,i=o.config,a=o.field,l=(o.operator,o.value),u=o.readonly,s=o.parentFuncs,p=o.id,d=o.groupId,f=l?l.getIn(["args",t]):null,g=f?f.get("value"):void 0,v=1==r.valueSources.length?r.valueSources[0]:void 0,h={config:i,fieldFunc:e,fieldArg:t,leftField:a,operator:null,value:g,valueSrc:f?f.get("valueSrc")||v||"value":v,setValue:n.setArgValue,setValueSrc:n.setArgValueSrc,funcKey:e,argKey:t,argDefinition:r,readonly:u,parentFuncs:s,id:p,groupId:d};return c.createElement(_.JX,{className:"rule--func--arg-value"},c.createElement(N,h))},n.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?c.createElement(_.JX,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},n.renderBracketBefore=function(e){var t=e.renderBrackets;return c.createElement(_.JX,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},n.renderBracketAfter=function(e){var t=e.renderBrackets;return c.createElement(_.JX,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},n.renderFuncArgs=function(){var e=n.meta,t=e.funcDefinition,r=e.funcKey;if(!r)return null;var o=t.args;return o?c.createElement(c.Fragment,null,n.renderBracketBefore(t),c.createElement(_.JX,{key:"args",className:"rule--func--args"},Object.keys(o).map((function(e,i){return c.createElement(_.JX,{key:"arg-".concat(e,"-").concat(i),className:"rule--func--arg"},n.renderArgSep(e,o[e],i,t),n.renderArgLabel(e,o[e]),n.renderArgLabelSep(e,o[e]),n.renderArgVal(r,e,o[e]))}))),n.renderBracketAfter(t)):null},(0,h.EM)((0,a.Z)(n)),n.onPropsChanged(e),n}return(0,i.Z)(r,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.config,r=(e.field,e.operator,e.value),n=r?r.get("func"):null;return{funcDefinition:n?(0,f.getFuncConfig)(t,n):null,funcKey:n}}},{key:"render",value:function(){return c.createElement(_.JX,{className:"rule--func--wrapper"},this.renderFuncSelect(),this.renderFuncArgs())}}]),r}(c.PureComponent);V.propTypes={id:d().string,groupId:d().string,config:d().object.isRequired,field:d().string.isRequired,operator:d().string,customProps:d().object,value:d().object,setValue:d().func.isRequired,readonly:d().bool,parentFuncs:d().array,fieldDefinition:d().object,isFuncArg:d().bool};var N=function(e){(0,l.Z)(r,e);var t=T(r);function r(){var e;(0,o.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).setValue=function(t,r,n){var o=e.props;(0,o.setValue)(o.argKey,r)},e.setValueSrc=function(t,r,n){var o=e.props;(0,o.setValueSrc)(o.argKey,r)},e}return(0,i.Z)(r,[{key:"render",value:function(){var e=this.props,t=e.funcKey,r=e.argKey,n=e.parentFuncs;return c.createElement(Z.Z,(0,C.Z)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:[].concat((0,E.Z)(n||[]),[[t,r]])}))}}]),r}(c.PureComponent);N.propTypes={funcKey:d().string.isRequired,argKey:d().string.isRequired,setValue:d().func.isRequired,setValueSrc:d().func.isRequired,readonly:d().bool,parentFuncs:d().array,id:d().string,groupId:d().string};var D=r(4229);const x=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,i=e.readonly,a=e.customProps,l=void 0===a?{}:a,u=l.radioYes||{},s=l.radioNo||{},p=function(e){return r("true"==e.target.value)},d=(0,D.Z)(),f=(0,D.Z)();return c.createElement(c.Fragment,null,c.createElement("input",(0,C.Z)({key:d,type:"radio",id:d,value:!0,checked:!!t,disabled:i,onChange:p},u)),c.createElement("label",{style:{display:"inline"},key:d+"label",htmlFor:d},n),c.createElement("input",(0,C.Z)({key:f,type:"radio",id:f,value:!1,checked:!t,disabled:i,onChange:p},s)),c.createElement("label",{style:{display:"inline"},key:f+"label",htmlFor:f},o))},I=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=e.customProps,l=t||"";return c.createElement("input",(0,C.Z)({type:"text",value:l,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i},a))},A=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=(e.maxRows,e.fullWidth),l=e.customProps,u=t||"";return c.createElement("textarea",(0,C.Z)({value:u,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i,style:{width:a?"100%":void 0}},l))};var q=r(61320),M=r.n(q);const B=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return c.createElement("input",(0,C.Z)({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},G=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return c.createElement("input",(0,C.Z)({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},W=function(e){var t,r=e.value,n=e.setValue,o=(e.config,e.valueFormat),i=(e.use12Hours,e.readonly),a=e.customProps;return t=r?M()(r).format("YYYY-MM-DDTHH:mm"):"",c.createElement("input",(0,C.Z)({type:"datetime-local",value:t,disabled:i,onChange:function(e){var t=e.target.value;t=""==t?void 0:M()(new Date(t)).format(o),n(t)}},a))};var z=r(48159),J=r.n(z);const $=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps;return c.createElement("select",(0,C.Z)({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},J()(i,["showSearch","input","showCheckboxes"])),(0,v.mi)(t,(function(e){var t=e.title,r=e.value;return c.createElement("option",{key:r,value:r},t)})))},H=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps,a=null!=r;return c.createElement("select",(0,C.Z)({onChange:function(e){return n(e.target.value)},value:a?r:"",disabled:o},J()(i,["showSearch","input"])),!a&&c.createElement("option",{disabled:!0,value:""}),(0,v.mi)(t,(function(e){var t=e.title,r=e.value;return c.createElement("option",{key:r,value:r},t)})))},U=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,l=e.placeholder,u=e.customProps,s=null==t?"":t;return c.createElement("input",(0,C.Z)({type:"number",value:s,placeholder:l,disabled:n,min:o,max:i,step:a,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},u))},Y=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,l=e.placeholder,u=e.customProps,s=void 0===u?{}:u,p=s.input||{},d=s.slider||s,f=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},g=null==t?"":t;return[c.createElement("input",(0,C.Z)({key:"number",type:"number",value:g,placeholder:l,disabled:n,min:o,max:i,step:a,onChange:f},p)),c.createElement("input",(0,C.Z)({key:"range",type:"range",value:g,disabled:n,min:o,max:i,step:a,onChange:f},d))]},K=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=null!=n;return c.createElement("select",{onChange:function(e){return r(e.target.value)},value:i?n:"",disabled:o},!i&&c.createElement("option",{disabled:!0,value:""}),function e(t){return t.map((function(t){var r=t.items,n=t.path,o=t.label,i=t.disabled;return r?c.createElement("optgroup",{disabled:i,key:n,label:o},e(r)):c.createElement("option",{disabled:i,key:n,value:n},o)}))}(t))},X=function(e){var t,r=e.id,n=e.not,o=e.setNot,i=e.conjunctionOptions,a=e.setConjunction,l=e.disabled,u=e.readonly,s=e.config,p=e.showNot,d=e.notLabel,f=Object.keys(i).length,g=l,v=s.settings.forceShowConj||f>1&&!g,h=function(e){return a(e.target.value)};return[p&&(t="not",[c.createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:u,onChange:function(e){return o(e.target.checked)}}),c.createElement("label",{key:r+t+"label",htmlFor:r+t},d||"NOT")]),v&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=t.name,o=t.label,s=t.checked,p=a.isDummyFn?"__dummy":"";return!u&&!l||s?[c.createElement("input",{key:r+p,type:"radio",id:r+p,name:n+p,checked:s,disabled:u||l,value:e,onChange:h}),c.createElement("label",{key:r+p+"label",htmlFor:r+p},o)]:null}))]},Q=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=(e.config,r||{addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"}[t]);return c.createElement("button",{onClick:n,type:"button",disabled:o},i)},ee=function(e){var t=e.children;return e.config,c.createElement(c.Fragment,null,t)},te=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return c.createElement("select",{onChange:function(e){return n(e.target.value)},value:r,disabled:o},function(e){return e.map((function(e){var t=(0,k.Z)(e,2),r=t[0],n=t[1];return c.createElement("option",{key:r,value:r},n.label)}))}(t))},re=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,i=(e.config,e.type);return[c.createElement("input",{key:o+i,type:"checkbox",id:o+i,checked:!!t,onChange:function(e){return r(e.target.checked)}}),c.createElement("label",{key:o+i+"label",htmlFor:o+i},n)]},ne=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var oe=function(e){return e.config,e.children}},16930:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>_,v2:()=>Z});var n=r(64649),o=r(27378),i=r(26333),a=r(70328),l=r(75144),u=r(30888),s=r(61320),c=r.n(s),p=r(37991);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=i.yK,v=i._w,h=i.Cq,m=i.f5,y=i.MY,b=i.DI,O=i.$g,j=i.eI,F=i.Bz,w=i.OH,S=i.rk,C=i.Zr,E=a.q,k=function(e,t,r,o,i,a,l,u,s,c,p,d){var f="string"!=typeof o||o.startsWith("$")?o:"$"+o,g=t(a,d);if(void 0!==g)return r?l||e&&"$eq"!=e?l?{$not:(0,n.Z)({},e,[f,g])}:(0,n.Z)({},o,{$not:(0,n.Z)({},e,g)}):(0,n.Z)({},o,{$ne:g}):l||e&&"$eq"!=e?l?(0,n.Z)({},e,[f,g]):(0,n.Z)({},o,(0,n.Z)({},e,g)):(0,n.Z)({},o,g)},P=function(e,t,r,o,i,a,l,u,s,c,p){var d,f,g="string"!=typeof r||r.startsWith("$")?r:"$"+r;return t?a?{$not:{$and:[(0,n.Z)({},e[0],[g,i[0]]),(0,n.Z)({},e[1],[g,i[1]])]}}:(0,n.Z)({},r,{$not:(d={},(0,n.Z)(d,e[0],i[0]),(0,n.Z)(d,e[1],i[1]),d)}):a?{$and:[(0,n.Z)({},e[0],[g,i[0]]),(0,n.Z)({},e[1],[g,i[1]])]}:(0,n.Z)({},r,(f={},(0,n.Z)(f,e[0],i[0]),(0,n.Z)(f,e[1],i[1]),f))},L={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,i,a,l,u){var s=l?"=":i.label;return"boolean"==o&&l?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(s," ").concat(r)},mongoFormatOp:k.bind(null,"$eq",(function(e){return e}),!1),jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,i,a,l,u){return"boolean"==o&&l?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(i.label," ").concat(r)},mongoFormatOp:k.bind(null,"$ne",(function(e){return e}),!1),jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:k.bind(null,"$lt",(function(e){return e}),!1),jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:k.bind(null,"$lte",(function(e){return e}),!1),jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:k.bind(null,"$gt",(function(e){return e}),!1),jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:k.bind(null,"$gte",(function(e){return e}),!1),jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:".contains",spelOps:["matches",".contains"],mongoFormatOp:k.bind(null,"$regex",(function(e){return"string"==typeof e?(0,u.hr)(e):void 0}),!1),jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:k.bind(null,"$regex",(function(e){return"string"==typeof e?(0,u.hr)(e):void 0}),!0),valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:".startsWith",spelOps:["matches",".startsWith"],mongoFormatOp:k.bind(null,"$regex",(function(e){return"string"==typeof e?"^"+(0,u.hr)(e):void 0}),!1),jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:".endsWith",spelOps:["matches",".endsWith"],mongoFormatOp:k.bind(null,"$regex",(function(e){return"string"==typeof e?(0,u.hr)(e)+"$":void 0}),!1),jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,l){var u=r.first(),s=r.get(1);return l?"".concat(e," BETWEEN ").concat(u," AND ").concat(s):"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,a,l){var u=r[0],s=r[1];return"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},mongoFormatOp:P.bind(null,["$gte","$lte"],!1),valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]?null:"Invalid range":null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,l){var u=r.first(),s=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(u," AND ").concat(s):"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},spelFormatOp:function(e,t,r,n,o,i,a,l){var u=r[0],s=r[1];return"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},mongoFormatOp:P.bind(null,["$gte","$lte"],!0),valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]?null:"Invalid range":null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,u){var s=(0,l.sqlEmptyValue)(u);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," <= ''")},mongoFormatOp:k.bind(null,"$in",(function(e,t){return[(0,l.mongoEmptyValue)(t),null]}),!1),jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,u){var s=(0,l.sqlEmptyValue)(u);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," > ''")},mongoFormatOp:k.bind(null,"$nin",(function(e,t){return[(0,l.mongoEmptyValue)(t),null]}),!1),jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," == null")},mongoFormatOp:k.bind(null,"$eq",(function(e){return null}),!1),jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," != null")},mongoFormatOp:k.bind(null,"$ne",(function(e){return null}),!1),jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,a,l){var u=l?"=":"==";return"".concat(e," ").concat(u," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:k.bind(null,"$eq",(function(e){return e}),!1),reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:k.bind(null,"$ne",(function(e){return e}),!1),reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},spelOp:"$contains",mongoFormatOp:k.bind(null,"$in",(function(e){return e}),!1),reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:k.bind(null,"$nin",(function(e){return e}),!1),reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"CollectionUtils.containsAny()",elasticSearchQueryType:"term",mongoFormatOp:k.bind(null,"$in",(function(e){return e}),!1)},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,a,l){var u=l?"=":"==";return"value"==n?"".concat(e," ").concat(u," [").concat(r.join(", "),"]"):"".concat(e," ").concat(u," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,u){return"value"==n?"".concat(e," = '").concat(r.map((function(e){return l.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:".equals",mongoFormatOp:k.bind(null,"$eq",(function(e){return e}),!1),reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,u){return"value"==n?"".concat(e," != '").concat(r.map((function(e){return l.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:k.bind(null,"$ne",(function(e){return e}),!1),reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,i,a,l){var u=r.first(),s=r.get(1),c=a.get("proximity");return"".concat(e," ").concat(u," NEAR/").concat(c," ").concat(s)},sqlFormatOp:function(e,t,r,n,o,i,a,u){var s=r.first(),c=r.get(1),p=l.SqlString.trim(s),d=l.SqlString.trim(c),f=a.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(p,", ").concat(d,"), ").concat(f,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",factory:function(e){return o.createElement(E,e)},minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:k.bind(null,"$gt",(function(e){return 0}),!1)},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:k.bind(null,"$eq",(function(e){return e}),!1)},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:k.bind(null,"$eq",(function(e){return 0}),!1)}},Z=function(e){return null==e?"NULL":e.toString()};const _={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"AND":"&&")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" AND ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" && ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:L,widgets:{text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",factory:function(e){return o.createElement(v,e)},formatValue:function(e,t,r,n){return n?Z(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){var i;return"matches"==o.spelOp&&"regex"!=n?(i="starts_with"==n?"(?s)^".concat((0,u.hr)(e),".*"):"(?s).*".concat((0,u.hr)(e),"ends_with"==n?"$":".*"),(0,l.spelEscape)(i)):(0,l.spelEscape)(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?l.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):l.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",factory:function(e){return o.createElement(h,e)},formatValue:function(e,t,r,n){return n?Z(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?l.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):l.SqlString.escape(e)},spelFormatValue:function(e){return(0,l.spelEscape)(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",factory:function(e){return o.createElement(F,e)},valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?Z(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return l.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return(0,l.spelEscape)(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",factory:function(e){return o.createElement(w,e)},valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?Z(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return l.SqlString.escape(e)},spelFormatValue:function(e){return(0,l.spelEscape)(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",factory:function(e){return o.createElement(j,e)},valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=(0,u.w1)(t.fieldSettings.listValues||t.asyncListValues,e);return n?Z(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return l.SqlString.escape(e)},spelFormatValue:function(e){return(0,l.spelEscape)(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",factory:function(e){return o.createElement(O,e)},valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=e.map((function(e){return(0,u.w1)(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?o.map(Z):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){return e.map((function(e){return l.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var i=o.spelOp&&"$"==o.spelOp[0],a=(0,l.spelEscape)(e);return i&&(a=(0,l.spelFixList)(a)),a},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",factory:function(e){return o.createElement(m,e)},dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",useKeyboard:!0,valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=c()(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return l.SqlString.escape(i.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return"new java.text.SimpleDateFormat('yyyy-MM-dd').parse('".concat(i.format("YYYY-MM-DD"),"')")},jsonLogic:function(e,t,r){return c()(e,r.valueFormat).toDate()},toJS:function(e,t){var r=c()(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=c()(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",factory:function(e){return o.createElement(y,e)},timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,useKeyboard:!0,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=c()(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return l.SqlString.escape(i.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return"T(java.time.LocalTime).parse('".concat(i.format("HH:mm:ss"),"')")},jsonLogic:function(e,t,r){var n=c()(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=c()(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=c()(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",factory:function(e){return o.createElement(b,e)},timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,useKeyboard:!0,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=c()(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return l.SqlString.escape(i.toDate())},spelFormatValue:function(e,t,r,n,o){var i=c()(e,r.valueFormat);return"new java.text.SimpleDateFormat('yyyy-MM-dd HH:mm:ss').parse('".concat(i.format("YYYY-MM-DD HH:mm:ss"),"')")},jsonLogic:function(e,t,r){return c()(e,r.valueFormat).toDate()},toJS:function(e,t){var r=c()(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=c()(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",factory:function(e){return o.createElement(g,e)},labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o){return l.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return(0,l.spelEscape)(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",factory:function(e){return o.createElement(S,e)},formatValue:function(e,t,r,n,o,i,a){return n&&a.label||e},sqlFormatValue:function(e,t,r,n,o,i){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare",customProps:{showSearch:!0}},func:{valueSrc:"func",factory:function(e){return o.createElement(C,e)},valueLabel:"Function",valuePlaceholder:"Select function",customProps:{}},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return(0,l.spelEscape)(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]},factory:function(e){var t=e.value,r=e.setValue;return o.createElement("input",{type:"text",value:t||"",onChange:function(e){return r(e.target.value)}})}}},types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"],widgetProps:{customProps:{showSearch:!0}}},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{}}}},settings:f(f({},p.X),{},{formatField:function(e,t,r,n,o,i){return i?r:e},formatSpelField:function(e,t,r,n,o,i){var a=n.map((function(e,t){var r=e.key,n=e.parent;return 0==t?"[map]"==n?"#this[".concat((0,l.spelEscape)(r),"]"):r:"map"==n||"[map]"==n?"[".concat((0,l.spelEscape)(r),"]"):".".concat(r)})).join("");return o.isSpelVariable&&(a="#"+a),a},sqlFormatReverse:function(e){if(null!=e)return"NOT("+e+")"},spelFormatReverse:function(e){if(null!=e)return"!("+e+")"},formatReverse:function(e,t,r,n,o,i){if(null!=e)return i?"NOT ("+e+")":"!("+e+")"},formatAggr:function(e,t,r,n,o,i,a,l,u,s){var c=a.labelForFormat,p=a.cardinality;if(0==p){var d=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(d)}if(null==p||1==p){var f=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(f," ").concat(c," ").concat(n)}if(2==p){var g=e?" WHERE ".concat(e):"",v=n.first(),h=n.get(1);return"COUNT OF ".concat(t).concat(g," ").concat(c," ").concat(v," AND ").concat(h)}},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}},customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5})}},37991:(e,t,r)=>{"use strict";r.d(t,{X:()=>f});var n=r(26333),o=r(27378),i=n.E$,a=n.P9,l=n.TD,u=n.hO,s=n.lU,c=n.H_,p=n.kB,d=n.pm,f={formatField:function(e,t,r,n,o,i){return i?r:e},renderField:function(e){return o.createElement(i,e)},renderOperator:function(e){return o.createElement(i,e)},renderFunc:function(e){return o.createElement(i,e)},renderConjs:function(e){return o.createElement(a,e)},renderSwitch:function(e){return o.createElement(d,e)},renderButton:function(e){return o.createElement(l,e)},renderButtonGroup:function(e){return o.createElement(u,e)},renderProvider:function(e){return o.createElement(s,e)},renderValueSources:function(e){return o.createElement(c,e)},renderConfirm:p,renderSwitchPrefix:function(){return o.createElement(o.Fragment,null,"Conditions")},valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",renderSize:"small",maxLabelsLength:100,canReorder:!0,canRegroup:!0,showLock:!1,canDeleteLocked:!1,showNot:!0,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,forceShowConj:!1,canShortMongoQuery:!0,removeEmptyGroupsOnLoad:!0,removeIncompleteRulesOnLoad:!0,removeInvalidMultiSelectValuesOnLoad:!0,groupActionsPosition:"topRight",setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:null,addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"",notLabel:"Not",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null,defaultGroupConjunction:"AND",jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"}}},53568:(e,t,r)=>{"use strict";r.d(t,{Z:()=>Je});var n=r(25773),o=r(64649),i=r(27378),a=r(54311),l=r(45530),u=r(74653),s=r(26077),c=r(69250),p=r(26707),d=r(54139),f=r(38227),g=r(87354),v=r(27868),h=r(61320),m=r.n(h),y=r(59991),b=r(13456),O=r(30888),j=r(48159),F=r.n(j),w=r(53782),S=r(41558),C=["width"],E=r(649),k=r(11026),P=["width"],L=r(82693),Z=r(86877),_=r(54344),R=r(26989),T=r(57299),V=r(21334),N=r(17419),D=r(47820),x=r(74002),I=r(20373),A=r(2771),q=r(99445),M=r(50623),B=["width","showCheckboxes"];function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=i.createElement(A.Z,{fontSize:"small"}),J=i.createElement(q.Z,{fontSize:"small"}),$=(0,V.D)(),H=[];const U=function(e){var t=e.allowCustomValues,r=e.multiple,o=e.value,a=e.customProps,l=e.readonly,u=e.config,s=e.groupBy,c=e.filterOptionsConfig,f=c?(0,V.D)(c):$,g=(0,M.Z)(e,{debounceTimeout:100,multiple:r}),v=g.open,h=g.onOpen,m=g.onClose,y=g.onChange,b=g.onInputChange,O=g.inputValue,j=g.options,S=g.isInitialLoading,C=g.isLoading,E=g.aPlaceholder,k=g.extendOptions,P=g.getOptionSelected,L=g.getOptionDisabled,Z=g.getOptionLabel,_=u.settings,T=_.defaultSelectWidth,A=_.defaultSearchWidth,q=a||{},G=q.width,U=q.showCheckboxes,Y=(0,w.Z)(q,B),K=Y.input||{},X=K.width||A;K=F()(K,["width"]);var Q=F()(Y,["showSearch","showCheckboxes"]),ee=G||T,te={width:r?void 0:ee,minWidth:ee},re=l?"":E,ne=null!=o?o:r?H:null,oe=(0,I.Z)((function(e){return{input:{minWidth:X+" !important"}}})),ie=(0,I.Z)((function(e){return{root:{height:"auto"},label:{marginTop:"3px",marginBottom:"3px"}}}))(),ae=oe();return i.createElement(d.Z,{fullWidth:!0},i.createElement(N.ZP,(0,n.Z)({disableCloseOnSelect:r,fullWidth:!0,multiple:r,style:te,classes:ae,freeSolo:t,loading:S,open:v,onOpen:h,onClose:m,inputValue:O,onInputChange:b,label:re,onChange:y,value:ne,getOptionSelected:P,disabled:l,readOnly:l,options:j,groupBy:s,getOptionLabel:Z,getOptionDisabled:L,renderInput:function(e){return i.createElement(p.Z,(0,n.Z)({},e,{InputProps:W(W({},e.InputProps),{},{readOnly:l,endAdornment:i.createElement(i.Fragment,null,C?i.createElement(D.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}),disabled:l,placeholder:re},K))},renderTags:function(e,t){return e.map((function(e,r){return i.createElement(x.Z,(0,n.Z)({key:r,classes:ie,label:Z(e)},t({index:r})))}))},renderOption:function(e,t){var n=t.selected;return e.specialValue?i.createElement(i.Fragment,null,e.renderTitle||e.title):r&&0!=U?i.createElement(i.Fragment,null,i.createElement(R.Z,{icon:z,checkedIcon:J,style:{marginRight:8},checked:n}),e.title):i.createElement(i.Fragment,null,e.renderTitle||e.title)},filterOptions:function(e,t){var r=f(e,t);return k(r)}},Q)))};var Y=r(44920),K=["items","selectedKey","setField"];function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){var n=t.items,o=t.path,i=t.label,a=t.disabled,l=t.grouplabel,u="  ".repeat(r);return n?e(n,r+1):{title:i,renderTitle:u+i,value:o,disabled:a,groupTitle:r>0?u+l:null}})).flat(1/0)},te={stringify:function(e){return["title","value","grouplabel","label"].map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}},re=r(40458),ne=r(96341),oe=r(9334),ie=r(90547),ae=r(78976),le=r(62460),ue=r(42470),se=r(48826),ce=r(53260),pe=r(9799),de=r(99898),fe=r(7493),ge=r(35311),ve=(0,I.Z)((function(e){return{paper:{padding:e.spacing(1)}}}));const he={MaterialTextWidget:function(e){var t=e.value,r=e.setValue,o=(e.config,e.readonly),a=e.placeholder,l=e.customProps,u=e.maxLength,s=t||"";return i.createElement(d.Z,null,i.createElement(p.Z,(0,n.Z)({value:s,placeholder:o?"":a,InputProps:{readOnly:o},inputProps:{maxLength:u},disabled:o,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}},l)))},MaterialTextAreaWidget:function(e){var t=e.value,r=e.setValue,o=e.config,a=e.readonly,l=e.placeholder,u=e.customProps,s=e.maxLength,c=e.maxRows,f=e.fullWidth,g=o.settings.defaultMaxRows,v=t||"";return i.createElement(d.Z,{fullWidth:f},i.createElement(p.Z,(0,n.Z)({fullWidth:f,maxRows:c||g,multiline:!0,value:v,placeholder:a?"":l,InputProps:{readOnly:a},inputProps:{maxLength:s},disabled:a,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}},u)))},MaterialDateWidget:function(e){var t=e.value,r=e.setValue,o=e.readonly,a=e.customProps,l=e.dateFormat,u=e.valueFormat,s=e.placeholder,c=e.useKeyboard?f.e:f.M;return i.createElement(d.Z,null,i.createElement(c,(0,n.Z)({readOnly:o,disabled:o,placeholder:o?"":s,format:l,value:t||null,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(u):void 0}(e))}},a)))},MaterialDateTimeWidget:function(e){var t=e.value,r=e.setValue,o=e.use12Hours,a=e.readonly,l=e.placeholder,u=e.dateFormat,s=e.timeFormat,c=e.valueFormat,p=e.customProps,f=e.useKeyboard?g.B:g.x,v=u+" "+s;return i.createElement(d.Z,null,i.createElement(f,(0,n.Z)({readOnly:a,disabled:a,ampm:!!o,placeholder:a?"":l,format:v,value:t||null,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(c):void 0}(e))}},p)))},MaterialTimeWidget:function(e){var t=e.value,r=e.setValue,o=e.use12Hours,a=e.readonly,l=e.placeholder,u=e.timeFormat,s=e.valueFormat,c=e.customProps,p=e.useKeyboard?v.e:v.j,f=-1!=u.indexOf(":ss"),g=t?m()(t,u):null;return i.createElement(d.Z,null,i.createElement(p,(0,n.Z)({readOnly:a,disabled:a,ampm:!!o,placeholder:a?"":l,format:u,value:g||null,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(s):void 0}(e))},views:f?["hours","minutes","seconds"]:["hours","minutes"]},c)))},MaterialSelectWidget:function(e){var t=e.listValues,r=e.value,o=e.setValue,a=(e.allowCustomValues,e.readonly),l=e.placeholder,u=e.customProps,s=null!=r;return i.createElement(d.Z,null,i.createElement(y.Z,(0,n.Z)({autoWidth:!0,displayEmpty:!0,label:a?"":l,onChange:function(e){void 0!==e.target.value&&o(e.target.value)},value:s?r:"",disabled:a,readOnly:a,renderValue:function(e){return a||null!=e?function(e){return(0,O.mi)(t,(function(t){var r=t.title;return t.value===e?r:null})).filter((function(e){return null!==e})).shift()}(e):l}},F()(u,["showSearch","input"])),(0,O.mi)(t,(function(e){var t=e.title,r=e.value;return i.createElement(b.Z,{key:r,value:r},t)}))))},MaterialNumberWidget:function(e){var t=e.value,r=e.setValue,o=(e.config,e.readonly),a=e.min,l=e.max,u=e.step,s=e.placeholder,c=e.customProps,f=null==t?"":t;return i.createElement(d.Z,null,i.createElement(p.Z,(0,n.Z)({type:"number",value:f,placeholder:o?"":s,InputProps:{readOnly:o},inputProps:{min:a,max:l,step:u},disabled:o,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},c)))},MaterialSliderWidget:function(e){var t=e.config,r=e.placeholder,o=e.customProps,a=e.value,l=e.setValue,u=e.min,s=e.max,c=e.step,f=e.marks,g=e.readonly,v=t.settings.defaultSliderWidth,h=o||{},m=h.width,y=(0,w.Z)(h,C),b=y.input||{},O=y.slider||y,j="number"==typeof a?a:"",F="number"==typeof a?a:null,E=!!f&&Object.keys(f).map((function(e){return{value:e,label:f[e]}})),k=i.createElement(p.Z,(0,n.Z)({type:"number",value:j,placeholder:r,InputProps:{readOnly:g},inputProps:{min:u,max:s,step:c},disabled:g,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),l(t)},onBlur:function(){a<u?l(u):a>s&&l(s)}},b)),P=i.createElement(S.Z,(0,n.Z)({value:F,onChange:function(e,t){l(t)},disabled:g,min:u,max:s,step:c,marks:E,valueLabelDisplay:"auto"},O)),L={marginLeft:"5px",paddingLeft:"12px",marginBottom:E&&"-16px",width:m||v};return i.createElement(d.Z,null,i.createElement("div",{style:{display:"inline-flex",alignItems:"center"}},i.createElement("div",{style:{marginLeft:"5px"}},k),i.createElement("div",{style:L},P)))},MaterialRangeWidget:function(e){var t=e.config,r=e.placeholders,o=e.customProps,a=e.value,l=e.setValue,u=e.min,s=e.max,c=e.step,f=e.marks,g=e.readonly,v=e.textSeparators,h=t.settings.defaultSliderWidth;(0,i.useEffect)((function(){var t=e.value||[void 0,void 0],r=(0,k.Z)(t,2),n=r[0],o=r[1];!e.value||null!=n&&null!=o||setTimeout((function(){var e=n||o;l([e,e])}),1)}),[]);var m=function(){a&&(a[0]<u?l([u,a[1]]):a[1]>s&&l([a[0],s]))},y=o||{},b=y.width,O=(0,w.Z)(y,P),j=O.input||{},F=O.slider||O,C=!!f&&Object.keys(f).map((function(e){return{value:e,label:f[e]}})),L=a?(0,E.Z)(a):[void 0,void 0],Z=(0,k.Z)(L,2),_=Z[0],R=Z[1];null==_&&(_="",L[0]=0),null==R&&(R="",L[1]=0);var T=i.createElement(p.Z,(0,n.Z)({type:"number",value:_,placeholder:r[0],InputProps:{readOnly:g},inputProps:{min:u,max:s,step:c},disabled:g,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,E.Z)(e.value):[void 0,void 0];n[0]=r,l(n)},onBlur:m},j)),V=i.createElement(p.Z,(0,n.Z)({type:"number",value:R,placeholder:r[1],InputProps:{readOnly:g},inputProps:{min:u,max:s,step:c},disabled:g,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,E.Z)(e.value):[void 0,void 0];n[1]=r,l(n)},onBlur:m},j)),N=i.createElement(S.Z,(0,n.Z)({value:L,onChange:function(e,t){l(t)},disabled:g,min:u,max:s,step:c,marks:C,valueLabelDisplay:"auto"},F)),D={marginLeft:"5px"},x={marginLeft:"5px",paddingLeft:"12px",marginBottom:C&&"-16px",width:b||h};return i.createElement(d.Z,null,i.createElement("div",{style:{display:"inline-flex"}},i.createElement("div",{style:D},T),i.createElement("div",{className:"widget--sep"},i.createElement("span",null,v[1])),i.createElement("div",{style:D},V),i.createElement("div",{style:x},N)))},MaterialBooleanWidget:function(e){var t=e.customProps,r=e.value,o=e.setValue,a=e.labelYes,l=e.labelNo,u=e.readonly;return i.createElement(d.Z,null,i.createElement(_.Z,{component:"div"},i.createElement(Z.Z,{component:"label",container:!0,alignItems:"center",spacing:0},i.createElement(Z.Z,{item:!0,component:"span"},l),i.createElement(Z.Z,{item:!0,component:"span"},i.createElement(L.Z,(0,n.Z)({checked:!!r,onChange:function(){o(!r)},disabled:u},t))),i.createElement(Z.Z,{item:!0,component:"span"},a))))},MaterialMultiSelectWidget:function(e){var t,r=e.listValues,o=e.value,a=e.setValue,l=(e.allowCustomValues,e.readonly),u=e.placeholder,s=e.customProps,c=null!=o&&o.length>0;return i.createElement(d.Z,null,i.createElement(y.Z,(0,n.Z)({multiple:!0,autoWidth:!0,displayEmpty:!0,label:l?"":u,onChange:function(e){void 0!==e.target.value&&a(e.target.value)},value:c?o:[],disabled:l,readOnly:l,renderValue:function(e){if(!l&&!e.length)return u;var t=(0,O.mi)(r,(function(t){var r=t.title,n=t.value;return e.indexOf(n)>-1?r:null})).filter((function(e){return null!==e}));return t.join(", ")}},F()(s,["showSearch","input","showCheckboxes"])),(t=c?o:[],(0,O.mi)(r,(function(e){var r=e.title,n=e.value;return i.createElement(b.Z,{key:n,value:n},i.createElement(R.Z,{checked:t.indexOf(n)>-1}),i.createElement(T.Z,{primary:r}))})))))},MaterialAutocompleteWidget:U,MaterialFieldSelect:function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,a=e.placeholder,l=null!=n;return i.createElement(d.Z,null,i.createElement(y.Z,{autoWidth:!0,displayEmpty:!0,label:a,onChange:function(e){void 0!==e.target.value&&r(e.target.value)},value:l?n:"",disabled:o,renderValue:function(e){return o||e?function t(r){return r.map((function(r){return r.items?t(r.items):r.path===e?r.label:null}))}(t).filter((function(e){return Array.isArray(e)?e.some((function(e){return null!==e})):null!==e})).pop():a}},function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){var n=t.items,o=t.path,a=t.label,l=t.disabled,u="  ".repeat(r);return n?[i.createElement(Y.Z,{disabled:l,key:o,disableSticky:!0},u&&i.createElement("span",null,u),a),e(n,r+1)]:i.createElement(b.Z,{disabled:l,key:o,value:o},u&&i.createElement("span",null,u),a)}))}(t)))},MaterialFieldAutocomplete:function(e){return i.createElement(U,(r=(t=e).items,n=t.selectedKey,o=t.setField,a=(0,w.Z)(t,K),l=ee(r),u=n,Q(Q({},a),{},{listValues:l,setValue:function(e,t){if(e)return o(e)},groupBy:function(e){return e.groupTitle},filterOptionsConfig:te,allowCustomValues:!1,multiple:!1,value:u})));var t,r,n,o,a,l,u},MaterialButton:function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,a=(e.config,{delGroup:i.createElement(re.Z,null),delRuleGroup:i.createElement(re.Z,null),delRule:i.createElement(re.Z,null),addRuleGroup:i.createElement(ne.Z,null)}),l={addRule:i.createElement(ne.Z,null),addGroup:i.createElement(ne.Z,null),addRuleGroupExt:i.createElement(ne.Z,null)},u={addRule:"default",addGroup:"primary",delGroup:"secondary",delRuleGroup:"secondary",delRule:"secondary"};return a[t]?i.createElement(ie.Z,{size:"small",disabled:o,onClick:n,color:u[t]},a[t]):i.createElement(oe.Z,{size:"small",disabled:o,onClick:n,color:u[t],startIcon:l[t]},r)},MaterialButtonGroup:function(e){var t=e.children;return e.config,i.createElement(i.Fragment,null,t)},MaterialConjs:function(e){var t=e.id,r=e.not,n=e.setNot,o=e.conjunctionOptions,a=e.setConjunction,l=e.disabled,u=e.readonly,s=e.config,c=e.showNot,p=e.notLabel,f=Object.keys(o).length,g=l,v=s.settings.forceShowConj||f>1&&!g,h=function(e){return a(e)};return i.createElement(d.Z,null,i.createElement(ae.Z,{disableElevation:!0,variant:"contained",size:"small",disabled:u},c&&(u&&!r?null:i.createElement(oe.Z,{key:t,id:t+"__not",color:r?"secondary":"default",onClick:function(e){return n(e)}.bind(null,!r),disabled:u},p||"NOT")),v&&Object.keys(o).map((function(e){var t=o[e],r=t.id,n=(t.name,t.label),s=t.checked,c=a.isDummyFn?"__dummy":"";return!u&&!l||s?i.createElement(oe.Z,{key:r+c,id:r+c,color:s?"primary":"default",value:e,onClick:h.bind(null,e),disabled:u||l},n):null}))))},MaterialSwitch:function(e){var t=e.value,r=e.setValue,n=e.label,o=e.checkedLabel,a=e.hideLabel,l=e.id,u=e.config,s=e.type,c=(u.settings.renderSize,function(){return r(!t)}),p=s,d=t&&o||n,f=t?i.createElement(se.Z,null):i.createElement(ue.Z,null);return"lock"==s?a?i.createElement(ie.Z,{key:l+p,onClick:c,size:"small"},f):i.createElement(oe.Z,{key:l+p,onClick:c,size:"small",startIcon:f},d):i.createElement(le.Z,{control:i.createElement(L.Z,{checked:!!t,size:"small",onChange:function(e){return r(e.target.checked)}}),label:d})},MaterialValueSources:function(e){var t=e.valueSources,r=e.valueSrc,n=e.title,o=e.setValueSrc,a=(e.readonly,i.useState(null)),l=(0,k.Z)(a,2),u=l[0],s=l[1],c=ve(),p=function(){s(null)},f=Boolean(u);return i.createElement("div",null,i.createElement(ie.Z,{size:"small",onClick:function(e){u?p():function(e){s(e.currentTarget)}(e)}},i.createElement(ce.Z,null)),i.createElement(pe.ZP,{open:f,anchorEl:u,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:p,classes:{paper:c.paper},disablePortal:!0},i.createElement(d.Z,{component:"fieldset"},i.createElement(ge.Z,{component:"legend"},n),i.createElement(fe.Z,{value:r||"value",onChange:function(e){void 0!==e.target.value&&(o(e.target.value),p())}},function(e){return e.map((function(e){var t=(0,k.Z)(e,2),n=t[0],o=t[1];return i.createElement(le.Z,{key:n,value:n,checked:r==n||!r&&"value"==n,control:i.createElement(de.Z,null),label:o.label})}))}(t)))))},MaterialConfirm:function(e){var t=e.onOk,r=e.okText,n=e.cancelText,o=e.title;(0,e.confirmFn)({description:o||"Are you sure?",title:null,confirmationText:r||"Ok",cancellationText:n||"Cancel"}).then(t).catch((function(){}))},MaterialUseConfirm:u.N,MaterialProvider:function(e){var t=e.config,r=e.children,n=t.settings.theme||{},o=t.settings.locale||{},p=n.material,d=o.material,f=p||d?(0,a.Z)(p,d):null,g=i.createElement("div",{className:"mui"},r),v=i.createElement(s.M,{utils:c.Z},i.createElement(u.W,null,g));return f?i.createElement(l.Z,{theme:f},v):v}};var me=r(16930),ye=r(75144);function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var je=he.MaterialBooleanWidget,Fe=he.MaterialTextWidget,we=he.MaterialTextAreaWidget,Se=he.MaterialDateWidget,Ce=he.MaterialTimeWidget,Ee=he.MaterialDateTimeWidget,ke=he.MaterialMultiSelectWidget,Pe=he.MaterialSelectWidget,Le=he.MaterialNumberWidget,Ze=he.MaterialSliderWidget,_e=he.MaterialRangeWidget,Re=he.MaterialAutocompleteWidget,Te=he.MaterialFieldSelect,Ve=he.MaterialFieldAutocomplete,Ne=he.MaterialConjs,De=he.MaterialSwitch,xe=he.MaterialButton,Ie=he.MaterialButtonGroup,Ae=he.MaterialValueSources,qe=he.MaterialProvider,Me=he.MaterialConfirm,Be=he.MaterialUseConfirm,Ge=Oe(Oe({},me.ZP.settings),{},{renderField:function(e){var t;return null!=e&&null!==(t=e.customProps)&&void 0!==t&&t.showSearch?i.createElement(Ve,e):i.createElement(Te,e)},renderOperator:function(e){return i.createElement(Te,e)},renderFunc:function(e){return i.createElement(Te,e)},renderConjs:function(e){return i.createElement(Ne,e)},renderSwitch:function(e){return i.createElement(De,e)},renderButton:function(e){return i.createElement(xe,e)},renderButtonGroup:function(e){return i.createElement(Ie,e)},renderValueSources:function(e){return i.createElement(Ae,e)},renderProvider:function(e){return i.createElement(qe,e)},renderConfirm:Me,useConfirm:Be}),We=Oe(Oe({},me.ZP.widgets),{},{text:Oe(Oe({},me.ZP.widgets.text),{},{factory:function(e){return i.createElement(Fe,e)}}),textarea:Oe(Oe({},me.ZP.widgets.textarea),{},{factory:function(e){return i.createElement(we,e)}}),number:Oe(Oe({},me.ZP.widgets.number),{},{factory:function(e){return i.createElement(Le,e)}}),multiselect:Oe(Oe({},me.ZP.widgets.multiselect),{},{factory:function(e){return e.asyncFetch||e.showSearch?i.createElement(Re,(0,n.Z)({multiple:!0},e)):i.createElement(ke,e)}}),select:Oe(Oe({},me.ZP.widgets.select),{},{factory:function(e){return e.asyncFetch||e.showSearch?i.createElement(Re,e):i.createElement(Pe,e)}}),slider:Oe(Oe({},me.ZP.widgets.slider),{},{factory:function(e){return i.createElement(Ze,e)}}),boolean:Oe(Oe({},me.ZP.widgets.boolean),{},{factory:function(e){return i.createElement(je,e)}}),date:Oe(Oe({},me.ZP.widgets.date),{},{factory:function(e){return i.createElement(Se,e)}}),time:Oe(Oe({},me.ZP.widgets.time),{},{factory:function(e){return i.createElement(Ce,e)}}),datetime:Oe(Oe({},me.ZP.widgets.datetime),{},{factory:function(e){return i.createElement(Ee,e)}}),rangeslider:{type:"number",jsType:"number",valueSrc:"value",factory:function(e){return i.createElement(_e,e)},valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?(0,me.v2)(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return ye.SqlString.escape(e)},spelFormatValue:function(e){return(0,ye.spelEscape)(e)},singleWidget:"slider",toJS:function(e,t){return e}}}),ze=Oe(Oe({},me.ZP.types),{},{number:Oe(Oe({},me.ZP.types.number),{},{widgets:Oe(Oe({},me.ZP.types.number.widgets),{},{rangeslider:{opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]}})})});const Je=Oe(Oe({},me.ZP),{},{types:ze,widgets:We,settings:Ge})},50623:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(649),o=r(64649),i=r(27791),a=r(11026),l=r(50824),u=r.n(l),s=r(27378),c=r(66726),p=r.n(c),d=r(30888),f=r(50832);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const h=function(e,t){var r=e.asyncFetch,o=e.useLoadMore,l=e.useAsyncSearch,c=e.forceAsyncSearch,g=e.asyncListValues,h=e.listValues,m=e.allowCustomValues,y=e.value,b=e.setValue,O=e.placeholder,j=t.debounceTimeout,F=t.multiple,w=["LOAD_MORE","LOADING_MORE"],S="Load more...",C="Loading more...",E=c?"Type to search":O,k=s.useState(!1),P=(0,a.Z)(k,2),L=P[0],Z=P[1],_=s.useState(void 0),R=(0,a.Z)(_,2),T=R[0],V=R[1],N=s.useState(0),D=(0,a.Z)(N,2),x=D[0],I=D[1],A=s.useState(!1),q=(0,a.Z)(A,2),M=q[0],B=q[1],G=s.useState(""),W=(0,a.Z)(G,2),z=W[0],J=W[1],$=s.useState(void 0),H=(0,a.Z)($,2),U=H[0],Y=H[1],K=s.useRef(0),X=s.useRef(!0),Q=s.useRef(!1),ee=(0,d.LH)(g),te=r?m?U:(0,f.jU)(U,ee,!0):h,re=x>0,ne=L&&r&&void 0===U&&(!c||z),oe=ne&&re,ie=!oe&&te&&te.length>0&&T&&T.hasMore&&(T.filter||"")===z,ae=!re&&ie,le=(0,d.mi)(te,f._O),ue=null!=y,se=function(){var e=(0,i.Z)(u().mark((function e(){var t,n,i,a,l,s,c,p,g,h,m,y,b,O,j=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.length>0&&void 0!==j[0]?j[0]:null,!(n=j.length>1&&void 0!==j[1]&&j[1])&&T&&V(void 0),i=n&&U?U.length:0,a=n&&T||!o&&{pageSize:0},l=++K.current,e.next=8,r(t,i,a);case 8:if(s=e.sent,K.current==l&&X.current){e.next=12;break}return e.abrupt("return",null);case 12:return c=s&&s.values?s:{values:s},p=c.values,g=c.hasMore,h=c.meta,m=(0,d.LH)(p),n?(b=(0,f.jU)(U,m,!1),y=b.length>U.length):(b=m,o&&(y=b.length>0)),(O=null!=g||null!=h||null!=y?v(v(v(v({},null!=y?{hasMore:y}:{}),null!=g?{hasMore:g}:{}),null!=h?h:{}),{},{filter:t}):void 0)&&V(O),e.abrupt("return",b);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=(0,i.Z)(u().mark((function e(){var t,r,n,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,r=o.length>1&&void 0!==o[1]&&o[1],I((function(e){return e+1})),B(r),e.next=6,se(t,r);case 6:if(n=e.sent,X.current){e.next=9;break}return e.abrupt("return");case 9:null!=n&&Y(n),I((function(e){return e-1})),B(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=s.useCallback(p()(ce,j),[]);s.useEffect((function(){return function(){X.current=!1}}),[]),s.useEffect((function(){ne&&0==x&&0==K.current&&(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:case"end":return e.stop()}}),e)})))()}),[ne]);var de=function(){Z(!0)},fe=function(e){Q.current?(Q.current=!1,F&&Z(!1)):Z(!1)},ge=function(){var e=(0,i.Z)(u().mark((function e(t,r){var n,o,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(null==r?void 0:r.specialValue)||(null==r?void 0:r.value)||F&&r.map((function(e){return(null==e?void 0:e.specialValue)||(null==e?void 0:e.value)})).find((function(e){return!!e})),"LOAD_MORE"!=n){e.next=7;break}return Q.current=!0,e.next=5,ce(z,!0);case 5:e.next=8;break;case 7:"LOADING_MORE"==n?Q.current=!0:F?(o=r.map((function(e,r){var n=null!=e.value?e:(0,f.lR)(e,te),o=m&&!n?Array.isArray(t)?t[r]:e:null;return n||o})),(i=o.filter((function(e){return void 0!==e})).map((function(e){return void 0!==e.value?e.value:e}))).length||(i=void 0),b(i,o)):(a=null==r?void 0:r.value,b(a,[r]));case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),ve=function(){var e=(0,i.Z)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=r)!==S&&n!==C){e.next=3;break}return e.abrupt("return");case 3:if(J(n),m&&(F||b(n,[n])),!l||c&&!n){e.next=11;break}return e.next=9,pe(n);case 9:e.next=12;break;case 11:l&&c&&Y([]);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),he=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t||L){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ve(null,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{options:le,listValues:te,hasValue:ue,open:L,onOpen:de,onClose:fe,onDropdownVisibleChange:function(e){e?de():fe()},onChange:ge,inputValue:z,onInputChange:ve,onSearch:he,canShowLoadMore:ae,isInitialLoading:oe,isLoading:re,isLoadingMore:M,isSpecialValue:function(e){var t=(null==e?void 0:e.specialValue)||(null==e?void 0:e.value);return w.includes(t)},extendOptions:function(e){var t=(0,n.Z)(e);return o&&(ae?t.push({specialValue:"LOAD_MORE",title:S}):M&&t.push({specialValue:"LOADING_MORE",title:C,disabled:!0})),t},getOptionSelected:function(e,t){if(null==t)return null;var r=null!=t.value?t.value:t;return e.value===r},getOptionDisabled:function(e){return e&&e.disabled},getOptionLabel:function(e){if(null==e)return null;var t=null!=e.value?e:(0,f._O)((0,f.lR)(e,te));return!t&&e.specialValue?e.title:!t&&m?e:t?t.title:e},aPlaceholder:E}}},54216:(e,t,r)=>{"use strict";r.d(t,{I4:()=>ti.ZP,gs:()=>s,Ib:()=>Zr,AE:()=>Qe,cQ:()=>oi});var n={};r.r(n),r.d(n,{addCaseGroup:()=>Re,addDefaultCaseGroup:()=>_e,addGroup:()=>Te,addRule:()=>Le,moveItem:()=>Ne,removeGroup:()=>Ve,removeRule:()=>Ze,setTree:()=>Pe});var o={};r.r(o),r.d(o,{setConjunction:()=>De,setLock:()=>Ie,setNot:()=>xe});var i={};r.r(i),r.d(i,{setField:()=>Ae,setOperator:()=>qe,setOperatorOption:()=>Ge,setValue:()=>Me,setValueSrc:()=>Be});var a={};r.r(a),r.d(a,{_mongodbFormat:()=>an,_spelFormat:()=>Ln,_sqlFormat:()=>yn,elasticSearchFormat:()=>ro,jsonLogicFormat:()=>Gr,mongodbFormat:()=>on,queryBuilderFormat:()=>Vr,queryString:()=>Wn,spelFormat:()=>Pn,sqlFormat:()=>mn});var l={};r.r(l),r.d(l,{_loadFromJsonLogic:()=>mo,_loadFromSpel:()=>Vo,checkTree:()=>io,getTree:()=>no,isImmutableTree:()=>lo,isJsonLogic:()=>Y.Gj,isTree:()=>uo,isValidTree:()=>ao,loadFromJsonLogic:()=>ho,loadFromSpel:()=>To,loadTree:()=>oo});var u={};r.r(u),r.d(u,{ConfigUtils:()=>H,DefaultUtils:()=>S,ExportUtils:()=>gn,TreeUtils:()=>w,getSwitchValues:()=>w.getSwitchValues,simulateAsyncFetch:()=>Uo.ZS,uuid:()=>$.Z,validateTree:()=>K.lB});var s={};r.r(s),r.d(s,{LINEAR_REGRESSION:()=>ei,LOWER:()=>Xo,NOW:()=>Yo,RELATIVE_DATETIME:()=>Ko,UPPER:()=>Qo});var c=r(64649),p=r(22951),d=r(91976),f=r(47169),g=r(67591),v=r(99492),h=r(27597),m=r(27378),y=r(23615),b=r.n(y),O=r(11026),j=r(90046),F=r.n(j),w=r(49925),S=r(53893),C="ADD_GROUP",E="ADD_CASE_GROUP",k="REMOVE_GROUP",P="SET_CONJUNCTION",L="SET_NOT",Z="ADD_RULE",_="REMOVE_RULE",R="SET_FIELD",T="SET_OPERATOR",V="SET_VALUE",N="SET_VALUE_SRC",D="SET_OPERATOR_OPTION",x="SET_LOCK",I="SET_TREE",A="MOVE_ITEM",q="after",M="before",B="append",G="prepend",W="SET_DRAG_PROGRESS",z="SET_DRAG_START",J="SET_DRAG_END",$=r(4229),H=r(64779),U=r(46752),Y=r(30888),K=r(73289),X=r(48159),Q=r.n(X),ee=r(25389),te=r.n(ee);function re(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ae=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=i.settings.shouldCreateEmptyGroup,s=t.push(n),c=!u,p=!(null==l||!l.isDefaultCase),d=e;return(e=fe(e,t,r,n,(0,S.defaultGroupProperties)(i).merge(o||{}),i,a))!==d&&(a||p||(e=e.setIn((0,w.expandTreePath)(s,"children1"),new(F().OrderedMap)),c&&(e=fe(e,s,"rule",(0,$.Z)(),(0,S.defaultRuleProperties)(i),i))),e=(0,w.fixPathsInTree)(e)),e},le=function(e,t,r){e=ge(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);return!(0,w.hasChildren)(e,o)&&!n&&(e=(0,w.fixEmptyGroupsInTree)(e),(0,w.isEmptyTree)(e)&&!n&&(e=fe(e,new(F().List),"rule",(0,$.Z)(),(0,S.defaultRuleProperties)(r),r))),(0,w.fixPathsInTree)(e)},ue=function(e,t,r){e=ge(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),i=e.getIn((0,w.expandTreePath)(o)),a=i.getIn(["properties","field"]),l=i.getIn(["properties","operator"]),u=(i.getIn(["properties","value",0]),a?(0,H.getFieldConfig)(r,a):null),s=l?(0,H.getOperatorConfig)(r,l,a):null,c=a&&l&&0!=s.cardinality,p="rule_group"==i.get("type"),d=!(0,w.hasChildren)(e,o),f=p?c&&u.initialEmptyWhere:n;return d&&!f&&(p&&(e=e.deleteIn((0,w.expandTreePath)(o))),e=(0,w.fixEmptyGroupsInTree)(e),(0,w.isEmptyTree)(e)&&!n&&(e=fe(e,new(F().List),"rule",(0,$.Z)(),(0,S.defaultRuleProperties)(r),r))),(0,w.fixPathsInTree)(e)},se=function(e,t,r){return e.setIn((0,w.expandTreePath)(t,"properties","not"),r)},ce=function(e,t,r){return(0,w.removeIsLockedInTree)(e.setIn((0,w.expandTreePath)(t,"properties","isLocked"),r))},pe=function(e,t,r){return e.setIn((0,w.expandTreePath)(t,"properties","conjunction"),r)},de=function e(t,r,n){n&&Array.isArray(n)&&(r.children1=new(F().OrderedMap)(n.reduce((function(r,n){var o=(0,$.Z)(),i=ie(ie({},n),{},{properties:(0,S.defaultItemProperties)(t,n).merge(n.properties||{}),id:o});return e(t,i,i.children1),ie(ie({},r),{},(0,c.Z)({},o,new(F().Map)(i)))}),{})))},fe=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("switch_group"==r)throw new Error("Can't add switch_group programmatically");var l,u,s=i.settings,p=s.maxNumberOfCases,d=s.maxNumberOfRules,f=s.maxNesting,g=e.get("type"),v="switch_group"==g,h=e.getIn((0,w.expandTreePath)(t)),m=v?e.getIn((0,w.expandTreePath)(t.take(2))):null,y=(0,w.expandTreePath)(t,"children1"),b=e.getIn(y),O=!!b&&b.size,j=O?b.size:null;"case_group"==r?(l=j,u=p):"group"==r?(l=t.size,u=f):"rule_group"==(null==h?void 0:h.get("type"))||(l=v?(0,w.getTotalRulesCountInTree)(m):(0,w.getTotalRulesCountInTree)(e),u=d);var S=!u||!l||l<u,C={type:r,id:n,properties:o};de(i,C,a);var E="case_group"==r&&O&&null==b.last().get("children1");if(S){var k=new(F().OrderedMap)((0,c.Z)({},n,new(F().Map)(C)));if(O)if(E){var P,L=b.last(),Z=new(F().OrderedMap)((P={},(0,c.Z)(P,n,new(F().Map)(C)),(0,c.Z)(P,L.get("id"),L),P));e=(e=e.deleteIn((0,w.expandTreePath)(y,"children1",L.get("id")))).mergeIn(y,Z)}else e=e.mergeIn(y,k);else e=e.setIn(y,k);e=(0,w.fixPathsInTree)(e)}return e},ge=function(e,t){return e=e.deleteIn((0,w.expandTreePath)(t)),(0,w.fixPathsInTree)(e)},ve=function(e,t,r,n,o){var i=(0,w.getItemByPath)(e,t),a=t.pop(),l=t.size>1?(0,w.getItemByPath)(e,a):null,u=l?l.get("children1"):null,s=(0,w.getItemByPath)(e,r),p=n==B||n==G?r:r.pop(),d=n==B||n==G?s:r.size>1?(0,w.getItemByPath)(e,p):null,f=d?d.get("children1"):null;if(!l||!d||!i)return e;var g=l.get("id")==d.get("id"),v=p.size<a.size&&(0,Y.vZ)(p.toArray(),a.toArray().slice(0,p.size)),h=p.size>a.size&&(0,Y.vZ)(a.toArray(),p.toArray().slice(0,a.size)),m=null,y=null;v?m=F().List(a.toArray().slice(p.size)):h&&(y=F().List(p.toArray().slice(a.size)));var b=f,j=u;return h||(j=j.delete(i.get("id"))),g?b=j:v&&(b=b.updateIn((0,w.expandTreeSubpath)(m,"children1"),(function(e){return j}))),n==M||n==q?b=F().OrderedMap().withMutations((function(e){var t,r=re(b.entries());try{for(r.s();!(t=r.n()).done;){var o=(0,O.Z)(t.value,2),a=o[0],l=o[1];a==s.get("id")&&n==M&&e.set(i.get("id"),i),e.set(a,l),a==s.get("id")&&n==q&&e.set(i.get("id"),i)}}catch(e){r.e(e)}finally{r.f()}})):n==B?b=b.merge((0,c.Z)({},i.get("id"),i)):n==G&&(b=F().OrderedMap((0,c.Z)({},i.get("id"),i)).merge(b)),h&&(j=(j=j.updateIn((0,w.expandTreeSubpath)(y,"children1"),(function(e){return b}))).delete(i.get("id"))),g||v||(e=e.updateIn((0,w.expandTreePath)(a,"children1"),(function(e){return j}))),h||(e=e.updateIn((0,w.expandTreePath)(p,"children1"),(function(e){return b}))),(0,w.fixPathsInTree)(e)},he=function(e,t,r,n){if(!r)return ge(e,t);var o=n.settings,i=o.fieldSeparator,a=o.setOpOnChangeField,l=o.showErrorMessage;Array.isArray(r)&&(r=r.join(i));var u=e.getIn((0,w.expandTreePath)(t,"type")),s=e.getIn((0,w.expandTreePath)(t,"properties")),c="rule_group"==u,p=(0,H.getFieldConfig)(n,r),d="!group"==p.type,f=d&&"array"==p.mode,g=c!=d,v=s.get("operator"),h=s.get("operatorOptions"),m=(s.get("field"),s.get("value"),s.get("valueSrc",new(F().List)),s.get("valueType",new(F().List)),p&&-1!==p.operators.indexOf(v)?v:null),y=null,b=(0,U.Qu)(n,r);if(b&&1==b.length)y=b[0];else if(b&&b.length>1){var O,j=re(a||[]);try{for(j.s();!(O=j.n()).done;){var C=O.value;if("keep"!=C||g?"default"==C?y=(0,S.defaultOperator)(n,r,!1):"first"==C&&(y=(0,U.Gx)(n,r)):y=m,y)break}}catch(e){j.e(e)}finally{j.f()}}if(!d&&!p.operators)return console.warn("Type ".concat(p.type," is not supported")),e;if(c&&!d&&(e=(e=(e=e.setIn((0,w.expandTreePath)(t,"type"),"rule")).deleteIn((0,w.expandTreePath)(t,"children1"))).setIn((0,w.expandTreePath)(t,"properties"),new(F().OrderedMap))),d){e=e.setIn((0,w.expandTreePath)(t,"type"),"rule_group");var E=(0,U.g0)(n,n,s,r,y,"field",!0),k=(E.canReuseValue,E.newValue),P=E.newValueSrc,L=E.newValueType,Z=E.operatorCardinality,_=(0,S.defaultGroupProperties)(n,p).merge({field:r,mode:p.mode});return f&&(_=_.merge({operator:y,value:k,valueSrc:P,valueType:L})),e=(e=e.setIn((0,w.expandTreePath)(t,"children1"),new(F().OrderedMap))).setIn((0,w.expandTreePath)(t,"properties"),_),p.initialEmptyWhere&&1==Z||(e=fe(e,t,"rule",(0,$.Z)(),(0,S.defaultRuleProperties)(n,r),n)),(0,w.fixPathsInTree)(e)}return e.updateIn((0,w.expandTreePath)(t,"properties"),(function(e){return e.withMutations((function(e){var t=(0,U.g0)(n,n,e,r,y,"field",!0),o=t.canReuseValue,i=t.newValue,a=t.newValueSrc,u=t.newValueType,s=t.newValueError;l&&(e=e.set("valueError",s));var c=o?h:(0,S.defaultOperatorOptions)(n,y,r);return e.set("field",r).set("operator",y).set("operatorOptions",c).set("value",i).set("valueSrc",a).set("valueType",u).delete("asyncListValues")}))}))},me=function(e,t,r,n){var o=n.settings.showErrorMessage,i=e.getIn((0,w.expandTreePath)(t,"properties")),a=e.getIn((0,w.expandTreePath)(t,"children1")),l=i.get("field"),u="!group"==(0,H.getFieldConfig)(n,l).type,s=(0,H.getOperatorConfig)(n,r,l),c=s?(0,Y.LS)(s.cardinality,1):null;return e=e.updateIn((0,w.expandTreePath)(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),i=e.get("operatorOptions"),a=(e.get("value",new(F().List)),e.get("valueSrc",new(F().List)),e.get("operator"),(0,U.g0)(n,n,e,t,r,"operator",!0)),l=a.canReuseValue,u=a.newValue,s=a.newValueSrc,c=a.newValueType,p=a.newValueError;o&&(e=e.set("valueError",p));var d=l?i:(0,S.defaultOperatorOptions)(n,r,t);return l||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",d).set("value",u).set("valueSrc",s).set("valueType",c)}))})),u&&0==c&&0==a.size&&(e=fe(e,t,"rule",(0,$.Z)(),(0,S.defaultRuleProperties)(n,l),n)),e},ye=function(e,t,r,n,o,i,a,l){var u,s=i.settings,c=s.fieldSeparator,p=s.showErrorMessage,d=e.getIn((0,w.expandTreePath)(t,"properties","valueSrc",r+""))||null;"field"===d&&Array.isArray(n)&&(n=n.join(c));var f=e.getIn((0,w.expandTreePath)(t,"properties","field"))||null,g=e.getIn((0,w.expandTreePath)(t,"properties","operator"))||null,v=(0,H.getOperatorConfig)(i,g,f),h=g?(0,Y.LS)(v.cardinality,1):null,m=o||Fe(n,d,i),y=(0,K.ik)(i,f,f,g,n,m,d,a,!1,!1),b=(0,O.Z)(y,2),j=b[0],S=b[1],C=!j;if(S!==n&&(n=S),p){var E=(0,U.wg)(i,f,g,d),k=(0,H.getFieldWidgetConfig)(i,f,g,E,d),P=Array.from({length:h},(function(r,n){return e.getIn((0,w.expandTreePath)(t,"properties","valueSrc",n+""))||null}));if(v&&v.validateValues&&P.filter((function(e){return"value"==e||null==e})).length==h){var L=Array.from({length:h},(function(o,i){return i==r?n:e.getIn((0,w.expandTreePath)(t,"properties","value",i+""))||null})),Z=k&&k.toJS?L.map((function(e){return k.toJS(e,k)})):L,_=v.validateValues(Z);e=e.setIn((0,w.expandTreePath)(t,"properties","valueError",h),_)}}e.getIn((0,w.expandTreePath)(t,"properties","value"))||(e=e.setIn((0,w.expandTreePath)(t,"properties","value"),new(F().List)(new Array(h))).setIn((0,w.expandTreePath)(t,"properties","valueType"),new(F().List)(new Array(h))).setIn((0,w.expandTreePath)(t,"properties","valueError"),new(F().List)(new Array(h))));var R=null==e.getIn((0,w.expandTreePath)(t,"properties","value",r+"")),T=!!e.getIn((0,w.expandTreePath)(t,"properties","valueError",r));return(C||p)&&(e=e.deleteIn((0,w.expandTreePath)(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn((0,w.expandTreePath)(t,"properties","value",r+""),void 0)).setIn((0,w.expandTreePath)(t,"properties","valueType",r+""),null):(a&&(e=e.setIn((0,w.expandTreePath)(t,"properties","asyncListValues"),a)),e=(e=e.setIn((0,w.expandTreePath)(t,"properties","value",r+""),n)).setIn((0,w.expandTreePath)(t,"properties","valueType",r+""),m),u=l&&!R&&!T)),p&&(e=e.setIn((0,w.expandTreePath)(t,"properties","valueError",r),j)),l&&(C&&T||!C&&!T)&&(e=e.setIn((0,w.expandTreePath)(t,"properties","valueError",r),j),u=!1),{tree:e,isInternalValueChange:u}},be=function(e,t,r,n,o){var i=o.settings.showErrorMessage,a=e.getIn((0,w.expandTreePath)(t,"properties","field"))||null,l=e.getIn((0,w.expandTreePath)(t,"properties","operator"))||null;if(e=(e=(e=e.setIn((0,w.expandTreePath)(t,"properties","value",r+""),void 0)).setIn((0,w.expandTreePath)(t,"properties","valueType",r+""),null)).deleteIn((0,w.expandTreePath)(t,"properties","asyncListValues")),i){e=e.setIn((0,w.expandTreePath)(t,"properties","valueError",r),null);var u=(0,H.getOperatorConfig)(o,l,a),s=l?(0,Y.LS)(u.cardinality,1):null;u.validateValues&&(e=e.setIn((0,w.expandTreePath)(t,"properties","valueError",s),null))}if(e=void 0===n?e.setIn((0,w.expandTreePath)(t,"properties","valueSrc",r+""),null):e.setIn((0,w.expandTreePath)(t,"properties","valueSrc",r+""),n),n){var c=e.getIn((0,w.expandTreePath)(t,"properties")),p=(0,U.g0)(o,o,c,a,l,"valueSrc",!0),d=p.canReuseValue,f=p.newValue,g=p.newValueSrc,v=p.newValueType;p.newValueError,d||g.get(r)!=n||(e=(e=e.setIn((0,w.expandTreePath)(t,"properties","value",r+""),f.get(r))).setIn((0,w.expandTreePath)(t,"properties","valueType",r+""),v.get(r)))}return e},Oe=function(e,t,r,n){return e.setIn((0,w.expandTreePath)(t,"properties","operatorOptions",r),n)},je=function(e,t){return t.settings.canLeaveEmptyGroup||(e=(0,w.fixEmptyGroupsInTree)(e)),e},Fe=function(e,t,r){var n=null;if(e)if("field"===t){var o=(0,H.getFieldConfig)(r,e);o&&(n=o.type)}else if("func"===t){var i=e.get("func");if(i){var a=(0,H.getFuncConfig)(r,i);a&&(n=a.returnType)}}return n},we={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},Se=function(e,t){var r=[I,z,W,J],n=te()(Q()(e,["config","asyncListValues","__isInternal"]),Y.LF),o=e.path&&function(e,t){return e.getIn((0,w.expandTreePath)(t,"properties","field"))||null}(t.tree,e.path)||e.field;return o&&(n.affectedField=o),(r.includes(e.type)||0==e.type.indexOf("@@redux"))&&(n=null),n};const Ce=m.createContext();var Ee=r(45106),ke=r(23884),Pe=function(e,t){return{type:I,tree:t,config:e}},Le=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:Z,ruleType:n,children:o,path:(0,Y.gH)(t),id:(0,$.Z)(),properties:(0,S.defaultRuleProperties)(e).merge(r||{}),config:e}},Ze=function(e,t){return{type:_,path:(0,Y.gH)(t),config:e}},_e=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:E,path:(0,Y.gH)(t),children:n,id:(0,$.Z)(),properties:(0,S.defaultGroupProperties)(e).merge(r||{}),config:e,meta:{isDefaultCase:!0}}},Re=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:E,path:(0,Y.gH)(t),children:n,id:(0,$.Z)(),properties:(0,S.defaultGroupProperties)(e).merge(r||{}),config:e}},Te=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:C,path:(0,Y.gH)(t),children:n,id:(0,$.Z)(),properties:(0,S.defaultGroupProperties)(e).merge(r||{}),config:e}},Ve=function(e,t){return{type:k,path:(0,Y.gH)(t),config:e}},Ne=function(e,t,r,n){return{type:A,fromPath:(0,Y.gH)(t),toPath:(0,Y.gH)(r),placement:n,config:e}},De=function(e,t,r){return{type:P,path:(0,Y.gH)(t),conjunction:r}},xe=function(e,t,r){return{type:L,path:(0,Y.gH)(t),not:r}},Ie=function(e,t,r){return{type:x,path:(0,Y.gH)(t),lock:r}},Ae=function(e,t,r){return{type:R,path:(0,Y.gH)(t),field:r,config:e}},qe=function(e,t,r){return{type:T,path:(0,Y.gH)(t),operator:r,config:e}},Me=function(e,t,r,n,o,i,a){return{type:V,path:(0,Y.gH)(t),delta:r,value:n,valueType:o,asyncListValues:i,config:e,__isInternal:a}},Be=function(e,t,r,n){return{type:N,path:(0,Y.gH)(t),delta:r,srcKey:n,config:e}},Ge=function(e,t,r,n){return{type:D,path:(0,Y.gH)(t),name:r,value:n,config:e}},We=function(e,t){return{type:W,mousePos:e,dragging:t}},ze=function(e,t,r){return{type:z,dragStart:e,dragging:t,mousePos:r}},Je=function(){return{type:J}},$e=r(93168);function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ye=function(e){(0,g.Z)(l,e);var t,r,a=(t=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function l(e){var t;return(0,p.Z)(this,l),(t=a.call(this,e)).shouldComponentUpdate=(0,$e.M6)((0,f.Z)(t),{tree:function(e){return e!==t.oldValidatedTree||t.oldValidatedTree!==t.validatedTree}}),(0,$e.EM)((0,f.Z)(t)),t._updateActions(e),t.validatedTree=e.getMemoizedTree(e.config,e.tree),t.oldValidatedTree=t.validatedTree,t}return(0,d.Z)(l,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=(0,$e.DE)(Ue(Ue(Ue({},n),o),i),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!(0,Y.Rh)(this.validatedTree,this.oldValidatedTree)&&t&&t(this.validatedTree,o,e.__lastAction)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch,o=e.__isInternalValueChange;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n,__isInternalValueChange:o})}}]),l}(m.Component);Ye.propTypes={config:b().object.isRequired,onChange:b().func,renderBuilder:b().func,tree:b().any};var Ke=(0,ke.$j)((function(e){return{tree:e.tree,__isInternalValueChange:e.__isInternalValueChange,__lastAction:e.__lastAction}}),null,null,{context:Ce})(Ye);Ke.displayName="ConnectedQuery";const Xe=Ke;var Qe=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e,t){var r;(0,p.Z)(this,o),(r=n.call(this,e,t)).shouldComponentUpdate=(0,$e.M6)((0,f.Z)(r),{value:function(e,t,r){return!1}}),(0,$e.EM)((0,f.Z)(r)),r.getMemoizedConfig=(0,H.createConfigMemo)(),r.getMemoizedTree=(0,K.ci)();var i=r.getMemoizedConfig(e),a=e.value,l=function(e,t,r){var n=(0,S.defaultRoot)(e),o=ie({tree:t||n},we);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments.length>1?arguments[1]:void 0,i={__isInternalValueChange:void 0,__lastAction:void 0},a={},l=Se(n,t);switch(n.type){case I:var u=r(n.config,n.tree);a.tree=u;break;case E:a.tree=ae(t.tree,n.path,"case_group",n.id,n.properties,n.config,n.children,n.meta);break;case C:a.tree=ae(t.tree,n.path,"group",n.id,n.properties,n.config,n.children,n.meta);break;case k:a.tree=le(t.tree,n.path,n.config);break;case Z:a.tree=fe(t.tree,n.path,n.ruleType,n.id,n.properties,n.config,n.children);break;case _:a.tree=ue(t.tree,n.path,n.config);break;case P:a.tree=pe(t.tree,n.path,n.conjunction);break;case L:a.tree=se(t.tree,n.path,n.not);break;case R:a.tree=he(t.tree,n.path,n.field,n.config);break;case x:a.tree=ce(t.tree,n.path,n.lock);break;case T:a.tree=me(t.tree,n.path,n.operator,n.config);break;case V:var s=ye(t.tree,n.path,n.delta,n.value,n.valueType,n.config,n.asyncListValues,n.__isInternal),c=s.tree,p=s.isInternalValueChange;a.__isInternalValueChange=p,a.tree=c;break;case N:a.tree=be(t.tree,n.path,n.delta,n.srcKey,n.config);break;case D:a.tree=Oe(t.tree,n.path,n.name,n.value);break;case A:a.tree=ve(t.tree,n.fromPath,n.toPath,n.placement,n.config);break;case z:a.dragStart=n.dragStart,a.dragging=n.dragging,a.mousePos=n.mousePos;break;case W:a.mousePos=n.mousePos,a.dragging=n.dragging;break;case J:a.tree=je(t.tree,e),a=ie(ie({},a),we)}return l&&(a.__lastAction=l),ie(ie(ie({},t),i),a)}}(i,r.getMemoizedTree(i,a),r.getMemoizedTree),u=(0,Ee.MT)(l);return r.state={store:u,config:i},r}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this,r=this.state.config,n=this.getMemoizedConfig(e),o=r!==n,i=this.state.store.getState().tree,a=!(0,Y.Rh)(e.value,this.props.value)&&!(0,Y.Rh)(e.value,i),l=a?e.value||(0,S.defaultRoot)(e):i;if(o&&this.setState({config:n}),a||o){var u=this.getMemoizedTree(n,l,r);return Promise.resolve().then((function(){t.state.store.dispatch(Pe(n,u))}))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.settings,i=this.state,a=i.config,l=i.store,u=o.renderProvider;return m.createElement(u,{config:a},m.createElement(ke.zt,{store:l,context:Ce},m.createElement(Xe,{config:a,getMemoizedTree:this.getMemoizedTree,onChange:n,renderBuilder:t||r})))}}]),o}(m.Component);Qe.propTypes={conjunctions:b().object.isRequired,fields:b().object.isRequired,types:b().object.isRequired,operators:b().object.isRequired,widgets:b().object.isRequired,settings:b().object.isRequired,onChange:b().func,renderBuilder:b().func,value:b().any};var et=r(53782),tt=r(25773);var rt=r(60042),nt=r(649),ot=r(43023),it=r.n(ot);function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var o=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,v.Z)(this,r)}}var lt=!1,ut=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){(0,g.Z)(o,t);var n=at(o);function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e))._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=(0,$e.W7)(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var i,a=o.closest(".query-builder-container")||o,l=(a=t._getScrollParent(a)||document.body).scrollTop,u=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),s=u.length?u[0]:null;s&&(i=window.getComputedStyle(s,null).getPropertyValue("padding-left"),i=parseInt(i));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:i},p={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:l,clientX:n.clientX,clientY:n.clientY,itemInfo:it()(t.tree.items[e]),treeEl:o,treeElContainer:a},d={clientX:n.clientX,clientY:n.clientY},f=t._getEventTarget(n,p);t.eventTarget=f,f.addEventListener("mousemove",t.onDrag),f.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(p,c,d)},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),i=t.props.dragStart,a=o.paddingLeft,l=i.treeElContainer,u=l.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var s={clientX:e.clientX,clientY:e.clientY},c={clientX:i.clientX,clientY:i.clientY};if(e.__mock_dom){var p=i.treeEl,d=t._getDraggableNodeEl(p),f=t._getPlaceholderNodeEl(p);e.__mock_dom({treeEl:p,dragEl:d,plhEl:f})}if(!i.plX){var g=i.treeEl,v=t._getPlaceholderNodeEl(g);v&&(i.plX=v.getBoundingClientRect().left+window.scrollX,i.plY=v.getBoundingClientRect().top+window.scrollY)}var h=i.x,m=i.y,y=i.clientX,b=i.clientY,O=i.scrollTop,j={x:h+(e.clientX-y),y:m+(e.clientY-b)+(u-O)};o.x=j.x,o.y=j.y,o.paddingLeft=a,o.mousePos=s,o.startMousePos=c,t.props.setDragProgress(s,o);var F=!!n&&t.handleDrag(o,e,r);F||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){this.tree=(0,w.getFlatTree)(e.tree)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=(0,$e.gt)(this)(e,t);if(o&&n==t&&r!=e){var i=[];for(var a in e)e[a]!=r[a]&&"dragging"!=a&&"mousePos"!=a&&i.push(a);i.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(lt=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,i=n.treeElContainer,a=this._getPlaceholderNodeEl(o,!0);if(a){var l=a.getBoundingClientRect().left+window.scrollX,u=a.getBoundingClientRect().top+window.scrollY,s=n.plX,c=n.plY,p=i.scrollTop;n.plX=l,n.plY=u,n.itemInfo=it()(r.itemInfo),n.y=a.offsetTop,n.x=a.offsetLeft,n.clientY+=u-c,n.clientX+=l-s,i!=document.body&&(n.scrollTop=p),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,i,a,l=this,u=e.itemInfo,s=e.paddingLeft,c=null,p=this.props.dragStart.treeEl,d=e.id,f=this._getDraggableNodeEl(p),g=this._getPlaceholderNodeEl(p);if(f&&g){if(n=f.getBoundingClientRect(),!(o=g.getBoundingClientRect()).width)return;var v={hrz:0,vrt:0};n.top<o.top?v.vrt=-1:n.bottom>o.bottom&&(v.vrt=1),n.left>o.left?v.hrz=1:n.left<o.left&&(v.hrz=-1);var h,m={x:(a=p.getBoundingClientRect()).left+(a.right-a.left)/2,y:v.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)h=t.__mocked_hov_container;else{var y=document.elementFromPoint(m.x,m.y-1);if(!(h=y?y.closest(".group-or-rule-container"):null)&&y&&y.classList.contains("query-builder-container")){var b,O=null==y||null===(b=y.firstChild)||void 0===b?void 0:b.firstChild;O&&O.classList.contains("group-or-rule-container")&&(h=O)}}if(h){var j=h.classList.contains("group-container"),F=h.getAttribute("data-id"),w=h,S=!1,C=!1;if(w){var E=(i=w.getBoundingClientRect()).bottom-i.top,k=this.tree.items[F],P=null,L=null,Z=null,_=null;if(0==v.vrt)Z=u,(L=g)&&(P=L.getBoundingClientRect());else if(j){if(v.vrt>0){var R=h.getElementsByClassName("group--header"),T=R.length?R[0]:null;if(T){var V=T.getBoundingClientRect(),N=V.bottom-V.top;n.bottom-V.top>3*N/4&&k.top>e.itemInfo.top&&(Z=k,P=V,L=T,C=!0)}}else v.vrt<0&&k.lev>=u.lev&&i.bottom-n.top>=2&&k.top<e.itemInfo.top&&(Z=k,P=i,L=w,S=!0);(v.vrt<0?i.bottom-n.top>E-5:n.bottom-i.top>E-5)&&(C||S||(Z=k,P=i,L=w),_=k)}else(v.vrt<0?i.bottom-n.top>E/2:n.bottom-i.top>E/2)&&(Z=k,P=i,L=w);var D=Z&&Z.id==d;if(P){var x=n.left-a.left,I=(P.left,a.left,Math.max(0,Math.round(x/s))),A=[],W=[];if(D);else{if(j&&(S?A.push([B,Z,Z.lev+1]):C&&A.push([G,Z,Z.lev+1]),_)){var z=0==_.lev,J="case_group"==_.type&&"case_group"!=u.type,$=_.prev&&this.tree.items[_.prev].caseId,H=_.next&&this.tree.items[_.next].caseId;u.caseId==$&&($=null),u.caseId==H&&(H=null);var U=$&&this.tree.items[$],K=H&&this.tree.items[H];v.vrt>0?z?W.push([B,_,_.lev+1]):J&&K?W.push([G,K,K.lev+1]):W.push([q,_,_.lev]):v.vrt<0&&(z?W.push([G,_,_.lev+1]):J&&U?W.push([B,U,U.lev+1]):W.push([M,_,_.lev]))}S||C||(v.vrt<0?A.push([M,Z,Z.lev]):v.vrt>0&&A.push([q,Z,Z.lev]))}var X=function(e){var t=e[1],r=u.caseId?l.tree.items[u.caseId]:null,n=t.caseId?l.tree.items[t.caseId]:null;return[].concat((0,nt.Z)(e),[r,n])};A=A.map(X),W=W.map(X);var Q=null,ee=(A=A.filter((function(e){var t=e[0],r=e[1];if((t==M||t==q)&&null==r.parent)return!1;if(r.collapsed&&(t==B||t==G))return!1;var n=r.id==u.id;if(!n)for(var o=r;o.parent;)if((o=l.tree.items[o.parent]).id==u.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==B||t==G?r:l.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return l.canMove(u,e[1],e[0],e[3],e[4],e[5],r)}));0==ee.length&&W.length>0&&(ee=W.filter((function(e){return l.canMove(u,e[1],e[0],e[3],e[4],e[5],r)})));var te=ee.map((function(e){return e[2]})),re=u.lev,ne=te.concat(re),oe=null;-1!=ne.indexOf(I)?oe=I:I>Math.max.apply(Math,(0,nt.Z)(ne))?oe=Math.max.apply(Math,(0,nt.Z)(ne)):I<Math.min.apply(Math,(0,nt.Z)(ne))&&(oe=Math.min.apply(Math,(0,nt.Z)(ne))),Q=ee.find((function(e){return e[2]==oe})),D||Q||!ee.length||(Q=ee[0]),c=Q}}}else Y.kg.log("out of tree bounds!")}return!!c&&(this.move(u,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,i,a){if(!e||!t)return!1;if(e.id===t.id)return!1;var l=this.props.config.settings,u=l.canRegroup,s=l.canRegroupCases,c=l.maxNesting,p=l.maxNumberOfRules,d=l.canLeaveEmptyCase,f=i?i.lev+1:t.lev,g=r==M||r==q,v=r==G||r==B,h=g&&1==t.lev||v&&0==t.lev,m=e.parent!=t.parent,y=v||m,b="case_group"==e.type&&!h||"rule_group"==e.parentType||"rule_group"==t.type||"rule_group"==t.parentType||"case_group"!=e.type&&"case_group"==t.type&&g||"case_group"!=e.type&&"switch_group"==t.type||!s&&e.caseId!=t.caseId,O=t.isLocked||e.isLocked||i&&i.isLocked;if(c&&f>c)return!1;if(y&&(!u||b||O))return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var j=!!n&&2==n._height,F=o?o.leafsCount+1:0;if(p&&F>p)return!1;if(j&&!d)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==B))return!1;var w=!0;return a&&(w=a(e.node.toJS(),t.node.toJS(),r,i?i.node.toJS():null)),w}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(lt=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return m.createElement(e,(0,tt.Z)({},this.props,{onDragStart:this.onDragStart}))}}]),o}(m.Component),t.propTypes={tree:b().any.isRequired,actions:b().object.isRequired},t},st=["isDraggingTempo","isDraggingMe","dragging"];var ct=r(60042);const pt=function(e){return function(t){var r;return r=function(r){(0,g.Z)(a,r);var n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,h.Z)(n);if(o){var r=(0,h.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,v.Z)(this,e)});function a(e){var t;return(0,p.Z)(this,a),(t=i.call(this,e)).handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=m.createRef(),t}return(0,d.Z)(a,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,i=r.dragging,a=(0,et.Z)(r,st),l=a.isTrueLocked,u={};o&&n&&(lt||(u={top:i.y,left:i.x,width:i.w}));var s=ct(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,l?"locked":null);return m.createElement("div",{className:s,style:u,ref:this.wrapper,"data-id":this.props.id},m.createElement(t,(0,tt.Z)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},a)))}}]),a}(m.PureComponent),r.propTypes={isDraggingTempo:b().bool,isDraggingMe:b().bool,onDragStart:b().func,dragging:b().object,isLocked:b().bool,isTrueLocked:b().bool},r}};var dt=r(50098),ft=r.n(dt),gt=r(71975),vt=r.n(gt);function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var mt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),t=n.call(this,e),(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.config,r=e.selectedField,n=e.selectedOperator,o=(0,H.getFieldConfig)(t,r),i=null==o?void 0:o.operators,a=te()(vt()(t.operators,(function(e,t){return-1!==(null==i?void 0:i.indexOf(t))})),(function(e,n){return(0,H.getOperatorConfig)(t,n,r)})),l=this.buildOptions(t,a,i),u=!!n,s=(u?a[n]:null)||{},c=u?[n]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:l,selectedKey:n,selectedKeys:c,selectedPath:c,selectedLabel:s.label,selectedOpts:s,fieldConfig:o}}},{key:"buildOptions",value:function(e,t,r){return t&&r?ft()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){return{key:e,path:e,label:t[e].label}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderOperator,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:n},this.meta);return u.items?l(u):null}}]),o}(m.PureComponent);mt.propTypes={id:b().string,groupId:b().string,config:b().object.isRequired,selectedField:b().string,selectedOperator:b().string,readonly:b().bool,setOperator:b().func.isRequired};var yt=r(67103);var bt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.setOperator,i=e.selectedFieldPartsLabels,a=e.showOperator,l=e.showOperatorLabel,u=e.selectedFieldWidgetConfig,s=e.readonly,c=e.id,p=e.groupId;return[a&&m.createElement(yt.JX,{key:"operators-for-"+(i||[]).join("_"),className:"rule--operator"},t.settings.showLabels&&m.createElement("label",{className:"rule--label"},t.settings.operatorLabel),m.createElement(mt,{key:"operator",config:t,selectedField:r,selectedOperator:n,setOperator:o,readonly:s,id:c,groupId:p})),l&&m.createElement(yt.JX,{key:"operators-for-"+(i||[]).join("_"),className:"rule--operator"},m.createElement("div",{className:"rule--operator"},t.settings.showLabels?m.createElement("label",{className:"rule--label"}," "):null,m.createElement("span",null,u.operatorInlineLabel)))]}}]),o}(m.PureComponent),Ot=r(31159),jt=r.n(Ot);function Ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var wt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),t=n.call(this,e),(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.config,n=e.parentField,o=t,i=r.settings,a=i.maxLabelsLength,l=i.fieldSeparatorDisplay,u=i.fieldPlaceholder,s=i.fieldSeparator,c=!!t,p=c?null:(0,Y.aS)(u,a),d=c?(0,H.getFieldConfig)(r,o):null,f=d||{},g=(0,U.rA)(o,r),v=(0,U.rA)(o,r,!0),h=this.getFieldLabel(d,o,r),m=(0,U.fY)(o,r),y=m?m.join(l):null;(y==h||n)&&(y=null);var b=f.label2,O="string"==typeof n?n.split(s):n,j=n?(0,H.getFieldConfig)(r,n):null,F=n?j&&j.subfields:r.fields;return{placeholder:p,items:this.buildOptions(O,r,F,O),parentField:n,selectedKey:o,selectedKeys:g,selectedPath:v,selectedLabel:h,selectedOpts:f,selectedAltLabel:b,selectedFullLabel:y}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.fieldSeparator,o=r.settings.maxLabelsLength,i=Array.isArray(t)?t:t.split(n),a=e&&e.label||jt()(i);return(0,Y.aS)(a,o)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var a=t.settings,l=a.fieldSeparator,u=a.fieldSeparatorDisplay,s=o?o.join(l)+l:"";return ft()(r).map((function(a){var l=r[a],c=n.getFieldLabel(l,a,t),p=(0,U.fY)(s+a,t).join(u);(p==c||e)&&(p=null);var d=l.label2,f=l.tooltip,g=(o||[]).concat(a),v=l.disabled;if(!l.hideForSelect)return"!struct"==l.type?{disabled:v,key:a,path:s+a,label:c,fullLabel:p,altLabel:d,tooltip:f,items:n.buildOptions(e,t,l.subfields,g,c)}:{disabled:v,key:a,path:s+a,label:c,fullLabel:p,altLabel:d,tooltip:f,grouplabel:i}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setField,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:n},this.meta);return l(u)}}]),o}(m.PureComponent);wt.propTypes={id:b().string,groupId:b().string,config:b().object.isRequired,selectedField:b().string,parentField:b().string,customProps:b().object,readonly:b().bool,setField:b().func.isRequired};var St=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.setField,o=e.parentField,i=e.classname,a=e.readonly,l=e.id,u=e.groupId;return m.createElement(yt.JX,{className:i},t.settings.showLabels&&m.createElement("label",{className:"rule--label"},t.settings.fieldLabel),m.createElement(wt,{config:t,selectedField:r,parentField:o,setField:n,customProps:t.settings.customFieldSelectProps,readonly:a,id:l,groupId:u}))}}]),o}(m.PureComponent),Ct=r(24900),Et=["factory"];var kt,Pt,Lt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=(0,H.getOperatorConfig)(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=(0,et.Z)(t,Et),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly})),i=this.props.selectedOperator;return m.createElement("div",{className:"rule--operator rule--operator--".concat(i.toUpperCase())},o)}}]),o}(m.PureComponent);function Zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Lt.propTypes={config:b().object.isRequired,operatorOptions:b().any.isRequired,selectedField:b().string.isRequired,selectedOperator:b().string.isRequired,readonly:b().bool,setOperatorOption:b().func.isRequired};var Rt=r(60042);const Tt=function(e){var t=(0,ke.$j)((function(e){return{dragging:e.dragging}}),null,null,{context:Ce})(function(e){var t;return t=function(t){(0,g.Z)(i,t);var r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,h.Z)(r);if(n){var o=(0,h.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,v.Z)(this,e)});function i(e){var t;return(0,p.Z)(this,i),(t=o.call(this,e)).dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e){t.props.actions.setField(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,i){t.props.actions.setValue(t.props.path,e,r,n,o,i)},t.setValueSrc=function(e,r){t.props.actions.setValueSrc(t.props.path,e,r)},t.dummyFn.isDummyFn=!0,t}return(0,d.Z)(i,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=(0,$e.gt)(this)(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var l in e){var u=e[l]!=r[l];"dragging"!=l||i||(u=!1),u&&a.push(l)}a.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=(0,H.getFieldConfig)(this.props.config,this.props.field),n=this.props.config.settings.showErrorMessage,o=(r&&r.type,!t&&this.props.isDraggingTempo),i=this.props.valueError,a=null!=(i&&i.toArray().filter((function(e){return!!e})).shift()||null)&&n;return m.createElement("div",{className:rt("group-or-rule-container","rule-container",a?"rule-with-error":null),"data-id":this.props.id},[t?m.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueError:this.props.valueError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,m.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:t,isDraggingTempo:o,onDragStart:this.props.onDragStart,setLock:o?this.dummyFn:this.setLock,removeSelf:o?this.dummyFn:this.removeSelf,setField:o?this.dummyFn:this.setField,setOperator:o?this.dummyFn:this.setOperator,setOperatorOption:o?this.dummyFn:this.setOperatorOption,setValue:o?this.dummyFn:this.setValue,setValueSrc:o?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueError:this.props.valueError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),i}(m.Component),t.propTypes={id:b().string.isRequired,groupId:b().string,config:b().object.isRequired,path:b().any.isRequired,operator:b().string,field:b().string,actions:b().object.isRequired,onDragStart:b().func,value:b().any,valueSrc:b().any,asyncListValues:b().array,valueError:b().any,operatorOptions:b().object,reordableNodesCnt:b().number,parentField:b().string,isLocked:b().bool,isTrueLocked:b().bool,dragging:b().object,isDraggingTempo:b().bool},t}(e));return t.displayName="ConnectedRuleContainer",t}(kt=pt("rule")(kt=(0,yt.rB)((Pt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),t=n.call(this,e),(0,$e.EM)((0,f.Z)(t)),t.removeSelf=t.removeSelf.bind((0,f.Z)(t)),t.setLock=t.setLock.bind((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedOperator","config","reordableNodesCnt","isLocked"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedOperator,n=e.config,o=e.reordableNodesCnt,i=e.isLocked,a=(0,U.fY)(t,n),l=(0,H.getFieldConfig)(n,t),u=l&&"!struct"==l.type,s=t&&r&&!u,c=(0,H.getOperatorConfig)(n,r,t),p=c&&null!=c.options,d=(0,H.getFieldWidgetConfig)(n,t,r)||{},f=d.hideOperator;return{selectedFieldPartsLabels:a,selectedFieldWidgetConfig:d,showDragIcon:n.settings.canReorder&&o>1&&!i,showOperator:t&&!f,showOperatorLabel:t&&f&&d.operatorInlineLabel,showWidget:s,showOperatorOptions:s&&p}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this,t=this.props.confirmFn,r=this.props.config.settings,n=r.renderConfirm,o=r.removeRuleConfirmOptions,i=function(){e.props.removeSelf()};o&&!this.isEmptyCurrentRule()?n(_t(_t({},o),{},{onOk:i,onCancel:null,confirmFn:t})):i()}},{key:"isEmptyCurrentRule",value:function(){return!(null!==this.props.selectedField&&null!==this.props.selectedOperator&&this.props.value.filter((function(e){return void 0!==e})).size>0)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings.immutableFieldsMode;return m.createElement(St,{key:"field",classname:"rule--field",config:t,selectedField:this.props.selectedField,setField:n?yt.ig:this.props.setField,parentField:this.props.parentField,readonly:n||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldPartsLabels,i=n.selectedFieldWidgetConfig,a=n.showOperator,l=n.showOperatorLabel,u=t.settings.immutableOpsMode;return m.createElement(bt,{key:"operator",config:t,selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,setOperator:u?yt.ig:this.props.setOperator,selectedFieldPartsLabels:o,showOperator:a,showOperatorLabel:l,selectedFieldWidgetConfig:i,readonly:u||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.isLocked,o=this.meta.showWidget,i=t.settings.immutableValuesMode;if(!o)return null;var a=m.createElement(Ct.Z,{key:"values",field:this.props.selectedField,parentField:this.props.parentField,operator:this.props.selectedOperator,value:this.props.value,valueSrc:this.props.valueSrc,asyncListValues:this.props.asyncListValues,valueError:r,config:t,setValue:i?yt.ig:this.props.setValue,setValueSrc:i?yt.ig:this.props.setValueSrc,readonly:i||n,id:this.props.id,groupId:this.props.groupId});return m.createElement(yt.JX,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},a)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var i=m.createElement(Lt,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?yt.ig:this.props.setOperatorOption,config:e,readonly:o});return m.createElement(yt.JX,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},i)}},{key:"renderBeforeWidget",value:function(){var e=this.props.config.settings.renderBeforeWidget;return e&&m.createElement(yt.JX,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},"function"==typeof e?e(this.props):e)}},{key:"renderAfterWidget",value:function(){var e=this.props.config.settings.renderAfterWidget;return e&&m.createElement(yt.JX,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},"function"==typeof e?e(this.props):e)}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,i=n.showErrorMessage,a=r&&r.toArray().filter((function(e){return!!e})).shift()||null;return i&&a&&m.createElement("div",{className:"rule--error"},o?o({error:a}):a)}},{key:"renderDrag",value:function(){return this.meta.showDragIcon&&m.createElement("span",{key:"rule-drag-icon",className:"qb-drag-handler rule--drag-handler",onMouseDown:this.props.handleDraggerMouseDown},m.createElement(yt.Vn,null)," ")}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,i=n.immutableGroupsMode,a=n.renderButton,l=n.canDeleteLocked;return!i&&(!r||r&&l)&&m.createElement(a,{type:"delRule",onClick:this.removeSelf,label:o,config:t})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,i=t.settings,a=i.lockLabel,l=i.lockedLabel,u=i.showLock,s=i.renderSwitch;return u&&!(r&&!n)&&m.createElement(s,{type:"lock",id:o,value:r,setValue:this.setLock,label:a,checkedLabel:l,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,i=n.value,a=n.config,l="value"==o.first()&&!t&&1==i.size&&r.fullWidth,u=a.settings.renderButtonGroup,s=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],c=m.createElement("div",{key:"rule-body",className:Rt("rule--body",l&&"can--shrink--value")},s),p=this.renderError(),d=this.renderDrag(),f=this.renderLock(),g=this.renderDel();return m.createElement(m.Fragment,null,d,m.createElement("div",{className:"rule--body--wrapper"},c,p),m.createElement("div",{className:"rule--header"},m.createElement(u,{config:a},f,g)))}}]),o}(m.PureComponent),Pt.propTypes={id:b().string.isRequired,groupId:b().string,selectedField:b().string,selectedOperator:b().string,operatorOptions:b().object,config:b().object.isRequired,value:b().any,valueSrc:b().any,asyncListValues:b().array,isDraggingMe:b().bool,isDraggingTempo:b().bool,parentField:b().string,valueError:b().any,isLocked:b().bool,isTrueLocked:b().bool,handleDraggerMouseDown:b().func,setField:b().func,setOperator:b().func,setOperatorOption:b().func,setLock:b().func,removeSelf:b().func,setValue:b().func,setValueSrc:b().func,reordableNodesCnt:b().number},kt=Pt))||kt)||kt)||kt;var Vt=r(9465),Nt=r.n(Vt);const Dt=function(e){var t=(0,ke.$j)((function(e){return{dragging:e.dragging}}),null,null,{context:Ce})(function(e){var t;return t=function(t){(0,g.Z)(i,t);var r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,h.Z)(r);if(n){var o=(0,h.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,v.Z)(this,e)});function i(e){var t;return(0,p.Z)(this,i),(t=o.call(this,e))._selectedConjunction=function(e){return(e=e||t.props).conjunction||(0,S.defaultGroupConjunction)(e.config,e.field)},t.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setConjunction(t.props.path,e)},t.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setNot(t.props.path,e)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeGroup(t.props.path)},t.addGroup=function(){t.props.actions.addGroup(t.props.path)},t.addCaseGroup=function(){t.props.actions.addCaseGroup(t.props.path)},t.addDefaultCaseGroup=function(){t.props.actions.addDefaultCaseGroup(t.props.path)},t.addRule=function(){t.props.actions.addRule(t.props.path)},t.setField=function(e){t.props.actions.setField(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setValue=function(e,r,n){t.props.actions.setValue(t.props.path,e,r,n)},(0,$e.EM)((0,f.Z)(t)),t.selectedConjunction=t._selectedConjunction(e),t.conjunctionOptions=t._getConjunctionOptions(e),t.dummyFn.isDummyFn=!0,t}return(0,d.Z)(i,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=(0,$e.gt)(this)(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var l in e){var u=e[l]!=r[l];"dragging"!=l||i||(u=!1),u&&a.push(l)}a.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return te()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=this.props.path.size,n=this.props.config.settings.maxNesting,o=!t&&this.props.isDraggingTempo,i=void 0===n||r<n,a=1==r;return m.createElement("div",{className:"group-or-rule-container group-container","data-id":this.props.id},[t?m.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:a,allowFurtherNesting:i,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,value:this.props.value||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,m.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:t,isDraggingTempo:o,onDragStart:this.props.onDragStart,isRoot:a,allowFurtherNesting:i,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:o?this.dummyFn:this.setConjunction,setNot:o?this.dummyFn:this.setNot,setLock:o?this.dummyFn:this.setLock,removeSelf:o?this.dummyFn:this.removeSelf,addGroup:o?this.dummyFn:this.addGroup,addCaseGroup:o?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:o?this.dummyFn:this.addDefaultCaseGroup,addRule:o?this.dummyFn:this.addRule,setField:o?this.dummyFn:this.setField,setOperator:o?this.dummyFn:this.setOperator,setValue:o?this.dummyFn:this.setValue,value:this.props.value||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),i}(m.Component),t.propTypes={config:b().object.isRequired,actions:b().object.isRequired,path:b().any.isRequired,id:b().string.isRequired,groupId:b().string,not:b().bool,conjunction:b().string,children1:b().any,onDragStart:b().func,reordableNodesCnt:b().number,field:b().string,parentField:b().string,isLocked:b().bool,isTrueLocked:b().bool,dragging:b().object,isDraggingTempo:b().bool},t}(e));return t.displayName="ConnectedGroupContainer",t};var xt={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},It=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,i=e.setLock,a=e.isLocked,l=e.isTrueLocked,u=e.id,s=e.canAddGroup,c=e.canAddRule,p=e.canDeleteGroup,d=t.settings,f=d.immutableGroupsMode,g=d.addRuleLabel,v=d.addGroupLabel,h=d.delGroupLabel,y=d.groupActionsPosition,b=d.renderButton,O=d.renderSwitch,j=d.renderButtonGroup,F=d.lockLabel,w=d.lockedLabel,S=d.showLock,C=d.canDeleteLocked,E=xt[y||"topRight"],k=S&&!(a&&!l)&&m.createElement(O,{type:"lock",id:u,value:a,setValue:i,label:F,checkedLabel:w,config:t}),P=!f&&c&&!a&&m.createElement(b,{type:"addRule",onClick:r,label:g,readonly:a,config:t}),L=!f&&s&&!a&&m.createElement(b,{type:"addGroup",onClick:n,label:v,readonly:a,config:t}),Z=!f&&p&&(!a||a&&C)&&m.createElement(b,{type:"delGroup",onClick:o,label:h,config:t});return m.createElement("div",{className:"group--actions ".concat(E)},m.createElement(j,{config:t},k,P,L,Z))}}]),o}(m.PureComponent);function At(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?At(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):At(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Mt=r(60042),Bt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return""},t.renderBeforeActions=function(){var e=t.props.config.settings.renderBeforeActions;return null==e?null:"function"==typeof e?m.createElement(e,t.props):e},t.renderAfterActions=function(){var e=t.props.config.settings.renderAfterActions;return null==e?null:"function"==typeof e?m.createElement(e,t.props):e},t.removeSelf=t.removeSelf.bind((0,f.Z)(t)),t.setLock=t.setLock.bind((0,f.Z)(t)),t.renderItem=t.renderItem.bind((0,f.Z)(t)),t}return(0,d.Z)(o,[{key:"isGroupTopPosition",value:function(){return Nt()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this,t=this.props.confirmFn,r=this.props.config.settings,n=r.renderConfirm,o=r.removeGroupConfirmOptions,i=function(){e.props.removeSelf()};o&&!this.isEmptyCurrentGroup()?n(qt(qt({},o),{},{onOk:i,onCancel:null,confirmFn:t})):i()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.children1;return!e||0==e.size||1==e.size&&this.isEmpty(e.first())}},{key:"isEmpty",value:function(e){return"group"==e.get("type")||"rule_group"==e.get("type")?this.isEmptyGroup(e):this.isEmptyRule(e)}},{key:"isEmptyGroup",value:function(e){var t=e.get("children1");return!t||0==t.size||1==t.size&&this.isEmpty(t.first())}},{key:"isEmptyRule",value:function(e){var t=e.get("properties");return!(null!==t.get("field")&&null!==t.get("operator")&&t.get("value").filter((function(e){return void 0!==e})).size>0)}},{key:"render",value:function(){return m.createElement(m.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}},{key:"showNot",value:function(){return this.props.config.settings.showNot}},{key:"showConjs",value:function(){var e=this.props,t=e.conjunctionOptions;return e.children1,e.config,Object.keys(t).length>1||this.showNot()}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&m.createElement("div",{key:"group-children",className:Mt("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return m.createElement("div",{key:"group-header",className:Mt("group--header",this.isOneChild()?"one--child":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&m.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return m.createElement(It,{config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props.config.settings.maxNumberOfRules,t=this.props.totalRulesCnt;return!e||t<e}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.map(this.renderItem).toList():null}},{key:"renderItem",value:function(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,i=t.isLocked,a="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return m.createElement(Lr,(0,tt.Z)({},this.extraPropsForItem(e),{key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:a,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:i}))}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=this.reordableNodesCnt();return t.settings.canReorder&&!r&&o>1&&!n}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown;return this.showDragIcon()&&m.createElement("span",{key:"group-drag-icon",className:"qb-drag-handler group--drag-handler",onMouseDown:e},m.createElement(yt.Vn,null)," ")}},{key:"conjunctionOptions",value:function(){return this.props.conjunctionOptions}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.children1,n=e.id,o=e.selectedConjunction,i=e.setConjunction,a=e.not,l=e.setNot,u=e.isLocked,s=t.settings,c=s.immutableGroupsMode,p=s.renderConjs,d=(s.showNot,s.notLabel),f=this.conjunctionOptions();if(!this.showConjs())return null;if(!r||!r.size)return null;var g={disabled:this.isOneChild(),readonly:c||u,selectedConjunction:o,setConjunction:c?yt.ig:i,conjunctionOptions:f,config:t,not:a||!1,id:n,setNot:c?yt.ig:l,notLabel:d,showNot:this.showNot(),isLocked:u};return m.createElement(p,g)}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}}]),o}(m.PureComponent);Bt.propTypes={reordableNodesCnt:b().number,conjunctionOptions:b().object.isRequired,allowFurtherNesting:b().bool.isRequired,isRoot:b().bool.isRequired,not:b().bool,selectedConjunction:b().string,config:b().object.isRequired,id:b().string.isRequired,groupId:b().string,path:b().any,children1:b().any,isDraggingMe:b().bool,isDraggingTempo:b().bool,isLocked:b().bool,isTrueLocked:b().bool,handleDraggerMouseDown:b().func,onDragStart:b().func,addRule:b().func.isRequired,addGroup:b().func.isRequired,removeSelf:b().func.isRequired,setConjunction:b().func.isRequired,setNot:b().func.isRequired,setLock:b().func.isRequired,actions:b().object.isRequired};const Gt=Dt(pt("group")((0,yt.rB)(Bt)));var Wt=r(43243);var zt,Jt,$t=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,a=e.setLock,l=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,p=c.immutableGroupsMode,d=c.addRuleLabel,f=c.delGroupLabel,g=c.renderButton,v=c.renderSwitch,h=c.renderButtonGroup,y=c.lockLabel,b=c.lockedLabel,O=c.showLock,j=c.canDeleteLocked,F=O&&!(l&&!u)&&m.createElement(v,{type:"lock",id:s,value:l,setValue:a,label:y,checkedLabel:b,hideLabel:!0,config:t}),w=!p&&n&&!l&&m.createElement(g,{type:"addRuleGroup",onClick:r,label:d,readonly:l,config:t}),S=!p&&o&&(!l||l&&j)&&m.createElement(g,{type:"delRuleGroup",onClick:i,label:f,config:t});return m.createElement("div",{className:"group--actions"},m.createElement(h,{config:t},F,w,S))}}]),o}(m.PureComponent);function Ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Yt=Dt(zt=pt("group rule_group")(zt=(0,yt.rB)((Jt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"rule_group--children"},t.renderHeaderWrapper=function(){return null},t.renderFooterWrapper=function(){return null},t.renderConjs=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!1},(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.children1.size}},{key:"renderChildrenWrapper",value:function(){return m.createElement(m.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),(0,Wt.Z)((0,h.Z)(o.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.setField,o=e.parentField,i=e.id,a=e.groupId,l=e.isLocked,u=t.settings.immutableFieldsMode;return m.createElement(St,{key:"field",classname:"group--field",config:t,selectedField:r,setField:n,parentField:o,readonly:u||l,id:i,groupId:a})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return m.createElement($t,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}]),o}(Bt),Jt.propTypes=Ut(Ut({},Bt.propTypes),{},{selectedField:b().string,parentField:b().string,setField:b().func}),zt=Jt))||zt)||zt)||zt;const Kt=Yt;var Xt,Qt,er=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,a=e.setLock,l=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,p=c.immutableGroupsMode,d=c.addSubRuleLabel,f=c.delGroupLabel,g=c.renderButton,v=c.renderSwitch,h=c.renderButtonGroup,y=c.lockLabel,b=c.lockedLabel,O=c.showLock,j=c.canDeleteLocked,F=O&&!(l&&!u)&&m.createElement(v,{type:"lock",id:s,value:l,setValue:a,label:y,checkedLabel:b,config:t}),w=!p&&n&&!l&&m.createElement(g,{type:"addRuleGroupExt",onClick:r,label:d,readonly:l,config:t}),S=!p&&o&&(!l||l&&j)&&m.createElement(g,{type:"delRuleGroup",onClick:i,label:f,config:t});return m.createElement("div",{className:"group--actions group--actions--tr"},m.createElement(h,{config:t},F,w,S))}}]),o}(m.PureComponent);function tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var or=r(60042),ir=Dt(Xt=pt("group rule_group_ext")(Xt=(0,yt.rB)((Qt=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"rule_group_ext--children"},t.renderFooterWrapper=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!0},(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:or("group--header",this.isOneChild()?"one--child":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return m.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget())}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=(e.selectedOperator,(0,H.getFieldConfig)(t,r)||{});return null!=n.showNot?n.showNot:t.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=(e.selectedOperator,(0,H.getFieldConfig)(t,r)||{}),i=(0,Wt.Z)((0,h.Z)(o.prototype),"conjunctionOptions",this).call(this);if(n.conjunctions){var a,l={},u=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return nr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(n.conjunctions);try{for(u.s();!(a=u.n()).done;){var s=a.value;l[s]=i[s]}}catch(e){u.e(e)}finally{u.f()}i=l}return i}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.setField,o=e.parentField,i=e.id,a=e.groupId,l=e.isLocked,u=t.settings.immutableFieldsMode;return m.createElement(St,{key:"field",classname:"rule--field",config:t,selectedField:r,setField:n,parentField:o,readonly:u||l,id:i,groupId:a})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.setField,i=e.setOperator,a=e.isLocked,l=t.settings.immutableFieldsMode,u=(0,H.getFieldWidgetConfig)(t,r,n)||{},s=u.hideOperator,c=r&&s&&u.operatorInlineLabel,p=r&&!s;return m.createElement(bt,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedOperator:n,setField:o,setOperator:i,selectedFieldPartsLabels:["group"],showOperator:p,showOperatorLabel:c,selectedFieldWidgetConfig:u,readonly:l||a,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,i=t.settings.immutableValuesMode;if(!r||!n)return null;var a=m.createElement(Ct.Z,{key:"values",isForRuleGruop:!0,field:this.props.selectedField,operator:this.props.selectedOperator,value:this.props.value,valueSrc:"value",valueError:null,config:t,setValue:i?yt.ig:this.props.setValue,setValueSrc:yt.ig,readonly:i||o,id:this.props.id,groupId:this.props.groupId});return m.createElement(yt.JX,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},a)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return m.createElement(er,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.children1.size}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}]),o}(Bt),Qt.propTypes=rr(rr({},Bt.propTypes),{},{selectedField:b().string,selectedOperator:b().string,value:b().any,parentField:b().string,setField:b().func,setOperator:b().func,setValue:b().func}),Xt=Qt))||Xt)||Xt)||Xt;const ar=ir;var lr,ur,sr={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},cr=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,i=e.isLocked,a=e.isTrueLocked,l=e.id,u=e.canAddGroup,s=e.canAddDefault,c=t.settings,p=c.immutableGroupsMode,d=c.addCaseLabel,f=c.addDefaultCaseLabel,g=c.groupActionsPosition,v=c.renderButton,h=c.renderSwitch,y=c.renderButtonGroup,b=c.lockLabel,O=c.lockedLabel,j=c.showLock,F=sr[g||"topRight"],w=j&&!(i&&!a)&&m.createElement(h,{type:"lock",id:l,value:i,setValue:o,label:b,checkedLabel:O,config:t}),S=!p&&u&&!i&&m.createElement(v,{type:"addCaseGroup",onClick:r,label:d,readonly:i,config:t}),C=!p&&s&&!i&&m.createElement(v,{type:"addDefaultCaseGroup",onClick:n,label:f,readonly:i,config:t});return m.createElement("div",{className:"group--actions ".concat(F)},m.createElement(y,{config:t},w,S,C))}}]),o}(m.PureComponent);function pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var dr=r(60042),fr=Dt(lr=pt("group switch_group")(lr=(0,yt.rB)((ur=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"switch_group--children"},t.renderFooterWrapper=function(){return null},t.hasDefaultCase=function(){return t.props.children1.size&&t.props.children1.filter((function(e){return null==e.get("children1")})).size>0},(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"canAddGroup",value:function(){var e=this.props.config.settings.maxNumberOfCases,t=this.props.children1.size;return!e||t<e}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e=this.props.children1.size;return this.hasDefaultCase()&&e--,e}},{key:"totalRulesCntForItem",value:function(e){return(0,w.getTotalRulesCountInTree)(e)}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.config.settings,r=t.canLeaveEmptyCase,n=t.canRegroupCases,o=this.props.children1.size;this.hasDefaultCase()&&o--;var i=(0,w.getTotalReordableNodesCountInTree)(e);return 1==i&&n&&r&&o>1&&(i=111),i}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:dr("group--header",this.isOneChild()?"one--child":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var e=this.props.config.settings.renderSwitchPrefix;return e?e():null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return m.createElement(cr,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}}]),o}(Bt),ur.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Bt.propTypes),lr=ur))||lr)||lr)||lr;const gr=fr;var vr,hr;function mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var br=r(60042),Or=Dt(vr=pt("group case_group")(vr=(0,yt.rB)((hr=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"case_group--children"},t.renderFooterWrapper=function(){return null},(0,$e.EM)((0,f.Z)(t)),t.onPropsChanged(e),t}return(0,d.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&(0,Wt.Z)((0,h.Z)(o.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return m.createElement("div",{key:"group-header",className:br("group--header",this.isOneChild()?"one--child":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:m.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":m.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:(0,Wt.Z)((0,h.Z)(o.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?this.renderValue():null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&(0,Wt.Z)((0,h.Z)(o.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&(0,Wt.Z)((0,h.Z)(o.prototype),"canAddRule",this).call(this)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.setValue,i=e.id,a=t.settings.immutableValuesMode,l=m.createElement(Ct.Z,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:"value",valueError:null,config:t,setValue:a?yt.ig:o,setValueSrc:yt.ig,readonly:a||r,id:i,groupId:null});return m.createElement(yt.JX,{className:"case_group--value"},l)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,i=e.isTrueLocked,a=e.id;return m.createElement(It,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,t=e&&e.size?e.get(0):null,r=null!=t&&(!Array.isArray(t)||t.length>0);return(0,Wt.Z)((0,h.Z)(o.prototype),"isEmptyCurrentGroup",this).call(this)&&!r}}]),o}(Bt),hr.propTypes=yr(yr({},Bt.propTypes),{},{parentReordableNodesCnt:b().number,value:b().any,setValue:b().func}),vr=hr))||vr)||vr)||vr;const jr=Or;var Fr=["type"];function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Cr,Er,kr=function(e){var t=e.properties.toObject(),r=Sr({},t);return e.isParentLocked&&(r.isLocked=!0),t.isLocked&&(r.isTrueLocked=!0),r},Pr={rule:function(e){return m.createElement(Tt,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return m.createElement(Gt,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return m.createElement(Kt,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return m.createElement(ar,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return m.createElement(gr,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return m.createElement(jr,(0,tt.Z)({},kr(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},Lr=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(){return(0,p.Z)(this,o),n.apply(this,arguments)}return(0,d.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.type,r=(0,et.Z)(e,Fr),n="array"==r.properties.get("mode")?"_ext":"",o=r.config.settings.renderItem,i=Pr[t+n];return o?o(Sr(Sr({},r),{},{type:t,itemComponent:i})):i?i(r):null}}]),o}(m.PureComponent);Lr.propTypes={config:b().object.isRequired,id:b().string.isRequired,groupId:b().string,type:b().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:b().any.isRequired,properties:b().any.isRequired,children1:b().any,actions:b().object.isRequired,reordableNodesCnt:b().number,onDragStart:b().func,parentField:b().string,isDraggingTempo:b().bool,isParentLocked:b().bool};var Zr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,ke.$j)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:ze,setDragProgress:We,setDragEnd:Je},null,{context:Ce})(ut(e,t));return r.displayName="ConnectedSortableContainer",r}((Er=function(e){(0,g.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,h.Z)(t);if(r){var o=(0,h.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,v.Z)(this,e)});function o(e){var t;return(0,p.Z)(this,o),(t=n.call(this,e))._updPath(e),t}return(0,d.Z)(o,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=(0,$e.gt)(this)(e,t);if(n){var o=[];for(var i in e)e[i]!==r[i]&&"__isInternalValueChange"!=i&&o.push(i);o.length||(n=!1),1==o.length&&"tree"==o[0]&&e.__isInternalValueChange&&(n=!1)}return n}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=F().List.of(t)}},{key:"render",value:function(){var e=this.props.tree,t=e.get("type"),r="switch_group"==t,n=r?null:(0,w.getTotalReordableNodesCountInTree)(e),o=r?null:(0,w.getTotalRulesCountInTree)(e),i=e.get("id");return m.createElement(Lr,{key:i,id:i,path:this.path,type:t,properties:e.get("properties")||new j.Map,config:this.props.config,actions:this.props.actions,children1:e.get("children1")||new j.Map,reordableNodesCnt:n,totalRulesCnt:o,parentReordableNodesCnt:0,onDragStart:this.props.onDragStart})}}]),o}(m.Component),Er.propTypes={tree:b().any.isRequired,config:b().object.isRequired,actions:b().object.isRequired,onDragStart:b().func},Cr=Er))||Cr,_r=r(86893);function Rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Vr=function(e,t){var r={usedFields:[]},n=Nr(e,t,r);if(n)return Tr(Tr({},n),r)},Nr=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?Dr(e,t,r):"rule"===n?xr(e,t,r):void 0}},Dr=function(e,t,r){var n=e.get("properties")||new j.Map,o=e.get("children1"),i=e.get("id"),a=o.map((function(e){return Nr(e,t,r)})).filter((function(e){return void 0!==e}));if(a.size){var l=n.get("conjunction");l||(l=(0,S.defaultConjunction)(t));var u=n.get("not");return{id:i,rules:a.toList(),condition:l.toUpperCase(),not:u}}},xr=function(e,t,r){var n=e.get("properties")||new j.Map,o=e.get("id"),i=n.get("operator"),a=n.get("operatorOptions"),l=n.get("field"),u=n.get("value"),s=n.get("valueSrc"),c=n.get("valueType"),p=u.filter((function(e){return void 0===e})).size>0;if(null!=l&&null!=i&&!p){var d=(0,H.getFieldConfig)(t,l)||{},f=(0,H.getOperatorConfig)(t,i,l)||{},g=d.type||"undefined",v=(0,Y.LS)(f.cardinality,1),h=t.types[d.type]||{},m=(0,U.i5)(l,t,r);if(!(u.size<v)){-1==r.usedFields.indexOf(l)&&r.usedFields.push(l),u=u.toArray(),s=s.toArray(),c=c.toArray();for(var y=[],b=0;b<u.length;b++){var O={type:c[b],value:u[b]};if(y.push(O),"field"==s[b]){var F=u[b];-1==r.usedFields.indexOf(F)&&r.usedFields.push(F)}}var w=a?a.toJS():null;w&&!Object.keys(w).length&&(w=null);var S={id:o,fieldName:m,type:g,input:h.mainWidget,operator:i};return w&&(S.operatorOptions=w),S.values=y,S}}},Ir=r(14648),Ar=r.n(Ir);function qr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gr=function(e,t){var r,n={usedFields:[],errors:[]},o=Wr(e,t,n,!0),i=n.errors,a=n.usedFields,l=t.settings.fieldSeparator,u={},s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Br(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(a);try{for(s.s();!(r=s.n()).done;)for(var c=r.value,p=((0,H.getFieldConfig)(t,c),c.split(l)),d=u,f=0;f<p.length;f++){var g=p[f],v=(0,H.getFieldConfig)(t,p.slice(0,f+1))||{};f!=p.length-1?"!group"==v.type&&"struct"!=v.mode?(d[g]||(d[g]=[{}]),d=d[g][0]):(d[g]||(d[g]={}),d=d[g]):d[g]||(d[g]=null)}}catch(e){s.e(e)}finally{s.f()}return{errors:i,logic:o,data:u}},Wr=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){var i,a=e.get("type"),l=e.get("properties")||new j.Map,u=l.get("isLocked"),s=t.settings.jsonLogic.lockedOp;return"group"===a||"rule_group"===a?i=zr(e,t,r,n,o):"rule"===a&&(i=Jr(e,t,r,o)),u&&i&&s&&(i=(0,c.Z)({},s,i)),i}},zr=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type"),a=e.get("properties")||new j.Map,l=a.get("mode"),u=e.get("children1"),s=a.get("field");if(u){var p=a.get("conjunction");p||(p=(0,S.defaultConjunction)(t));var d=t.conjunctions[p],f=d.jsonLogicConj||p.toLowerCase(),g=a.get("not");if("and"==f||"or"==f){var v="rule_group"===i&&!n,h=v&&"struct"!=l?s:o,m=a.get("operator"),y=m&&(0,H.getOperatorConfig)(t,m,s)||null,b=$r(t,a,r,m,o),O=v&&(!m||0==y.cardinality),F=u.map((function(e){return Wr(e,t,r,!1,h)})).filter((function(e){return void 0!==e}));if(v&&"struct"!=l&&!O){if(null==b)return}else if(!F.size)return;var w={};if(1!=F.size||n?w[f]=F.toList().toJS():w=F.first(),g&&(w={"!":w}),v&&"struct"!=l){var C=Yr(r,t,s,o);if(O){var E=m||"some";w=(0,c.Z)({},E,[C,w])}else{var k=F.size?{filter:[C,w]}:C,P={reduce:[k,{"+":[1,{var:"accumulator"}]},0]};w=Xr(t,a,P,b,m)}}return w}r.errors.push("Conjunction ".concat(f," is not supported"))}},Jr=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new j.Map,i=o.get("field"),a=o.get("operator"),l=o.get("operatorOptions");if((l=l?l.toJS():null)&&!Object.keys(l).length&&(l=null),null!=i&&null!=a){var u=(0,H.getFieldConfig)(t,i)||{},s=(0,H.getOperatorConfig)(t,a,i)||{},c=s.reversedOp,p=(0,H.getOperatorConfig)(t,c,i)||{},d=!1;if(s.jsonLogic||p.jsonLogic){if(!s.jsonLogic&&p.jsonLogic){d=!0;var f=[c,a];a=f[0],c=f[1];var g=[p,s];s=g[0],p=g[1]}var v=$r(t,o,r,a,n);if(void 0!==v){var h=Yr(r,t,i,n);return Xr(t,o,h,v,a,l,u,d)}}else r.errors.push("Operator ".concat(a," is not supported"))}},$r=function(e,t,r,n,o){var i=t.get("field"),a=t.get("valueSrc"),l=t.get("valueType"),u=(0,H.getFieldConfig)(e,i)||{},s=(0,H.getOperatorConfig)(e,n,i)||{},c=(0,Y.LS)(s.cardinality,1),p=t.get("value"),d=t.get("asyncListValues");if(null!=p){var f=[],g=[],v=r.usedFields,h=p.map((function(t,c){var p=a?a.get(c):null,v=l?l.get(c):null,h=(0,_r.EN)(t,p,e),m=(0,U.wg)(e,i,n,p),y=Q()((0,H.getFieldWidgetConfig)(e,i,n,m,p),["factory"]),b=Hr(r,e,h,p,v,y,u,n,s,o,d);return void 0!==b&&(f.push(p),g.push(v)),b})),m=h.filter((function(e){return void 0===e})).size>0;if(!(h.size<c||m))return c>1?h.toArray():1==c?h.first():null;r.usedFields=v}},Hr=function(e,t,r,n,o,i,a,l,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"==n)p=Yr(e,t,r,s);else if("func"==n)p=Ur(e,t,r,s);else if("function"==typeof i.jsonLogic){var d=i.jsonLogic,f=[r,Mr(Mr({},Ar()(a,["fieldSettings","listValues"])),{},{asyncListValues:c}),Q()(i,["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue"])];l&&(f.push(l),f.push(u)),p=d.apply(void 0,f)}else p=r;return p}},Ur=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=r.get("func"),i=r.get("args"),a=(0,H.getFuncConfig)(t,o);if(a.jsonLogic){var l={};for(var u in a.args){var s=a.args[u],p=(0,H.getFieldConfig)(t,s),d=i?i.get(u):void 0,f=d?d.get("value"):void 0,g=d?d.get("valueSrc"):void 0,v=Hr(e,t,f,g,s.type,p,s,null,null,n);if(null!=f&&void 0===v)return void e.errors.push("Can't format value of arg ".concat(u," for func ").concat(o));void 0!==v&&(l[u]=v)}var h,m=Object.values(l);if("function"==typeof a.jsonLogic){var y=a.jsonLogic,b=[l];h=y.apply(void 0,b)}else{var O=a.jsonLogic||o,j=!!a.jsonLogicIsMethod;if(j){var F=m[0],w=m.slice(1);h=w.length?{method:[F,O,w]}:{method:[F,O]}}else h=(0,c.Z)({},O,m)}return h}e.errors.push("Func ".concat(o," is not supported"))},Yr=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.settings,a=i.fieldSeparator,l=i.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(a));var u=(0,H.getFieldConfig)(t,r)||{},s=r;if(u.fieldName&&(s=u.fieldName),o){var p=(0,H.getFieldConfig)(t,o)||{},d=o;p.fieldName&&(d=p.fieldName),0==s.indexOf(d+a)?s=s.slice((d+a).length):e.errors.push("Can't cut group ".concat(d," from field ").concat(s))}var f=u.jsonLogicVar||("!group"==u.type?l.groupVarKey:"var");n=(0,c.Z)({},f,s),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},Kr=function(e,t,r,n){var o=e,i=(0,Y.LS)(t.cardinality,1),a=(0,Y.LS)(t._jsonLogicIsRevArgs,!1);"string"==typeof t.jsonLogic&&(o=t.jsonLogic);var l=["<","<=",">",">="],u=["==","!="];return function(e,t,s,p,d){return 0==i&&u.includes(o)?(0,c.Z)({},o,[r,null]):0==i?(0,c.Z)({},o,r):1==i&&a?(0,c.Z)({},o,[n,r]):1==i?(0,c.Z)({},o,[r,n]):2==i&&l.includes(o)?(0,c.Z)({},o,[n[0],r,n[1]]):(0,c.Z)({},o,[r].concat((0,nt.Z)(n)))}},Xr=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=t.get("field"),s=(0,H.getOperatorConfig)(e,o,u)||{},c="function"==typeof s.jsonLogic?s.jsonLogic:Kr(o,s,r,n),p=[r,o,n,Q()(s,["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"]),i,a],d=c.apply(void 0,p);return l&&(d={"!":d}),d},Qr=r(33940),en=r(37991);function tn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var nn=function(e){return"object"==(0,Qr.Z)(e)&&null!==e&&!Array.isArray(e)},on=function(e,t){return an(e,t,!1)},an=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=ln([],e,t,n);return r?[o,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),o)},ln=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var u=t.get("type");return"group"===u||"rule_group"===u?un(e,t,r,n,o,i,a,l):"rule"===u?sn(e,t,r,n,o,i,a,l):void 0}},un=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.get("type"),a=t.get("properties")||new j.Map,l=t.get("children1"),u=r.settings.canShortMongoQuery;if(l){var s=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,p=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),d=s&&p,f="rule_group"===i?a.get("field"):null,g=pn(f,r,n,d),v=(0,H.getFieldConfig)(r,f)||{},h=v.mode,m=f&&"array"==h,y=o?!a.get("not"):a.get("not"),b=l.map((function(o){return ln([].concat((0,nt.Z)(e),[t]),o,r,n,y,!0,"array"==h?function(e){return"$$el.".concat(e)}:void 0)})).filter((function(e){return void 0!==e}));if(m||b.size){var O=a.get("conjunction");O||(O=(0,S.defaultConjunction)(r));var F=r.conjunctions[O],w=F.reversedConj;y&&w&&(O=w,F=r.conjunctions[O]);var C,E=F.mongoConj;if(1==b.size)C=b.first();else if(b.size>1){var k=b.toList().toJS(),P=u&&"$and"==E;P&&(C=k.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(nn(n)||(n={$eq:n}),nn(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),C||(C=(0,c.Z)({},E,k))}if(f)if("array"==h){var L={$size:g},Z=C?{$size:{$filter:{input:"$"+g,as:"el",cond:C}}}:L;C={$expr:C=ln(e,t.set("type","rule"),r,n,!1,!1,(function(e){return Z}),L)}}else C=(0,c.Z)({},g,{$elemMatch:C});return C}}},sn=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u=t.get("properties")||new j.Map,s=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,c=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),p=s&&c,d=u.get("operator"),f=u.get("operatorOptions"),g=u.get("field"),v=u.get("value"),h=u.get("valueSrc"),m=u.get("valueType"),y=u.get("asyncListValues");if(null!=g&&null!=d&&void 0!==v){var b=(0,H.getFieldConfig)(r,g)||{},F=(0,H.getOperatorConfig)(r,d,g)||{},w=F.reversedOp,S=(0,H.getOperatorConfig)(r,w,g)||{},C=(0,Y.LS)(F.cardinality,1),E=o;if(E&&w){var k=[w,d];d=k[0],w=k[1];var P=[S,F];F=P[0],S=P[1],E=!1}var L=pn(g,r,n,p),Z=[],_=[],R=!1,T=v.map((function(e,t){var o=h?h.get(t):null,i=m?m.get(t):null,a=(0,_r.EN)(e,o,r),l=(0,U.wg)(r,g,d,o),u=Q()((0,H.getFieldWidgetConfig)(r,g,d,l,o),["factory"]),s=cn(n,r,a,o,i,u,b,p,d,F,y),c=(0,O.Z)(s,2),f=c[0],v=c[1];return void 0!==f&&(R=R||v,Z.push(o),_.push(i)),f}));a&&(R=!0);var V=R&&i,N=T.filter((function(e){return void 0===e})).size>0;if(!(T.size<C||N)){var D=C>1?T.toArray():1==C?T.first():null,x=F.mongoFormatOp;if(x){var I=[a?a(L):L,d,void 0!==l&&null==D?l:D,R,Z.length>1?Z:Z[0],_.length>1?_:_[0],Q()(F,["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"]),f,b],A=x.apply(void 0,I);return V&&(A={$expr:A}),E&&(A={$not:A}),A}n.errors.push("Operator ".concat(d," is not supported"))}}},cn=function(e,t,r,n,o,i,a,l,u,s,c){if(void 0===r)return[void 0,!1];var p,d=!1;if("field"==n){var f=dn(e,t,r,l),g=(0,O.Z)(f,2);p=g[0],d=g[1]}else if("func"==n){var v=fn(e,t,r,l),h=(0,O.Z)(v,2);p=h[0],d=h[1]}else if("function"==typeof i.mongoFormatValue){var m=i.mongoFormatValue,y=[r,rn(rn({},Ar()(a,["fieldSettings","listValues"])),{},{asyncListValues:c}),Q()(i,["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue"])];u&&(y.push(u),y.push(s)),p=m.apply(void 0,y)}else p=r;return[p,d]},pn=function(e,t,r,n){if(e){var o=(0,H.getFieldConfig)(t,e)||{},i=t.settings.fieldSeparator,a=(Array.isArray(e)||e.split(i),Array.isArray(e)?e.join(i):e);if(o.fieldName&&(a=o.fieldName),n){var l=(0,H.getFieldConfig)(t,n)||{},u=n;l.fieldName&&(u=l.fieldName),0==a.indexOf(u+".")?a=a.slice((u+".").length):r.errors.push("Can't cut group ".concat(u," from field ").concat(a))}return a}},dn=function(e,t,r,n){var o,i=t.settings.fieldSeparator;if(r){var a=(0,H.getFieldConfig)(t,r)||{},l=Array.isArray(r)?r:r.split(i),u=((0,U.rA)(r,t),(0,U.fY)(r,t)),s=u?u.join(i):null;o="$"+(t.settings.formatField||en.X.formatField)(pn(r,t,e,n),l,s,a,t,!1)}return[o,!0]},fn=function(e,t,r,n){var o,i=r.get("func"),a=r.get("args"),l=(0,H.getFuncConfig)(t,i),u=l.mongoFunc||i,s=l.mongoArgsAsObject,p={},d=0,f=void 0;for(var g in l.args){var v=l.args[g],h=(0,H.getFieldConfig)(t,v),m=a?a.get(g):void 0,y=m?m.get("value"):void 0,b=m?m.get("valueSrc"):void 0,j=m?m.get("asyncListValues"):void 0,F=(0,U.wg)(t,h,null,b),w=Q()((0,H.getFieldWidgetConfig)(t,h,null,F,b),["factory"]),S=cn(e,t,y,b,v.type,w,h,n,null,null,j),C=(0,O.Z)(S,2),E=C[0];if(C[1],null!=y&&void 0===E)return e.errors.push("Can't format value of arg ".concat(g," for func ").concat(i)),[void 0,!1];d++,void 0!==E&&(p[g]=E,f=E)}if("function"==typeof l.mongoFormatFunc){var k=[p];o=l.mongoFormatFunc.apply(void 0,k)}else{if(null===l.mongoFormatFunc)return e.errors.push("Functon ".concat(u," is not supported")),[void 0,!1];o=s?(0,c.Z)({},u,p):1==d&&void 0!==f?(0,c.Z)({},u,f):(0,c.Z)({},u,Object.values(p))}return[o,!0]},gn=r(75144);function vn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mn=function(e,t){return yn(e,t,!1)},yn=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=bn(e,t,n);return r?[o,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),o)},bn=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?On(e,t,r):"rule"===n?jn(e,t,r):void 0}},On=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new j.Map,i=e.get("children1"),a="rule_group"===n?o.get("field"):null;"array"==((0,H.getFieldConfig)(t,a)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(a));var l=o.get("not"),u=i.map((function(e){return bn(e,t,r)})).filter((function(e){return void 0!==e}));if(u.size){var s=o.get("conjunction");return s||(s=(0,S.defaultConjunction)(t)),t.conjunctions[s].sqlFormatConj(u,s,l)}},jn=function(e,t,r){var n=e.get("properties")||new j.Map,o=n.get("field"),i=n.get("operator"),a=n.get("operatorOptions"),l=n.get("valueSrc"),u=n.get("valueType"),s=n.get("value"),c=n.get("asyncListValues");if(null!=o&&null!=i){var p=(0,H.getFieldConfig)(t,o)||{},d=(0,H.getOperatorConfig)(t,i,o)||{},f=d.reversedOp,g=(0,H.getOperatorConfig)(t,f,o)||{},v=(0,Y.LS)(d.cardinality,1),h=!1,m=d.sqlOp||d.sqlFormatOp,y=g.sqlOp||g.sqlFormatOp;if(m||y){if(!y&&y){h=!0;var b=[f,i];i=b[0],f=b[1];var O=[g,d];d=O[0],g=O[1]}var F=[],w=[],S=s.map((function(e,n){var a=l?l.get(n):null,s=u?u.get(n):null,f=(0,_r.EN)(e,a,t),g=(0,U.wg)(t,o,i,a),v=Q()((0,H.getFieldWidgetConfig)(t,o,i,g,a),["factory"]),h=Fn(r,t,f,a,s,v,p,i,d,c);return void 0!==h&&(F.push(a),w.push(s)),h}));if(!(S.filter((function(e){return void 0===e})).size>0||S.size<v)){var C=1==v?S.first():S,E=d.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=(0,Y.LS)(t.cardinality,1);return 0==o?r=function(e,t,r,o,i,a,l,u){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,a,l,u){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,a,l,u){var s=r.first(),c=r.get(1);return"".concat(e," ").concat(n," ").concat(s," AND ").concat(c)}),r}(i,d);if(E){var k,P=[wn(r,t,o),i,C,F.length>1?F:F[0],w.length>1?w:w[0],Q()(d,["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"]),a,p];if(k=E.apply(void 0,P),h&&(k=t.settings.sqlFormatReverse(k)),void 0!==k)return k;r.errors.push("Operator ".concat(i," is not supported for value source ").concat(F.join(", ")))}else r.errors.push("Operator ".concat(i," is not supported"))}}else r.errors.push("Operator ".concat(i," is not supported"))}},Fn=function(e,t,r,n,o,i,a,l,u,s){if(void 0!==r){var c;if("field"==n)c=wn(e,t,r);else if("func"==n)c=Sn(e,t,r);else if("function"==typeof i.sqlFormatValue){var p=i.sqlFormatValue,d=[r,hn(hn({},Ar()(a,["fieldSettings","listValues"])),{},{asyncListValues:s}),Q()(i,["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue"])];if(l&&(d.push(l),d.push(u)),"field"==n){var f=(0,H.getFieldConfig)(t,r)||{};d.push(f)}c=p.apply(void 0,d)}else c=Array.isArray(r)?r.map((function(e){return gn.SqlString.escape(e)})):gn.SqlString.escape(r);return c}},wn=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=(0,H.getFieldConfig)(t,r)||{},i=Array.isArray(r)?r:r.split(n),a=((0,U.rA)(r,t),(0,U.fY)(r,t)),l=a?a.join(n):null;return(t.settings.formatField||en.X.formatField)((0,U.i5)(r,t,e),i,l,o,t)}},Sn=function(e,t,r){var n,o=r.get("func"),i=r.get("args"),a=(0,H.getFuncConfig)(t,o),l=a.sqlFunc||o,u={};for(var s in a.args){var c=a.args[s],p=(0,H.getFieldConfig)(t,c),d=i?i.get(s):void 0,f=d?d.get("value"):void 0,g=d?d.get("valueSrc"):void 0,v=d?d.get("asyncListValues"):void 0,h=Fn(e,t,f,g,c.type,p,c,null,null,v);if(null!=f&&void 0===h)return void e.errors.push("Can't format value of arg ".concat(s," for func ").concat(o));void 0!==h&&(u[s]=h)}if("function"==typeof a.sqlFormatFunc){var m=[u];n=a.sqlFormatFunc.apply(void 0,m)}else{var y=Object.entries(u).map((function(e){var t=(0,O.Z)(e,2);return t[0],t[1]})).join(", ");n="".concat(l,"(").concat(y,")")}return n},Cn=r(62173);function En(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function kn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?En(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):En(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pn=function(e,t){return Ln(e,t,!1)},Ln=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=Zn(e,t,n,null);return r?[o,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),o)},Zn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?Tn(e,t,r,n):"rule"===o?xn(e,t,r,n):"switch_group"==o?Rn(e,t,r,n):"case_group"==o?_n(e,t,r,n):void 0}},_n=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var i=e.get("properties")||new j.Map,a=In(t,i,r,null,n,"!case_value"),l=(0,O.Z)(a,3),u=l[0],s=(l[1],l[2],Tn(e,t,r,n));return[s,u]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},Rn=function(e,t,r){e.get("properties")||new j.Map;var n=e.get("children1");if(n){var o=n.map((function(e){return _n(e,t,r,null)})).filter((function(e){return void 0!==e})).toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var i=[],a=0;a<o.length;a++)a==o.length-1||o[a][0]?(i.push(o[a]),a==o.length-1&&o[a][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(a));for(var l="",u="",s=0;s<i.length;s++){var c=(0,O.Z)(i[s],2),p=c[0],d=c[1];null==d&&(d="null"),null==p&&(p="true"),s!=i.length-1?(l+="(".concat(p," ? ").concat(d," : "),u+=")"):l+="".concat(d)}return l+u}}},Tn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),i=e.get("properties")||new j.Map,a=i.get("mode"),l=e.get("children1"),u=i.get("field");if(l){var s=i.get("conjunction");s||(s=(0,S.defaultConjunction)(t));var c=t.conjunctions[s],p=i.get("not"),d="rule_group"===o,f=d&&"struct"!=a,g=f?u:n,v=(0,H.getFieldConfig)(t,g)||{},h=v.isSpelArray,m=i.get("operator");m||a&&"some"!=a||(m="some");var y=Dn(t,m,u),b=y!=m,F=m&&(0,H.getOperatorConfig)(t,y,u)||null,w=d&&(!y||0==F.cardinality),C=In(t,i,r,y,n,null),E=(0,O.Z)(C,3),k=E[0],P=E[1],L=E[2],Z=l.map((function(e){return Zn(e,t,r,g)})).filter((function(e){return void 0!==e}));if(f&&!w){if(null==k)return}else if(!Z.size)return;var _,R=d,T=Z.size?c.spelFormatConj(Z,s,p,R):null;if(f){var V=qn(r,t,u,n),N=h?".length":".size()",D="".concat(V).concat(N),x=T?"".concat(V,".?[").concat(T,"]").concat(N):D,I=w?D:k;_=Nn(r,t,i,x,I,y,P,L,b)}else _=T;return _}},Vn=function(e,t){var r=t.spelOp;if(r){var n,o="$"==r[0],i="."==r[0]||o,a="()"==r.substring(r.length-2),l=i?r.slice(1):a?r.substring(0,r.length-2):r,u=(0,Y.LS)(t.cardinality,1);return 0==u?n=function(e,t,r,n,o,a,u,s){return i?"".concat(e,".").concat(l,"()"):"".concat(e," ").concat(l)}:1==u&&(n=function(e,t,r,n,u,s,c,p){return o?"".concat(r,".").concat(l,"(").concat(e,")"):a?"".concat(l,"(").concat(e,", ").concat(r,")"):i?"".concat(e,".").concat(l,"(").concat(r,")"):"".concat(e," ").concat(l," ").concat(r)}),n}},Nn=function(e,t,r,n,o,i,a,l){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=r.get("field"),c=(0,H.getOperatorConfig)(t,i,s)||{},p=(0,H.getFieldConfig)(t,s)||{},d=r.get("operatorOptions"),f=c.spelFormatOp||Vn(0,c);if(f){var g,v=[n,i,o,a,l,Q()(c,["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"]),d,p];return g=f.apply(void 0,v),u&&(g=t.settings.spelFormatReverse(g)),void 0===g&&e.errors.push("Operator ".concat(i," is not supported for value source ").concat(a)),g}e.errors.push("Operator ".concat(i," is not supported"))},Dn=function(e,t,r){if(t){var n=(0,H.getOperatorConfig)(e,t,r)||{},o=n.reversedOp,i=(0,H.getOperatorConfig)(e,o,r)||{},a=n.spelOp||n.spelFormatOp,l=i.spelOp||i.spelFormatOp;if(a||l){if(!a&&l){var u=[o,t];t=u[0],o=u[1];var s=[i,n];n=s[0],i=s[1]}return t}}},xn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new j.Map,i=o.get("field"),a=o.get("operator");if(null!=i&&null!=a){var l=Dn(t,a,i);if(l){var u=l!=a,s=In(t,o,r,l,n,null),c=(0,O.Z)(s,3),p=c[0],d=c[1],f=c[2];if(void 0!==p){var g=qn(r,t,i,n),v=Nn(r,t,o,g,p,l,d,f,u);return v}}else r.errors.push("Operator ".concat(a," is not supported"))}},In=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=t.get("field"),l=t.get("valueSrc"),u=t.get("valueType");("!case_value"==i||u&&"case_value"==u.get(0))&&(a="!case_value");var s,c=(0,H.getFieldConfig)(e,a)||{},p=(0,H.getOperatorConfig)(e,n,a)||{},d=(0,Y.LS)(p.cardinality,1),f=t.get("value"),g=t.get("asyncListValues"),v=[],h=[];if(null!=f){var m=f.map((function(t,i){var s=l?l.get(i):null,d=u?u.get(i):null,f=(0,_r.EN)(t,s,e),m=(0,U.wg)(e,a,n,s),y=Q()((0,H.getFieldWidgetConfig)(e,a,n,m,s),["factory"]),b=An(r,e,f,s,d,y,c,n,p,o,g);return void 0!==b&&(v.push(s),h.push(d)),b})),y=m.filter((function(e){return void 0===e})).size>0;m.size<d||y||(s=d>1?m.toArray():1==d?m.first():null)}return[s,v.length>1?v:v[0],h.length>1?h:h[0]]},An=function(e,t,r,n,o,i,a,l,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"==n)p=qn(e,t,r,s);else if("func"==n)p=Mn(e,t,r,s);else if("function"==typeof i.spelFormatValue){var d=i.spelFormatValue,f=[r,kn(kn({},Ar()(a,["fieldSettings","listValues"])),{},{asyncListValues:c}),Q()(i,["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue"])];if(l&&(f.push(l),f.push(u)),"field"==n){var g=(0,H.getFieldConfig)(t,r)||{};f.push(g)}p=d.apply(void 0,f)}else p=(0,gn.spelEscape)(r);return p}},qn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,i=(0,H.getFieldConfig)(t,r)||{},a=Array.isArray(r)?r:r.split(o),l=((0,U.rA)(r,t,n),(0,U.At)(r,t,n)),u=t.settings.formatSpelField,s=(0,U.i5)(r,t,e);if(n){var c=(0,H.getFieldConfig)(t,n)||{},p=n;c.fieldName&&(p=c.fieldName),0==s.indexOf(p+o)?s=s.slice((p+o).length):e.errors.push("Can't cut group ".concat(p," from field ").concat(s))}var d=l.map((function(e){var t,r=(0,O.Z)(e,3),n=r[0],o=r[1],i=r[2];return i&&(t="!struct"==i.type||"!group"==i.type&&"struct"==i.mode?o.isSpelMap?"map":"class":"!group"==i.type?o.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==o?void 0:o.isSpelVariable}})),f=u(s,n,a,d,i,t);return f}},Mn=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=r.get("func"),a=r.get("args"),l=(0,H.getFuncConfig)(t,i),u=l.spelFunc||i,s={};for(var c in l.args){var p=l.args[c],d=(0,H.getFieldConfig)(t,p),f=a?a.get(c):void 0,g=f?f.get("value"):void 0,v=f?f.get("valueSrc"):void 0,h=f?f.get("asyncListValues"):void 0,m=An(e,t,g,v,p.type,d,p,null,null,o,h);if(null!=g&&void 0===m)return void e.errors.push("Can't format value of arg ".concat(c," for func ").concat(i));void 0!==m&&(s[c]=m)}if("function"==typeof l.spelFormatFunc){var y=l.spelFormatFunc,b=[s];n=y.apply(void 0,b)}else{var j=Object.entries(s).map((function(e){var t=(0,O.Z)(e,2);return t[0],t[1]}));if("."==u[0]&&j.length){var F=(0,Cn.Z)(j),w=F[0],S=F.slice(1);n="".concat(w).concat(u,"(").concat(S.join(", "),")")}else n="".concat(u,"(").concat(j.join(", "),")")}return n};function Bn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Wn=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={errors:[]},o=zn(e,t,n,r,null);return n.errors.length&&console.warn("Errors while exporting to string:",n.errors),o},zn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){var i=e.get("type");return e.get("children1"),"group"===i||"rule_group"===i?Jn(e,t,r,n,o):"rule"===i?Un(e,t,r,n,o):void 0}},Jn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type"),a=e.get("properties")||new j.Map,l=a.get("mode"),u=e.get("children1");if(u){var s="rule_group"===i,c=s&&"array"==l?a.get("field"):null,p=s&&"array"==l,d=a.get("not"),f=u.map((function(e){return zn(e,t,r,n,c)})).filter((function(e){return void 0!==e}));if(p||f.size){var g=a.get("conjunction");g||(g=(0,S.defaultConjunction)(t));var v,h=t.conjunctions[g],m=f.size?h.formatConj(f,g,d,n):null;if(c){var y=Un(e,t,r,n,o,!0);if(y){var b,O=y.pop(),F=[m].concat((0,nt.Z)(y));v=(b=t.settings).formatAggr.apply(b,(0,nt.Z)(F)),O&&(v=t.settings.formatReverse(v,null,null,null,null,n))}}else v=m;return v}}},$n=function(e,t,r,n,o,i){var a,l=t.get("field"),u=t.get("valueSrc"),s=t.get("valueType"),c=(0,H.getFieldConfig)(e,l)||{},p=n||t.get("operator"),d=(0,H.getOperatorConfig)(e,p,l)||{},f=(0,Y.LS)(d.cardinality,1),g=t.get("value"),v=t.get("asyncListValues"),h=[],m=[];if(null!=g){var y=g.map((function(t,n){var a=u?u.get(n):null,f=s?s.get(n):null,g=(0,_r.EN)(t,a,e),y=(0,U.wg)(e,l,p,a),b=Q()((0,H.getFieldWidgetConfig)(e,l,p,y,a),["factory"]),O=Yn(e,r,g,a,f,b,c,p,d,o,i,v);return void 0!==O&&(h.push(a),m.push(f)),O}));y.filter((function(e){return void 0===e})).size>0||y.size<f||(a=1==f?y.first():y)}return[a,h.length>1?h:h[0],m.length>1?m:m[0]]},Hn=function(e,t){var r,n=t.labelForFormat||e,o=(0,Y.LS)(t.cardinality,1);return 0==o?r=function(e,t,r,o,i,a,l,u){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,a,l,u){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,a,l,u){var s=r.first(),c=r.get(1);return"".concat(e," ").concat(n," ").concat(s," AND ").concat(c)}),r},Un=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=e.get("properties")||new j.Map,l=a.get("field"),u=a.get("operator"),s=a.get("operatorOptions");if(null!=l&&null!=u){var c=(0,H.getFieldConfig)(t,l)||{},p=(0,H.getOperatorConfig)(t,u,l)||{},d=p.reversedOp,f=(0,H.getOperatorConfig)(t,d,l)||{},g=!1,v=p.formatOp;if(!v&&d&&(v=f.formatOp)){g=!0;var h=[d,u];u=h[0],d=h[1];var m=[f,p];p=m[0],f=m[1]}if(v||(v=Hn(u,p)),v){var y=Kn(t,r,l,n,o),b=$n(t,a,r,u,n,o),F=(0,O.Z)(b,3),w=F[0],S=F[1],C=F[2];if(void 0!==w){var E=[y,u,w,S,C,Q()(p,["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"]),s,n,c,g];if(i)return E;var k=v.apply(void 0,E);return g&&(k=t.settings.formatReverse(k,u,d,p,f,n)),k}}}},Yn=function(e,t,r,n,o,i,a,l,u,s){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,p=arguments.length>11?arguments[11]:void 0;if(void 0!==r){var d;if("field"==n)d=Kn(e,t,r,s,c);else if("func"==n)d=Xn(e,t,r,s,c);else if("function"==typeof i.formatValue){var f=i.formatValue,g=[r,Gn(Gn({},Ar()(a,["fieldSettings","listValues"])),{},{asyncListValues:p}),Q()(i,["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue"]),s];if(l&&(g.push(l),g.push(u)),"field"==n){var v=(0,H.getFieldConfig)(e,r)||{};g.push(v)}d=f.apply(void 0,g)}else d=r;return d}},Kn=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=e.settings,l=a.fieldSeparator,u=a.fieldSeparatorDisplay,s=null;if(r){var c=(0,H.getFieldConfig)(e,r)||{},p=Array.isArray(r)?r:r.split(l),d=((0,U.rA)(r,e),(0,U.fY)(r,e,i?o:null)),f=d?d.join(u):null,g=c.label2||f,v=e.settings.formatField||en.X.formatField,h=(0,U.i5)(r,e,t,i?o:null);s=v(h,p,g,c,e,n)}return s},Xn=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=r.get("func"),a=r.get("args"),l=(0,H.getFuncConfig)(e,i),u=n&&l.label||i,s={},c={};for(var p in l.args){var d=l.args[p],f=(0,H.getFieldConfig)(e,d),g=a?a.get(p):void 0,v=g?g.get("value"):void 0,h=g?g.get("valueSrc"):void 0,m=g?g.get("asyncListValues"):void 0,y=Yn(e,t,v,h,d.type,f,d,null,null,n,o,m),b=n&&d.label||p;void 0!==y&&(s[p]=y,c[b]=y)}var j=null;if("function"==typeof l.formatFunc){var F=l.formatFunc,w=[s,n];j=F.apply(void 0,w)}else{var S=Object.entries(c).map((function(e){var t=(0,O.Z)(e,2),r=t[0],o=t[1];return n?"".concat(r,": ").concat(o):"".concat(o)})).join(", ");j="".concat(u,"(").concat(S,")")}return j};function Qn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function to(e,t,r,n,o){if(e&&r&&null!=t){var i=r,a=n.operators[i];if(a){var l=a.elasticSearchQueryType,u=!1;!l&&a.reversedOp&&(u=!0,i=a.reversedOp,l=(a=n.operators[i]).elasticSearchQueryType);var s=(0,U.wg)(n,e,i,o),p=n.widgets[s];if(p){var d,f,g=p.elasticSearchFormatValue;if(d="function"==typeof l?l(s):l)return f="function"==typeof g?g(d,t,i,e,n):function(e,t,r,n,o){var i=function(e,t){return e}(n);switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return(0,c.Z)({},i,t[0]);case"term":return(0,c.Z)({},n,t[0]);case"geo_bounding_box":return(0,c.Z)({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return(0,c.Z)({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return(0,c.Z)({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return(0,c.Z)({},n,function(e){return{value:e}}(t[0]));default:return}}(d,t,i,e,n),u?{bool:{must_not:(0,c.Z)({},d,eo({},f))}}:(0,c.Z)({},d,eo({},f))}}}}function ro(e,t){if(e){var r=e.get("type"),n=e.get("properties")||new Map;if("rule"===r&&n.get("field")){var o,i,a=n.get("operator"),l=n.get("field"),u=n.get("value").toJS(),s=(null===(o=n.get("valueType"))||void 0===o||o.get(0),null===(i=n.get("valueSrc"))||void 0===i?void 0:i.get(0));if("func"===s)return;return u&&Array.isArray(u[0])?u[0].map((function(e){return to(l,[e],a,t,s)})):to(l,u,a,t,s)}if("group"===r||"rule_group"===r){var p=n.get("not"),d=n.get("conjunction");return d||(d=(0,S.defaultConjunction)(t)),function(e,t,r,n,o){if(e&&e.size){var i=e.valueSeq().toArray(),a=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),l=i.map((function(e){return n(e,o)})).filter((function(e){return void 0!==e}));if(l.length){var u=l.flat(1/0);return{bool:(0,c.Z)({},a,u)}}}}(e.get("children1"),d,p,ro,t)}}}var no=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),t&&(n=(0,w.getLightTree)(n,r)),n}},oo=function(e){if(lo(e))return e;if(uo(e))return so(e);if("string"==typeof e&&e.startsWith('["~#iM"'))throw"You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17";if("string"==typeof e)return so(JSON.parse(e));throw"Can't load tree!"},io=function(e,t){if(e){var r=(0,H.extendConfig)(t);return(0,K.lB)(e,null,r,r)}},ao=function(e){return 0==(0,w.getTreeBadFields)(e).length},lo=function(e){return j.Map.isMap(e)},uo=function(e){return"object"==(0,Qr.Z)(e)&&("group"==e.type||"switch_group"==e.type)};function so(e){return(0,j.fromJS)(e,(function(e,t){var r;if("properties"==e){r=t.toOrderedMap();for(var n=0;n<2;n++){var o;null===(null===(o=r.get("value"))||void 0===o?void 0:o.get(n))&&(r=r.setIn(["value",n],void 0))}}else if("value"==e&&t.get(0)&&void 0!==t.get(0).toJS){var i=t.get(0).toJS();r=i.func?t.toOrderedMap():F().List.of(i)}else r="asyncListValues"==e?t.toJS():"children1"==e&&F().Iterable.isIndexed(t)?new(F().OrderedMap)(t.map((function(e){return[e.get("id"),e]}))):F().Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return r}))}var co=r(61320),po=r.n(co);function fo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function go(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fo(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var vo=function(e){return Array.from(new Set(e))},ho=function(e,t){return mo(e,t,!1)},mo=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=(0,H.extendConfig)(t),i=yo(o),a=e?bo(e,i,o,"rule",n):void 0;a&&"group"!=a.type&&(a=Eo(a,o));var l=a?oo(a):void 0;return r?[l,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),l)},yo=function(e){var t={};for(var r in e.operators){var n=e.operators[r];if("string"==typeof n.jsonLogic){var o=(n._jsonLogicIsRevArgs?"#":"")+n.jsonLogic+"/"+(0,Y.LS)(n.cardinality,1);t[o]||(t[o]=[]),t[o].push(r)}else if("string"==typeof n.jsonLogic2){var i=n.jsonLogic2+"/"+(0,Y.LS)(n.cardinality,1);t[i]||(t[i]=[]),t[i].push(r)}}var a={};for(var l in e.conjunctions)a[e.conjunctions[l].jsonLogicConj||l.toLowerCase()]=l;var u={};for(var s in e.funcs){var c=e.funcs[s],p=void 0;c.jsonLogicIsMethod?p="#"+c.jsonLogic:"string"==typeof c.jsonLogic&&(p=c.jsonLogic),p&&(u[p]||(u[p]=[]),u[p].push(s))}var d=e.settings.jsonLogic;return{operators:t,conjunctions:a,funcs:u,varKeys:["var",d.groupVarKey,d.altVarKey]}},bo=function e(t,r,n,o,i){var a,l,u,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;(0,Y.Gj)(t)&&(l=t[a=Object.keys(t)[0]],Array.isArray(l)||(l=[l]));var f=i.errors.length,g=n.settings.jsonLogic.lockedOp,v="!"==a&&1==l.length&&l[0]&&(0,Y.Gj)(l[0])&&r.varKeys.includes(Object.keys(l[0])[0]),h="!"==a&&!v,m=g&&a==g;m?u=e(l[0],r,n,o,i,s,c,p,d,!0):h?u=e(l[0],r,n,o,i,!s,c,p,d):"val"==o?u=jo(a,l,r,n,s,i,d)||Fo(a,l,r,n,s,c,i,d)||Oo(t,c,p,n,i):"rule"==o&&(u=wo(a,l,r,n,s,i,d,!1)||Lo(a,l,r,n,s,i,d));var y=i.errors.length;return"!"!=a&&void 0===u&&y==f&&i.errors.push("Can't parse logic ".concat(JSON.stringify(t))),m&&(u.properties.isLocked=!0),u},Oo=function(e,t,r,n,o){if(void 0!==e){var i=n.widgets[r||t.mainWidget];if(i){if(!(0,Y.Gj)(e)){if(t&&"time"==t.type&&"number"==typeof e){var a=Math.floor(e/60/60)%24,l=Math.floor(e/60)%60,u=e%60,s=i.valueFormat;if(s){var c=new Date(e);c.setMilliseconds(0),c.setHours(a),c.setMinutes(l),c.setSeconds(u),e=po()(c).format(s)}else e="".concat(a,":").concat(l,":").concat(u)}if(t&&["date","datetime"].includes(t.type)&&e&&!(e instanceof Date))try{var p=new Date(e);p instanceof Date&&p.toISOString()===e&&(e=p)}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var d=i.valueFormat;d&&(e=po()(e).format(d))}var f;return e&&t.fieldSettings&&t.fieldSettings.asyncFetch&&(f=Array.isArray(e)?e:[e]),{valueSrc:"value",value:e,valueType:i.type,asyncListValues:f}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(t.type))}},jo=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=n.settings.fieldSeparator;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var u=t[0];a&&(u=[a,u].join(l)),u=(0,H.normalizeField)(n,u);var s=(0,H.getFieldConfig)(n,u);return s?{valueSrc:"field",value:u,valueType:s.type}:void i.errors.push("No config for field ".concat(u))}},Fo=function(e,t,r,n,o,i,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var u,s,p,d="method"==e;if(d){var f,g,v=(0,Cn.Z)(t);f=v[0],u=v[1],g=v.slice(2),s=[f].concat((0,nt.Z)(g))}else u=e,s=t;var h=(d?"#":"")+u,m=(r.funcs[h]||[]).filter((function(e){return!i||n.funcs[e].returnType==i.type}));if(m.length)p=m[0];else for(var y=(0,c.Z)({},e,t),b=0,j=Object.entries(n.funcs||{});b<j.length;b++){var F=(0,O.Z)(j[b],2),w=F[0],S=F[1];if(S.jsonLogicImport&&S.returnType==i.type){var C=void 0;try{C=S.jsonLogicImport(y)}catch(e){}C&&(p=w,s=C)}}if(p&&p){var E=n.funcs[p],k=Object.keys(E.args||{}),P=s.reduce((function(e,t,o){var i=k[o],u=E.args[i],s=bo(t,r,n,"val",a,!1,u,null,l);if(void 0!==s||void 0!==(s=u.defaultValue))return go(go({},e),{},(0,c.Z)({},i,s));a.errors.push("No value for arg ".concat(i," of func ").concat(p))}),{});return{valueSrc:"func",value:{func:p,args:P},valueType:E.returnType}}}},wo=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=r.conjunctions[e],u=n.settings.fieldSeparator,s=a?(0,H.getFieldConfig)(n,a):null;if(null==s||s.type,l){var p="group",d=t.map((function(e){return bo(e,r,n,"rule",i,!1,null,null,a)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return go(go({},e),{},(0,c.Z)({},t.id,t))}),{}),f=Object.values(d).map((function(e){var t;return null==e||null===(t=e.properties)||void 0===t?void 0:t.field})).filter((function(e){return e&&e.includes(u)})),g=Object.fromEntries(vo(f).map((function(e){var t=e.split(u),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat((0,nt.Z)(r.slice(0,t)),[e])})).map((function(e){return[e.join(u),(0,H.getFieldConfig)(n,e)]})).filter((function(e){var t=(0,O.Z)(e,2);return t[0],"!group"==t[1].type})));return[e,Object.keys(r)]}))),v=(Object.values(d).map((function(e){var t;return null==e||null===(t=e.properties)||void 0===t?void 0:t.field})).map((function(e){return g[e]})).filter((function(e){return e&&e.length})),vo(Object.values(g).flat())),h=(So(v),{conjunction:l,not:o}),m=(0,$.Z)(),y={},b={};return Object.entries(d).map((function(e){var t=(0,O.Z)(e,2),r=t[0],o=t[1];if("group"==o.type||"rule_group"==o.type)y[r]=o;else{var i,s=null==o||null===(i=o.properties)||void 0===i?void 0:i.field,c=g[s],p=null==c?void 0:c.at(-1);if(p){var d=y,f=a?a.split(u):[];(0,Y.wU)(f,p.split(u).slice(0,f.length))||(f=[]),p.split(u).slice(f.length).map((function(e,t,r){return[].concat((0,nt.Z)(f),(0,nt.Z)(r.slice(0,t)),[e]).join(u)})).map((function(e){return(0,H.normalizeField)(n,e)})).map((function(e){return{f:e,fc:(0,H.getFieldConfig)(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=b[r];o||(o=(0,$.Z)(),b[r]=o,d[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:l,not:!1,field:r,mode:n.mode}}),d=d[o].children1})),d[r]=o}else y[r]=o}})),{type:p,id:m,children1:y,properties:h}}},So=function(e){for(var t=(0,nt.Z)(e).sort((function(e,t){return e.length-t.length})),r=0;r<t.length;r++)for(var n=r+1;n<t.length;n++)0==t[n].indexOf(t[r])&&(t.splice(n,1),n--);return t},Co=function(e,t,r,n,o){if(e)return{type:"rule_group",id:(0,$.Z)(),children1:(0,c.Z)({},e.id,e),properties:{conjunction:o||(0,S.defaultGroupConjunction)(n,r),not:!1,field:t}}},Eo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:(0,$.Z)(),children1:(0,c.Z)({},e.id,e),properties:{conjunction:(0,S.defaultConjunction)(t),not:r}}},ko=function(e,t,r,n,o,i,a){var l=[],u=Po(e,t,r,n,o,i,l,!1)||Po(e,t,r,n,o,i,l,!0);if(u)return u;a.errors.push(l.join("; ")||"Unknown op ".concat(e,"/").concat(t))},Po=function(e,t,r,n,o,i,a,l){var u=!(("all"==e||"some"==e)&&(0,Y.Gj)(r[1])&&"in"==Object.keys(r[1])[0])&&i.settings.groupOperators.includes(e),s=u?0:t-1;(u||["==","!="].includes(e)&&1==s&&null===r[1])&&(s=0);var c=e+"/"+s,p=i.settings.fieldSeparator,d=o.operators[(l?"#":"")+c];if(d){var f,g=[];if(["<","<=",">",">="].includes(e)&&3==t)f=r[1],g=[r[0],r[2]];else if(l)f=r[1],g=[r[0]];else{var v=(0,Cn.Z)(r);f=v[0],g=v.slice(1)}if((0,Y.Gj)(f)){var h,m,y=Object.keys(f)[0],b=Object.values(f)[0];if(o.varKeys.includes(y)&&"string"==typeof b&&(h=b),u&&(m=g[0],g=[]),"reduce"==y&&Array.isArray(b)&&3==b.length){var j=b,F=(0,O.Z)(j,3),w=F[0],S=F[1],C=F[2];if((0,Y.Gj)(w)&&0==C&&(0,Y.Gj)(S)&&Array.isArray(S["+"])&&1==S["+"][0]&&(0,Y.Gj)(S["+"][1])&&"accumulator"==S["+"][1].var)if(y=Object.keys(w)[0],b=Object.values(w)[0],"filter"==y){var E=b,k=(0,O.Z)(E,2),P=k[0],L=k[1];(0,Y.Gj)(P)&&(y=Object.keys(P)[0],b=Object.values(P)[0],o.varKeys.includes(y)&&"string"==typeof b&&(h=b,m=L))}else o.varKeys.includes(y)&&"string"==typeof b&&(h=b)}if(h){n&&(h=[n,h].join(p)),h=(0,H.normalizeField)(i,h);var Z=(0,H.getFieldConfig)(i,h);if(Z){var _=d[0];if(d.length>1&&Z&&Z.operators){if(d=d.filter((function(e){return Z.operators.includes(e)})),0==d.length)return void a.push("No corresponding ops for field ".concat(h));_=d[0]}return{field:h,fieldConfig:Z,opKey:_,args:g,having:m}}a.push("No config for field ".concat(h))}else a.push("Unknown field ".concat(JSON.stringify(f)))}else a.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)))}},Lo=function e(t,r,n,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(t){var u=r.length;if(("all"==t||"some"==t)&&(0,Y.Gj)(r[1])){var s=Object.keys(r[1])[0];"in"==s&&(r=[r[0],r[1][s][1]],t=t+"-"+s)}var c=ko(t,u,r,l,n,o,a);if(c){var p,d,f=c.field,g=c.fieldConfig,v=c.opKey,h=c.args,m=c.having,y=o.operators[v],b=(void 0!==g.showNot?g.showNot:o.settings.showNot,!0);if("!group"==g.type&&m){d=m[p=Object.keys(m)[0]],Array.isArray(d)||(d=[d]);var O="!"==p&&1==d.length&&d[0]&&(0,Y.Gj)(d[0])&&n.varKeys.includes(Object.keys(d[0])[0]);"!"!=p||O||(i=!i,d=(m=m["!"])[p=Object.keys(m)[0]],Array.isArray(d)||(d=[d]))}i&&b&&y.reversedOp&&(i=!1,v=y.reversedOp,y=o.operators[v]);var j=(0,U.wg)(o,f,v),F=h.map((function(e){return bo(e,n,o,"val",a,!1,g,j,l)}));if(!F.filter((function(e){return void 0===e})).length){var w;if("!group"==g.type&&m){if(void 0!==n.conjunctions[p])w=wo(p,d,n,o,i,a,f,!0),i=!1;else{var C,E=e(p,d,n,o,i&&b,a,f);!i||!b||null!=E&&null!==(C=E.properties)&&void 0!==C&&C.not||(i=!1),w=Co(E,f,g,o,n.conjunctions.and)}if(!w)return;w.type="rule_group",i&&Object.assign(w.properties,{not:i}),Object.assign(w.properties,{field:f,mode:g.mode,operator:v}),"array"==g.mode&&Object.assign(w.properties,{value:F.map((function(e){return e.value})),valueSrc:F.map((function(e){return e.valueSrc})),valueType:F.map((function(e){return e.valueType}))})}else if("!group"!=g.type||m){var k=F.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),P=k.length?k[0]:void 0;w={type:"rule",id:(0,$.Z)(),properties:{field:f,operator:v,value:F.map((function(e){return e.value})),valueSrc:F.map((function(e){return e.valueSrc})),valueType:F.map((function(e){return e.valueType})),asyncListValues:P}},i&&(w=Eo(w,o,i))}else w={type:"rule_group",id:(0,$.Z)(),children1:{},properties:{conjunction:(0,S.defaultGroupConjunction)(o,g),not:i,mode:g.mode,field:f,operator:v}},"array"==g.mode&&Object.assign(w.properties,{value:F.map((function(e){return e.value})),valueSrc:F.map((function(e){return e.valueSrc})),valueType:F.map((function(e){return e.valueType}))});return w}}}},Zo=r(2746);function _o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var To=function(e,t){return Vo(e,t,!0)},Vo=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={errors:[]},a=(0,H.extendConfig)(t),l=xo(a),u=void 0;try{var s=Zo.SpelExpressionEvaluator.compile(e);r=s._compiledExpression}catch(e){i.errors.push(e)}r&&(Y.kg.debug("compiledExpression:",r),n=No(r,i),Y.kg.debug("convertedObj:",n,i),(u=Go(n,l,a,i))&&"group"!=u.type&&"switch_group"!=u.type&&(u=Ho(u,a,n.not)),Y.kg.debug("jsTree:",u));var c=u?oo(u):void 0;return o?[c,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),c)},No=function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.getType(),a=t.getChildren().map((function(n){return e(n,r,t)}));if("op-or"!=i&&"op-and"!=i||(a=a.reduce((function(e,t){var r=t.type!=i||t.not?[t]:t.children;return[].concat((0,nt.Z)(e),(0,nt.Z)(r))}),[])),"op-not"==i)return 1!=a.length&&r.errors.push("Operator NOT should have 1 child, but got ".concat(a.length,"}")),Ro(Ro({},a[0]),{},{not:!a[0].not});if("compound"==i){var l=(a=a.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));l&&1!=l.children.length&&r.errors.push("Selection should have 1 child, but got ".concat(l.children.length));var u=l?l.children[0]:null,s=a[a.length-1],c="method"==s.type&&"size"==s.val.methodName||"!func"==s.type&&"size"==s.methodName,p="property"==s.type&&"length"==s.val,d=a.filter((function(e){return e!==l&&e!==s})),f={type:"compound",children:d};if(c||p)return{type:"!aggr",filter:u,source:f};if(a=(a=a.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"method"==s.type){var g=a.filter((function(e){return e!==s}));return{type:"!func",obj:g,methodName:s.val.methodName,args:s.val.args}}if("!func"==s.type){var v=a.filter((function(e){return e!==s}));return Ro(Ro({},s),{},{obj:v})}}try{t.getRaw?n=t.getRaw():0==t.getValue.length&&(n=t.getValue())}catch(e){Y.kg.error("[spel2js] Error in getValue()",e)}if("ternary"==i&&(n=Do(a)),"object"===(0,Qr.Z)(n)&&null!==n&&(n.methodName||n.functionName)&&(n.args=n.args.map((function(n){return e(n,r,t)}))),"list"==i&&(n=n.map((function(n){return e(n,r,t)})),!o&&1==n.length))return n[0];if("constructorref"==i){var h=a.find((function(e){return"qualifiedidentifier"==e.type})),m=null==h?void 0:h.val;if(!m)return void r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(a)));var y=a.filter((function(e){return"qualifiedidentifier"!=e.type}));return{type:"!new",cls:m,args:y}}if("typeref"==i){var b=a.find((function(e){return"qualifiedidentifier"==e.type})),O=null==b?void 0:b.val;return O?(a.filter((function(e){return"qualifiedidentifier"!=e.type})),{type:"!type",cls:O}):void r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(a)))}if("function"==i||"method"==i){var j=n,F=j.functionName,w=j.methodName,S=j.args;return{type:"!func",methodName:F||w,isVar:"function"==i,args:S}}return{type:i,children:a,val:n}},Do=function(e){var t=[];return function e(r){var n=(0,O.Z)(r,3),o=n[0],i=n[1],a=n[2];t.push([o,i]),"ternary"==(null==a?void 0:a.type)?e(a.children):t.push([void 0,a])}(e),t},xo=function(e){var t={},r=function(r){var n=e.operators[r];if(n.spelOps)n.spelOps.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else if(n.spelOp){var o=n.spelOp;t[o]||(t[o]=[]),t[o].push(r)}else Y.kg.log("[spel] No spelOp for operator ".concat(r))};for(var n in e.operators)r(n);var o={};for(var i in e.conjunctions)o[e.conjunctions[i].spelConj||i.toLowerCase()]=i;var a={};for(var l in e.funcs){var u=e.funcs[l],s=void 0;"string"==typeof u.spelFunc&&(s=u.spelFunc),s&&(a[s]||(a[s]=[]),a[s].push(l))}return{operators:t,conjunctions:o,funcs:a}},Io=function(e,t){var r=!1,n=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;r=!0,t.errors.push("Unexpected item in compound: ".concat(JSON.stringify(e)))}));return r?void 0:n},Ao=function e(t,r,n,o,i){if(null!=t){var a=n.settings.fieldSeparator,l={number:"number",string:"text",boolean:"boolean",null:"null"},u=null!=i&&i._groupField?[null==i?void 0:i._groupField]:[];if("compound"==t.type){var s,p,d=Io(t.children,o);if(!d)return;var f=[].concat(u,(0,nt.Z)(d));return{valueSrc:"field",isVariable:"variable"==(null===(s=t.children)||void 0===s||null===(p=s[0])||void 0===p?void 0:p.type),value:f.join(a)}}if("variable"==t.type||"property"==t.type){var g=[].concat(u,[t.val]);return{valueSrc:"field",isVariable:"variable"==t.type,value:g.join(a)}}if(l[t.type]){var v=t.val,h=l[t.type];return null!=i&&i.isUnary&&(v=-v),{valueSrc:"value",valueType:h,value:v}}if("list"==t.type){var m,y=t.val.map((function(i){return e(i,r,n,o,t)}));return y.length&&(null===(m=y[0])||void 0===m||m.valueType),{valueSrc:"value",valueType:"multiselect",value:y.map((function(e){return null==e?void 0:e.value}))}}if("!func"==t.type){var b,O=t.obj,j=t.methodName,F=t.args,w=(t.isVar,b={},(0,c.Z)(b,".contains","like"),(0,c.Z)(b,".startsWith","starts_with"),(0,c.Z)(b,".endsWith","ends_with"),(0,c.Z)(b,"$contains","select_any_in"),(0,c.Z)(b,".equals","multiselect_equals"),(0,c.Z)(b,"CollectionUtils.containsAny()","multiselect_contains"),b),S=F.map((function(a){return e(a,r,n,o,Ro(Ro({},t),{},{_groupField:null==i?void 0:i._groupField}))}));if("contains"==j&&O&&"list"==O[0].type){var C=O.map((function(i){return e(i,r,n,o,t)}));if(1!=S.length||"field"!=S[0].valueSrc)return void o.errors.push("Expected arg to method ".concat(j," to be field but got: ").concat(JSON.stringify(S)));var E=S[0].value;if(1!=C.length||"multiselect"!=C[0].valueType)return void o.errors.push("Expected object of method ".concat(j," to be inline list but got: ").concat(JSON.stringify(C)));var k=w["$"+j],P=C[0];return qo(n,o,E,k,[P])}if(O&&"property"==O[0].type&&w[O[0].val+"."+j+"()"]){var L=w[O[0].val+"."+j+"()"],Z=S[0].value,_=S.slice(1);return qo(n,o,Z,L,_)}if(w["."+j]){var R=w["."+j],T=Io(O,o);if(T&&1==S.length){var V=[].concat(u,(0,nt.Z)(T)).join(a);return qo(n,o,V,R,S)}}else{if("parse"==j&&O&&"!new"==O[0].type&&"SimpleDateFormat"==O[0].cls.at(-1)){var N=O[0].args.map((function(a){return e(a,r,n,o,Ro(Ro({},t),{},{_groupField:null==i?void 0:i._groupField}))}));if(1!=N.length||"text"!=N[0].valueType)return void o.errors.push("Expected args of ".concat(O[0].cls.join("."),".").concat(j," to be 1 string but got: ").concat(JSON.stringify(N)));if(1!=S.length||"text"!=S[0].valueType)return void o.errors.push("Expected args of ".concat(O[0].cls.join(".")," to be 1 string but got: ").concat(JSON.stringify(S)));var D=N[0].value,x=S[0].value,I=D.includes(" ")?"datetime":"date",A=I,q=(0,H.getFieldConfig)(n,null),M=n.widgets[A||(null==q?void 0:q.mainWidget)].valueFormat,B=po()(x,po().ISO_8601);return{valueSrc:"value",valueType:I,value:B.isValid()?B.format(M):void 0}}if("parse"==j&&O&&"!type"==O[0].type&&"LocalTime"==O[0].cls.at(-1)){if(1!=S.length||"text"!=S[0].valueType)return void o.errors.push("Expected args of ".concat(O[0].cls.join(".")," to be 1 string but got: ").concat(JSON.stringify(S)));var G=S[0].value,W=((0,H.getFieldConfig)(n,null),n.widgets.time.valueFormat),z=po()(G,"HH:mm:ss");return{valueSrc:"value",valueType:"time",value:z.isValid()?z.format(W):void 0}}o.errors.push("Unsupported method ".concat(j))}}else{if("op-plus"==t.type&&"ternary"==(null==i?void 0:i.type))return Jo(t,r,n,o);o.errors.push("Can't convert arg of type ".concat(t.type))}}},qo=function(e,t,r,n,o){if(!o.filter((function(e){return void 0===e})).length){var i=(0,H.getFieldConfig)(e,r);if(i){var a=(0,U.wg)(e,r,n),l=e.widgets[a||i.mainWidget],u=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),s=u.length?u[0]:void 0;return{type:"rule",id:(0,$.Z)(),properties:{field:r,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==l?void 0:l.type)||(null==i?void 0:i.type))||e.valueType})),asyncListValues:s}}}t.errors.push("No config for field ".concat(r))}},Mo=function(e,t,r,n,o){var i=e.groupFilter,a=e.groupFieldValue;if("field"!=a.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(a));var l=a.value,u=qo(n,o,l,t,r);if(u){var s=(0,H.getFieldConfig)(n,l),c=null==s?void 0:s.mode,p=Ro(Ro({},i||{}),{},{type:"rule_group",properties:Ro(Ro(Ro({},u.properties),(null==i?void 0:i.properties)||{}),{},{mode:c})});return p.id||(p.id=(0,$.Z)()),p}},Bo=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(e.type==t.type){if("!aggr"==e.type){var l=[e.source,t.source].map((function(e){return Ao(e,n,o,i,Ro(Ro({},r),{},{_groupField:null==a?void 0:a._groupField}))})),u=(0,O.Z)(l,2),s=u[0],c=u[1];return s.value==c.value}var p=[e,t].map((function(e){return Ao(e,n,o,i,Ro(Ro({},r),{},{_groupField:null==a?void 0:a._groupField}))})),d=(0,O.Z)(p,2),f=d[0],g=d[1];return f.value==g.value}return!1},Go=function e(t,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){var a;if(0==t.type.indexOf("op-")){var l=t.type.slice("op-".length),u=("minus"==l||"plus"==l)&&1==t.children.length;if(u)return t.isUnary=!0,e(t.children[0],r,n,o,t);var s="and"==l&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,c="or"==l&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type,p=s||c;if(p){var d=(0,O.Z)(t.children[0].children,2),f=d[0],g=d[1],v=(0,O.Z)(t.children[1].children,2),h=v[0],m=v[1],y="number"==g.type&&"number"==m.type,b=Bo(f,h,t,r,n,o,i);if(y&&b){g.val,m.val;var j={type:"op-between",children:[f,g,m]};return e(j,r,n,o,i)}}var F,w=r.operators[l];"eq"==l&&"null"==t.children[1].type?F="is_null":"ne"==l&&"null"==t.children[1].type?F="is_not_null":"le"==l&&"string"==t.children[1].type&&""==t.children[1].val?(F="is_empty",w=["is_empty"]):"gt"==l&&"string"==t.children[1].type&&""==t.children[1].val?(F="is_not_empty",w=["is_not_empty"]):"between"==l&&(F="between",w=["between"]);var S=function(){return t.children.map((function(a){return e(a,r,n,o,Ro(Ro({},t),{},{_groupField:null==i?void 0:i._groupField}))}))};if("and"==l||"or"==l){var C={},E=S();E.forEach((function(e){if(e){var t=(0,$.Z)();e.id=t,null!=e.type?C[t]=e:o.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),a={type:"group",id:(0,$.Z)(),children1:C,properties:{conjunction:r.conjunctions[l],not:t.not}}}else if(w){var k=S(),P=k[0],L=k.slice(1);if(F=w[0],P)if(P.groupFieldValue){"field"!=P.groupFieldValue.valueSrc&&o.errors.push("Expected group field ".concat(JSON.stringify(P)));var Z=P.groupFieldValue.value,_=L[0];_&&_.groupFieldValue&&"field"==_.groupFieldValue.valueSrc&&_.groupFieldValue.value==Z?(F="all",L=[]):"equal"==F&&"value"==_.valueSrc&&"number"==_.valueType&&0==_.value?(F="none",L=[]):"greater"==F&&"value"==_.valueSrc&&"number"==_.valueType&&0==_.value&&(F="some",L=[]),a=Mo(P,F,L,n,o)}else{"field"!=P.valueSrc&&o.errors.push("Expected field ".concat(JSON.stringify(P)));var R=P.value;if(w.length>1){Y.kg.warn("[spel] Spel operator ".concat(l," can be mapped to ").concat(w));var T=w.map((function(e){return{op:e,widget:(0,U.wg)(n,R,e)}}));if("eq"==l||"ne"==l){var V=T.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));F=V.op}}a=qo(n,o,R,F,L)}}else i||(a=Wo(t,r,n,o)),a||o.errors.push("Can't convert op ".concat(l))}else if("!aggr"==t.type){var N,D=e(t.source,r,n,o,Ro(Ro({},t),{},{_groupField:null==i?void 0:i._groupField})),x=e(t.filter,r,n,o,Ro(Ro({},t),{},{_groupField:null==D?void 0:D.value}));"rule"==(null===(N=x)||void 0===N?void 0:N.type)&&(x=Ho(x,n)),a={groupFilter:x,groupFieldValue:D},i||(a=void 0,o.errors.push("Unexpected !aggr in root"))}else if("ternary"==t.type){var I={};t.val.forEach((function(e){var i=(0,O.Z)(e,2),a=i[0],l=i[1],u=zo(a,l,r,n,o,t);u&&(I[u.id]=u)})),a={type:"switch_group",id:(0,$.Z)(),children1:I,properties:{}}}else if((a=Ao(t,r,n,o,i))&&!a.type&&!i){var A=Wo(t,r,n,o);A?a=A:(a=void 0,o.errors.push("Can't convert rule of type ".concat(t.type,", it looks like var/literal")))}return a}},Wo=function(e,t,r,n){var o={},i=zo(null,e,t,r,n);return i&&(o[i.id]=i),{type:"switch_group",id:(0,$.Z)(),children1:o,properties:{}}},zo=function(e,t,r,n,o){var i,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=$o(n,o,r,t,a);return e?(i=Go(e,r,n,o,a))&&i.type?("group"!=i.type&&(i=Ho(i,n)),i.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0):i={id:(0,$.Z)(),type:"case_group",properties:{}},i&&(i.properties=Ro(Ro({},i.properties),l)),i},Jo=function(e,t,r,n){var o=[];return function i(a){a.map((function(a){if("op-plus"==a.type)i(a.children);else{var l=Ao(a,t,r,n,e);l?o.push(l):n.errors.push("Can't convert ".concat(a.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},$o=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a={};o="op-plus"==(null==n?void 0:n.type)?Jo(n,r,e,t):Ao(n,r,e,t,i);var l=e.widgets.case_value,u=null==l?void 0:l.spelImportValue;if(u){var s=u(o),c=(0,O.Z)(s,2),p=c[0],d=c[1];d.map((function(e){return t.errors.push(e)})),p&&(a={value:[p],valueSrc:["value"],valueType:["case_value"]})}else t.errors.push("No fucntion to import case value");return a},Ho=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:(0,$.Z)(),children1:(0,c.Z)({},e.id,e),properties:{conjunction:(0,S.defaultConjunction)(t),not:r||!1}}},Uo=(r(26333),r(70328),r(50832)),Yo={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:function(){return new Date}},spelFunc:"new java.util.Date()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Ko={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:function(e,t,r){return po()(e).add(t,r).toDate()}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field"]},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}}},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"]},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}}}}},Xo={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:".toLowerCase",jsonLogicCustomOps:{toLowerCase:function(e){return e.toLowerCase()}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field"]}}},Qo={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:".toUpperCase",jsonLogicCustomOps:{toUpperCase:function(e){return e.toUpperCase()}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field"]}}},ei={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},ti=r(16930);function ri(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ri(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oi=ni(ni(ni({},u),a),l)},50832:(e,t,r)=>{"use strict";r.d(t,{ZS:()=>u,_O:()=>c,jU:()=>s,lR:()=>p});var n=r(649),o=r(27791),i=r(50824),a=r.n(i),l=r(30888),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n=(0,o.Z)(a().mark((function n(o,i,u){var s,c,p,d,f,g;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=null!=u.pageSize?u.pageSize:t,c=(0,l.LH)(e).filter((function(e){var t=e.title;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())})),s&&Math.ceil(c.length/s),p=i||0,s&&Math.ceil(p/s),d=s?c.slice(p,p+s):c,f=s?p+d.length:null,g=!!s&&f<c.length,console.debug("simulateAsyncFetch",{search:o,offset:i,values:d,hasMore:g,filtered:c}),n.next=11,(0,l._v)(r);case 11:return n.abrupt("return",{values:d,hasMore:g});case 12:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()},s=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return e;var o=e||[],i=t.filter((function(e){return null==o.find((function(t){return t.value==e.value}))})),a=r?[].concat((0,n.Z)(i),(0,n.Z)(o)):[].concat((0,n.Z)(o),(0,n.Z)(i));return a},c=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,i=e.renderTitle,a={title:t,value:r};return n&&(a.disabled=n),o&&(a.groupTitle=o),i&&(a.renderTitle=i),a},p=function(e,t){return(0,l.mi)(t,(function(t){return t.value===e?t:null})).filter((function(e){return null!==e})).shift()}},64779:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createConfigMemo:()=>S,extendConfig:()=>C,getFieldConfig:()=>N,getFieldRawConfig:()=>Z,getFieldWidgetConfig:()=>x,getFuncArgConfig:()=>V,getFuncConfig:()=>T,getOperatorConfig:()=>D,normalizeField:()=>R});var n=r(649),o=r(64649),i=r(33940),a=r(15409),l=r.n(a),u=r(4229),s=r(73952),c=r.n(s),p=r(37991),d=r(61320),f=r.n(d),g=r(30888),v=r(46752),h=r(43023),m=r.n(h),y=r(14648),b=r.n(y);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=["conjunctions","fields","types","operators","widgets","settings","funcs"],S=function(){var e=new Map,t=0;return function(r){return n=function(e){return b()(e,w)}(r),function(t){var r,n=j(e.keys());try{var o=function(){var n=r.value;if(0===w.map((function(e){return n[e]===t[e]})).filter((function(e){return!e})).length)return{v:e.get(n)}};for(n.s();!(r=n.n()).done;){var a=o();if("object"===(0,i.Z)(a))return a.v}}catch(e){n.e(e)}finally{n.f()}var l,u=j(e.values());try{var s=function(){var e=l.value;if(0===w.map((function(r){return e[r]===t[r]})).filter((function(e){return!e})).length)return{v:e}};for(u.s();!(l=u.n()).done;){var c=s();if("object"===(0,i.Z)(c))return c.v}}catch(e){u.e(e)}finally{u.f()}return null}(n)||function(r){var n=C(r,++t);return e.size+1>2&&e.delete(e.keys()[0]),e.set(r,n),n}(n);var n}},C=function(e,t){return e.__configId||(e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),e.settings=l()({},p.X,e.settings),e._fieldsCntByType={},e._funcsCntByType={},e.types=m()(e.types),function(e,t){for(var r in e)E(0,e[r],t)}(e.types,e),e.fields=m()(e.fields),e.__fieldNames={},k(e.fields,e),e.funcs=m()(e.funcs),P(e.funcs,e),f().locale(e.settings.locale.moment),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||(0,u.Z)()})),e};function E(e,t,r){var n=null,o=null;for(var i in t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0],t.widgets){var a=t.widgets[i];if(a.operators){var u=a.operators;t.excludeOperators&&(u=u.filter((function(e){return!t.excludeOperators.includes(e)}))),n=(0,g.UU)(n,u)}a.defaultOperator&&(o=a.defaultOperator),i==t.mainWidget&&(a=l()({},{widgetProps:t.mainWidgetProps||{}},a)),t.widgets[i]=a}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var s,c=j(t.valueSources);try{for(c.s();!(s=c.n()).done;){var p=s.value;"value"==p||t.widgets[p]||(t.widgets[p]={})}}catch(e){c.e(e)}finally{c.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function k(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var o in e)L(e[o],t,[].concat((0,n.Z)(r),[o])),e[o].subfields&&k(e[o].subfields,t,[].concat((0,n.Z)(r),[o]))}function P(e,t){if(e)for(var r in e){var n=e[r];for(var o in n.returnType&&(t._funcsCntByType[n.returnType]||(t._funcsCntByType[n.returnType]=0),t._funcsCntByType[n.returnType]++),n.args)L(n.args[o],t,null,!0);if(n.args){var i,a=!0,l=j(Object.keys(n.args).reverse());try{for(l.s();!(i=l.n()).done;){var u=i.value,s=n.args[u];!a&&s.isOptional&&delete s.isOptional,s.isOptional||(a=!1)}}catch(e){l.e(e)}finally{l.f()}}n.subfields&&P(n.subfields,t)}}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=null,a=null,u=t.types[e.type],s=e.excludeOperators||[];if("!struct"!=e.type&&"!group"!=e.type){var c=["listValues","allowCustomValues","validateValue"];e.fieldSettings||(e.fieldSettings={});for(var p=0,d=c;p<d.length;p++){var f=d[p];e[f]&&(e.fieldSettings[f]=e[f],delete e[f])}if(e.fieldSettings.listValues&&(e.fieldSettings.listValues=(0,g.Pq)(e.fieldSettings.listValues,e.type,e.fieldSettings)),!u)return void(e.disabled=!0);o||(t._fieldsCntByType[e.type]||(t._fieldsCntByType[e.type]=0),t._fieldsCntByType[e.type]++),e.widgets||(e.widgets={}),o&&(e._isFuncArg=!0),e.mainWidget=e.mainWidget||u.mainWidget,e.valueSources=e.valueSources||u.valueSources;var v=u.excludeOperators||[];for(var h in u.widgets){var m=e.widgets[h]||{},y=u.widgets[h]||{};o||function(){var t=[].concat((0,n.Z)(s),(0,n.Z)(v)),r=e.preferWidgets&&("field"==h||e.preferWidgets.includes(h))||t.length>0;if(m.operators){var o=m.operators.filter((function(e){return!t.includes(e)}));i=[].concat((0,n.Z)(i||[]),(0,n.Z)(o))}else if(r&&y.operators){var l=y.operators.filter((function(e){return!t.includes(e)}));i=[].concat((0,n.Z)(i||[]),(0,n.Z)(l))}m.defaultOperator&&(a=m.defaultOperator)}(),h==e.mainWidget&&(m=l()({},{widgetProps:e.mainWidgetProps||{}},m)),e.widgets[h]=m}o||(!e.operators&&i&&(e.operators=Array.from(new Set(i))),!e.defaultOperator&&a&&(e.defaultOperator=a))}var b=_(t,r);b&&(e.fieldName=b),r&&e.fieldName&&(t.__fieldNames[e.fieldName]=r)}var Z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"==t)return{type:"case_value",mainWidget:"case_value",widgets:{case_value:e.widgets.case_value}};var o=e.settings.fieldSeparator,i=Array.isArray(t)?t:t.split(o),a=e[r];if(!a)return null;for(var l=a,u=null,s=[],c=0;c<i.length;c++){var p=i[c];s.push(p);var d=s.join(o);u=l[d],c<i.length-1&&(u&&u[n]?(l=u[n],s=[]):u=null)}return u},_=function(e,t){if(!t)return null;for(var r,o,i=e.settings.fieldSeparator,a=(0,n.Z)(t),l=[];void 0!==(r=a.pop())&&a.length>0;)if(l.unshift(r),(o=Z(e,a)).fieldName)return[o.fieldName].concat(l).join(i);return null},R=function(e,t){var r=e.settings.fieldSeparator,n=Array.isArray(t)?t.join(r):t;return e.__fieldNames[n]?e.__fieldNames[n].join(r):n},T=function(e,t){return t&&Z(e,t,"funcs","subfields")||null},V=function(e,t,r){var n=T(e,t);if(!n)return null;var o=n.args&&n.args[r]||null;if(!o)return null;var i=e.types[o.type]||{};return c()({},i,o||{},(function(e,t,r,n,o,i){if(Array.isArray(e))return t}))},N=function(e,t){if(!t)return null;if("object"==(0,i.Z)(t)&&!t.func&&t.type)return t;if("object"==(0,i.Z)(t)&&t.func&&t.arg)return V(e,t.func,t.arg);var r=Z(e,t);if(!r)return null;var n=e.types[r.type]||{};return c()({},n,r||{},(function(e,t,r,n,o,i){if(Array.isArray(e))return t}))},D=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o=N(e,r),i=(0,v.wg)(e,r,t),a=e.widgets[i]||{},u=(o&&o.widgets?o.widgets[i]:{})||{},s=(a.opProps||{})[t],c=(u.opProps||{})[t],p=l()({},n,s,c);return p}return n},x=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;if(!r&&!n&&"const"!=o&&"!case_value"!=t)return null;var i=N(e,t);n||(n=(0,v.wg)(e,t,r,o));var a=e.widgets[n]||{},u=(i&&i.widgets?i.widgets[n]:{})||{},s=u.widgetProps||{},c=("value"==o||!o)&&i&&i.fieldSettings||{},p=l()({},a,s,c);return p}},53893:(e,t,r)=>{"use strict";r.r(t),r.d(t,{defaultConjunction:()=>h,defaultField:()=>p,defaultGroupConjunction:()=>v,defaultGroupProperties:()=>m,defaultItemProperties:()=>y,defaultOperator:()=>d,defaultOperatorOptions:()=>f,defaultRoot:()=>O,defaultRule:()=>b,defaultRuleProperties:()=>g});var n=r(64649),o=r(90046),i=r.n(o),a=r(4229),l=r(64779),u=r(46752);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof e.settings.defaultField?e.settings.defaultField(r):e.settings.defaultField||(t?(0,u.C1)(e,r):null)},d=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(0,l.getFieldConfig)(e,t),o=n&&n.operators||[],i=n&&n.defaultOperator;o.includes(i)||(i=null),!i&&r&&(i=(0,u.Gx)(e,t));var a="function"==typeof e.settings.defaultOperator?e.settings.defaultOperator(t,n):i;return a},f=function(e,t,r){var n=t?(0,l.getOperatorConfig)(e,t,r):null;return n&&n.options?new(i().Map)(n.options&&n.options.defaults||{}):null},g=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null,l=null,s=e.settings,c=s.setDefaultFieldAndOp,g=s.showErrorMessage;o?(a=null==o||null===(t=o.properties)||void 0===t?void 0:t.field,l=null==o||null===(r=o.properties)||void 0===r?void 0:r.operator):c&&(a=p(e,!0,n),l=d(e,a));var v=new(i().Map)({field:a,operator:l,value:new(i().List),valueSrc:new(i().List),operatorOptions:f(e,l,a)});if(g&&(v=v.set("valueError",new(i().List))),a&&l){var h=(0,u.g0)(e,e,v,a,l,"operator",!1),m=h.newValue,y=h.newValueSrc,b=h.newValueType,O=h.newValueError;v=v.set("value",m).set("valueSrc",y).set("valueType",b),g&&(v=v.set("valueError",O))}return v},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(t=(0,l.getFieldConfig)(e,t))&&t.conjunctions||Object.keys(e.conjunctions);return 1==r.length?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},h=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(i().Map)({conjunction:v(e,t),not:!1})},y=function(e,t){var r;return t&&"group"==t.type?m(e,null==t||null===(r=t.properties)||void 0===r?void 0:r.field):g(e,null,t)},b=function(e,t){return(0,n.Z)({},e,new(i().Map)({type:"rule",id:e,properties:g(t)}))},O=function(e){return new(i().Map)({type:"group",id:(0,a.Z)(),children1:new(i().OrderedMap)(c({},b((0,a.Z)(),e))),properties:m(e)})}},75144:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SqlString:()=>o,mongoEmptyValue:()=>a,spelEscape:()=>c,spelFixList:()=>s,spelFormatConcat:()=>p,spelImportConcat:()=>d,sqlEmptyValue:()=>i});var n=r(33940),o=r(59383);o.trim=function(e){return"'"==e.charAt(0)?e.substring(1,e.length-1):e},o.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=o.escape(e);return"'"+(n=(t?"%":"")+(n=(n=o.trim(n)).replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var i=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},a=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},l=function(e){return"'"+e.replace(/'/g,"''")+"'"},u=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!i.includes(t)||!i.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return c(e,!0)})):e.map((function(e){return c(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")},s=function(e){return"".concat(e,".?[true]")},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch((0,n.Z)(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return u(e,r);throw new Error("spelEscape: Object is not supported");default:return l(e)}},p=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?c(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},d=function(e){if(null==e)return[void 0,[]];var t=[];return[("case_value"==e.valueType?e.value:[e]).map((function(e){return"value"==e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"==e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]}},86893:(e,t,r)=>{"use strict";r.d(t,{EN:()=>s,K9:()=>f,hq:()=>p,z7:()=>g});var n=r(33940),o=r(64779),i=r(46752),a=r(90046),l=r.n(a),u=function(e){return"object"==(0,n.Z)(e)&&null!==e&&!Array.isArray(e)},s=function(e,t,r){return"func"==t?c(e,r):e},c=function(e,t){return function(e){if(e){var r=e.get("func"),n=r&&(0,o.getFuncConfig)(t,r);if(n){var a=e,l=!1;for(var c in n.args){var p=n.args[c],f=p.valueSources,g=p.isOptional,v=p.defaultValue,h=(0,i.Ac)(t,f,p),m=a.get("args"),y=1==h.length?h[0]:void 0,b=m?m.get(c):void 0,O=b?b.get("value"):void 0,j=(b?b.get("valueSrc"):void 0)||y;if(void 0!==O){var F=s(O,j,t);if(void 0===F)return;if(F!==O&&(a=a.setIn(["args",c,"value"],F)),l)return}else if(void 0===v||u(v)){if(!g)return;l=!0}else a=(a=a.setIn(["args",c,"value"],d(p))).setIn(["args",c,"valueSrc"],"value")}return a}}}(e)},p=function(e,t,r){var n=r.settings.fieldSeparator;e=e||new(l().Map),Array.isArray(t)&&(t=t.join(n)),e=(e=e.set("func",t)).set("args",new(l().Map));var a=t&&(0,o.getFuncConfig)(r,t);if(a)for(var s in a.args){var c=a.args[s],p=c.valueSources,f=c.defaultValue,g=(0,i.Ac)(r,p,c),v=g.length?g[0]:void 0,h=(f?u(f)&&f.func?"func":"value":void 0)||v;void 0!==f&&(e=e.setIn(["args",s,"value"],d(c))),h&&(e=e.setIn(["args",s,"valueSrc"],h))}return e},d=function(e){var t=e.defaultValue;return u(t)&&!l().Map.isMap(t)&&t.func?l().fromJS(t,(function(e,t){return l().Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},f=function(e,t,r,n,o){if(e&&e.get("func")){e=e.setIn(["args",t,"value"],r);var a=n.valueSources,l=(0,i.Ac)(o,a,n),u=1==l.length?l[0]:void 0;u&&(e=e.setIn(["args",t,"valueSrc"],u))}return e},g=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new(l().Map)({valueSrc:r}))),e}},93168:(e,t,r)=>{"use strict";r.d(t,{DE:()=>f,EM:()=>d,M6:()=>s,W7:()=>u,gt:()=>c});var n=r(27378),o=r(25389),i=r.n(o),a=r(30888),l=function e(t){if(t){var r,n=(r=t)._reactRootContainer?"root":Object.getOwnPropertyNames(r).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==n?n:e(t.parentNode)}},u=function(e){return"root"===l(e)},s=function(e,t){return function(r,n){var o=e.props,i=e.state,l=r!=o||n!=i;if(l&&i==n&&o!=r){var u=[];for(var s in r){var c=r[s]!=o[s];c&&("ignore"==t[s]?c=!1:"shallow_deep"==t[s]?c=!(0,a.wU)(r[s],o[s],!0):"shallow"==t[s]?c=!(0,a.wU)(r[s],o[s]):"function"==typeof t[s]&&(c=t[s](r[s],o[s],n))),c&&u.push(s)}u.length||(l=!1)}return l}},c=function(e){return function(t,r){return!(0,a.wU)(e.props,t)||!(0,a.wU)(e.state,r)}},p=function(){var e=n.version.split(".").map(parseInt.bind(null,10));return 16==e[0]&&e[1]>=3||e[0]>16},d=function(e){p?e.UNSAFE_componentWillReceiveProps=function(t){e.onPropsChanged(t)}:e.componentWillReceiveProps=function(t){e.onPropsChanged(t)}},f=function(e,t,r){return i()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r(e.apply(void 0,[t].concat(o)))}}))}},46752:(e,t,r)=>{"use strict";r.d(t,{Ac:()=>C,At:()=>j,C1:()=>v,CD:()=>S,Gx:()=>m,Qu:()=>h,eI:()=>E,fY:()=>O,g0:()=>g,gk:()=>F,i5:()=>P,lC:()=>b,rA:()=>y,wg:()=>k});var n=r(33940),o=r(649),i=r(11026),a=r(64779),l=r(30888),u=r(90046),s=r.n(u),c=r(73289),p=r(31159),d=r.n(p),f=["select","multiselect","treeselect","treemultiselect"],g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],d=arguments.length>7&&void 0!==arguments[7]&&arguments[7];t||(t=e);var g=r.get("field"),v=r.get("operator"),h=r.get("value"),m=r.get("valueSrc",new(s().List)),y=r.get("valueType",new(s().List)),b=r.get("asyncListValues"),O=e.settings,j=O.convertableWidgets,F=O.clearValueOnChangeField,w=O.clearValueOnChangeOp,S=O.showErrorMessage,C=(0,a.getOperatorConfig)(e,o,n),P=o?(0,l.LS)(C.cardinality,1):null,L=(0,a.getFieldConfig)(t,g),Z=(0,a.getFieldConfig)(e,n),_=g&&v&&o&&null!=h&&(!u||"field"==u&&!F||"operator"==u&&!w)&&L&&Z&&L.type==Z.type;_&&f.includes(L.type)&&"field"==u&&(_=!1);for(var R=0;R<P;R++){var T=m.get(R)||null,V=k(t,g,v,T),N=k(e,n,o,T),D="value"==T?V:k(t,g,v,"value"),x="value"==T?N:k(e,n,o,"value"),I=x==D||(j[D]||[]).includes(x);I||(_=!1)}v!=o&&[v,o].includes("proximity")&&(_=!1);var A=(0,a.getFieldWidgetConfig)(e,n,o,null,m.first()),q=E(e,n,o),M={},B=Array.from({length:P},(function(){return null}));if(_)for(var G=function(t){var r=h.get(t),a=y.get(t)||null,l=m.get(t)||null,s=null!=q.find((function(e){return e==l}));!s&&t>0&&null==l&&(s=!0);var f=b,g=(0,c.ik)(e,n,n,o,r,a,l,f,p,d),v=(0,i.Z)(g,2),O=v[0],j=v[1],F=j!==r,w=!s||!!O&&("field"==u||!S&&!F);if(!!O&&S&&!w&&!F&&(B[t]=O),F&&(M[t]=j),w)return _=!1,"break"},W=0;W<P;W++){var z=G(W);if("break"===z)break}var J=null,$=null,H=null,U=null;if(J=new(s().List)(Array.from({length:P},(function(e,t){var r=void 0;if(_)t<h.size&&(r=h.get(t),void 0!==M[t]&&(r=M[t]));else if(1==P){var n;r=(0,l.du)([null==Z?void 0:Z.defaultValue,null==Z||null===(n=Z.fieldSettings)||void 0===n?void 0:n.defaultValue,null==A?void 0:A.defaultValue])}return r}))),$=new(s().List)(Array.from({length:P},(function(e,t){var r=null;return _?t<m.size&&(r=m.get(t)):(1==q.length||q.length>1)&&(r=q[0]),r}))),S){if(C&&C.validateValues&&$.toJS().filter((function(e){return"value"==e||null==e})).length==P){var Y=A&&A.toJS?J.toJS().map((function(e){return A.toJS(e,A)})):J.toJS(),K=C.validateValues(Y);S&&B.push(K)}U=new(s().List)(B)}return H=new(s().List)(Array.from({length:P},(function(e,t){var r=null;return _?t<y.size&&(r=y.get(t)):1==P&&A&&void 0!==A.type?r=A.type:1==P&&Z&&void 0!==Z.type&&(r="!group"==Z.type?"number":Z.type),r}))),{canReuseValue:_,newValue:J,newValueSrc:$,newValueType:H,newValueError:U,operatorCardinality:P}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n="string"==typeof t?t.split(r):t,o=t?(0,a.getFieldRawConfig)(e,t):e,i=o,l=null,u=[];do{var s=i===e?e.fields:i.subfields;if(!s||!Object.keys(s).length){i=l=null;break}l=Object.keys(s)[0],u.push(l),i=s[l]}while("!struct"==i.type||"!group"==i.type);return(n||[]).concat(u).join(r)},h=function(e,t){var r=(0,a.getFieldConfig)(e,t);return r?r.operators:[]},m=function(e,t){var r=h(e,t);return r?r[0]:null},y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=Array.isArray(e)?e:e.split(n);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},b=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return O(e,t,r,"funcs","subfields")},O=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var l=t.settings.fieldSeparator,u=Array.isArray(e)?e:e.split(l),s=r?Array.isArray(r)?r:r.split(l):[];return u.slice(s.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat((0,o.Z)(s),(0,o.Z)(e)).join(l)})).map((function(e){var r=(0,a.getFieldRawConfig)(t,e,n,i);return r&&r.label||r&&d()(e.split(l))})).filter((function(e){return null!=e}))},j=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&(0,a.getFieldRawConfig)(t,r)||null,i=t.settings.fieldSeparator,l=Array.isArray(e)?e:e.split(i),u=r?Array.isArray(r)?r:r.split(i):[];return l.slice(u.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat((0,o.Z)(u),(0,o.Z)(e)).join(i),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:(0,a.getFieldRawConfig)(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},F=function(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=t&&"object"==(0,n.Z)(t)&&!!t.func&&!!t.arg,s=e.settings.showLabels,c=(0,a.getFieldConfig)(e,t),p=(0,a.getFieldWidgetConfig)(e,t,r,null,i)||{},d=(0,a.getOperatorConfig)(e,r,t)||{},f=l?1:d.cardinality,g=null;if(f>1){var v=p.valueLabels||d.valueLabels;v&&(g=v[o]),g&&"object"!=(0,n.Z)(g)&&(g={label:g,placeholder:g}),g||(g={label:e.settings.valueLabel+" "+(o+1),placeholder:e.settings.valuePlaceholder+" "+(o+1)})}else{var h=p.valueLabel,m=p.valuePlaceholder;u&&(h||(h=c.label||t.arg),m||s||(m=c.label||t.arg)),g={label:h||e.settings.valueLabel,placeholder:m||e.settings.valuePlaceholder}}return g};function w(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=[],l=[];if(!t)return{widgets:i,valueSrcs:l};var u="object"==(0,n.Z)(t)&&(!!t.func&&!!t.arg||t._isFuncArg),s=(0,a.getFieldConfig)(e,t),c=r?e.operators[r]:null;if(s&&s.widgets){var p=function(n){var a=s.widgets[n],p=e.widgets[n].valueSrc||"value",d=!0;if("field"==n&&(d=d&&C(e,["field"],s).length>0),"func"==n&&(d=d&&C(e,["func"],s).length>0),"value"!=o||a.operators||u||"!case_value"==t||(d=!1),a.operators&&r&&(d=d&&-1!=a.operators.indexOf(r)),o&&o!=p&&"const"!=o&&(d=!1),c&&0==c.cardinality&&"value"!=p&&(d=!1),d){i.push(n);var f=s.valueSources&&-1!=s.valueSources.indexOf(p);c&&c.valueSources&&-1==c.valueSources.indexOf(p)&&(f=!1),f&&!l.find((function(e){return e==p}))&&l.push(p)}};for(var d in s.widgets)p(d)}var f=function(e){var t=0;return s.preferWidgets?s.preferWidgets.includes(e)&&(t+=10-s.preferWidgets.indexOf(e)):e==s.mainWidget&&(t+=100),"field"==e&&(t-=1),"func"==e&&(t-=2),t};return i.sort((function(e,t){return f(t)-f(e)})),{widgets:i,valueSrcs:l}}var S=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=w(e,t,r,n),i=o.widgets;return i},C=function(e,t,r){return r?t.filter((function(t){var n=!0;if("field"==t&&e._fieldsCntByType){var o=r._isFuncArg?0:1;n=n&&e._fieldsCntByType[r.type]>o}return"func"==t&&(e._funcsCntByType&&(n=n&&!!e._funcsCntByType[r.type]),r.funcs&&(n=n&&r.funcs.length>0)),n})):t},E=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=w(e,t,r,null),i=o.valueSrcs,a=C(e,i,n);return a},k=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=w(e,t,r,n),i=o.widgets,a=null;return i.length&&(a=i[0]),a},P=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var i=(0,a.getFieldConfig)(t,e)||{},l=t.settings.fieldSeparator,u=Array.isArray(e)?e:e.split(l),s=Array.isArray(e)?e.join(l):e;if(i.tableName){var c=(0,o.Z)(u);c[0]=i.tableName,s=c.join(l)}if(i.fieldName&&(s=i.fieldName),n){var p=(0,a.getFieldConfig)(t,n)||{},d=n;p.fieldName&&(d=p.fieldName),0==s.indexOf(d+l)?s=s.slice((d+l).length):r.errors.push("Can't cut group ".concat(d," from field ").concat(s))}return s}}},30888:(e,t,r)=>{"use strict";r.d(t,{Gj:()=>Z,LF:()=>T,LH:()=>j,LS:()=>p,N0:()=>F,Pq:()=>P,Rh:()=>f,UU:()=>N,_v:()=>_,aS:()=>d,du:()=>x,gH:()=>V,hr:()=>y,kg:()=>I,mi:()=>S,vZ:()=>g,w1:()=>w,wU:()=>v,y6:()=>L,zo:()=>C});var n=r(11026),o=r(649),i=r(33940),a=r(90046),l=r.n(a),u=r(27061);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e,t){return void 0===e?t:e},d=function(e,t,r){if(!t||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."},f=function(e,t){return e===t||e.equals(t)},g=function(e,t){return e===t||(a.Map.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},v=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?h(e,t,r):a.Map.isMap(e)?e.equals(t):"object"==(0,i.Z)(e)?m(e,t,r):e===t)};function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++){var i=r?v(e[o],t[o],r):e[o]===t[o];if(!i)return!1}return!0}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var a=0;a<i;a++){var l=n[a],u=r?v(e[l],t[l],r):e[l]===t[l];if(!u)return!1}return!0}var y=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},b=function(e){return"object"==(0,i.Z)(e)&&null!==e},O=function(e,t){return b(e)?e:{value:e,title:void 0!==t?t:e}},j=function(e){if(!b(e))return e;if(Array.isArray(e))return e.map((function(e){return O(e)}));var t=[];for(var r in e){var n=e[r];t.push(O(r,n))}return t},F=function(e,t){if(Array.isArray(e)){var r=e.map((function(e){return O(e)}));return r.find((function(e){return e.value===t}))||r.find((function(e){return"".concat(e.value)===t}))}return void 0!==e[t]?O(t,e[t]):void 0},w=function(e,t){if(null==e)return t;var r=F(e,t);return void 0!==r?r.title:t},S=function(e,t){var r=[];if(Array.isArray(e)){var n,o=s(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=t(O(i));null!=a&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}}else for(var l in e){var u=t(O(l,e[l]));null!=u&&r.push(u)}return r},C={id:"value",pId:"parent",rootPId:void 0},E=function e(t,r){var n=C,i=F(t,r),a=i?i[n.pId]:void 0,l=a?t.find((function(e){return e[n.id]===a})):void 0;return l?[l.value].concat((0,o.Z)(e(t,l.value))):[]},k=function(e,t){var r=C,n=F(e,t);return n?e.filter((function(e){return e[r.pId]===n[r.id]})).map((function(e){return e.value})):[]},P=function(e,t,r){var n=["treeselect","treemultiselect"].includes(t),o=["multiselect","treemultiselect"].includes(t);return n&&(e=function(e,t,r){var n,o=s(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.path=E(e,i.value),0!=t.treeSelectOnlyLeafs){var a=k(e,i.value);r||(i.selectable=0==a.length)}}}catch(e){o.e(e)}finally{o.f()}return e}(e=function(e){var t,r,n=C,o=function e(o,i,a){if(o.children){1==a&&(o[n.pId]=n.rootPId);var l,u=o.children.length,c=s(o.children);try{for(c.s();!(l=c.n()).done;){var p=l.value;p[n.pId]=o[n.id],t++,i.splice(t,0,p),r++,e(p,i,a+1)}}catch(e){c.e(e)}finally{c.f()}delete o.children,0==u&&(i.splice(t,1),t--,r--)}};if(Array.isArray(e))for(r=e.length,t=0;t<r;t++){var i=e[t];b(i)&&(void 0!==i[n.pId]&&i[n.pId]!=n.rootPId||o(i,e,1))}return e}(e=j(e)),r,o)),e},L=function(e,t){if(!e)return e;for(var r=!0,n=0;n<t.length;n++){var o=t[n];if(void 0===e[n]||o!=e[n]){r=!1;break}}return r?e.slice(t.length):e},Z=function(e){return"object"===(0,i.Z)(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length};function _(e){return new Promise((function(t){setTimeout(t,e)}))}var R=function(e){return"object"===(0,i.Z)(e)&&null!==e&&"function"==typeof e.toJS};function T(e){return R(e)?e.toJS():e}function V(e){return R(e)?e:new(l().List)(e)}function N(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var o=(0,n.Z)(e,2),i=o[0];if(-1==o[1]){var a=r.slice(t+1),l=r.slice(0,t).reverse().find((function(e){var t=(0,n.Z)(e,2);return t[0],-1!=t[1]})),u=a.find((function(e){var t=(0,n.Z)(e,2);return t[0],-1!=t[1]}));return u?[i,"before",u[0]]:l?[i,"after",l[0]]:[i,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=(0,n.Z)(t,3),o=r[0],i=r[1],a=r[2],l=e.indexOf(a);return-1==e.indexOf(o)&&(l>-1?e.splice(l+("after"==i?1:0),0,o):e.splice("append"==i?1/0:0,0,o)),e}),e.slice())}var D=function(){return void 0!==u&&{NODE_ENV:"production"}&&!1},x=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},I=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=null!=e?e:D();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}}()},49925:(e,t,r)=>{"use strict";r.r(t),r.d(t,{expandTreePath:()=>l,expandTreeSubpath:()=>u,fixEmptyGroupsInTree:()=>f,fixPathsInTree:()=>d,getFlatTree:()=>g,getItemByPath:()=>s,getLightTree:()=>y,getSwitchValues:()=>b,getTotalReordableNodesCountInTree:()=>v,getTotalRulesCountInTree:()=>h,getTreeBadFields:()=>m,hasChildren:()=>j,isEmptyTree:()=>O,removeIsLockedInTree:()=>p,removePathsInTree:()=>c});var n=r(649),o=r(64649),i=r(90046),a=r.n(i),l=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},u=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},s=function(e,t){var r=new(a().OrderedMap)((0,o.Z)({},e.get("id"),e)),n=e;return t.forEach((function(e){n=r.get(e),r=n.get("children1")})),n},c=function(e){var t=e;return function e(r,n){var o=n.push(r.get("id"));r.get("path")&&(t=t.removeIn(l(o,"path")));var i=r.get("children1");i&&i.map((function(t,r){e(t,o)}))}(e,new(a().List)),t},p=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.push(r.get("id")),a=r.getIn(["properties","isLocked"]);o&&a&&(t=t.deleteIn(l(i,"properties","isLocked")));var u=r.get("children1");u&&u.map((function(t,r){e(t,i,a||o)}))}(e,new(a().List)),t},d=function(e){var t=e;return function e(r,n,o,i){if(r){var u=r.get("path"),s=r.get("id"),c=s||i,p=n.push(c);u&&u.equals(p)||(t=t.setIn(l(p,"path"),p)),s||(t=t.setIn(l(p,"id"),c));var d=r.get("children1");d&&("Map"==d.constructor.name&&(t=t.setIn(l(p,"children1"),new(a().OrderedMap)(d))),d.map((function(t,r){e(t,p,o+1,r)})))}}(e,new(a().List),0),t},f=function(e){var t=e;return function e(r,n,o,i){if(!r)return!1;var a=r.get("id")||i,u=n.push(a),s=r.get("children1");if(s){var c=s.map((function(t,r){return e(t,u,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==s.size||c)&&o>0)return t=t.deleteIn(l(u)),!0}return!1}(e,new(a().List),0),t},g=function(e){var t=[],r={},n=0;!function e(o,i,a,l,u,s,c,p,d){var f=o.get("type"),g=o.get("collapsed"),v=o.get("id"),h=o.get("children1"),m=o.getIn(["properties","isLocked"]),y=h?h.map((function(e,t){return t})):null,b="rule_group"==f,O=!u&&(!h||b),j=t.length,F=n;if(t.push(v),a||(n+=1),c.height=(c.height||0)+1,r[v]={type:f,parent:i.length?i[i.length-1]:null,parentType:p,caseId:"case_group"==f?v:d,isDefaultCase:"case_group"==f&&!h,path:i.concat(v),lev:s,leaf:!h,index:j,id:v,children:y,leafsCount:0,_top:j,_height:S-j,top:a?null:F,height:C,bottom:(a?null:F)+C,collapsed:g,node:o,isLocked:m||l},h){var w={};h.map((function(t,r){e(t,i.concat(v),a||g,l||m,u||b,s+1,w,f,"case_group"==f?v:d)})),g||(c.height=(c.height||0)+(w.height||0))}d&&O&&r[d].leafsCount++;var S=t.length,C=c.height;Object.assign(r[v],{_height:S-j,height:C,bottom:(a?null:F)+C})}(e,[],!1,!1,!1,0,{},null,null);for(var o=0;o<t.length;o++){var i=o>0?t[o-1]:null,a=o<t.length-1?t[o+1]:null,l=r[t[o]];l.prev=i,l.next=a}return{flat:t,items:r}},v=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,l;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),l=r.get("type")):(i=r.id,a=r.children1,l=r.type),t++,a&&"rule_group"!=l&&a.map((function(t,r){e(t,n.concat(i),o+1)}))}(e,[],0),t-1},h=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,l;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),l=r.get("type")):(i=r.id,a=r.children1,l=r.type),"rule"==l||"rule_group"==l?t++:a&&a.map((function(t,r){e(t,n.concat(i),o+1)}))}(e,[],0),t},m=function(e){var t=[];return e&&function e(r,n,o){var i=r.get("id"),a=r.get("children1"),l=r.getIn(["properties","valueError"]),u=r.getIn(["properties","field"]);l&&l.size>0&&l.filter((function(e){return null!=e})).size>0&&t.push(u),a&&a.map((function(t,r){e(t,n.concat(i),o+1)}))}(e,[],0),Array.from(new Set(t))},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e;function n(e,r){e.path&&delete e.path,!t&&r&&delete e.id;var o=e.properties;o&&null==o.operatorOptions&&delete o.operatorOptions;var i=e.children1;if(i){for(var a in i)n(i[a],a);t&&(e.children1=Object.values(i))}}return n(e,null),r},b=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,o=e.getIn(["properties","value"]);o&&1==o.size?(r=o.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat((0,n.Z)(t),[r])})),t},O=function(e){return!e.get("children1")||0==e.get("children1").size},j=function(e,t){return e.getIn(l(t,"children1")).size>0}},4229:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=0;const o=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&n++;return("x"===e?t:3&t|8).toString(16)}))+e}},73289:(e,t,r)=>{"use strict";r.d(t,{ci:()=>v,ik:()=>b,lB:()=>m});var n=r(649),o=r(11026),i=r(33940),a=r(64779),l=r(46752),u=r(30888),s=r(53893),c=r(49925),p=r(48159),d=r.n(p),f=r(90046),g=function(e,t){return function(e){return"object"==(0,i.Z)(e)&&null!==e&&Array.isArray(e)?"array":(0,i.Z)(e)}(e)==t||"number"==t&&!isNaN(e)},v=function(){var e,t,r;return function(n,o,i){return o?n.__configId===r&&((0,u.Rh)(o,e)||(0,u.Rh)(o,t))?t:(r=n.__configId,e=o,t=h(o,null,n,i||n)):null}},h=function(e,t,r,n){var o=m(e,t,r,n);return(0,c.fixPathsInTree)(o)},m=function(e,t,r,n,o,i){return void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===i&&(i=r.settings.removeIncompleteRulesOnLoad),y(e,[],null,{},{config:r,oldConfig:n,removeEmptyGroups:o,removeIncompleteRules:i})};function y(e,t,r,n,o){var i=e.get("type"),c=e.get("children1");return("group"===i||"rule_group"===i||"case_group"==i||"switch_group"==i)&&c&&c.size?function(e,t,r,n,o){var i=o.removeEmptyGroups,a=e.get("id"),l=e.get("children1"),u=l;!a&&r&&(a=r,e=e.set("id",a),n.sanitized=!0);var s={};l=l.map((function(e,r){return y(e,t.concat(a),r,s,o)})),i&&(l=l.filter((function(e){return null!=e})));var c=s.sanitized||u.size!=l.size;return!l.size&&i&&t.length&&(c=!0,e=void 0),c&&(n.sanitized=!0),c&&e&&(e=e.set("children1",l)),e}(e,t,r,n,o):"rule"===i?function(e,t,r,n,o){var i=o.removeIncompleteRules,c=o.config,p=o.oldConfig,d=c.settings.showErrorMessage,f=e.get("id"),g=e.get("properties"),v=g.get("field")||null,h=g.get("operator")||null,m=g.get("operatorOptions"),y=g.get("valueSrc"),b=g.get("value"),O=g.get("valueError"),j={field:v,operator:h,operatorOptions:m?m.toJS():{},valueSrc:y?y.toJS():null,value:b?b.toJS():null,valueError:O?O.toJS():null};v&&h&&b&&b.includes(void 0),!f&&r&&(f=r,e=e.set("id",f),n.sanitized=!0);var F=v?(0,a.getFieldConfig)(c,v):null;v&&!F&&(u.kg.warn("No config for field ".concat(v)),v=null),null==v&&(g=["operator","operatorOptions","valueSrc","value"].reduce((function(e,t){return e.delete(t)}),g),h=null),"range_between"!=h&&"range_not_between"!=h||(h="range_between"==h?"between":"not_between",console.info("Fixed operator ".concat(g.get("operator")," to ").concat(h)),g=g.set("operator",h));var w=h?(0,a.getOperatorConfig)(c,h,v):null;h&&!w&&(console.warn("No config for operator ".concat(h)),h=null);var S=v?(0,l.Qu)(c,v):[];S?h&&-1==S.indexOf(h)&&("is_empty"==h||"is_not_empty"==h?(h="is_empty"==h?"is_null":"is_not_null",console.info("Fixed operator ".concat(g.get("operator")," to ").concat(h," for ").concat(v)),g=g.set("operator",h)):(console.warn("Operator ".concat(h," is not supported for field ").concat(v)),h=null)):(console.warn("Type of field ".concat(v," is not supported")),h=null),null==h&&(g=(g=(g=g.delete("operatorOptions")).delete("valueSrc")).delete("value")),m=g.get("operatorOptions"),h&&(0,u.LS)(w.cardinality,1),!h||m&&!w.options?(m=null,g=g.delete("operatorOptions")):h&&!m&&w.options&&(m=(0,s.defaultOperatorOptions)(c,h,v),g=g.set("operatorOptions",m)),y=g.get("valueSrc"),b=g.get("value");var C=!d,E=(0,l.g0)(c,p,g,v,h,null,C,!0);b=E.newValue,y=E.newValueSrc,O=E.newValueError,g=(g=g.set("value",b)).set("valueSrc",y),d&&(g=g.set("valueError",O));var k={field:v,operator:h,operatorOptions:m?m.toJS():{},valueSrc:y?y.toJS():null,value:b?b.toJS():null,valueError:O?O.toJS():null},P=!(0,u.vZ)(j,k),L=v&&h&&b&&!b.includes(void 0);return P&&(n.sanitized=!0),!L&&i?e=void 0:P&&(e=e.set("properties",g)),e}(e,0,r,n,o):e}var b=function(e,t,r,n,i,u,s,c){var p=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=arguments.length>9&&void 0!==arguments[9]&&arguments[9],g=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],v=null,h=i;if(null!=i){if("field"==s){var m=F(t,r,i,s,u,c,e,n,f,p),y=(0,o.Z)(m,2);v=y[0],h=y[1]}else if("func"==s){var b=w(t,r,i,s,u,c,e,n,f,p),O=(0,o.Z)(b,2);v=O[0],h=O[1]}else if("value"==s||!s){var S=j(t,r,i,s,u,c,e,n,f,p),C=(0,o.Z)(S,2);v=C[0],h=C[1]}if(!v){(0,a.getFieldConfig)(e,r);var E=(0,l.wg)(e,r,n,s),k=n?(0,a.getOperatorConfig)(e,n,r):null,P=d()((0,a.getFieldWidgetConfig)(e,r,n,E,s),["factory"]),L="field"==s?(0,a.getFieldConfig)(e,i):null,Z=P,_=P.validateValue;if("function"==typeof _){var R=[h,Z,n,k];"field"==s&&R.push(L);var T=_.apply(void 0,R);"boolean"==typeof T?0==T&&(v="Invalid value"):v=T}}}return g&&v&&console.warn("[RAQB validate]","Field ".concat(r,": ").concat(v)),[v,h]},O=function(e,t,r,i,a){var l=f.List.isList(e)?e.toJS():e instanceof Array?(0,n.Z)(e):void 0;if(l){var s=l.reduce((function(e,r){var i=(0,o.Z)(e,2),a=i[0],l=i[1],s=(0,u.N0)(t,r);return null==s?[a,[].concat((0,n.Z)(l),[r])]:[[].concat((0,n.Z)(a),[s.value]),l]}),[[],[]]),c=(0,o.Z)(s,2),p=c[0],d=c[1],g=d.length>1;return[d.length?"".concat(g?"Values":"Value"," ").concat(d.join(", ")," ").concat(g?"are":"is"," not in list of values"):null,(r=void 0!==a?a:r||i)?p:e]}var v=(0,u.N0)(t,e);return null==v?["Value ".concat(e," is not in list of values"),e]:[null,e=v.value]},j=function(e,t,r,n,o,u,s){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,p=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]&&arguments[9];if(t){var f=(0,a.getFieldConfig)(s,t),v=(0,l.wg)(s,t,c,n),h=s.widgets[v],m=h.type,y=h.jsType,b=f.fieldSettings;if(o!=m)return["Value should have type ".concat(m,", but got value of type ").concat(o),r];if(y&&!g(r,y)&&!b.listValues)return["Value should have JS type ".concat(y,", but got value of type ").concat((0,i.Z)(r)),r];if(b){var j=u||b.listValues;if(j&&!b.allowCustomValues)return O(r,j,d,p,s.settings.removeInvalidMultiSelectValuesOnLoad);if(null!=b.min&&r<b.min)return["Value ".concat(r," < min ").concat(b.min),d?b.min:r];if(null!=b.max&&r>b.max)return["Value ".concat(r," > max ").concat(b.max),d?b.max:r]}}return[null,r]},F=function(e,t,r,n,o,l,u){var s=u.settings.fieldSeparator,c="object"==(0,i.Z)(t)&&(null==t?void 0:t._isFuncArg),p=Array.isArray(e)?e.join(s):e,d=Array.isArray(r)?r.join(s):r,f=(0,a.getFieldConfig)(u,r);return f?d!=p||c?o&&o!=f.type?["Field ".concat(r," is of type ").concat(f.type,", but expected ").concat(o),r]:[null,r]:["Can't compare field ".concat(e," with itself"),r]:["Unknown field ".concat(r),r]},w=function(e,t,r,n,i,l,u){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=r;if(r){var f=r.get("func");if(f){var g=(0,a.getFuncConfig)(u,f);if(!g)return["Unknown function ".concat(f),r];if(i&&g.returnType!=i)return["Function ".concat(f," should return value of type ").concat(g.returnType,", but got ").concat(i),r];for(var v in g.args){var h=g.args[v],m=d.get("args"),y=m?m.get(v):void 0,O=(0,a.getFieldConfig)(u,h),j=y?y.get("value"):void 0,F=y?y.get("valueSrc"):void 0;if(void 0!==j){var w=b(u,e,O,s,j,h.type,F,l,p,c,!1),S=(0,o.Z)(w,2),C=S[0],E=S[1];if(null!==C){if(!p)return["Invalid value of arg ".concat(v," for func ").concat(f,": ").concat(C),r];d=d.deleteIn(["args",v]),void 0!==h.defaultValue&&(d=(d=d.setIn(["args",v,"value"],h.defaultValue)).setIn(["args",v,"valueSrc"],"value"))}else E!==j&&(d=d.setIn(["args",v,"value"],E))}else if(c&&void 0===h.defaultValue&&!p)return["Value of arg ".concat(v," for func ").concat(f," is required"),r]}}}return[null,d]}},13837:(e,t,r)=>{var n={"./es-us":73099,"./es-us.js":73099,"./ru":21753,"./ru.js":21753,"moment/locale/es-us":73099,"moment/locale/es-us.js":73099,"moment/locale/ru":21753,"moment/locale/ru.js":21753};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=13837}}]);
//# sourceMappingURL=113.bundle.js.map